import{e as Y}from"./element-plus-secondary-0.0.0-dataease.js";import{a as j,e as q}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as T}from"./icon_right_outlined-0.0.0-dataease.js";import{mountedOrg as G,switchOrg as J}from"./user-0.0.0-dataease.js";import B from"./OrgCell-0.0.0-dataease.js";import{b as K}from"./vue-router_2-0.0.0-dataease.js";import{l as Q}from"./login-0.0.0-dataease.js";import{l as X}from"./logout-0.0.0-dataease.js";import{l as Z,d as ee}from"./vant-0.0.0-dataease.js";import{d as te,r as m,b as oe,k as le,o as s,c as g,S as _,a as c,W as d,u as f,Y as I,z as E,T as O,U as k,R as S,a8 as L}from"./@vue-0.0.0-dataease.js";import{_ as re}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./interactive-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";const ae=""+new URL("../png/user-0.0.0-dataease.png",import.meta.url).href,ie={class:"de-mobile-user"},ne={class:"mobile-user-top"},se={class:"user-name"},ce={class:"cell-org_scroll"},pe={class:"grey"},ue=["onClick"],me=te({__name:"index",setup(de){const v=j(),{push:R}=K(),U=m("组织"),C=m(""),x=m(!0),V=async()=>{await Q(),X(),R("/login")},$=()=>{x.value=!1},u=m("");let y=null;const z=()=>{var o;const t=[...y];for(;t.length;){const e=t.pop();if((e==null?void 0:e.id)===v.getOid){C.value=e==null?void 0:e.name;break}(o=e==null?void 0:e.children)!=null&&o.length&&e.children.forEach(i=>t.push(i))}};let p=[],h=[];const N=(t,o)=>{t.forEach(e=>{var b;const{name:i,id:r}=e;o<=p.length?(o<p.length&&(p=p.slice(0,o),h=h.slice(0,o)),p.splice(p.length-1,1,r),h.splice(h.length-1,1,i)):(p.push(r),h.push(i));let n=o+1;r===v.getOid&&(l.value=[...h],a.value=[...p],n=999),(b=e==null?void 0:e.children)!=null&&b.length&&n!==999&&N(e==null?void 0:e.children,n)})};oe(()=>{G().then(t=>{y=t.data,w.value=t.data,z(),N(y,1),l.value.pop(),a.value.pop(),u.value=l.value[l.value.length-1]})});const H=t=>{J(t).then(o=>{const e=o.data.token;v.setToken(e),v.setExp(o.data.exp),v.setTime(Date.now()),window.location.reload()})},W=()=>{l.value.pop(),u.value=l.value[l.value.length-1],a.value.pop(),l.value.length||(x.value=!0)},A=()=>{l.value.length&&(l.value=[],u.value="",a.value=[])},F=(t,o)=>{t!=="right"?H(o.id):(l.value.push(o.name),u.value=o.name,a.value.push(o.id))},M=t=>{t!==a.value.length-1&&(a.value=a.value.slice(0,t+1),l.value=l.value.slice(0,t+1),u.value=l.value[l.value.length-1])},w=m([]),l=m([]),a=m([]),D=(t,o)=>{const e=t.shift();return o.reduce((i,r)=>{if(e&&r.id===e){if(!t.length)return r.children||[];i=D([...t],r.children||[])||[]}return i},[])},P=le(()=>a.value.length?D([...a.value],w.value):w.value);return(t,o)=>{const e=q,i=Y;return s(),g("div",ie,[x.value?(s(),g(_,{key:0},[o[0]||(o[0]=c("div",{class:"logout flex-center",style:{"padding-top":"8px",margin:"0"}},"我的",-1)),c("div",ne,[d(f(Z),{round:"",width:"48",height:"48",src:f(ae)},null,8,["src"]),c("div",se,I(f(v).name),1)]),d(B,{onClick:$,label:"切换组织","prefix-icon":"icon_switch_outlined",tips:C.value,nextlevel:""},null,8,["tips"]),c("div",{class:"logout flex-center danger",onClick:V},"注销")],64)):(s(),g(_,{key:1},[d(f(ee),{"safe-area-inset-top":"",title:u.value||U.value,"left-arrow":"",onClickLeft:W},null,8,["title"]),c("div",ce,[c("div",pe,[c("div",{onClick:A,class:"flex-align-center"},[c("span",{class:E(["ellipsis",!!l.value.length&&"active"])},"组织",2),l.value.length?(s(),O(i,{key:0},{default:k(()=>[d(e,{name:"icon_right_outlined"},{default:k(()=>[d(f(T),{class:"svg-icon"})]),_:1})]),_:1})):S("",!0)]),(s(!0),g(_,null,L(l.value,(r,n)=>(s(),g("div",{onClick:b=>M(n),class:"flex-align-center",key:r},[c("span",{class:E(["ellipsis",r!==u.value&&"active"])},I(r),3),l.value.length>1&&n!==l.value.length-1?(s(),O(i,{key:0},{default:k(()=>[d(e,{name:"icon_right_outlined"},{default:k(()=>[d(f(T),{class:"svg-icon"})]),_:1})]),_:1})):S("",!0)],8,ue))),128))]),(s(!0),g(_,null,L(P.value,r=>(s(),O(B,{onClick:n=>F(n,r),key:r.id,label:r.name,nextlevel:r.children,active:C.value===r.name},null,8,["onClick","label","nextlevel","active"]))),128))])],64))])}}});const Bt=re(me,[["__scopeId","data-v-289afcd3"]]);export{Bt as default};
