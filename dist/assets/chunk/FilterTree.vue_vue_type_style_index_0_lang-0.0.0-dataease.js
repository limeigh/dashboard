import{E as w,i as C,M as E}from"./element-plus-secondary-0.0.0-dataease.js";import F from"./RowAuth-0.0.0-dataease.js";import{s as S}from"./snapshot-0.0.0-dataease.js";import{d as B,i as L,r as u,k as x,o as A,T as D,U as a,W as l,_ as f,Y as m,a as p,n as M,q as N}from"./@vue-0.0.0-dataease.js";const $={class:"tree-cont"},I={class:"content"},Y=B({__name:"FilterTree",emits:["filter-data"],setup(U,{expose:_,emit:h}){const v=h,g=L("filedList",()=>[]),r=u(),i=u(!1),n=x(()=>g().reduce((t,e)=>(e.id!=="-1"&&(t[e.id]=e),t),{}));N("filedList",n);const T=()=>{i.value=!1},y=S(),b=()=>{r.value.submit()},k=t=>{const{logic:e,items:s,errorMessage:o}=t;if(o){w.error({message:o,type:"error",showClose:!0});return}c(s),v("filter-data",{logic:e,items:s}),y.recordSnapshotCache("changeFilter"),i.value=!1},c=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?c(e.subTree.items||[]):e.field&&delete e.field})},d=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?d(e.subTree.items):n.value[e.fieldId]&&(e.field=n.value[e.fieldId])})};return _({init:t=>{i.value=!0,M(()=>{d(t.items||[]),r.value.init(t||{})})}}),(t,e)=>{const s=C,o=E;return A(),D(o,{width:"896px","append-to-body":"",title:t.$t("chart.add_filter"),"destroy-on-close":"",class:"de-dialog-form filter-tree-cont",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=V=>i.value=V)},{footer:a(()=>[l(s,{secondary:"",onClick:T},{default:a(()=>[f(m(t.$t("chart.cancel")),1)]),_:1}),l(s,{type:"primary",onClick:b},{default:a(()=>[f(m(t.$t("chart.confirm")),1)]),_:1})]),default:a(()=>[p("div",$,[p("div",I,[l(F,{onSave:k,ref_key:"rowAuth",ref:r},null,512)])])]),_:1},8,["title","modelValue"])}}});export{Y as _};
