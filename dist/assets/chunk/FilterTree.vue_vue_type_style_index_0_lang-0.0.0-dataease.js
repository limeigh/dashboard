import"./index-0.0.0-dataease.js";import{E as w}from"./el-dialog-0.0.0-dataease.js";import{D as C,y as E}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import F from"./RowAuth-0.0.0-dataease.js";import{s as L}from"./snapshot-0.0.0-dataease.js";import{d as S,x,r as f,y as B,f as D,g as A,i as r,j as l,a3 as u,a4 as m,P as p,n as N,L as $}from"./vue-0.0.0-dataease.js";const j={class:"tree-cont"},I={class:"content"},G=S({__name:"FilterTree",emits:["filter-data"],setup(M,{expose:_,emit:h}){const g=h,v=x("filedList",()=>[]),a=f(),i=f(!1),n=B(()=>v().reduce((t,e)=>(e.id!=="-1"&&(t[e.id]=e),t),{}));$("filedList",n);const y=()=>{i.value=!1},T=L(),b=()=>{a.value.submit()},V=t=>{const{logic:e,items:s,errorMessage:o}=t;if(o){C.error({message:o,type:"error",showClose:!0});return}c(s),g("filter-data",{logic:e,items:s}),T.recordSnapshotCache("changeFilter"),i.value=!1},c=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?c(e.subTree.items||[]):e.field&&delete e.field})},d=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?d(e.subTree.items):n.value[e.fieldId]&&(e.field=n.value[e.fieldId])})};return _({init:t=>{i.value=!0,N(()=>{d(t.items||[]),a.value.init(t||{})})}}),(t,e)=>{const s=E,o=w;return D(),A(o,{width:"896px","append-to-body":"",title:t.$t("chart.add_filter"),"destroy-on-close":"",class:"de-dialog-form filter-tree-cont",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=k=>i.value=k)},{footer:r(()=>[l(s,{secondary:"",onClick:y},{default:r(()=>[u(m(t.$t("chart.cancel")),1)]),_:1}),l(s,{type:"primary",onClick:b},{default:r(()=>[u(m(t.$t("chart.confirm")),1)]),_:1})]),default:r(()=>[p("div",j,[p("div",I,[l(F,{onSave:V,ref_key:"rowAuth",ref:a},null,512)])])]),_:1},8,["title","modelValue"])}}});export{G as _};
