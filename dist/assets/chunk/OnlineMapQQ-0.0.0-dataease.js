import{d as w,r as d,o as y,a as T,f as M,O,_ as C,n as E}from"./vue-0.0.0-dataease.js";import{_ as I}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const h=["id"],L=w({__name:"OnlineMapQQ",props:{mapKey:{},securityCode:{}},setup(m){const l=d("de-map-container"),t=d(null),s=d(!1),i=m,_=()=>{if(!i.mapKey)return;const e=`https://map.qq.com/api/gljs?v=1.exp&key=${i.mapKey}`;v(e).then(()=>{var n;if(t.value){(n=t.value)==null||n.destroy(),t.value=null,s.value=!0,setTimeout(()=>{l.value=l.value+"-de-",s.value=!1,E(()=>{u()})},1500);return}u()}).catch(n=>{console.error(n),t.value&&(t.value.destroy(),t.value=null)})},u=()=>{var o,e,n;if(window.TMap){const c=new window.TMap.LatLng(39.90923,116.397428);t.value=new window.TMap.Map(document.getElementById(l.value),{viewMode:"2D",zoom:11,center:c}),(o=t.value)==null||o.removeControl(window.TMap.constants.DEFAULT_CONTROL_ID.ZOOM),(e=t.value)==null||e.removeControl(window.TMap.constants.DEFAULT_CONTROL_ID.ROTATION),(n=t.value)==null||n.removeControl(window.TMap.constants.DEFAULT_CONTROL_ID.SCALE)}},v=o=>new Promise(function(e,n){var p;const c="de-qq-script-id";let r=document.getElementById(c);r&&((p=r.parentElement)==null||p.removeChild(r),r=null,window.TMap=null);const a=document.createElement("script");a.id=c,a.onload=function(){return e(null)},a.onerror=function(){return n(new Error("Load script from ".concat(o," failed")))},a.src=o;const f=document.head||document.getElementsByTagName("head")[0];(document.body||f).appendChild(a)});return y(()=>{_()}),T(()=>{var n;const o="de-qq-script-id";let e=document.getElementById(o);e&&((n=e.parentElement)==null||n.removeChild(e),e=null,window.TMap=null)}),(o,e)=>s.value?C("",!0):(M(),O("div",{key:0,class:"de-map-container",id:l.value},null,8,h))}});const B=I(L,[["__scopeId","data-v-f25992f6"]]);export{B as default};
