import"./index-0.0.0-dataease.js";import{o as G,n as W,y as X,G as Y,j as H}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as Z}from"./el-row-0.0.0-dataease.js";import{E as ee}from"./el-color-picker-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{a as le,E as ae}from"./el-select-0.0.0-dataease.js";import{E as te}from"./el-col-0.0.0-dataease.js";import{d as oe,X as ne,y as q,o as se,f as d,O as h,P as b,W as g,a6 as x,a8 as U,j as a,i as n,u as r,a3 as ie,a4 as O,g as f,_ as V,l as de,S as re}from"./vue-0.0.0-dataease.js";import{i as ue}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as ce}from"./icon_add_outlined-0.0.0-dataease.js";import{a as pe}from"./chart-0.0.0-dataease.js";import{f as k}from"./attr-0.0.0-dataease23.js";import{i as fe}from"./field-list-0.0.0-dataease.js";import{w as F}from"./lodash-0.0.0-dataease.js";import{E as me}from"./index-0.0.0-dataease20.js";import{E as _e}from"./index-0.0.0-dataease4.js";import{_ as ye}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./index-0.0.0-dataease27.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";import"./index-0.0.0-dataease3.js";const he={style:{float:"left"}},ve={style:{float:"left",color:"#8492a6",fontSize:"12px"}},ge={class:"flex-align-center",style:{"margin-left":"-4px"}},xe=oe({__name:"AssistLineEdit",props:{chart:{type:Object,required:!0},line:{type:Array,required:!0},quotaFields:{type:Array,required:!0},quotaExtFields:{type:Array,required:!0},useQuotaExt:{type:Boolean,default:!1}},emits:["onAssistLineChange"],setup(y,{emit:L}){const{t:s}=G(),i=y,S=[{type:"left",name:s("chart.drag_block_value_axis_left")},{type:"right",name:s("chart.drag_block_value_axis_right")}],c=ne({lineArr:[],lineObj:{name:s("chart.assist_line"),field:"0",fieldId:"",summary:"avg",axis:"y",yAxisType:"left",value:"0",lineType:"solid",color:"#ff0000",curField:{},fontSize:"10"},fieldOptions:[{label:s("chart.field_fixed"),value:"0"},{label:s("chart.field_dynamic"),value:"1"}],lineOptions:[{label:s("chart.line_type_solid"),value:"solid"},{label:s("chart.line_type_dashed"),value:"dashed"},{label:s("chart.line_type_dotted"),value:"dotted"}],predefineColors:pe,fontSize:[]}),N=q(()=>{const l=[];for(let t=10;t<=60;t=t+2)l.push({name:t+"",value:t+""});return l}),z=L,w=()=>{c.lineArr=JSON.parse(JSON.stringify(i.line)),c.lineArr.forEach(l=>{i.useQuotaExt?(l.yAxisType==="left"&&F(i.quotaFields,t=>t.id===l.fieldId)==null&&(l.fieldId=void 0),l.yAxisType==="right"&&F(i.quotaExtFields,t=>t.id===l.fieldId)==null&&(l.fieldId=void 0)):F(i.quotaFields,t=>t.id===l.fieldId)==null&&(l.fieldId=void 0)}),u()},Q=()=>{var t;const l={...c.lineObj,curField:i.quotaFields?i.quotaFields[0]:null,fieldId:i.quotaFields?(t=i.quotaFields[0])==null?void 0:t.id:null};c.lineArr.push(JSON.parse(JSON.stringify(l))),u()},j=l=>{c.lineArr.splice(l,1),u()},B=l=>{var t,_;i.useQuotaExt&&l.yAxisType==="right"?(l.fieldId=i.quotaExtFields?(t=i.quotaExtFields[0])==null?void 0:t.id:null,l.curField=C(l.fieldId)):(l.fieldId=i.quotaFields?(_=i.quotaFields[0])==null?void 0:_.id:null,l.curField=A(l.fieldId)),u()},u=()=>{z("onAssistLineChange",c.lineArr)},$=l=>{i.useQuotaExt&&l.yAxisType==="right"?l.curField=C(l.fieldId):l.curField=A(l.fieldId),u()},A=l=>{if(!l)return{};const t=i.quotaFields.filter(_=>_.id===l);return t.length===0?{}:t[0]},C=l=>{if(!l)return{};const t=i.quotaExtFields.filter(_=>_.id===l);return t.length===0?{}:t[0]},J=q(()=>["percentage-bar-stack","percentage-bar-stack-horizontal"].includes(i.chart.type)?c.fieldOptions.filter(l=>l.value==="0"):c.fieldOptions);return se(()=>{w()}),(l,t)=>{const _=Y,p=te,m=le,v=ae,M=me,E=W,I=H,P=_e,D=ee,K=Z,R=X;return d(),h("div",null,[b("div",{onKeydown:t[0]||(t[0]=U(()=>{},["stop"])),onKeyup:t[1]||(t[1]=U(()=>{},["stop"])),style:{"max-height":"50vh","margin-top":"-4px","overflow-y":"auto"}},[(d(!0),h(g,null,x(c.lineArr,(o,T)=>(d(),f(K,{key:T,class:"line-item",gutter:8},{default:n(()=>[a(p,{span:4},{default:n(()=>[a(_,{modelValue:o.name,"onUpdate:modelValue":e=>o.name=e,class:"value-item",style:{width:"100% !important"},placeholder:r(s)("chart.name"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024),y.useQuotaExt?(d(),f(p,{key:0,span:3},{default:n(()=>[a(v,{modelValue:o.yAxisType,"onUpdate:modelValue":e=>o.yAxisType=e,class:"select-item",onChange:e=>B(o)},{default:n(()=>[(d(),h(g,null,x(S,e=>a(m,{key:e.type,label:e.name,value:e.type},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):V("",!0),a(p,{span:3},{default:n(()=>[a(v,{modelValue:o.field,"onUpdate:modelValue":e=>o.field=e,class:"select-item",onChange:u},{default:n(()=>[(d(!0),h(g,null,x(J.value,e=>(d(),f(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.field==="0"?(d(),f(p,{key:1,span:7},{default:n(()=>[a(M,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,"controls-position":"right",class:"value-item",placeholder:r(s)("chart.drag_block_label_value"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),o.field==="1"?(d(),f(p,{key:2,span:4},{default:n(()=>[a(v,{modelValue:o.fieldId,"onUpdate:modelValue":e=>o.fieldId=e,class:"select-item",placeholder:r(s)("chart.field"),onChange:e=>$(o)},{default:n(()=>[(d(!0),h(g,null,x(y.useQuotaExt&&o.yAxisType==="right"?y.quotaExtFields:y.quotaFields,e=>(d(),f(m,{key:e.id,label:e.name,value:e.id},{default:n(()=>[b("span",he,[a(I,null,{default:n(()=>[a(E,{className:`field-icon-${r(k)[o.deType]}`},{default:n(()=>[(d(),f(de(r(fe)[r(k)[o.deType]]),{class:re(["svg-icon",`field-icon-${r(k)[o.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),b("span",ve,O(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])]),_:2},1024)):V("",!0),o.field==="1"?(d(),f(p,{key:3,span:3},{default:n(()=>[a(v,{modelValue:o.summary,"onUpdate:modelValue":e=>o.summary=e,class:"select-item",placeholder:r(s)("chart.aggregation"),onChange:u},{default:n(()=>[a(m,{key:"avg",value:"avg",label:"平均值"}),a(m,{key:"max",value:"max",label:r(s)("chart.max")},null,8,["label"]),a(m,{key:"min",value:"min",label:r(s)("chart.min")},null,8,["label"]),a(m,{key:"last_item",value:"last_item",label:r(s)("chart.last_item")},null,8,["label"])]),_:1},8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),a(p,{span:y.useQuotaExt?2:3},{default:n(()=>[a(P,{effect:"dark",content:r(s)("chart.font_size"),placement:"top"},{default:n(()=>[a(v,{modelValue:o.fontSize,"onUpdate:modelValue":e=>o.fontSize=e,class:"select-item",placeholder:r(s)("chart.text_fontsize"),onChange:u},{default:n(()=>[(d(!0),h(g,null,x(N.value,e=>(d(),f(m,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["content"])]),_:2},1032,["span"]),a(p,{span:y.useQuotaExt?2:4},{default:n(()=>[a(v,{modelValue:o.lineType,"onUpdate:modelValue":e=>o.lineType=e,class:"select-item",onChange:u},{default:n(()=>[(d(!0),h(g,null,x(c.lineOptions,e=>(d(),f(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["span"]),a(p,{span:2},{default:n(()=>[a(D,{"is-custom":"","trigger-width":60,modelValue:o.color,"onUpdate:modelValue":e=>o.color=e,class:"color-picker-style",predefine:c.predefineColors,onChange:u},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1024),a(p,{span:1},{default:n(()=>[b("div",ge,[a(I,{style:{width:"28px !important",height:"28px !important","font-size":"20px !important"},class:"hover-icon",onClick:e=>j(T)},{default:n(()=>[a(E,{name:"icon_delete-trash_outlined"},{default:n(()=>[a(r(ue),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))],32),a(R,{class:"circle-button",text:"",style:{"margin-left":"5px"},onClick:Q},{icon:n(()=>[a(E,{name:"icon_add_outlined"},{default:n(()=>[a(r(ce),{class:"svg-icon"})]),_:1})]),default:n(()=>[ie(" "+O(r(s)("chart.add_assist_line")),1)]),_:1})])}}});const ol=ye(xe,[["__scopeId","data-v-00668fdd"]]);export{ol as default};
