import{i as Y,r as W,C as X,A as G,y as H,B as Z,e as ee,f as le,N as te,p as ae}from"./element-plus-secondary-0.0.0-dataease.js";import{f as oe,e as ne}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as ie,l as re,k as U,b as se,o as s,c as h,a as b,S as g,a8 as x,X as q,W as t,U as n,u as d,_ as de,Y as O,T as m,R as V,V as ue,z as pe}from"./@vue-0.0.0-dataease.js";import{i as ce}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as me}from"./icon_add_outlined-0.0.0-dataease.js";import{a as fe}from"./chart-0.0.0-dataease.js";import{f as k}from"./attr-0.0.0-dataease23.js";import{i as _e}from"./field-list-0.0.0-dataease.js";import{x as A}from"./lodash-es-0.0.0-dataease.js";import{_ as ye}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";const he={style:{float:"left"}},ve={style:{float:"left",color:"#8492a6",fontSize:"12px"}},ge={class:"flex-align-center",style:{"margin-left":"-4px"}},xe=ie({__name:"AssistLineEdit",props:{chart:{type:Object,required:!0},line:{type:Array,required:!0},quotaFields:{type:Array,required:!0},quotaExtFields:{type:Array,required:!0},useQuotaExt:{type:Boolean,default:!1}},emits:["onAssistLineChange"],setup(y,{emit:L}){const{t:i}=oe(),r=y,N=[{type:"left",name:i("chart.drag_block_value_axis_left")},{type:"right",name:i("chart.drag_block_value_axis_right")}],p=re({lineArr:[],lineObj:{name:i("chart.assist_line"),field:"0",fieldId:"",summary:"avg",axis:"y",yAxisType:"left",value:"0",lineType:"solid",color:"#ff0000",curField:{},fontSize:"10"},fieldOptions:[{label:i("chart.field_fixed"),value:"0"},{label:i("chart.field_dynamic"),value:"1"}],lineOptions:[{label:i("chart.line_type_solid"),value:"solid"},{label:i("chart.line_type_dashed"),value:"dashed"},{label:i("chart.line_type_dotted"),value:"dotted"}],predefineColors:fe,fontSize:[]}),S=U(()=>{const l=[];for(let a=10;a<=60;a=a+2)l.push({name:a+"",value:a+""});return l}),z=L,Q=()=>{p.lineArr=JSON.parse(JSON.stringify(r.line)),p.lineArr.forEach(l=>{r.useQuotaExt?(l.yAxisType==="left"&&A(r.quotaFields,a=>a.id===l.fieldId)==null&&(l.fieldId=void 0),l.yAxisType==="right"&&A(r.quotaExtFields,a=>a.id===l.fieldId)==null&&(l.fieldId=void 0)):A(r.quotaFields,a=>a.id===l.fieldId)==null&&(l.fieldId=void 0)}),u()},w=()=>{var a;const l={...p.lineObj,curField:r.quotaFields?r.quotaFields[0]:null,fieldId:r.quotaFields?(a=r.quotaFields[0])==null?void 0:a.id:null};p.lineArr.push(JSON.parse(JSON.stringify(l))),u()},B=l=>{p.lineArr.splice(l,1),u()},$=l=>{var a,_;r.useQuotaExt&&l.yAxisType==="right"?(l.fieldId=r.quotaExtFields?(a=r.quotaExtFields[0])==null?void 0:a.id:null,l.curField=C(l.fieldId)):(l.fieldId=r.quotaFields?(_=r.quotaFields[0])==null?void 0:_.id:null,l.curField=F(l.fieldId)),u()},u=()=>{z("onAssistLineChange",p.lineArr)},j=l=>{r.useQuotaExt&&l.yAxisType==="right"?l.curField=C(l.fieldId):l.curField=F(l.fieldId),u()},F=l=>{if(!l)return{};const a=r.quotaFields.filter(_=>_.id===l);return a.length===0?{}:a[0]},C=l=>{if(!l)return{};const a=r.quotaExtFields.filter(_=>_.id===l);return a.length===0?{}:a[0]},J=U(()=>["percentage-bar-stack","percentage-bar-stack-horizontal"].includes(r.chart.type)?p.fieldOptions.filter(l=>l.value==="0"):p.fieldOptions);return se(()=>{Q()}),(l,a)=>{const _=W,c=X,f=G,v=H,M=Z,E=ne,I=ee,R=le,D=te,K=ae,P=Y;return s(),h("div",null,[b("div",{onKeydown:a[0]||(a[0]=q(()=>{},["stop"])),onKeyup:a[1]||(a[1]=q(()=>{},["stop"])),style:{"max-height":"50vh","margin-top":"-4px","overflow-y":"auto"}},[(s(!0),h(g,null,x(p.lineArr,(o,T)=>(s(),m(K,{key:T,class:"line-item",gutter:8},{default:n(()=>[t(c,{span:4},{default:n(()=>[t(_,{modelValue:o.name,"onUpdate:modelValue":e=>o.name=e,class:"value-item",style:{width:"100% !important"},placeholder:d(i)("chart.name"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024),y.useQuotaExt?(s(),m(c,{key:0,span:3},{default:n(()=>[t(v,{modelValue:o.yAxisType,"onUpdate:modelValue":e=>o.yAxisType=e,class:"select-item",onChange:e=>$(o)},{default:n(()=>[(s(),h(g,null,x(N,e=>t(f,{key:e.type,label:e.name,value:e.type},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):V("",!0),t(c,{span:3},{default:n(()=>[t(v,{modelValue:o.field,"onUpdate:modelValue":e=>o.field=e,class:"select-item",onChange:u},{default:n(()=>[(s(!0),h(g,null,x(J.value,e=>(s(),m(f,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.field==="0"?(s(),m(c,{key:1,span:7},{default:n(()=>[t(M,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,"controls-position":"right",class:"value-item",placeholder:d(i)("chart.drag_block_label_value"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),o.field==="1"?(s(),m(c,{key:2,span:4},{default:n(()=>[t(v,{modelValue:o.fieldId,"onUpdate:modelValue":e=>o.fieldId=e,class:"select-item",placeholder:d(i)("chart.field"),onChange:e=>j(o)},{default:n(()=>[(s(!0),h(g,null,x(y.useQuotaExt&&o.yAxisType==="right"?y.quotaExtFields:y.quotaFields,e=>(s(),m(f,{key:e.id,label:e.name,value:e.id},{default:n(()=>[b("span",he,[t(I,null,{default:n(()=>[t(E,{className:`field-icon-${d(k)[o.deType]}`},{default:n(()=>[(s(),m(ue(d(_e)[d(k)[o.deType]]),{class:pe(["svg-icon",`field-icon-${d(k)[o.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),b("span",ve,O(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])]),_:2},1024)):V("",!0),o.field==="1"?(s(),m(c,{key:3,span:3},{default:n(()=>[t(v,{modelValue:o.summary,"onUpdate:modelValue":e=>o.summary=e,class:"select-item",placeholder:d(i)("chart.aggregation"),onChange:u},{default:n(()=>[t(f,{key:"avg",value:"avg",label:"平均值"}),t(f,{key:"max",value:"max",label:d(i)("chart.max")},null,8,["label"]),t(f,{key:"min",value:"min",label:d(i)("chart.min")},null,8,["label"]),t(f,{key:"last_item",value:"last_item",label:d(i)("chart.last_item")},null,8,["label"])]),_:1},8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),t(c,{span:y.useQuotaExt?2:3},{default:n(()=>[t(R,{effect:"dark",content:d(i)("chart.font_size"),placement:"top"},{default:n(()=>[t(v,{modelValue:o.fontSize,"onUpdate:modelValue":e=>o.fontSize=e,class:"select-item",placeholder:d(i)("chart.text_fontsize"),onChange:u},{default:n(()=>[(s(!0),h(g,null,x(S.value,e=>(s(),m(f,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["content"])]),_:2},1032,["span"]),t(c,{span:y.useQuotaExt?2:4},{default:n(()=>[t(v,{modelValue:o.lineType,"onUpdate:modelValue":e=>o.lineType=e,class:"select-item",onChange:u},{default:n(()=>[(s(!0),h(g,null,x(p.lineOptions,e=>(s(),m(f,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["span"]),t(c,{span:2},{default:n(()=>[t(D,{"is-custom":"","trigger-width":60,modelValue:o.color,"onUpdate:modelValue":e=>o.color=e,class:"color-picker-style",predefine:p.predefineColors,onChange:u},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1024),t(c,{span:1},{default:n(()=>[b("div",ge,[t(I,{style:{width:"28px !important",height:"28px !important","font-size":"20px !important"},class:"hover-icon",onClick:e=>B(T)},{default:n(()=>[t(E,{name:"icon_delete-trash_outlined"},{default:n(()=>[t(d(ce),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))],32),t(P,{class:"circle-button",text:"",style:{"margin-left":"5px"},onClick:w},{icon:n(()=>[t(E,{name:"icon_add_outlined"},{default:n(()=>[t(d(me),{class:"svg-icon"})]),_:1})]),default:n(()=>[de(" "+O(d(i)("chart.add_assist_line")),1)]),_:1})])}}});const Nl=ye(xe,[["__scopeId","data-v-00668fdd"]]);export{Nl as default};
