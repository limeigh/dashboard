var d=Object.defineProperty;var a=(i,t,e)=>t in i?d(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var u=(i,t,e)=>(a(i,typeof t!="symbol"?t+"":t,e),e);import{aQ as l,x as h}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{b as x}from"./index-0.0.0-dataease.js";const{wsCache:f}=x();class p{constructor(){u(this,"uuid");u(this,"pwd");this.uuid=""}getTicket(){const t=window.location.href,e=t.lastIndexOf("?");if(e==-1)return null;const s=t.substring(e+1),n=/([^&=]+)=([^&]*)/g;let o;for(;(o=n.exec(s))!==null;)if(decodeURIComponent(o[1])==="ticket")return decodeURIComponent(o[2]);return null}setUuid(){const t=window.location.href,e=t.lastIndexOf("?"),s=t.substring(t.lastIndexOf("de-link/")+8,e>0?e:t.length);if(s!=null&&s.includes(",")){const n=s.indexOf(",");this.uuid=s.substring(0,n),s.length>n+1&&(this.pwd=s.substring(n+1))}else this.uuid=s}async loadProxy(){if(this.setUuid(),!this.uuid)return null;const t=this.uuid,e="/share/proxyInfo",s=l(),n=this.getTicket(),o={uuid:t,ciphertext:null,inIframe:s,ticket:n},c=f.get(`link-${t}`);c&&(o.ciphertext=c);const r=(await h.post({url:e,data:o})).data;return r&&(r.uuid=t,this.pwd&&(r.pwd=this.pwd)),r}}const k=new p;export{k as s};
