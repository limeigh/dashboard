var a=Object.defineProperty;var d=(i,t,e)=>t in i?a(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var u=(i,t,e)=>(d(i,typeof t!="symbol"?t+"":t,e),e);import{k as l}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{a as h,F as f,g as x}from"./index-0.0.0-dataease.js";const{wsCache:p}=h();class g{constructor(){u(this,"uuid");u(this,"pwd");this.uuid=""}getTicket(){const t=window.location.href,e=t.lastIndexOf("?");if(e==-1)return null;const s=t.substring(e+1),n=/([^&=]+)=([^&]*)/g;let o;for(;(o=n.exec(s))!==null;)if(decodeURIComponent(o[1])==="ticket")return decodeURIComponent(o[2]);return null}setUuid(){const t=window.location.href,e=t.lastIndexOf("?"),s=t.substring(t.lastIndexOf("de-link/")+8,e>0?e:t.length);if(s!=null&&s.includes(",")){const n=s.indexOf(",");this.uuid=s.substring(0,n),s.length>n+1&&(this.pwd=s.substring(n+1))}else this.uuid=s}async loadProxy(){if(this.setUuid(),!this.uuid)return null;const t=this.uuid,e="/share/proxyInfo",s=f(),n=this.getTicket(),o={uuid:t,ciphertext:null,inIframe:s,ticket:n},c=p.get(x(`link-${t}`));c&&(o.ciphertext=c);const r=(await l.post({url:e,data:o})).data;return r&&(r.uuid=t,this.pwd&&(r.pwd=this.pwd)),r}}const y=new g;export{y as s};
