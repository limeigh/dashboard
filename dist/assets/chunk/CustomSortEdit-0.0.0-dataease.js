import{b as L,R as j,z as k}from"./index-0.0.0-dataease.js";import{n as w,j as D}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as I}from"./icon_drag_outlined-0.0.0-dataease.js";import{d as O}from"./vuedraggable-es-0.0.0-dataease.js";import{e as B,f as R}from"./chart-0.0.0-dataease2.js";import{d as T,r as A,X as F,w as M,f as p,g as h,i as n,R as N,u as g,O as V,j as m,P as z,a4 as P}from"./vue-0.0.0-dataease.js";import{_ as U}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";const X=["title"],$={class:"item-span"},G=T({__name:"CustomSortEdit",props:{chart:{type:Object,required:!0},field:{type:Object,required:!0},fieldType:{type:String,required:!0},originSortList:{type:Array,default:()=>[],required:!1}},emits:["onSortChange"],setup(v,{emit:y}){const{wsCache:S}=L(),r=A(!1),c=F({sortList:[]}),s=v,x=y;M(()=>s.chart,()=>{u()},{deep:!0});const u=()=>{r.value=!0;const t=s.chart;t.chartExtRequest||(t.chartExtRequest={user:S.get("user.uid")});const o={fieldId:s.field.id,fieldType:s.fieldType,data:t};(s.fieldType==="drillFields"?B:R)(o).then(l=>{var i;const a=l.data;if((i=s.originSortList)!=null&&i.length){const e=[];s.originSortList.forEach(b=>{const d=a.findIndex(q=>q===b);d!==-1&&(e.push(a[d]),a.splice(d,1))}),a.unshift(...e)}c.sortList=a.map(e=>C(e)),_(),r.value=!1}).catch(()=>{r.value=!1})},_=()=>{const t=c.sortList.map(o=>E(o));x("onSortChange",t)},C=t=>({name:"name",value:t}),E=t=>t.value;return u(),(t,o)=>{const f=w,l=D,a=j,i=k;return p(),h(a,{height:"100%","max-height":"599px"},{default:n(()=>[N((p(),h(g(O),{list:c.sortList,animation:"300",class:"drag-list","item-key":"name",onUpdate:_},{item:n(({element:e})=>[(p(),V("span",{key:e.value,class:"item-dimension",title:e.value},[m(l,{class:"item-icon"},{default:n(()=>[m(f,{name:"icon_drag_outlined"},{default:n(()=>[m(g(I),{class:"svg-icon"})]),_:1})]),_:1}),z("span",$,P(e.value),1)],8,X))]),_:1},8,["list"])),[[i,r.value]])]),_:1})}}});const it=U(G,[["__scopeId","data-v-16781915"]]);export{it as default};
