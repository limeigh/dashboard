import{e as k,b as Jt,m as Qt,i as D,E as B,q as ge,f as ea,r as ta,H as aa,I as oa,t as sa,h as na,g as ia,S as la,T as ra,U as da,V as ca,w as ua,x as ma,M as pa,v as _a,G as fa,R as va,W as ha}from"./element-plus-secondary-0.0.0-dataease.js";import{d as ga,r as u,l as Je,k as R,x as ye,W as o,h as S,a7 as ya,w as ba,aq as wa,o as r,c as y,$ as O,z as M,Z as be,u as t,U as s,a as p,Y as h,R as f,S as U,a8 as we,T as m,X as Qe,_ as E,s as Ta,n as Te,q as ka,V as xa}from"./@vue-0.0.0-dataease.js";import{i as Ca}from"./icon_copy_filled-0.0.0-dataease.js";import{i as et}from"./icon_dataset-0.0.0-dataease.js";import{i as Da}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as Sa,_ as Ea,t as Na}from"./index.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import{i as Ia}from"./icon_rename_outlined-0.0.0-dataease.js";import{d as La,i as Aa}from"./icon_file-add_outlined-0.0.0-dataease.js";import{e as Ra,f as Pa,h as Fa,i as Va,j as $a,p as za,k as ke,m as Ba}from"./dataset-0.0.0-dataease.js";import{i as Oa}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as Ma,a as Ua}from"./dv-sort-desc-0.0.0-dataease.js";import{d as tt}from"./dv-folder-0.0.0-dataease.js";import{i as at}from"./icon_add_outlined-0.0.0-dataease.js";import{i as Ga}from"./icon_info_outlined-0.0.0-dataease.js";import{i as ja}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as qa}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{i as Ka}from"./icon_download_outlined-0.0.0-dataease.js";import{i as ot}from"./icon_edit_outlined-0.0.0-dataease.js";import{e as v,i as xe,f as Wa}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import st from"./DeResourceArrow-0.0.0-dataease.js";import{a as Ha,g as C,l as Ya,e as Xa,u as se,m as Za}from"./index-0.0.0-dataease.js";import{_ as nt}from"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{u as Ja}from"./useMoveLine-0.0.0-dataease.js";import{b as Qa,u as eo}from"./vue-router_2-0.0.0-dataease.js";import to from"./CreatDsGroup-0.0.0-dataease.js";import{E as ne}from"./EmptyBackground-0.0.0-dataease.js";import ao from"./DeResourceGroupOpt-0.0.0-dataease.js";import oo from"./DatasetDetail-0.0.0-dataease.js";import{t as so,g as no}from"./util-0.0.0-dataease.js";import{f as N}from"./attr-0.0.0-dataease23.js";import{useAppStoreWithOut as io}from"./app-0.0.0-dataease.js";import{t as it}from"./treeSortUtils-0.0.0-dataease.js";import lo from"./RowAuth-0.0.0-dataease2.js";import{D as ro,b as co}from"./dataVisualization-0.0.0-dataease2.js";import{i as uo}from"./interactive-0.0.0-dataease.js";import{t as mo}from"./@element-plus-0.0.0-dataease.js";import{i as Ce}from"./field-list-0.0.0-dataease.js";import{h as ie,d as po}from"./lodash-es-0.0.0-dataease.js";import{_ as _o}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./icon_right_outlined-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./icon_more_outlined-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./AuthTree-0.0.0-dataease2.js";import"./FilterFiled-0.0.0-dataease2.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./decimal.js-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";const fo={class:"resource-tree"},vo={class:"tree-header"},ho={class:"icon-methods"},go={class:"title"},yo={key:0,class:"flex-align-center"},bo={key:0,class:"ed-dropdown-menu__item--divided"},wo={class:"custom-tree-node"},To=["title"],ko={key:2,class:"icon-more"},xo={class:"dataset-info"},Co={class:"info-method"},Do=["title"],So={class:"create-user"},Eo={class:"right-btn"},No={class:"tab-border"},Io={class:"dataset-table-info"},Lo={key:0,class:"preview-num"},Ao={class:"flex-align-center"},Ro=["title"],Po={key:2,class:"table-row-column"},Fo={class:"tree-cont"},Vo={class:"content"},$o={class:"tip"},zo={class:"dialog-footer"};function lt(Z){return typeof Z=="function"||Object.prototype.toString.call(Z)==="[object Object]"&&!Ta(Z)}const Bo=ga({__name:"index",setup(Z){const{t:n}=Wa(),rt=uo(),{wsCache:x}=Ha(),I=io(),le=u(!1),P=u(!1),G=u(),re=u(!1),De=u(n("data_set.ten_wan")),F=u({}),L=u({}),Se=u(),dt={name:[{required:!0,message:n("commons.input_content"),trigger:"change"},{max:50,message:n("commons.char_can_not_more_50"),trigger:"change"}]},Ee=u([]);ka("filedList",Ee);const j=u(""),de=Qa(),Ne=eo(),_=Je({datasetTree:[],curSortType:"time_desc"}),ct=u(),J=u(""),ce=u(!1),Ie=x.get(C("open-backend"))==="1"?"_self":"_blank",V=R(()=>I.getIsDataEaseBi),Le=R(()=>I.getIsIframe),ut=R(()=>Ya(c.weight,c.ext)),Ae=e=>{const a=`#/${e}?opt=create&id=${c.id}`;x.set(C("dataset-info-id"),c.id),window.open(a,Ie)},mt=e=>{e&&e.opt==="newLeaf"&&_t(e.pid,e.name)},q=ye([]),pt=e=>{_.datasetTree=it(q.value,e),_.curSortType=e,x.set(C("TreeSort-dataset"),_.curSortType)},Re=e=>{_.datasetTree=it(q.value,e),_.curSortType=e},_t=(e,a)=>{const i=no(),d={dataState:"ready",id:i,name:a,pid:e,type:J.value,status:1,selfWatermarkStatus:!0},w=J.value==="dashboard"?ro:co,T={canvasStyleData:JSON.stringify(w),componentData:JSON.stringify([]),canvasViewInfo:{},...d};Oe(T).then(()=>{const X=J.value==="dataV"?"#/dvCanvas?dvId=":"#/dashboard?resourceId=";window.open(X+i,Ie)})},ue=u(),Pe={name:"",createBy:"",creator:"",id:"",nodeType:"",createTime:0,weight:0},c=Je(ie(Pe));let me=[],K=[],Q=[];const ft=[{key:"name",dataKey:"name",title:n("data_set.field_name"),width:250},{key:"deType",dataKey:"deType",title:n("data_set.field_type"),width:250,cellRenderer:({cellData:e})=>{let a;return o("div",{style:{width:"100%",display:"flex",alignItems:"center"}},[o(k,{style:{marginRight:"6px"}},{default:()=>[o(v,null,lt(a=S(Ce[N[e]],{class:`svg-icon field-icon-${N[e]}`}))?a:{default:()=>[a]})]}),n(`dataset.${N[e]}`)+`${e===3?"("+n("dataset.float")+")":""}`])}},{key:"description",dataKey:"description",title:n("data_set.field_notes"),width:250}],ee=u(!1),{width:pe,node:vt}=Ja("DATASOURCE"),Fe=R(()=>({creator:c.creator,createTime:c.createTime&&so(c.createTime)})),{handleDrop:ht,allowDrop:gt,handleDragStart:yt}=Na(_,"datasetTree",Ba,"dataset",q),bt=e=>e.map(a=>({key:a.dataeaseName,deType:a.deType,dataKey:a.dataeaseName,title:a.name,width:150,headerCellRenderer:({column:i})=>{let d;return o("div",{class:"flex-align-center"},[o(k,{style:{marginRight:"6px"}},{default:()=>[o(v,null,lt(d=S(Ce[N[i.deType]],{class:`svg-icon field-icon-${N[i.deType]}`}))?d:{default:()=>[d]})]}),o("span",{class:"ellipsis",title:i.title,style:{width:"120px"}},[i.title])])}})),_e=u(!1),Ve=u(!1),W=()=>{_e.value=!0;let e=he[Number(x.get(C("TreeSort-backend")))??1].value;e=x.get(C("TreeSort-dataset"))??e;const a={busiFlag:"dataset"};rt.setInteractive(a).then(i=>{const d=i||[];if(d.length&&d[0].id==="0"&&d[0].name==="root"){le.value=d[0].weight>=7,_.datasetTree=d[0].children||[],q.value=ie(t(_.datasetTree)),Re(e);return}_.datasetTree=d,q.value=ie(t(_.datasetTree)),Re(e)}).finally(()=>{_e.value=!1,ce.value=!0,Te(()=>{j.value.length&&Y.value.filter(j.value)});const i=c.id;i&&(Object.assign(c,ie(Pe)),$e(_.datasetTree,i),Te(()=>{Ve.value||(Ve.value=!0,Y.value.setCurrentKey(i,!0))}))})},$e=(e,a)=>{e.some(i=>{var d;return i.id===a?(ze(i),!0):((d=i.children)!=null&&d.length&&$e(i.children,a),!1)})};ya(()=>{const e=x.get(C("dataset-info-id"))||Ne.params.id;c.id=e||Ne.query.id||"",x.delete(C("dataset-info-id")),x.delete(C("db-info-id")),x.delete(C("dv-info-id")),At(),W(),Rt()});const $=ye([]),H=ye([]),fe=u(null),ze=e=>{if(!e.leaf){Y.value.setCurrentKey(null);return}Pa(e.id).then(a=>{Object.assign(c,a),c.weight=e.weight,c.ext=e.ext||0,K=[],Q=[],b.value="dataPreview",Ue(b.value)})},wt=()=>{P.value=!0,F.value.name=c.name,F.value.expressionTree="",Te(()=>{G.value.init({}),G.value.relationList=[],G.value.logic="or"})},Be=()=>{P.value=!1},Oe=({logic:e,items:a,errorMessage:i})=>{if(L.value.id=c.id,L.value.row=1e5,L.value.filename=F.value.name,L.value.dataEaseBi=V.value||I.getIsIframe,i){B.error(i);return}L.value.expressionTree=JSON.stringify({items:a,logic:e}),re.value=!0,Fa(L.value).then(d=>{if(V.value||I.getIsIframe){const w=new Blob([d.data],{type:"application/vnd.ms-excel"}),T=document.createElement("a");T.style.display="none",T.href=URL.createObjectURL(w),T.download=L.value.filename+".xlsx",document.body.appendChild(T),T.click(),document.body.removeChild(T)}else Ct(kt)}).finally(()=>{re.value=!1,P.value=!1})},Tt=()=>{Se.value.validate(e=>{if(e)G.value.submit();else return!1})},kt=()=>{se().emitter.emit("data-export-center",{activeName:"IN_PROGRESS"})},xt=(e,a,i)=>{const d=i.target.parentNode.parentNode;if([...d.classList].includes("no-hide")){d.classList.remove("no-hide");return}d.classList.add("no-hide")},Ct=e=>{const a="el-icon-loading",i="de-message-loading de-message-export";B({message:S("p",null,[n("data_set.can_go_to"),S(D,{text:!0,size:"small",class:"btn-text",onClick:()=>{e()}},n("data_export.export_center")),n("data_set.progress_and_download")]),iconClass:a,icon:S(mo),showClose:!0,customClass:i})},Dt=()=>{Me(c.id)},A=Xa(),Me=e=>{if(V.value){A.clearState(),A.setDatasetId(e),se().emitter.emit("changeCurrentComponent","DatasetEditor");return}de.push({path:"/dataset-form",query:{id:e}})},ve=e=>{if(V.value){A.clearState(),A.setdatasetPid(e==null?void 0:e.id),se().emitter.emit("changeCurrentComponent","DatasetEditor");return}de.push({path:"/dataset-form",query:{pid:e==null?void 0:e.id}})},Ue=e=>{switch(e){case"dataPreview":if(K.length){$.value=K,H.value=Q;break}ee.value=!0,fe.value=null,Va(c.id).then(a=>{var i,d;me=(a==null?void 0:a.allFields)||[],Ee.value=me,K=bt(((i=a==null?void 0:a.data)==null?void 0:i.fields)||[]),Q=((d=a==null?void 0:a.data)==null?void 0:d.data)||[],$.value=K,H.value=Q}).finally(()=>{ee.value=!1}),$a(c.id).then(a=>{fe.value=a});break;case"structPreview":$.value=ft,H.value=me;break}},Ge=u(),St=(e,a,i)=>{var d;if(e==="copy"){if(V.value){A.clearState(),A.setDatasetCopyId(a.id),se().emitter.emit("changeCurrentComponent","DatasetEditor");return}de.push({name:A.getToken&&I.getIsIframe?"dataset-embedded-form":"dataset-form",params:{id:a.id}});return}if(e==="delete"){let w={confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1,tip:""};(d=a.children)!=null&&d.length?w.tip=n("data_set.operate_with_caution"):delete w.tip,i!=="folder"?za(a.id).then(T=>{if(T===!0){const X=()=>{Ge.value.getChartData({queryType:"dataset",num:a.id,label:a.name})};ge.confirm("",{confirmButtonType:"danger",type:"warning",autofocus:!1,confirmButtonText:n("userimport.sure"),showClose:!1,dangerouslyUseHTMLString:!0,message:S("div",null,[S("p",{style:"margin-bottom: 8px;"},n("data_set.this_data_set")),S("p",{class:"tip"},n("data_set.to_delete_them")),S(D,{text:!0,onClick:X,style:"margin-left: -4px;"},n("data_set.check_blood_relationship"))])}).then(()=>{ke(a.id).then(()=>{W(),B.success(n("dataset.delete_success"))})})}else ge.confirm(n("datasource.delete_this_dataset"),w).then(()=>{ke(a.id).then(()=>{W(),B.success(n("dataset.delete_success"))})})}):ge.confirm(n("data_set.delete_this_folder"),w).then(()=>{ke(a.id).then(()=>{W(),B.success(n("dataset.delete_success"))})})}else ue.value.createInit(i,a,e)},je=(e,a)=>{e==="dataset"&&ve(a),e==="folder"&&ue.value.createInit(e,a||{})},b=u("dataPreview"),qe=[{label:n("visualization.move_to"),svgName:Sa,command:"move"},{label:n("visualization.rename"),svgName:Ia,command:"rename"},{label:n("common.delete"),divided:!0,svgName:Da,command:"delete"}],te=u([]),Et=e=>{e.id&&te.value.push(e.id)},Nt=e=>{e.id&&te.value.splice(te.value.indexOf(e.id),1)},It=R(()=>[{label:n("data_set.a_new_dataset"),svgName:et,command:"dataset"},{label:n("deDataset.new_folder"),divided:!0,svgName:tt,command:"folder"}]),Lt={children:"children",label:"name"},Ke=[{title:n("chart.data_preview"),name:"dataPreview"},{title:n("data_set.structure_preview"),name:"structPreview"}],he=[{name:n("visualization.time_asc"),value:"time_asc"},{name:n("visualization.time_desc"),value:"time_desc",divided:!0},{name:n("visualization.name_asc"),value:"name_asc"},{name:n("visualization.name_desc"),value:"name_desc"}],At=()=>{const e=x.get(C("TreeSort-dataset"));e&&(_.curSortType=e)},Rt=()=>{Ra().then(e=>{De.value=e})},We=R(()=>he.find(e=>e.value===_.curSortType).name),He=u([]),Pt=R(()=>c.weight>=7?[...Ke,...He.value]:[...Ke]),Ft=e=>{He.value=e},Y=u();ba(j,e=>{Y.value.filter(e)});const z=u(!0),Ye=e=>{z.value=e},Vt=(e,a)=>{var i;return e?(i=a.name)==null?void 0:i.toLowerCase().includes(e.toLowerCase()):!0},$t=()=>{I.setArrowSide(!0)},zt=()=>{I.setArrowSide(!1)},Bt=e=>e?[{label:n("common.copy"),svgName:Ca,command:"copy"}].concat(qe):qe,Ot=po((e,a)=>{const d=["dashboard","dataV","dataset","datasource"].findIndex(w=>w==="dataset");return d<0||!Za(a,d+1)?gt(e,a):(B.warning(n("free.save_error")),!1)},300);return(e,a)=>{const i=ea,d=ta,w=fa,T=aa,X=oa,Mt=sa,Ut=na,Gt=ia,jt=va,qt=la,Kt=ra,Wt=da,Ht=ha,Yt=ca,Xe=ua,Xt=ma,Zt=pa,Ze=wa("permission"),ae=_a;return r(),y(U,null,[O((r(),y("div",{class:M(["dataset-manage",Le.value&&"de-100vh"])},[o(st,{style:be({left:(z.value?t(pe)-12:0)+"px"}),onChangeSideTreeStatus:Ye,isInside:!z.value},null,8,["style","isInside"]),o(t(Qt),{class:M(["resource-area",{retract:!z.value}]),onMouseenter:$t,onMouseleave:zt,ref_key:"node",ref:vt,style:be({width:t(pe)+"px"})},{default:s(()=>[o(st,{isInside:!z.value,style:be({left:(z.value?t(pe)-12:0)+"px"}),onChangeSideTreeStatus:Ye},null,8,["isInside","style"]),p("div",fo,[p("div",vo,[p("div",ho,[p("span",go,h(t(n)("auth.dataset")),1),le.value?(r(),y("div",yo,[o(i,{class:"box-item",effect:"dark",content:t(n)("deDataset.new_folder"),placement:"top"},{default:s(()=>[o(t(k),{class:"custom-icon btn",style:{"margin-right":"20px"},onClick:a[0]||(a[0]=l=>je("folder"))},{default:s(()=>[o(t(v),{name:"dv-new-folder"},{default:s(()=>[o(t(La),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"]),o(i,{class:"box-item",effect:"dark",content:t(n)("data_set.a_new_dataset"),placement:"top"},{default:s(()=>[o(t(k),{class:"custom-icon btn",onClick:ve},{default:s(()=>[o(t(v),{name:"icon_file-add_outlined"},{default:s(()=>[o(t(Aa),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"])])):f("",!0)]),o(d,{placeholder:t(n)("commons.search"),modelValue:j.value,"onUpdate:modelValue":a[1]||(a[1]=l=>j.value=l),clearable:"",class:"search-bar"},{prefix:s(()=>[o(t(k),null,{default:s(()=>[o(t(v),{name:"icon_search-outline_outlined"},{default:s(()=>[o(t(Oa),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),o(X,{onCommand:pt,trigger:"click"},{dropdown:s(()=>[o(T,{style:{width:"246px"}},{default:s(()=>[(r(),y(U,null,we(he,l=>(r(),y(U,{key:l.value},[o(w,{class:M(["ed-select-dropdown__item",l.value===_.curSortType&&"selected"]),command:l.value},{default:s(()=>[E(h(l.name),1)]),_:2},1032,["class","command"]),l.divided?(r(),y("li",bo)):f("",!0)],64))),64))]),_:1})]),default:s(()=>[o(t(k),{class:"filter-icon-span"},{default:s(()=>[o(i,{offset:16,effect:"dark",content:We.value,placement:"top"},{default:s(()=>[o(t(v),{name:"dv-sort-asc",class:"opt-icon"},{default:s(()=>[_.curSortType.includes("asc")?(r(),m(t(Ma),{key:0,class:"svg-icon opt-icon"})):f("",!0)]),_:1})]),_:1},8,["content"]),o(i,{offset:16,effect:"dark",content:We.value,placement:"top"},{default:s(()=>[o(t(v),{name:"dv-sort-desc",class:"opt-icon"},{default:s(()=>[_.curSortType.includes("desc")?(r(),m(t(Ua),{key:0,class:"svg-icon"})):f("",!0)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})]),o(t(Jt),{class:"custom-tree"},{default:s(()=>[o(Mt,{menu:"",ref_key:"datasetListTree",ref:Y,"node-key":"id",data:_.datasetTree,"filter-node-method":Vt,"expand-on-click-node":"","highlight-current":"",onNodeDragStart:t(yt),"allow-drop":t(Ot),onNodeDrop:t(ht),draggable:"",onNodeExpand:Et,onNodeCollapse:Nt,"default-expanded-keys":te.value,props:Lt,onNodeClick:ze},{default:s(({node:l,data:g})=>[p("span",wo,[g.leaf?f("",!0):(r(),m(t(k),{key:0,style:{"font-size":"18px"}},{default:s(()=>[o(t(v),{name:"dv-folder"},{default:s(()=>[o(t(tt),{class:"svg-icon"})]),_:1})]),_:1})),g.leaf?(r(),m(t(k),{key:1,style:{"font-size":"18px"}},{default:s(()=>[o(t(v),{name:"icon_dataset"},{default:s(()=>[o(t(et),{class:"svg-icon"})]),_:1})]),_:1})):f("",!0),p("span",{title:l.label,class:"label-tooltip ellipsis"},h(l.label),9,To),g.weight>=7?(r(),y("div",ko,[g.leaf?(r(),m(t(k),{key:1,class:"hover-icon",onClick:Qe(oe=>Me(g.id),["stop"])},{default:s(()=>[o(t(v),{name:"icon_edit_outlined"},{default:s(()=>[o(t(ot),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])):(r(),m(t(nt),{key:0,"icon-size":"24px",onHandleCommand:oe=>je(oe,g),"menu-list":It.value,"icon-name":t(at),placement:"bottom-start"},null,8,["onHandleCommand","menu-list","icon-name"])),o(t(nt),{onHandleCommand:oe=>St(oe,g,g.leaf?"dataset":"folder"),"menu-list":Bt(g.leaf)},null,8,["onHandleCommand","menu-list"])])):f("",!0)])]),_:1},8,["data","onNodeDragStart","allow-drop","onNodeDrop","default-expanded-keys"])]),_:1})])]),_:1},8,["class","style"]),p("div",{class:M(["dataset-content",{auto:Le.value||V.value}])},[!_.datasetTree.length&&ce.value?(r(),m(ne,{key:0,description:t(n)("data_set.data_set_yet"),"img-type":"none"},{default:s(()=>[le.value?(r(),m(t(D),{key:0,onClick:a[2]||(a[2]=()=>ve()),type:"primary"},{icon:s(()=>[o(t(v),{name:"icon_add_outlined"},{default:s(()=>[o(t(at),{class:"svg-icon"})]),_:1})]),default:s(()=>[E(" "+h(t(n)("deDataset.create")+t(n)("auth.dataset")),1)]),_:1})):f("",!0)]),_:1},8,["description"])):c.id?(r(),y(U,{key:1},[p("div",xo,[p("div",Co,[p("span",{title:c.name,class:"dataset-name ellipsis"},h(c.name),9,Do),o(Ut,{style:{margin:"0 12px"},direction:"vertical"}),p("span",So,h(t(n)("visualization.create_by"))+":"+h(c.creator),1),o(Gt,{"show-arrow":"",offset:8,placement:"bottom",width:"290",trigger:"hover"},{reference:s(()=>[o(t(k),{size:"16px",class:"create-user"},{default:s(()=>[o(t(v),{name:"icon_info_outlined"},{default:s(()=>[o(t(Ga),{class:"svg-icon"})]),_:1})]),_:1})]),default:s(()=>[o(oo,{"create-time":Fe.value.createTime,creator:Fe.value.creator},null,8,["create-time","creator"])]),_:1}),p("div",Eo,[O((r(),m(t(D),{secondary:"",onClick:a[3]||(a[3]=l=>Ae("dashboard"))},{icon:s(()=>[o(t(v),{name:"icon_dashboard_outlined"},{default:s(()=>[o(t(ja),{class:"svg-icon"})]),_:1})]),default:s(()=>[E(" "+h(t(n)("visualization.panelAdd")),1)]),_:1})),[[Ze,["panel"]]]),O((r(),m(t(D),{secondary:"",onClick:a[4]||(a[4]=l=>Ae("dvCanvas"))},{icon:s(()=>[o(t(v),{name:"icon_operation-analysis_outlined"},{default:s(()=>[o(t(qa),{class:"svg-icon"})]),_:1})]),default:s(()=>[E(h(t(n)("data_set.new_data_screen")),1)]),_:1})),[[Ze,["screen"]]]),ut.value[0]?(r(),m(t(D),{key:0,secondary:"",onClick:wt},{icon:s(()=>[o(t(v),{name:"icon_download_outlined"},{default:s(()=>[o(t(Ka),{class:"svg-icon"})]),_:1})]),default:s(()=>[E(" "+h(t(n)("data_set.dataset_export")),1)]),_:1})):f("",!0),c.weight>=7?(r(),m(t(D),{key:1,type:"primary",onClick:Dt},{icon:s(()=>[o(t(v),{name:"icon_edit_outlined"},{default:s(()=>[o(t(ot),{class:"svg-icon"})]),_:1})]),default:s(()=>[E(" "+h(t(n)("visualization.edit")),1)]),_:1})):f("",!0)])]),p("div",No,[o(qt,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=l=>b.value=l),onTabChange:Ue},{default:s(()=>[(r(!0),y(U,null,we(Pt.value,l=>(r(),m(jt,{key:l.name,label:l.title,name:l.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),o(t(xe),{jsname:"L2NvbXBvbmVudC9yb3ctY29sLXBlcm1pc3Npb24vcGFuZS9pbmRleA==",onLoaded:Ft})])]),p("div",Io,[b.value==="dataPreview"?(r(),y("div",Lo,h(t(n)("data_set.pieces_in_total",{msg:fe.value})),1)):f("",!0),["dataPreview","structPreview"].includes(b.value)?(r(),y("div",{key:1,class:M(["info-table",[{"struct-preview":b.value==="structPreview"}]])},[b.value==="structPreview"?(r(),m(Wt,{key:0},{default:s(({height:l,width:g})=>[O((r(),m(Kt,{key:"structPreview",columns:$.value,data:H.value,"header-class":"excel-header-cell",width:g,height:l,fixed:""},{empty:s(()=>[o(ne,{description:t(n)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),_:1},8,["columns","data","width","height"])),[[ae,ee.value]])]),_:1})):f("",!0),b.value==="dataPreview"?O((r(),m(Yt,{class:"dataset-preview_table",data:H.value,onRowClick:xt,key:"dataPreview",border:"",style:{width:"100%",height:"100%"}},{empty:s(()=>[o(ne,{description:t(n)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),default:s(()=>[(r(!0),y(U,null,we($.value,(l,g)=>(r(),m(Ht,{key:l.dataKey,prop:l.dataKey,label:l.title,"min-width":150,fixed:$.value.length-1===g?"right":!1},{header:s(()=>[p("div",Ao,[o(t(k),{style:{"margin-right":"6px"}},{default:s(()=>[o(t(v),{className:`field-icon-${t(N)[l.deType]}`},{default:s(()=>[(r(),m(xa(t(Ce)[t(N)[l.deType]]),{class:M(["svg-icon",`field-icon-${t(N)[l.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),p("span",{class:"ellipsis",title:l.title,style:{width:"120px"}},h(l.title),9,Ro)])]),_:2},1032,["prop","label","fixed"]))),128))]),_:1},8,["data"])),[[ae,ee.value]]):f("",!0)],2)):f("",!0),["row","column"].includes(b.value)?(r(),y("div",Po,[o(t(xe),{"active-name":b.value,"dataset-id":c.id,jsname:"ZGF0YXNldC1yb3ctcGVybWlzc2lvbnM="},null,8,["active-name","dataset-id"]),o(t(xe),{"active-name":b.value,"dataset-id":c.id,jsname:"ZGF0YXNldC1jb2x1bW4tcGVybWlzc2lvbnM="},null,8,["active-name","dataset-id"])])):f("",!0)])],64)):ce.value?(r(),m(ne,{key:2,description:t(n)("deDataset.on_the_left"),"img-type":"select"},null,8,["description"])):f("",!0)],2),o(Ea,{ref_key:"relationChartRef",ref:Ge},null,512),o(ao,{"cur-canvas-type":J.value,onFinish:mt,ref_key:"resourceGroupOpt",ref:ct},null,8,["cur-canvas-type"]),o(to,{onFinish:a[6]||(a[6]=l=>W()),ref_key:"creatDsFolder",ref:ue},null,512)],2)),[[ae,_e.value]]),P.value?(r(),m(Zt,{key:0,modelValue:P.value,"onUpdate:modelValue":a[9]||(a[9]=l=>P.value=l),width:"800px",class:"de-dialog-form form-tree-cont",title:e.$t("dataset.export_dataset"),"append-to-body":""},{footer:s(()=>[p("div",zo,[o(t(D),{secondary:"",onClick:Be},{default:s(()=>[E(h(e.$t("dataset.cancel")),1)]),_:1}),O((r(),m(t(D),{type:"primary",onClick:Tt},{default:s(()=>[E(h(e.$t("dataset.confirm")),1)]),_:1})),[[ae,re.value]])])]),default:s(()=>[o(Xt,{ref_key:"exportFormRef",ref:Se,class:"de-form-item",onSubmit:a[8]||(a[8]=Qe(()=>{},["prevent"])),model:F.value,rules:dt,"before-close":Be},{default:s(()=>[o(Xe,{label:e.$t("dataset.filename"),prop:"name"},{default:s(()=>[o(d,{modelValue:F.value.name,"onUpdate:modelValue":a[7]||(a[7]=l=>F.value.name=l),modelModifiers:{trim:!0},placeholder:e.$t("dataset.pls_input_filename")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(Xe,{label:e.$t("dataset.export_filter"),prop:"expressionTree"},{default:s(()=>[p("div",Fo,[p("div",Vo,[o(lo,{onSave:Oe,ref_key:"rowAuth",ref:G},null,512)])])]),_:1},8,["label"])]),_:1},8,["model"]),p("span",$o,h(t(n)("data_set.pieces_of_data",{limit:De.value})),1)]),_:1},8,["modelValue","title"])):f("",!0)],64)}}});const zn=_o(Bo,[["__scopeId","data-v-b2f03592"]]);export{zn as default};
