import{g as Ce,N as Q,w as he,e as _e,r as ye,b as Se,p as be,x as ge}from"./element-plus-secondary-0.0.0-dataease.js";import{f as ke,e as we}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as Ie}from"./icon_admin_outlined-0.0.0-dataease.js";import{a6 as Ve,a as Fe,at as xe,au as Ee}from"./chart-0.0.0-dataease.js";import Pe from"./GradientColorSelector-0.0.0-dataease.js";import{u as ee}from"./index-0.0.0-dataease.js";import{d as Ne}from"./dvMain-0.0.0-dataease.js";import{s as $e}from"./pinia-0.0.0-dataease.js";import{c as Re}from"./index-0.0.0-dataease12.js";import{h as oe}from"./lodash-es-0.0.0-dataease.js";import{d as Be,r as E,l as Ae,k as g,w as Oe,b as ze,ae as Te,o as n,T as z,U as d,W as v,u as C,z as h,R as P,a as p,c as f,a8 as T,S as N,_ as De,Y as U,a6 as Ge,Z as $,n as re}from"./@vue-0.0.0-dataease.js";import{_ as Le}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";const Me={class:"custom-color-selector-container"},Ue=["onClick","title"],We={style:{float:"left"}},He={class:"cases-list__text"},Xe={key:0,class:"custom-color-extend-setting colors"},Ye=["onClick"],Ze={class:"inner-selector"},je={key:1,class:"series-color-setting colors"},qe=["id"],Je=["onClick"],Ke=["id"],Qe=["title"],eo={class:"series-color-picker-wrapper"},oo=Be({__name:"CustomColorStyleSelect",props:{themes:{default:"light"},modelValue:{},propertyInner:{},chart:{},sub:{type:Boolean,default:!1}},emits:["update:modelValue","changeBasicStyle"],setup(te,{emit:le}){const{t:D}=ke(),s=te,Y=Ne(),{batchOptStatus:Z}=$e(Y),j=le,se=()=>{b.value&&(l.value.basicStyleForm[S.value]="default",X({value:"default"}))},W=E(),i=Ae({seriesColor:[],curSeriesColor:{id:"",name:"",color:""},curColorIndex:0,seriesColorPickerId:"body"}),k=E(),_=g(()=>s.sub?"subColors":"colors"),S=g(()=>s.sub?"subColorScheme":"colorScheme"),w=g(()=>s.sub?"subSeriesColor":"seriesColor"),ie=g(()=>{var e,o,t,a,m,u;return((t=(o=(e=k.value)==null?void 0:e.propertyInner)==null?void 0:o["basic-style-selector"])==null?void 0:t.includes("seriesColor"))||((u=(m=(a=k.value)==null?void 0:a.propertyInner)==null?void 0:m["dual-basic-style-selector"])==null?void 0:u.includes("seriesColor"))}),ae=g(()=>{var e,o,t;return(t=(o=(e=k.value)==null?void 0:e.propertyInner)==null?void 0:o["dual-basic-style-selector"])==null?void 0:t.includes("subSeriesColor")}),R=()=>{var m,u,y,F,x,M;if(Z.value||!s.chart)return;if(k.value=Re.getChartView(s.chart.render,s.chart.type),s.sub){if(!ae.value)return}else if(!ie.value)return;let e=Y.getViewOriginData(s.chart.id);if(!e||(s.chart.type.includes("chart-mix")&&(s.sub?e=(u=(m=e.right)==null?void 0:m.data)==null?void 0:u[0]:e=(F=(y=e.left)==null?void 0:y.data)==null?void 0:F[0]),!e))return;const o=s.sub?(x=k.value)==null?void 0:x.setupSubSeriesColor:k.value.setupSeriesColor;if(!o)return;const t=o(s.chart,e.data),a=((M=s.chart.customAttr.basicStyle[w.value])==null?void 0:M.reduce((r,c)=>(r[c.id]=c,r),{}))||{};t==null||t.forEach(r=>{const c=a[r.id];c&&(r.color=c.color)}),i.seriesColor.splice(0,i.seriesColor.length,...t),i.seriesColor.length&&(i.curColorIndex>i.seriesColor.length-1&&(i.curColorIndex=0),i.curSeriesColor=i.seriesColor[i.curColorIndex],re(()=>{var r;(r=H.value)==null||r.hide(),i.seriesColorPickerId=`#seriesr-picker-slot-${s.sub?1:0}`}))},ce=(e,o)=>{var a;(a=W.value)==null||a.hide(),i.curSeriesColor=oe(e),i.curColorIndex=o;const t=`series-color-picker-${s.sub?1:0}-${o}`;i.seriesColorPickerId=`#${t}`,re(()=>{var u;document.getElementById(t)&&((u=W.value)==null||u.show())})},ne=()=>{let e=!1;i.seriesColor.forEach(o=>{o.id===i.curSeriesColor.id&&o.color!==i.curSeriesColor.color&&(e=!0,o.color=i.curSeriesColor.color)}),e&&(l.value.basicStyleForm[w.value]=oe(i.seriesColor),I(w.value))};Oe([()=>s.chart,()=>{var e;return(e=s.chart)==null?void 0:e.type},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.calcTopN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topNLabel}],R,{deep:!1}),ze(()=>{ee({name:"chart-type-change",callback:se}),ee({name:"chart-data-change",callback:R}),R()});const l=g({get(){return s.modelValue},set(e){j("update:modelValue",e)}}),B=Ve,q=Fe,A=E(!1),J=E(),H=E();function K(e){var o;l.value.basicStyleForm[S.value]=e.value,I(S.value),(o=J.value)==null||o.hide(),X(e)}const X=e=>{var m,u;const a=(((m=e==null?void 0:e.value)==null?void 0:m.endsWith("_split_gradient"))||b.value?xe(B):B).filter(y=>y.value===l.value.basicStyleForm[S.value]);a.length>0&&(l.value.basicStyleForm[_.value]=[...a[0].colors],l.value.customColor=l.value.basicStyleForm[_.value][0],l.value.colorIndex=0,(u=l.value.basicStyleForm[w.value])==null||u.forEach((y,F)=>{const x=a[0].colors.length;y.color=a[0].colors[F%x]}),I(),R())},me=()=>{var t;const{type:e}=s.chart,{basicStyleForm:o}=l.value;if(e.includes("map"))X();else{o[w.value]=[],I(w.value);const a=o[S.value];o[_.value]=((t=B.find(m=>m.value===a))==null?void 0:t.colors)??B[0].colors,I(_.value),R()}},ue=()=>{const{colorIndex:e,customColor:o,basicStyleForm:t}=l.value,a=t[_.value];if(b.value){let m=e===0?o:a[0],u=e===0?a[8]:o;t[_.value]=Ee(m,u,9,1)}else a[e]=o;I()},b=g(()=>l.value.basicStyleForm[S.value].endsWith("_split_gradient")),G=e=>e===0||e===l.value.basicStyleForm[_.value].length-1,pe=(e,o)=>{var t;b.value&&!G(e)||(l.value.colorIndex=e,l.value.customColor=o,(t=H.value)==null||t.show())};function I(e=_.value){j("changeBasicStyle",e)}const L=E(!1);function de(){L.value=!0}function ve(){L.value=!1}const V=e=>{var o;return(o=s.propertyInner)==null?void 0:o.includes(e)},fe=(e,o)=>{const t=o.colorIndex===e;return b.value?G(e)?t?"var(--ed-color-primary)":"rgb(230,230,230)":"rgb(230,230,230,0.01)":t?"var(--ed-color-primary)":""};return(e,o)=>{const t=he,a=Te("ArrowDown"),m=_e,u=ye,y=Se,F=we,x=be,M=ge;return n(),z(M,{size:"small",style:$([{width:"100%"},{"margin-bottom":A.value?"16px":0}])},{default:d(()=>[v(x,null,{default:d(()=>[V("gradient-color")?(n(),z(t,{key:0,label:C(D)("chart.color_case"),class:h(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:d(()=>[v(Pe,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=r=>l.value=r),themes:e.themes,onSelectColorCase:K},null,8,["modelValue","themes"])]),_:1},8,["label","class"])):P("",!0),V("gradient-color")?P("",!0):(n(),z(t,{key:1,label:C(D)("chart.color_case"),class:h(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:d(()=>[v(C(Ce),{placement:"bottom-start",ref_key:"colorCaseSelectorRef",ref:J,width:"268",offset:4,trigger:"click",persistent:!1,"show-arrow":!1,onShow:de,onHide:ve,"popper-style":{padding:0},effect:e.themes},{reference:d(()=>[v(u,{effect:e.themes,readonly:"",class:"custom-color-selector"},{prefix:d(()=>[p("div",Me,[(n(!0),f(N,null,T(l.value.basicStyleForm[_.value],(r,c)=>(n(),f("div",{key:c,style:$({flex:1,height:"100%",backgroundColor:r})},null,4))),128))])]),suffix:d(()=>[v(m,{class:h(["input-arrow-icon",{reverse:L.value}])},{default:d(()=>[v(a)]),_:1},8,["class"])]),_:1},8,["effect"])]),default:d(()=>[v(y,{"max-height":"274px",class:h(["cases-list",{dark:e.themes==="dark"}])},{default:d(()=>[(n(!0),f(N,null,T(C(B),r=>(n(),f("div",{key:r.value,class:h(["select-color-item",{active:l.value.basicStyleForm[S.value]===r.value}]),onClick:c=>K(r),title:r.name},[p("div",We,[(n(!0),f(N,null,T(r.colors,(c,O)=>(n(),f("span",{key:O,style:$({width:"20px",height:"20px",float:"left",backgroundColor:c})},null,4))),128))]),p("span",He,U(r.name),1)],10,Ue))),128))]),_:1},8,["class"])]),_:1},8,["effect"])]),_:1},8,["label","class"])),p("div",null,[p("div",{class:h(["custom-color-setting-btn",{active:A.value,dark:e.themes==="dark"}]),onClick:o[1]||(o[1]=r=>A.value=!A.value)},[v(m,{style:{"font-size":"12px"}},{default:d(()=>[v(F,{name:"icon_admin_outlined"},{default:d(()=>[v(C(Ie),{class:"svg-icon"})]),_:1})]),_:1})],2)])]),_:1}),A.value?(n(),f(N,{key:0},[p("div",{class:h(["custom-color-extend-setting",{dark:e.themes==="dark"}])},[De(U(C(D)("chart.custom_case"))+" ",1),p("span",{style:{color:"var(--ed-color-primary)",cursor:"pointer"},onClick:me},U(C(D)("chart.reset")),1)],2),!e.sub&&V("seriesColor")||e.sub&&V("subSeriesColor")?P("",!0):(n(),f("div",Xe,[(n(!0),f(N,null,T(l.value.basicStyleForm[_.value],(r,c)=>(n(),f("div",{key:c,class:h([{active:l.value.colorIndex===c,hover:b.value?G(c):!0},"color-item"]),style:$({"border-color":fe(c,l.value)}),onClick:O=>pe(c,r)},[p("div",{class:"color-item__inner",style:$({backgroundColor:r})},[b.value&&G(c)?(n(),z(m,{key:0,class:h(["input-arrow-icon",{reverse:L.value}]),style:{color:"white","font-size":"x-small",left:"2px",bottom:"2px"}},{default:d(()=>[v(a)]),_:1},8,["class"])):P("",!0)],4)],14,Ye))),128)),p("div",Ze,[v(C(Q),{ref_key:"customColorPickerRef",ref:H,modelValue:l.value.customColor,"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.customColor=r),size:"small",predefine:C(q),onChange:ue},null,8,["modelValue","predefine"])])])),(!e.sub&&V("seriesColor")||e.sub&&V("subSeriesColor"))&&!C(Z)?(n(),f("div",je,[p("div",{id:`seriesr-picker-slot-${e.sub?1:0}`,style:{overflow:"hidden",transform:"translateX(0)"}},null,8,qe),(n(!0),f(N,null,T(i.seriesColor,(r,c)=>{var O;return n(),f("div",{key:r.id,class:"color-list-item"},[p("div",{class:h([{active:r.id===((O=i.curSeriesColor)==null?void 0:O.id)},"color-item"]),onClick:ro=>ce(r,c)},[p("div",{class:"color-item__inner",style:$({backgroundColor:r.color})},null,4)],10,Je),p("div",{id:`series-color-picker-${e.sub?1:0}-${c}`},null,8,Ke),p("span",{class:h(["color-item-name",e.themes==="dark"?"dark":""]),title:r.name},U(r.name),11,Qe)])}),128))])):P("",!0)],64)):P("",!0),(n(),z(Ge,{defer:"",to:i.seriesColorPickerId},[p("div",eo,[v(C(Q),{ref_key:"seriesColorPickerRef",ref:W,modelValue:i.curSeriesColor.color,"onUpdate:modelValue":o[3]||(o[3]=r=>i.curSeriesColor.color=r),size:"small","popper-class":"series-color-picker",teleported:!1,predefine:C(q),onChange:ne},null,8,["modelValue","predefine"])])],8,["to"]))]),_:1},8,["style"])}}});const _t=Le(oo,[["__scopeId","data-v-c8cd287c"]]);export{_t as default};
