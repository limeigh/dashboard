import{a as Z,R as Ce}from"./index-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{E as he}from"./el-row-0.0.0-dataease.js";import{o as _e,j as ye,G as Se,n as be}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as ge,a as ke}from"./el-form-item-0.0.0-dataease.js";import{i as we}from"./icon_admin_outlined-0.0.0-dataease.js";import{E as ee}from"./el-color-picker-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as Ie}from"./el-popover-0.0.0-dataease.js";import{a3 as Ee,a as Ve,at as Fe,au as xe}from"./chart-0.0.0-dataease.js";import Pe from"./GradientColorSelector-0.0.0-dataease.js";import{d as $e}from"./dvMain-0.0.0-dataease.js";import{d as Ne,af as Re,r as x,X as Be,y as g,w as Oe,o as Ae,e as ze,f as n,g as z,i as p,j as v,u as C,S as h,_ as P,P as d,O as f,a6 as T,W as $,a3 as Te,a4 as W,ah as De,T as N,n as oe}from"./vue-0.0.0-dataease.js";import{c as Ge}from"./index-0.0.0-dataease21.js";import{e as re}from"./lodash-0.0.0-dataease.js";import{_ as Le}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./index-0.0.0-dataease27.js";import"./index-0.0.0-dataease20.js";import"./index-0.0.0-dataease18.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./dropdown-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./tslib.es6-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";import"./index-0.0.0-dataease22.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";const Me={class:"custom-color-selector-container"},We=["onClick","title"],Ue={style:{float:"left"}},je={class:"cases-list__text"},He={key:0,class:"custom-color-extend-setting colors"},Xe=["onClick"],qe={class:"inner-selector"},Je={key:1,class:"series-color-setting colors"},Ke=["id"],Qe=["onClick"],Ye=["id"],Ze=["title"],eo={class:"series-color-picker-wrapper"},oo=Ne({__name:"CustomColorStyleSelect",props:{themes:{default:"light"},modelValue:{},propertyInner:{},chart:{},sub:{type:Boolean,default:!1}},emits:["update:modelValue","changeBasicStyle"],setup(te,{emit:le}){const{t:D}=_e(),s=te,X=$e(),{batchOptStatus:q}=Re(X),J=le,se=()=>{b.value&&(l.value.basicStyleForm[S.value]="default",H({value:"default"}))},U=x(),a=Be({seriesColor:[],curSeriesColor:{id:"",name:"",color:""},curColorIndex:0,seriesColorPickerId:"body"}),k=x(),_=g(()=>s.sub?"subColors":"colors"),S=g(()=>s.sub?"subColorScheme":"colorScheme"),w=g(()=>s.sub?"subSeriesColor":"seriesColor"),ae=g(()=>{var e,o,t,c,u,m;return((t=(o=(e=k.value)==null?void 0:e.propertyInner)==null?void 0:o["basic-style-selector"])==null?void 0:t.includes("seriesColor"))||((m=(u=(c=k.value)==null?void 0:c.propertyInner)==null?void 0:u["dual-basic-style-selector"])==null?void 0:m.includes("seriesColor"))}),ce=g(()=>{var e,o,t;return(t=(o=(e=k.value)==null?void 0:e.propertyInner)==null?void 0:o["dual-basic-style-selector"])==null?void 0:t.includes("subSeriesColor")}),R=()=>{var u,m,y,V,F,M;if(q.value||!s.chart)return;if(k.value=Ge.getChartView(s.chart.render,s.chart.type),s.sub){if(!ce.value)return}else if(!ae.value)return;let e=X.getViewOriginData(s.chart.id);if(!e||(s.chart.type.includes("chart-mix")&&(s.sub?e=(m=(u=e.right)==null?void 0:u.data)==null?void 0:m[0]:e=(V=(y=e.left)==null?void 0:y.data)==null?void 0:V[0]),!e))return;const o=s.sub?(F=k.value)==null?void 0:F.setupSubSeriesColor:k.value.setupSeriesColor;if(!o)return;const t=o(s.chart,e.data),c=((M=s.chart.customAttr.basicStyle[w.value])==null?void 0:M.reduce((r,i)=>(r[i.id]=i,r),{}))||{};t==null||t.forEach(r=>{const i=c[r.id];i&&(r.color=i.color)}),a.seriesColor.splice(0,a.seriesColor.length,...t),a.seriesColor.length&&(a.curColorIndex>a.seriesColor.length-1&&(a.curColorIndex=0),a.curSeriesColor=a.seriesColor[a.curColorIndex],oe(()=>{var r;(r=j.value)==null||r.hide(),a.seriesColorPickerId=`#seriesr-picker-slot-${s.sub?1:0}`}))},ie=(e,o)=>{var c;(c=U.value)==null||c.hide(),a.curSeriesColor=re(e),a.curColorIndex=o;const t=`series-color-picker-${s.sub?1:0}-${o}`;a.seriesColorPickerId=`#${t}`,oe(()=>{var m;document.getElementById(t)&&((m=U.value)==null||m.show())})},ne=()=>{let e=!1;a.seriesColor.forEach(o=>{o.id===a.curSeriesColor.id&&o.color!==a.curSeriesColor.color&&(e=!0,o.color=a.curSeriesColor.color)}),e&&(l.value.basicStyleForm[w.value]=re(a.seriesColor),I(w.value))};Oe([()=>s.chart,()=>{var e;return(e=s.chart)==null?void 0:e.type},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.calcTopN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topNLabel}],R,{deep:!1}),Ae(()=>{Z({name:"chart-type-change",callback:se}),Z({name:"chart-data-change",callback:R}),R()});const l=g({get(){return s.modelValue},set(e){J("update:modelValue",e)}}),B=Ee,K=Ve,O=x(!1),Q=x(),j=x();function Y(e){var o;l.value.basicStyleForm[S.value]=e.value,I(S.value),(o=Q.value)==null||o.hide(),H(e)}const H=e=>{var u,m;const c=(((u=e==null?void 0:e.value)==null?void 0:u.endsWith("_split_gradient"))||b.value?Fe(B):B).filter(y=>y.value===l.value.basicStyleForm[S.value]);c.length>0&&(l.value.basicStyleForm[_.value]=[...c[0].colors],l.value.customColor=l.value.basicStyleForm[_.value][0],l.value.colorIndex=0,(m=l.value.basicStyleForm[w.value])==null||m.forEach((y,V)=>{const F=c[0].colors.length;y.color=c[0].colors[V%F]}),I(),R())},ue=()=>{var t;const{type:e}=s.chart,{basicStyleForm:o}=l.value;if(e.includes("map"))H();else{o[w.value]=[],I(w.value);const c=o[S.value];o[_.value]=((t=B.find(u=>u.value===c))==null?void 0:t.colors)??B[0].colors,I(_.value),R()}},me=()=>{const{colorIndex:e,customColor:o,basicStyleForm:t}=l.value,c=t[_.value];if(b.value){let u=e===0?o:c[0],m=e===0?c[8]:o;t[_.value]=xe(u,m,9,1)}else c[e]=o;I()},b=g(()=>l.value.basicStyleForm[S.value].endsWith("_split_gradient")),G=e=>e===0||e===l.value.basicStyleForm[_.value].length-1,de=(e,o)=>{var t;b.value&&!G(e)||(l.value.colorIndex=e,l.value.customColor=o,(t=j.value)==null||t.show())};function I(e=_.value){J("changeBasicStyle",e)}const L=x(!1);function pe(){L.value=!0}function ve(){L.value=!1}const E=e=>{var o;return(o=s.propertyInner)==null?void 0:o.includes(e)},fe=(e,o)=>{const t=o.colorIndex===e;return b.value?G(e)?t?"var(--ed-color-primary)":"rgb(230,230,230)":"rgb(230,230,230,0.01)":t?"var(--ed-color-primary)":""};return(e,o)=>{const t=ge,c=ze("ArrowDown"),u=ye,m=Se,y=Ce,V=be,F=he,M=ke;return n(),z(M,{size:"small",style:N([{width:"100%"},{"margin-bottom":O.value?"16px":0}])},{default:p(()=>[v(F,null,{default:p(()=>[E("gradient-color")?(n(),z(t,{key:0,label:C(D)("chart.color_case"),class:h(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:p(()=>[v(Pe,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=r=>l.value=r),themes:e.themes,onSelectColorCase:Y},null,8,["modelValue","themes"])]),_:1},8,["label","class"])):P("",!0),E("gradient-color")?P("",!0):(n(),z(t,{key:1,label:C(D)("chart.color_case"),class:h(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:p(()=>[v(C(Ie),{placement:"bottom-start",ref_key:"colorCaseSelectorRef",ref:Q,width:"268",offset:4,trigger:"click",persistent:!1,"show-arrow":!1,onShow:pe,onHide:ve,"popper-style":{padding:0},effect:e.themes},{reference:p(()=>[v(m,{effect:e.themes,readonly:"",class:"custom-color-selector"},{prefix:p(()=>[d("div",Me,[(n(!0),f($,null,T(l.value.basicStyleForm[_.value],(r,i)=>(n(),f("div",{key:i,style:N({flex:1,height:"100%",backgroundColor:r})},null,4))),128))])]),suffix:p(()=>[v(u,{class:h(["input-arrow-icon",{reverse:L.value}])},{default:p(()=>[v(c)]),_:1},8,["class"])]),_:1},8,["effect"])]),default:p(()=>[v(y,{"max-height":"274px",class:h(["cases-list",{dark:e.themes==="dark"}])},{default:p(()=>[(n(!0),f($,null,T(C(B),r=>(n(),f("div",{key:r.value,class:h(["select-color-item",{active:l.value.basicStyleForm[S.value]===r.value}]),onClick:i=>Y(r),title:r.name},[d("div",Ue,[(n(!0),f($,null,T(r.colors,(i,A)=>(n(),f("span",{key:A,style:N({width:"20px",height:"20px",float:"left",backgroundColor:i})},null,4))),128))]),d("span",je,W(r.name),1)],10,We))),128))]),_:1},8,["class"])]),_:1},8,["effect"])]),_:1},8,["label","class"])),d("div",null,[d("div",{class:h(["custom-color-setting-btn",{active:O.value,dark:e.themes==="dark"}]),onClick:o[1]||(o[1]=r=>O.value=!O.value)},[v(u,{style:{"font-size":"12px"}},{default:p(()=>[v(V,{name:"icon_admin_outlined"},{default:p(()=>[v(C(we),{class:"svg-icon"})]),_:1})]),_:1})],2)])]),_:1}),O.value?(n(),f($,{key:0},[d("div",{class:h(["custom-color-extend-setting",{dark:e.themes==="dark"}])},[Te(W(C(D)("chart.custom_case"))+" ",1),d("span",{style:{color:"var(--ed-color-primary)",cursor:"pointer"},onClick:ue},W(C(D)("chart.reset")),1)],2),!e.sub&&E("seriesColor")||e.sub&&E("subSeriesColor")?P("",!0):(n(),f("div",He,[(n(!0),f($,null,T(l.value.basicStyleForm[_.value],(r,i)=>(n(),f("div",{key:i,class:h([{active:l.value.colorIndex===i,hover:b.value?G(i):!0},"color-item"]),style:N({"border-color":fe(i,l.value)}),onClick:A=>de(i,r)},[d("div",{class:"color-item__inner",style:N({backgroundColor:r})},[b.value&&G(i)?(n(),z(u,{key:0,class:h(["input-arrow-icon",{reverse:L.value}]),style:{color:"white","font-size":"x-small",left:"2px",bottom:"2px"}},{default:p(()=>[v(c)]),_:1},8,["class"])):P("",!0)],4)],14,Xe))),128)),d("div",qe,[v(C(ee),{ref_key:"customColorPickerRef",ref:j,modelValue:l.value.customColor,"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.customColor=r),size:"small",predefine:C(K),onChange:me},null,8,["modelValue","predefine"])])])),(!e.sub&&E("seriesColor")||e.sub&&E("subSeriesColor"))&&!C(q)?(n(),f("div",Je,[d("div",{id:`seriesr-picker-slot-${e.sub?1:0}`,style:{overflow:"hidden",transform:"translateX(0)"}},null,8,Ke),(n(!0),f($,null,T(a.seriesColor,(r,i)=>{var A;return n(),f("div",{key:r.id,class:"color-list-item"},[d("div",{class:h([{active:r.id===((A=a.curSeriesColor)==null?void 0:A.id)},"color-item"]),onClick:ro=>ie(r,i)},[d("div",{class:"color-item__inner",style:N({backgroundColor:r.color})},null,4)],10,Qe),d("div",{id:`series-color-picker-${e.sub?1:0}-${i}`},null,8,Ye),d("span",{class:h(["color-item-name",e.themes==="dark"?"dark":""]),title:r.name},W(r.name),11,Ze)])}),128))])):P("",!0)],64)):P("",!0),(n(),z(De,{defer:"",to:a.seriesColorPickerId},[d("div",eo,[v(C(ee),{ref_key:"seriesColorPickerRef",ref:U,modelValue:a.curSeriesColor.color,"onUpdate:modelValue":o[3]||(o[3]=r=>a.curSeriesColor.color=r),size:"small","popper-class":"series-color-picker",teleported:!1,predefine:C(K),onChange:ne},null,8,["modelValue","predefine"])])],8,["to"]))]),_:1},8,["style"])}}});const Yo=Le(oo,[["__scopeId","data-v-c8cd287c"]]);export{Yo as default};
