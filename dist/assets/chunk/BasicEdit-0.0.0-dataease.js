import{E as C,a as pe,e as me,f as ue,K as de,B as ce,A as _e,y as fe,s as ye,P as ve,Q as ke,w as ge,x as be,i as he,Z as Ve}from"./element-plus-secondary-0.0.0-dataease.js";import{f as Te,j as P,e as Oe}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as xe}from"./dv-info-0.0.0-dataease.js";import{d as Ee,r as h,l as B,ae as Le,o as r,T as k,U as i,a as x,W as n,_ as E,Y as y,u as f,c as p,S as V,a8 as T,z as Ue,R as z}from"./@vue-0.0.0-dataease.js";import{_ as Ie}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const we={class:"basic-form-info-tips"},qe={class:"custom-form-item__label"},Re={key:1,class:"ds-task-form-inline"},Ce={class:"ds-span"},Be={key:2},$e={key:3},Fe={key:4},Ne={key:5},Se={key:6},Ae={key:7},De={key:8},Pe={key:9},ze={key:10},We={class:"dialog-footer"},je=Ee({__name:"BasicEdit",props:{labelTooltips:{type:Array,default:()=>[]}},emits:["saved"],setup(W,{expose:j,emit:K}){const{t}=Te(),$=W,L=h(!1),F=h(null),U=h(),M=[{value:"minute",label:t("system.time_0_seconds")},{value:"hour",label:t("system.and_0_seconds_de")}],G=[{value:"0",label:t("commons.date.permanent")},{value:"1",label:t("commons.date.one_year")},{value:"2",label:t("commons.date.six_months")},{value:"3",label:t("commons.date.three_months")},{value:"4",label:t("commons.date.one_month")}],Q=["logLiveTime","thresholdLogLiveTime","exportFileLiveTime","frontTimeOut","loginLimitTime","loginLimitRate"],e=B({form:B({dsIntervalTime:"30",dsExecuteTime:"minute",frontTimeOut:"30"}),settingList:[],orgOptions:[],roleOptions:[],loginOptions:[{value:"0",label:t("system.normal_login")},{value:"1",label:"LDAP"},{value:"2",label:"OIDC"},{value:"3",label:"CAS"},{value:"9",label:"OAuth2"}],sortOptions:[{value:"0",label:t("resource_sort.time_asc")},{value:"1",label:t("resource_sort.time_desc")},{value:"2",label:t("resource_sort.name_asc")},{value:"3",label:t("resource_sort.name_desc")}],openOptions:[{value:"0",label:t("open_opt.new_page")},{value:"1",label:t("open_opt.local_page")}]}),w=h({}),Y=()=>{var a;(a=$.labelTooltips)!=null&&a.length&&$.labelTooltips.forEach(s=>{w.value[s.key]=s.val})},g=B({dsIntervalTime:[{required:!0,message:t("common.require"),trigger:"blur"}]}),Z=()=>e.settingList.map(a=>{const s=a.pkey.startsWith("basic.")?a.pkey:`basic.${a.pkey}`,m=a.sort,d=a.type;let c=e.form[a.pkey];return Array.isArray(c)&&(c=c.join(",")),{pkey:s,pval:c,type:d,sort:m}}),H=K,J=async a=>{a&&await a.validate(s=>{if(s){if(e.form.dsExecuteTime==="minute"&&(Number(e.form.dsIntervalTime)<1||Number(e.form.dsIntervalTime)>59)){C.error(t("commons.date.of_range_1_59"));return}if(e.form.dsExecuteTime==="hour"&&(Number(e.form.dsIntervalTime)<1||Number(e.form.dsIntervalTime)>23)){C.error(t("commons.date.of_range_1_23"));return}const m=Z();if(m.length<2)return;ee(),P.post({url:"/sysParameter/basic/save",data:m}).then(d=>{d.msg||(C.success(t("common.save_success")),H("saved"),X()),S()}).catch(()=>{S()})}})},N=a=>{e.settingList=[],q.value=[],a&&(a.resetFields(),L.value=!1)},X=()=>{N(U.value)},ee=()=>{F.value=pe.service({target:".basic-param-drawer"})},S=()=>{var a;(a=F.value)==null||a.close()},A=h(),q=h([]),oe=(a,s,m,d,c,R,b,I)=>{A.value=b,e.orgOptions=s||[],e.roleOptions=m||[],e.loginOptions=d||[],e.sortOptions=c||[],e.openOptions=R||[],e.settingList=a.map(u=>{const v=u.pkey;Q.some(O=>`basic.${O}`===v)&&(g[v.split(".")[1]]=[{required:!0,message:t("common.require"),trigger:["blur","change"]}]),u.label=`setting_${v}`,u.pkey=v.split(".")[1];let _=u.pval;return u.pkey.includes("platformRid")&&(_!=null&&_.length)&&(_=_.split(","),g.platformRid||(g.platformRid=[{required:!0,message:t("common.require"),trigger:["blur","change"]}])),u.pkey.includes("platformOid")&&(g.platformOid||(g.platformOid=[{required:!0,message:t("common.require"),trigger:["blur","change"]}])),e.form[u.pkey]=_||e.form[u.pkey],u}),q.value=e.settingList.filter(u=>I.includes(u.pkey)),L.value=!0},le=async()=>{const a=e.form.platformOid;if(!a)return;const m=(await P.get({url:`/role/queryWithOid/${a}`})).data,d=te(m);e.roleOptions[0].children=d.get(!1),e.roleOptions[1].children=d.get(!0)},te=a=>{const s=new Map;return a.forEach(m=>{const d=m.readonly;let c=s.get(d);c||(c=[]),c.push({value:m.id,label:m.name,disabled:!1}),s.set(d,c)}),s},ae=()=>{e.form.platformRid=[],le()};return Y(),j({edit:oe}),(a,s)=>{const m=Oe,d=me,c=ue,R=de,b=ce,I=_e,u=fe,v=ye,_=ve,O=ke,se=Le("v-else"),re=ge,ne=be,D=he,ie=Ve;return r(),k(ie,{title:A.value,modelValue:L.value,"onUpdate:modelValue":s[5]||(s[5]=o=>L.value=o),"modal-class":"basic-param-drawer",size:"600px",direction:"rtl"},{footer:i(()=>[x("span",We,[n(D,{secondary:"",onClick:s[3]||(s[3]=o=>N(U.value))},{default:i(()=>[E(y(f(t)("common.cancel")),1)]),_:1}),n(D,{type:"primary",onClick:s[4]||(s[4]=o=>J(U.value))},{default:i(()=>[E(y(f(t)("commons.save")),1)]),_:1})])]),default:i(()=>[n(ne,{ref_key:"basicForm",ref:U,"require-asterisk-position":"right",model:e.form,rules:g,"label-width":"80px","label-position":"top"},{default:i(()=>[(r(!0),p(V,null,T(q.value,o=>(r(),k(re,{key:o.pkey,prop:o.pkey,class:Ue({"setting-hidden-item":o.pkey==="dsExecuteTime"})},{label:i(()=>[x("div",we,[x("span",qe,y(f(t)(o.label)),1),w.value[`setting_basic.${o.pkey}`]?(r(),k(c,{key:0,effect:"dark",content:w.value[`setting_basic.${o.pkey}`],placement:"top"},{default:i(()=>[n(d,null,{default:i(()=>[n(m,{name:"dv-info"},{default:i(()=>[n(f(xe),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"])):z("",!0)])]),default:i(()=>[o.pkey==="autoCreateUser"||o.pkey==="pwdStrategy"||o.pkey==="dip"||o.pkey==="shareDisable"||o.pkey==="sharePeRequire"||o.pkey==="loginLimit"?(r(),k(R,{key:0,class:"de-basic-switch","active-value":"true","inactive-value":"false",modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},null,8,["modelValue","onUpdate:modelValue"])):o.pkey==="dsIntervalTime"?(r(),p("div",Re,[x("span",null,y(f(t)("cron.every")),1),n(b,{modelValue:e.form.dsIntervalTime,"onUpdate:modelValue":s[0]||(s[0]=l=>e.form.dsIntervalTime=l),autocomplete:"off","step-strictly":"",class:"text-left",min:1,placeholder:f(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"]),n(u,{modelValue:e.form.dsExecuteTime,"onUpdate:modelValue":s[1]||(s[1]=l=>e.form.dsExecuteTime=l)},{default:i(()=>[(r(),p(V,null,T(M,l=>n(I,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:2},1032,["modelValue"]),x("span",Ce,y(f(t)("cron.every_exec")),1)])):o.pkey==="frontTimeOut"?(r(),p("div",Be,[n(b,{modelValue:e.form.frontTimeOut,"onUpdate:modelValue":s[2]||(s[2]=l=>e.form.frontTimeOut=l),autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,placeholder:f(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"])])):o.pkey==="logLiveTime"||o.pkey==="thresholdLogLiveTime"||o.pkey==="loginLimitRate"||o.pkey==="loginLimitTime"?(r(),p("div",$e,[n(b,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,max:4e3,placeholder:f(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","onUpdate:modelValue","placeholder"])])):o.pkey==="platformOid"?(r(),p("div",Fe,[n(v,{class:"edit-all-line",modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,data:e.orgOptions,"check-strictly":"","render-after-expand":!1,onChange:ae},null,8,["modelValue","onUpdate:modelValue","data"])])):o.pkey==="platformRid"?(r(),p("div",Ne,[n(v,{class:"edit-all-line",modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,data:e.roleOptions,"highlight-current":!0,multiple:"","render-after-expand":!1,placeholder:a.$t("common.please_select")+a.$t("user.role"),"show-checkbox":"","check-on-click-node":""},null,8,["modelValue","onUpdate:modelValue","data","placeholder"])])):o.pkey==="pvp"?(r(),p("div",Se,[n(u,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,class:"edit-all-line"},{default:i(()=>[(r(),p(V,null,T(G,l=>n(I,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):o.pkey==="exportFileLiveTime"?(r(),p("div",Ae,[n(b,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,max:4e3,placeholder:f(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","onUpdate:modelValue","placeholder"])])):o.pkey==="defaultLogin"?(r(),p("div",De,[n(O,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},{default:i(()=>[(r(!0),p(V,null,T(e.loginOptions,l=>(r(),k(_,{key:l.value,label:l.value},{default:i(()=>[E(y(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):o.pkey==="defaultSort"?(r(),p("div",Pe,[n(O,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},{default:i(()=>[(r(!0),p(V,null,T(e.sortOptions,l=>(r(),k(_,{key:l.value,label:l.value},{default:i(()=>[E(y(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):o.pkey==="defaultOpen"?(r(),p("div",ze,[n(O,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},{default:i(()=>[(r(!0),p(V,null,T(e.openOptions,l=>(r(),k(_,{key:l.value,label:l.value},{default:i(()=>[E(y(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):z("",!0),n(se)]),_:2},1032,["prop","class"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}});const Yo=Ie(je,[["__scopeId","data-v-9467dea0"]]);export{Yo as default};
