import"./index-0.0.0-dataease.js";import{E as be}from"./el-dialog-0.0.0-dataease.js";import{o as ge,G as Te,j as he,y as we}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{E as Se}from"./el-col-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as ve,a as Fe}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import{E as Ve,a as ye}from"./el-form-item-0.0.0-dataease.js";import{E as xe}from"./el-checkbox-0.0.0-dataease.js";import{E as Ne}from"./el-divider-0.0.0-dataease.js";import{d as Ie,w as Ce,X as Ae,y as H,x as K,r as Q,o as Ee,e as Ue,f as i,O as x,j as o,i as m,g as v,a3 as g,a4 as T,u as n,S as c,_ as N,R as k,U as D,P as p,W as I,a6 as C,n as ke}from"./vue-0.0.0-dataease.js";import{b as Z,ay as _}from"./chart-0.0.0-dataease.js";import De from"./CustomAggrEdit-0.0.0-dataease.js";import{e as G,w as ee,D as te,S as Le}from"./lodash-0.0.0-dataease.js";import{E as $e,a as Me}from"./index-0.0.0-dataease27.js";import{_ as Oe}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./el-popover-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./icon_info_outlined-0.0.0-dataease.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./icon_adjustment_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease.js";import"./attr-0.0.0-dataease23.js";import"./field-list-0.0.0-dataease.js";const pe={key:1},Ge={style:{display:"flex"}},ze={style:{flex:"1"}},Be=Ie({__name:"TableTotalSelector",props:{chart:{type:Object,required:!0},themes:{type:String,default:"dark"},propertyInner:{type:Array}},emits:["onTableTotalChange"],setup(a,{emit:le}){const{t:r}=ge(),y=a;Ce([()=>y.chart.customAttr.tableTotal,()=>y.chart.xAxis,()=>y.chart.yAxis],()=>{J()},{deep:!0});const z=[{name:r("chart.none"),value:"NONE"},{name:r("chart.sum"),value:"SUM"},{name:r("chart.avg"),value:"AVG"},{name:r("chart.max"),value:"MAX"},{name:r("chart.min"),value:"MIN"},{name:r("commons.custom"),value:"CUSTOM"}],t=Ae({tableTotalForm:G(_),rowSubTotalItem:{},rowTotalItem:{},colSubTotalItem:{},colTotalItem:{},totalCfg:[],totalCfgAttr:"",totalItem:{},selectedSubTotalDimensionName:"",selectedSubTotalDimension:void 0,subTotalDimensionList:[],basicStyleForm:JSON.parse(JSON.stringify(Z))}),ae=H(()=>{const s=y.chart;return s.customAttr.basicStyle.quotaPosition!=="row"&&s.xAxisExt.length&&s.yAxis.length>1}),oe=H(()=>{const s=y.chart;return s.customAttr.basicStyle.quotaPosition==="row"&&s.customAttr.basicStyle.tableLayoutMode!=="tree"&&s.xAxis.length&&s.xAxisExt.length&&s.yAxis.length>1});function me(s){t.selectedSubTotalDimension=ee(t.subTotalDimensionList,e=>e.name===s)}function P(){const s=[];for(let e=0;e<t.subTotalDimensionList.length;e++)t.subTotalDimensionList[e].checked&&s.push(t.subTotalDimensionList[e].name);t.tableTotalForm.row.subTotalsDimensions=s,w("row")}const re=()=>{var f;const s=[];if(y.chart.xAxis.length>=2)for(let d=0;d<y.chart.xAxis.length-1;d++){const u=Le(t.tableTotalForm.row.subTotalsDimensions,y.chart.xAxis[d].dataeaseName);s.push({displayName:y.chart.xAxis[d].name,name:y.chart.xAxis[d].dataeaseName,checked:t.tableTotalForm.row.subTotalsDimensionsNew?u:!0})}t.subTotalDimensionList=s;const e=ee(t.subTotalDimensionList,d=>d.name===t.selectedSubTotalDimensionName);e?t.selectedSubTotalDimension=e:(t.selectedSubTotalDimensionName=(f=s[0])==null?void 0:f.name,t.selectedSubTotalDimension=s[0]),t.tableTotalForm.row.subTotalsDimensionsNew||(t.tableTotalForm.row.subTotalsDimensionsNew=!0,P())},se=le,w=s=>{se("onTableTotalChange",t.tableTotalForm,s)},J=()=>{var V,E,U;const s=(E=(V=y.chart)==null?void 0:V.customAttr)==null?void 0:E.tableTotal;s&&(s.row&&(s.row.subTotalsDimensionsNew=!!((U=s.row)!=null&&U.subTotalsDimensionsNew)),t.tableTotalForm=te(G(s),G(_)));const e=y.chart.yAxis;if((e==null?void 0:e.length)>0){const F=e.map(b=>b.dataeaseName);F.indexOf(t.tableTotalForm.row.totalSortField)===-1&&(t.tableTotalForm.row.totalSortField=e[0].dataeaseName),F.indexOf(t.tableTotalForm.col.totalSortField)===-1&&(t.tableTotalForm.col.totalSortField=e[0].dataeaseName)}else t.tableTotalForm.row.totalSortField="",t.tableTotalForm.col.totalSortField="";[{...t.tableTotalForm.row.calcTotals},{...t.tableTotalForm.row.calcSubTotals},{...t.tableTotalForm.col.calcTotals},{...t.tableTotalForm.col.calcSubTotals}].forEach(F=>{ne(F.cfg,e)}),[[t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg],[t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg],[t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg],[t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg]].forEach(F=>{const[b,h]=F;if(!h.length){b.dataeaseName="",b.aggregation="",b.originName="";return}const L=h.findIndex(M=>M.dataeaseName===b.dataeaseName);L!==-1?b.aggregation=h[L].aggregation:(b.dataeaseName=h[0].dataeaseName,b.aggregation=h[0].aggregation,b.originName=h[0].originName,b.label=h[0].label)});const u=G(y.chart.customAttr.basicStyle);t.basicStyleForm=te(u,G(Z)),re()},A=s=>{var e;return(e=y.propertyInner)==null?void 0:e.includes(s)},B=(s,e)=>{for(let f=0;f<e.length;f++){const d=e[f];if(d.dataeaseName===s.dataeaseName){s.aggregation=d.aggregation,s.originName=d.originName,s.label=d.label;return}}},$=(s,e,f)=>{for(let d=0;d<e.length;d++){const u=e[d];if(u.dataeaseName===s.dataeaseName){u.aggregation=s.aggregation,u.label=s.label;break}}s.aggregation=="CUSTOM"&&!s.originName||w(f)},ne=(s,e)=>{if(!s.length){e.forEach(d=>{s.push({dataeaseName:d.dataeaseName,aggregation:"SUM",label:d.chartShowName??d.name})});return}if(!e.length){s.splice(0,s.length);return}const f=s.reduce((d,u)=>(d[u.dataeaseName]=u,d),{});s.splice(0,s.length),e.forEach(d=>{var u;s.push({dataeaseName:d.dataeaseName,aggregation:f[d.dataeaseName]?f[d.dataeaseName].aggregation:"SUM",originName:f[d.dataeaseName]?f[d.dataeaseName].originName:"",label:(u=f[d.dataeaseName])!=null&&u.label?f[d.dataeaseName].label:d.chartShowName??d.name})})},X=K("quota",()=>[]),de=K("dimension",()=>[]),j=Q(),q=Q(!1),R=(s,e,f)=>{q.value=!0,t.totalCfg=e,t.totalCfgAttr=f,t.totalItem=s,ke(()=>{j.value.initEdit(s,X().filter(d=>d.id!=="-1"))})},W=()=>{q.value=!1},ue=()=>{var e;j.value.setFieldForm();const s=G(j.value.fieldForm);(e=t.totalCfg)==null||e.forEach(f=>{f.dataeaseName===s.dataeaseName&&(f.originName=s.originName,ie(f),t.totalItem.originName=f.originName)}),W(),w(t.totalCfgAttr)},ie=s=>{s.extField=2,s.chartId=y.chart.id,s.datasetGroupId=y.chart.tableId,s.lastSyncTime=null,s.columnIndex=de().length+X().length,s.deExtractType=s.deType};return Ee(()=>{J()}),(s,e)=>{const f=Ne,d=xe,u=Ve,V=$e,E=Me,U=Te,F=Fe,b=ve,h=Se,L=Ue("Setting"),M=he,fe=ye,Y=we,ce=be;return i(),x(I,null,[o(fe,{size:"small",ref:"tableTotalForm",model:t.tableTotalForm,"label-position":"top"},{default:m(()=>{var O;return[A("row")?(i(),v(f,{key:0,"content-position":"center",class:c("divider-style-"+a.themes)},{default:m(()=>[g(T(n(r)("chart.row_cfg")),1)]),_:1},8,["class"])):N("",!0),k(o(u,{label:n(r)("chart.total_show"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(d,{effect:a.themes,modelValue:t.tableTotalForm.row.showGrandTotals,"onUpdate:modelValue":e[0]||(e[0]=l=>t.tableTotalForm.row.showGrandTotals=l),onChange:e[1]||(e[1]=l=>w("row.showGrandTotals"))},{default:m(()=>[g(T(n(r)("chart.show")),1)]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),[[D,A("row")]]),k(p("div",null,[o(u,{label:n(r)("chart.total_position"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(E,{effect:a.themes,modelValue:t.tableTotalForm.row.reverseLayout,"onUpdate:modelValue":e[2]||(e[2]=l=>t.tableTotalForm.row.reverseLayout=l),onChange:e[3]||(e[3]=l=>w("row.reverseLayout"))},{default:m(()=>[o(V,{effect:a.themes,label:!0},{default:m(()=>[g(T(n(r)("chart.total_pos_top")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:!1},{default:m(()=>[g(T(n(r)("chart.total_pos_bottom")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),o(u,{label:n(r)("chart.table_grand_total_label"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(U,{effect:a.themes,placeholder:n(r)("chart.table_grand_total_label"),size:"small",maxlength:"20",modelValue:t.tableTotalForm.row.label,"onUpdate:modelValue":e[4]||(e[4]=l=>t.tableTotalForm.row.label=l),clearable:"",onChange:e[5]||(e[5]=l=>w("row.label"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"]),o(u,{label:n(r)("chart.aggregation"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(h,{span:11},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.rowTotalItem.dataeaseName,"onUpdate:modelValue":e[6]||(e[6]=l=>t.rowTotalItem.dataeaseName=l),placeholder:n(r)("chart.aggregation"),onChange:e[7]||(e[7]=l=>B(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg))},{default:m(()=>[(i(!0),x(I,null,C(a.chart.yAxis,l=>(i(),v(F,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1}),o(h,{span:t.rowTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.rowTotalItem.aggregation,"onUpdate:modelValue":e[8]||(e[8]=l=>t.rowTotalItem.aggregation=l),placeholder:n(r)("chart.aggregation"),onChange:e[9]||(e[9]=l=>$(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))},{default:m(()=>[(i(),x(I,null,C(z,l=>o(F,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["span"]),t.rowTotalItem.aggregation==="CUSTOM"?(i(),v(h,{key:0,span:2,offset:1},{default:m(()=>[o(M,null,{default:m(()=>[o(L,{onClick:e[10]||(e[10]=l=>R(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))})]),_:1})]),_:1})):N("",!0)]),_:1},8,["label","class"]),oe.value?(i(),v(u,{key:0,class:c(["form-item","form-item-"+a.themes]),label:n(r)("chart.table_field_total_label")},{default:m(()=>[o(U,{effect:a.themes,placeholder:n(r)("chart.table_field_total_label"),size:"small",maxlength:"20",modelValue:t.rowTotalItem.label,"onUpdate:modelValue":e[11]||(e[11]=l=>t.rowTotalItem.label=l),clearable:"",onChange:e[12]||(e[12]=l=>$(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"])):N("",!0),a.chart.type==="table-pivot"?(i(),v(u,{key:1,label:n(r)("chart.total_sort"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(E,{effect:a.themes,modelValue:t.tableTotalForm.row.totalSort,"onUpdate:modelValue":e[13]||(e[13]=l=>t.tableTotalForm.row.totalSort=l),onChange:e[14]||(e[14]=l=>w("row.totalSort"))},{default:m(()=>[o(V,{effect:a.themes,label:"none"},{default:m(()=>[g(T(n(r)("chart.total_sort_none")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:"asc"},{default:m(()=>[g(T(n(r)("chart.total_sort_asc")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:"desc"},{default:m(()=>[g(T(n(r)("chart.total_sort_desc")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"])):N("",!0),a.chart.type==="table-pivot"&&t.tableTotalForm.row.totalSort!=="none"?(i(),v(u,{key:2,label:n(r)("chart.total_sort_field"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.tableTotalForm.row.totalSortField,"onUpdate:modelValue":e[15]||(e[15]=l=>t.tableTotalForm.row.totalSortField=l),class:"form-item-select",placeholder:n(r)("chart.total_sort_field"),onChange:e[16]||(e[16]=l=>w("row.totalSortField"))},{default:m(()=>[(i(!0),x(I,null,C(a.chart.yAxis,l=>(i(),v(F,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["label","class"])):N("",!0)],512),[[D,A("row")&&t.tableTotalForm.row.showGrandTotals]]),k(o(u,{label:n(r)("chart.sub_total_show"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(d,{effect:a.themes,modelValue:t.tableTotalForm.row.showSubTotals,"onUpdate:modelValue":e[17]||(e[17]=l=>t.tableTotalForm.row.showSubTotals=l),disabled:a.chart.xAxis.length<2,onChange:e[18]||(e[18]=l=>w("row"))},{default:m(()=>[g(T(n(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),[[D,A("row")]]),A("row")&&t.tableTotalForm.row.showSubTotals?(i(),x("div",pe,[p("div",Ge,[e[61]||(e[61]=p("div",{style:{width:"22px","flex-direction":"row"}},null,-1)),p("div",ze,[o(u,{class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.selectedSubTotalDimensionName,"onUpdate:modelValue":e[19]||(e[19]=l=>t.selectedSubTotalDimensionName=l),disabled:a.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:me},{default:m(()=>[(i(!0),x(I,null,C(t.subTotalDimensionList,l=>(i(),v(F,{key:l.name,label:l.displayName,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["class"]),t.selectedSubTotalDimension?(i(),v(u,{key:0,class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(d,{effect:a.themes,modelValue:t.selectedSubTotalDimension.checked,"onUpdate:modelValue":e[20]||(e[20]=l=>t.selectedSubTotalDimension.checked=l),disabled:a.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:P},{default:m(()=>[g(T(n(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["class"])):N("",!0)])]),o(u,{label:n(r)("chart.total_position"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(E,{effect:a.themes,modelValue:t.tableTotalForm.row.reverseSubLayout,"onUpdate:modelValue":e[21]||(e[21]=l=>t.tableTotalForm.row.reverseSubLayout=l),disabled:a.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:e[22]||(e[22]=l=>w("row"))},{default:m(()=>[o(V,{effect:a.themes,label:!0},{default:m(()=>[g(T(n(r)("chart.total_pos_top")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:!1},{default:m(()=>[g(T(n(r)("chart.total_pos_bottom")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),o(u,{label:n(r)("chart.total_label"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(U,{effect:a.themes,disabled:a.chart.xAxis.length<2,placeholder:n(r)("chart.total_label"),modelValue:t.tableTotalForm.row.subLabel,"onUpdate:modelValue":e[23]||(e[23]=l=>t.tableTotalForm.row.subLabel=l),size:"small",maxlength:"20",clearable:"",onChange:e[24]||(e[24]=l=>w("row.subLabel"))},null,8,["effect","disabled","placeholder","modelValue"])]),_:1},8,["label","class"]),o(u,{label:n(r)("chart.aggregation"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(h,{span:11},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.rowSubTotalItem.dataeaseName,"onUpdate:modelValue":e[25]||(e[25]=l=>t.rowSubTotalItem.dataeaseName=l),disabled:a.chart.xAxis.length<2,placeholder:n(r)("chart.aggregation"),onChange:e[26]||(e[26]=l=>B(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg))},{default:m(()=>[(i(!0),x(I,null,C(a.chart.yAxis,l=>(i(),v(F,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled","placeholder"])]),_:1}),o(h,{span:t.rowSubTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.rowSubTotalItem.aggregation,"onUpdate:modelValue":e[27]||(e[27]=l=>t.rowSubTotalItem.aggregation=l),disabled:a.chart.xAxis.length<2,placeholder:n(r)("chart.aggregation"),onChange:e[28]||(e[28]=l=>$(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg,"row"))},{default:m(()=>[(i(),x(I,null,C(z,l=>o(F,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","disabled","placeholder"])]),_:1},8,["span"]),t.rowSubTotalItem.aggregation==="CUSTOM"?(i(),v(h,{key:0,span:2,offset:1},{default:m(()=>[o(M,null,{default:m(()=>[o(L,{onClick:e[29]||(e[29]=l=>R(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg,"row.calcSubTotals.cfg"))})]),_:1})]),_:1})):N("",!0)]),_:1},8,["label","class"])])):N("",!0),A("col")?(i(),v(f,{key:2,"content-position":"center",class:c("divider-style-"+a.themes)},{default:m(()=>[g(T(n(r)("chart.col_cfg")),1)]),_:1},8,["class"])):N("",!0),k(o(u,{label:n(r)("chart.total_show"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(d,{effect:a.themes,modelValue:t.tableTotalForm.col.showGrandTotals,"onUpdate:modelValue":e[30]||(e[30]=l=>t.tableTotalForm.col.showGrandTotals=l),onChange:e[31]||(e[31]=l=>w("col"))},{default:m(()=>[g(T(n(r)("chart.show")),1)]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),[[D,A("col")]]),k(p("div",null,[o(u,{label:n(r)("chart.total_position"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(E,{effect:a.themes,modelValue:t.tableTotalForm.col.reverseLayout,"onUpdate:modelValue":e[32]||(e[32]=l=>t.tableTotalForm.col.reverseLayout=l),onChange:e[33]||(e[33]=l=>w("col"))},{default:m(()=>[o(V,{effect:a.themes,label:!0},{default:m(()=>[g(T(n(r)("chart.total_pos_left")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:!1},{default:m(()=>[g(T(n(r)("chart.total_pos_right")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),o(u,{label:n(r)("chart.table_grand_total_label"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(U,{effect:a.themes,placeholder:n(r)("chart.table_grand_total_label"),size:"small",maxlength:"20",modelValue:t.tableTotalForm.col.label,"onUpdate:modelValue":e[34]||(e[34]=l=>t.tableTotalForm.col.label=l),clearable:"",onBlur:e[35]||(e[35]=l=>w("col.label"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"]),o(u,{label:n(r)("chart.aggregation"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(h,{span:11},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.colTotalItem.dataeaseName,"onUpdate:modelValue":e[36]||(e[36]=l=>t.colTotalItem.dataeaseName=l),placeholder:n(r)("chart.aggregation"),onChange:e[37]||(e[37]=l=>B(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg))},{default:m(()=>[(i(!0),x(I,null,C(a.chart.yAxis,l=>(i(),v(F,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1}),o(h,{span:t.colTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.colTotalItem.aggregation,"onUpdate:modelValue":e[38]||(e[38]=l=>t.colTotalItem.aggregation=l),placeholder:n(r)("chart.aggregation"),onChange:e[39]||(e[39]=l=>$(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))},{default:m(()=>[(i(),x(I,null,C(z,l=>o(F,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["span"]),t.colTotalItem.aggregation==="CUSTOM"?(i(),v(h,{key:0,span:2,offset:1},{default:m(()=>[o(M,null,{default:m(()=>[o(L,{onClick:e[40]||(e[40]=l=>R(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))})]),_:1})]),_:1})):N("",!0)]),_:1},8,["label","class"]),ae.value?(i(),v(u,{key:0,class:c(["form-item","form-item-"+a.themes]),label:n(r)("chart.table_field_total_label")},{default:m(()=>[o(U,{effect:a.themes,placeholder:n(r)("chart.table_field_total_label"),size:"small",maxlength:"20",modelValue:t.colTotalItem.label,"onUpdate:modelValue":e[41]||(e[41]=l=>t.colTotalItem.label=l),clearable:"",onChange:e[42]||(e[42]=l=>$(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"])):N("",!0),a.chart.type==="table-pivot"?(i(),v(u,{key:1,label:n(r)("chart.total_sort"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(E,{effect:a.themes,modelValue:t.tableTotalForm.col.totalSort,"onUpdate:modelValue":e[43]||(e[43]=l=>t.tableTotalForm.col.totalSort=l),onChange:e[44]||(e[44]=l=>w("col"))},{default:m(()=>[o(V,{effect:a.themes,label:"none"},{default:m(()=>[g(T(n(r)("chart.total_sort_none")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:"asc"},{default:m(()=>[g(T(n(r)("chart.total_sort_asc")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:"desc"},{default:m(()=>[g(T(n(r)("chart.total_sort_desc")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"])):N("",!0),k(o(u,{label:n(r)("chart.total_sort_field"),class:"form-item"},{default:m(()=>[o(b,{effect:a.themes,modelValue:t.tableTotalForm.col.totalSortField,"onUpdate:modelValue":e[45]||(e[45]=l=>t.tableTotalForm.col.totalSortField=l),class:"form-item-select",placeholder:n(r)("chart.total_sort_field"),onChange:e[46]||(e[46]=l=>w("col"))},{default:m(()=>[(i(!0),x(I,null,C(a.chart.yAxis,l=>(i(),v(F,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["label"]),[[D,a.chart.type==="table-pivot"&&((O=t.tableTotalForm.col)==null?void 0:O.totalSort)!=="none"]])],512),[[D,A("col")&&t.tableTotalForm.col.showGrandTotals]]),k(o(u,{label:n(r)("chart.sub_total_show"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(d,{effect:a.themes,modelValue:t.tableTotalForm.col.showSubTotals,"onUpdate:modelValue":e[47]||(e[47]=l=>t.tableTotalForm.col.showSubTotals=l),disabled:a.chart.xAxisExt.length<2,onChange:e[48]||(e[48]=l=>w("col"))},{default:m(()=>[g(T(n(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),[[D,A("col")]]),k(p("div",null,[o(u,{label:n(r)("chart.total_position"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>{var l;return[o(E,{effect:a.themes,modelValue:t.tableTotalForm.col.reverseSubLayout,"onUpdate:modelValue":e[49]||(e[49]=S=>t.tableTotalForm.col.reverseSubLayout=S),disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,onChange:e[50]||(e[50]=S=>w("col"))},{default:m(()=>[o(V,{effect:a.themes,label:!0},{default:m(()=>[g(T(n(r)("chart.total_pos_left")),1)]),_:1},8,["effect"]),o(V,{effect:a.themes,label:!1},{default:m(()=>[g(T(n(r)("chart.total_pos_right")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue","disabled"])]}),_:1},8,["label","class"]),o(u,{label:n(r)("chart.total_label"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>{var l;return[o(U,{effect:a.themes,disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,placeholder:n(r)("chart.total_label"),modelValue:t.tableTotalForm.col.subLabel,"onUpdate:modelValue":e[51]||(e[51]=S=>t.tableTotalForm.col.subLabel=S),size:"small",maxlength:"20",clearable:"",onChange:e[52]||(e[52]=S=>w("col.subLabel"))},null,8,["effect","disabled","placeholder","modelValue"])]}),_:1},8,["label","class"]),o(u,{label:n(r)("chart.aggregation"),class:c(["form-item","form-item-"+a.themes])},{default:m(()=>[o(h,{span:11},{default:m(()=>{var l;return[o(b,{effect:a.themes,modelValue:t.colSubTotalItem.dataeaseName,"onUpdate:modelValue":e[53]||(e[53]=S=>t.colSubTotalItem.dataeaseName=S),disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,placeholder:n(r)("chart.aggregation"),onChange:e[54]||(e[54]=S=>B(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg))},{default:m(()=>[(i(!0),x(I,null,C(a.chart.yAxis,S=>(i(),v(F,{key:S.dataeaseName,label:S.name,value:S.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled","placeholder"])]}),_:1}),o(h,{span:t.colSubTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>{var l;return[o(b,{effect:a.themes,modelValue:t.colSubTotalItem.aggregation,"onUpdate:modelValue":e[55]||(e[55]=S=>t.colSubTotalItem.aggregation=S),disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,placeholder:n(r)("chart.aggregation"),onChange:e[56]||(e[56]=S=>$(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg,"col.calcSubTotals.cfg"))},{default:m(()=>[(i(),x(I,null,C(z,S=>o(F,{key:S.value,label:S.name,value:S.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","disabled","placeholder"])]}),_:1},8,["span"]),t.colSubTotalItem.aggregation==="CUSTOM"?(i(),v(h,{key:0,span:2,offset:1},{default:m(()=>[o(M,null,{default:m(()=>[o(L,{onClick:e[57]||(e[57]=l=>R(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg,"col.calcSubTotals.cfg"))})]),_:1})]),_:1})):N("",!0)]),_:1},8,["label","class"])],512),[[D,A("col")&&t.tableTotalForm.col.showSubTotals]])]}),_:1},8,["model"]),o(ce,{modelValue:q.value,"onUpdate:modelValue":e[60]||(e[60]=O=>q.value=O),width:"1000px",title:"自定义聚合公式","close-on-click-modal":!1},{footer:m(()=>[o(Y,{secondary:"",onClick:e[58]||(e[58]=O=>W())},{default:m(()=>[g(T(n(r)("dataset.cancel")),1)]),_:1}),o(Y,{type:"primary",onClick:e[59]||(e[59]=O=>ue())},{default:m(()=>[g(T(n(r)("dataset.confirm")),1)]),_:1})]),default:m(()=>[o(De,{ref_key:"calcEdit",ref:j},null,512)]),_:1},8,["modelValue"])],64)}}});const Mt=Oe(Be,[["__scopeId","data-v-70f2bbe4"]]);export{Mt as default};
