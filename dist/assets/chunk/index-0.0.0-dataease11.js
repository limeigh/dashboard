import{u as Ba,b as Fa,y as Oa,c as Ua,R as Nt,a as Aa,z as ja}from"./index-0.0.0-dataease.js";import{E as Wa}from"./el-drawer-0.0.0-dataease.js";import{o as Za,P as qa,D as j,aS as Ja,j as L,n as w,y as z,v as Lt,F as Ke,G as Ya}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as Ga}from"./el-dialog-0.0.0-dataease.js";import{a as Ka,E as Xa}from"./el-table-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./el-virtual-list-0.0.0-dataease.js";import{E as Qa,a as eo}from"./el-table-v2-0.0.0-dataease.js";import{E as to}from"./el-row-0.0.0-dataease.js";import{E as ao}from"./el-col-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as oo,a as lo}from"./el-tabs-0.0.0-dataease.js";import{E as so}from"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import{E as no}from"./el-popover-0.0.0-dataease.js";import{E as io}from"./el-divider-0.0.0-dataease.js";import{E as ro}from"./el-tree-0.0.0-dataease.js";import{E as co,a as uo,b as po}from"./el-dropdown-menu-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import{f as i,O as g,a5 as mo,P as p,d as fo,X as oe,y as de,r as C,s as Ne,w as _o,o as go,a7 as vo,R as H,j as t,T as Xe,u as e,i as a,a4 as c,_ as m,W as E,a6 as Qe,S as G,a3 as _,g as v,l as he,a8 as et,U as ye,n as Vt,h as be,ak as ho}from"./vue-0.0.0-dataease.js";import{i as It}from"./icon_down_outlined-1-0.0.0-dataease.js";import{i as $t}from"./icon_down_outlined-0.0.0-dataease.js";import{i as yo}from"./icon_copy_filled-0.0.0-dataease.js";import{i as bo}from"./icon_dataset-0.0.0-dataease.js";import{i as Co}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as wo,_ as To,t as xo}from"./index.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import{i as ko}from"./icon_rename_outlined-0.0.0-dataease.js";import{d as Mt}from"./dv-folder-0.0.0-dataease.js";import{d as So,i as Eo}from"./icon_file-add_outlined-0.0.0-dataease.js";import{i as zt}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as Do,a as No}from"./dv-sort-desc-0.0.0-dataease.js";import{i as Ht}from"./icon_add_outlined-0.0.0-dataease.js";import{i as Lo}from"./icon_info_outlined-0.0.0-dataease.js";import{i as tt}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as Rt}from"./icon_replace_outlined-0.0.0-dataease.js";import{i as Vo}from"./icon-maybe_outlined-0.0.0-dataease.js";import{d as Io}from"./option-0.0.0-dataease.js";import"./el-aside-0.0.0-dataease.js";import{G as Pt}from"./GridTable-0.0.0-dataease.js";import Bt from"./DeResourceArrow-0.0.0-dataease.js";import{_ as Ft}from"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{f as le}from"./attr-0.0.0-dataease23.js";import{j as $o,k as Mo,m as zo,n as Ho,o as Ro,p as Po,q as Ot,r as at,t as Bo,w as ot,x as Ut,y as Fo,e as Oo,z as Uo,A as Ao,B as jo,C as Wo,D as Zo}from"./datasource-0.0.0-dataease.js";import qo from"./CreatDsGroup-0.0.0-dataease2.js";import Jo from"./DatasetDetail-0.0.0-dataease.js";import{t as Ce}from"./util-0.0.0-dataease.js";import{E as lt}from"./EmptyBackground-0.0.0-dataease.js";import{d as At}from"./dayjs.min-0.0.0-dataease.js";import{useAppStoreWithOut as Yo}from"./app-0.0.0-dataease.js";import{_ as Go}from"./index.vue_vue_type_style_index_0_lang-0.0.0-dataease3.js";import jt from"./ExcelInfoBase-0.0.0-dataease.js";import Ko from"./SheetTabs-0.0.0-dataease.js";import{_ as S}from"./BaseInfoItem.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import Le from"./BaseInfoContent-0.0.0-dataease.js";import{u as Xo}from"./useMoveLine-0.0.0-dataease.js";import{i as Qo}from"./interactive-0.0.0-dataease.js";import{t as Wt}from"./treeSortUtils-0.0.0-dataease.js";import{i as Zt}from"./field-list-0.0.0-dataease.js";import{i as qt}from"./datasource-list-0.0.0-dataease.js";import{s as J}from"./encryption-0.0.0-dataease.js";import{e as F,h as el}from"./lodash-0.0.0-dataease.js";import{a as tl}from"./index-0.0.0-dataease16.js";import{E as al}from"./index-0.0.0-dataease4.js";import{_ as ol}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./use-dialog-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./raf-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./token-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./el-pagination-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./icon_right_outlined-0.0.0-dataease.js";import"./icon_more_outlined-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-tree-select-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./ApiHttpRequestDraw.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./icon_expand-right_filled-0.0.0-dataease.js";import"./ApiHttpRequestForm-0.0.0-dataease.js";import"./ApiKeyValue-0.0.0-dataease.js";import"./ApiTestModel-0.0.0-dataease.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./vuedraggable-es-0.0.0-dataease.js";import"./ApiBody-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./ApiVariable-0.0.0-dataease.js";import"./CodeEdit.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./index-0.0.0-dataease27.js";import"./Pagination-0.0.0-dataease.js";import"./ApiAuthConfig.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./index-0.0.0-dataease20.js";import"./index-0.0.0-dataease18.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./DsTypeList-0.0.0-dataease.js";import"./EditorDetail-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./el-select-v2-0.0.0-dataease.js";import"./fixed-size-list-0.0.0-dataease.js";import"./icon_calendar_outlined-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./de-delete-0.0.0-dataease.js";import"./icon_warning_filled-0.0.0-dataease.js";import"./CustomPassword.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./icon_invisible_outlined-0.0.0-dataease.js";import"./Cron.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-checkbox-group-0.0.0-dataease.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./ExcelDetail.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./icon_upload_outlined-0.0.0-dataease.js";import"./ExcelInfo-0.0.0-dataease.js";import"./icon_excel-0.0.0-dataease.js";import"./index.esm-0.0.0-dataease.js";import"./FinishPage-0.0.0-dataease.js";import"./ExcelRemoteDetail-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";const ll={width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function sl(O,D){return i(),g("svg",ll,[...D[0]||(D[0]=[mo('<g clip-path="url(#clip0_4327_361639)"><path d="M6 11.5C9.03757 11.5 11.5 9.03757 11.5 6C11.5 2.96243 9.03757 0.5 6 0.5C2.96243 0.5 0.5 2.96243 0.5 6C0.5 9.03757 2.96243 11.5 6 11.5Z" fill="#F54A45"></path><path d="M5.75 3.5C5.61193 3.5 5.5 3.61193 5.5 3.75V6.75C5.5 6.88807 5.61193 7 5.75 7H6.25C6.38807 7 6.5 6.88807 6.5 6.75V3.75C6.5 3.61193 6.38807 3.5 6.25 3.5H5.75Z" fill="white"></path><path d="M5.75 7.5C5.61193 7.5 5.5 7.61193 5.5 7.75V8.25C5.5 8.38807 5.61193 8.5 5.75 8.5H6.25C6.38807 8.5 6.5 8.38807 6.5 8.25V7.75C6.5 7.61193 6.38807 7.5 6.25 7.5H5.75Z" fill="white"></path></g><defs><clipPath id="clip0_4327_361639"><rect width="12" height="12" fill="white"></rect></clipPath></defs>',2)])])}const nl={render:sl},il={width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"};function rl(O,D){return i(),g("svg",il,[...D[0]||(D[0]=[p("g",{id:"icon_dataset_outlined"},[p("path",{id:"Union",d:"M0.833344 6.36987C0.833344 6.04308 1.02435 5.74646 1.32184 5.61123L9.65517 1.82335C9.87428 1.72376 10.1257 1.72376 10.3448 1.82335L18.6782 5.61123C18.9757 5.74646 19.1667 6.04308 19.1667 6.36987V14.4849C19.1667 14.8006 18.9883 15.0891 18.706 15.2303L10.3727 19.3969C10.1381 19.5142 9.86194 19.5142 9.62733 19.3969L1.294 15.2303C1.01168 15.0891 0.833344 14.8006 0.833344 14.4849V6.36987ZM16.0149 6.2314L10 3.49737L3.95267 6.24616L9.96664 8.83681L16.0149 6.2314ZM10.8333 10.2782V17.3032L17.5 13.9699V7.40638L10.8333 10.2782ZM2.50001 7.43512V13.9699L9.16668 17.3032V10.3069L2.50001 7.43512Z",fill:"currentColor"})],-1)])])}const Jt={render:rl},cl={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function dl(O,D){return i(),g("svg",cl,[...D[0]||(D[0]=[p("g",{id:"icon_new-item_outlined"},[p("path",{id:"Vector",d:"M12.2493 1.16602C12.4041 1.16602 12.5524 1.22747 12.6618 1.33687C12.7712 1.44627 12.8327 1.59464 12.8327 1.74935V12.2493C12.8327 12.4041 12.7712 12.5524 12.6618 12.6618C12.5524 12.7712 12.4041 12.8327 12.2493 12.8327H1.74935C1.59464 12.8327 1.44627 12.7712 1.33687 12.6618C1.22747 12.5524 1.16602 12.4041 1.16602 12.2493V1.74935C1.16602 1.59464 1.22747 1.44627 1.33687 1.33687C1.44627 1.22747 1.59464 1.16602 1.74935 1.16602H12.2493ZM11.3743 2.33268H2.62435C2.55291 2.33269 2.48396 2.35892 2.43057 2.40639C2.37719 2.45386 2.34308 2.51928 2.33472 2.59022L2.33268 2.62435V11.3743C2.33269 11.4458 2.35892 11.5147 2.40639 11.5681C2.45386 11.6215 2.51928 11.6556 2.59022 11.664L2.62435 11.666H11.3743C11.4458 11.666 11.5147 11.6398 11.5681 11.5923C11.6215 11.5448 11.6556 11.4794 11.664 11.4085L11.666 11.3743V2.62435C11.666 2.54699 11.6353 2.47281 11.5806 2.41811C11.5259 2.36341 11.4517 2.33268 11.3743 2.33268ZM7.29102 4.08268C7.32932 4.08268 7.36724 4.09023 7.40263 4.10488C7.43802 4.11954 7.47017 4.14103 7.49725 4.16811C7.52434 4.19519 7.54582 4.22735 7.56048 4.26273C7.57514 4.29812 7.58268 4.33605 7.58268 4.37435V6.41602H9.62435C9.66265 6.41602 9.70058 6.42356 9.73597 6.43822C9.77135 6.45288 9.8035 6.47436 9.83059 6.50144C9.85767 6.52853 9.87916 6.56068 9.89381 6.59607C9.90847 6.63145 9.91602 6.66938 9.91602 6.70768V7.29102C9.91602 7.32932 9.90847 7.36725 9.89381 7.40263C9.87916 7.43802 9.85767 7.47017 9.83059 7.49726C9.8035 7.52434 9.77135 7.54582 9.73597 7.56048C9.70058 7.57514 9.66265 7.58268 9.62435 7.58268H7.58268V9.62435C7.58268 9.66265 7.57514 9.70058 7.56048 9.73597C7.54582 9.77135 7.52434 9.80351 7.49725 9.83059C7.47017 9.85767 7.43802 9.87916 7.40263 9.89381C7.36724 9.90847 7.32932 9.91602 7.29102 9.91602H6.70768C6.66938 9.91602 6.63145 9.90847 6.59607 9.89381C6.56068 9.87916 6.52853 9.85767 6.50144 9.83059C6.47436 9.80351 6.45288 9.77135 6.43822 9.73597C6.42356 9.70058 6.41602 9.66265 6.41602 9.62435V7.58268H4.37435C4.33605 7.58268 4.29812 7.57514 4.26273 7.56048C4.22735 7.54582 4.19519 7.52434 4.16811 7.49726C4.14103 7.47017 4.11954 7.43802 4.10488 7.40263C4.09023 7.36725 4.08268 7.32932 4.08268 7.29102V6.70768C4.08268 6.66938 4.09023 6.63145 4.10488 6.59607C4.11954 6.56068 4.14103 6.52853 4.16811 6.50144C4.19519 6.47436 4.22735 6.45288 4.26273 6.43822C4.29812 6.42356 4.33605 6.41602 4.37435 6.41602H6.41602V4.37435C6.41602 4.33605 6.42356 4.29812 6.43822 4.26273C6.45288 4.22735 6.47436 4.19519 6.50144 4.16811C6.52853 4.14103 6.56068 4.11954 6.59607 4.10488C6.63145 4.09023 6.66938 4.08268 6.70768 4.08268H7.29102Z",fill:"white"})],-1)])])}const ul={render:dl},pl={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function ml(O,D){return i(),g("svg",pl,[...D[0]||(D[0]=[p("path",{d:"M5 3V21H19V3H5ZM4 1H20C20.5523 1 21 1.46904 21 2.04762V21.9524C21 22.531 20.5523 23 20 23H4C3.44772 23 3 22.531 3 21.9524V2.04762C3 1.46904 3.44772 1 4 1ZM7.5 7H11.5C11.7761 7 12 7.22386 12 7.5V8.5C12 8.77614 11.7761 9 11.5 9H7.5C7.22386 9 7 8.77614 7 8.5V7.5C7 7.22386 7.22386 7 7.5 7ZM7.5 11H16.5C16.7761 11 17 11.2239 17 11.5V12.5C17 12.7761 16.7761 13 16.5 13H7.5C7.22386 13 7 12.7761 7 12.5V11.5C7 11.2239 7.22386 11 7.5 11ZM7.5 15H16.5C16.7761 15 17 15.2239 17 15.5V16.5C17 16.7761 16.7761 17 16.5 17H7.5C7.22386 17 7 16.7761 7 16.5V15.5C7 15.2239 7.22386 15 7.5 15Z"},null,-1)])])}const Yt={render:ml},fl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function _l(O,D){return i(),g("svg",fl,[...D[0]||(D[0]=[p("g",{id:"icon_succeed_filled","clip-path":"url(#clip0_3515_155051)"},[p("path",{id:"Union",d:"M0.666016 7.99935C0.666016 12.0493 3.94935 15.3327 7.99935 15.3327C12.0494 15.3327 15.3327 12.0493 15.3327 7.99935C15.3327 3.94935 12.0494 0.666016 7.99935 0.666016C3.94935 0.666016 0.666016 3.94935 0.666016 7.99935ZM10.7617 5.9837C10.8242 5.92121 10.909 5.88611 10.9974 5.88611C11.0857 5.88611 11.1705 5.92121 11.233 5.9837L11.7044 6.45537C11.7668 6.51788 11.8019 6.60265 11.8019 6.69104C11.8019 6.77942 11.7668 6.86419 11.7044 6.9267L7.46169 11.1694C7.39918 11.2319 7.31441 11.267 7.22602 11.267C7.13763 11.267 7.05286 11.2319 6.99035 11.1694L4.55035 8.72903C4.48786 8.66652 4.45276 8.58176 4.45276 8.49337C4.45276 8.40498 4.48786 8.32021 4.55035 8.2577L5.02135 7.78604C5.08386 7.72354 5.16863 7.68844 5.25702 7.68844C5.34541 7.68844 5.43018 7.72354 5.49269 7.78604L7.22602 9.51937L10.7617 5.9837Z",fill:"#34C724"})],-1),p("defs",null,[p("clipPath",{id:"clip0_3515_155051"},[p("rect",{width:"16",height:"16",fill:"white"})])],-1)])])}const Gt={render:_l},gl={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function vl(O,D){return i(),g("svg",gl,[...D[0]||(D[0]=[p("path",{d:"M12 23.0001C5.925 23.0001 1 18.0751 1 12.0001C1 5.92506 5.925 1.00006 12 1.00006C18.075 1.00006 23 5.92506 23 12.0001C23 18.0751 18.075 23.0001 12 23.0001Z"},null,-1),p("path",{d:"M12.0002 10.586L9.02524 7.61099C8.93147 7.51726 8.80432 7.4646 8.67174 7.4646C8.53916 7.4646 8.412 7.51726 8.31824 7.61099L7.61124 8.31799C7.5175 8.41176 7.46484 8.53891 7.46484 8.67149C7.46484 8.80407 7.5175 8.93123 7.61124 9.02499L10.5862 12L7.61124 14.975C7.5175 15.0688 7.46484 15.1959 7.46484 15.3285C7.46484 15.4611 7.5175 15.5882 7.61124 15.682L8.31824 16.389C8.412 16.4827 8.53916 16.5354 8.67174 16.5354C8.80432 16.5354 8.93147 16.4827 9.02524 16.389L12.0002 13.414L14.9752 16.389C15.069 16.4827 15.1962 16.5354 15.3287 16.5354C15.4613 16.5354 15.5885 16.4827 15.6822 16.389L16.3892 15.682C16.483 15.5882 16.5356 15.4611 16.5356 15.3285C16.5356 15.1959 16.483 15.0688 16.3892 14.975L13.4142 12L16.3892 9.02499C16.483 8.93123 16.5356 8.80407 16.5356 8.67149C16.5356 8.53891 16.483 8.41176 16.3892 8.31799L15.6822 7.61099C15.5885 7.51726 15.4613 7.4646 15.3287 7.4646C15.1962 7.4646 15.069 7.51726 14.9752 7.61099L12.0002 10.586Z",fill:"white"},null,-1)])])}const Kt={render:vl},hl={class:"datasource-manage"},yl={class:"resource-tree"},bl={class:"tree-header"},Cl={class:"icon-methods"},wl={class:"title"},Tl={key:0,class:"flex-align-center"},xl={key:0,class:"ed-dropdown-menu__item--divided"},kl={class:"custom-tree-node",style:{position:"relative"}},Sl=["title"],El=["title"],Dl={key:3,class:"icon-more"},Nl={class:"datasource-info"},Ll={class:"info-method"},Vl=["title"],Il={class:"create-user"},$l={class:"right-btn flex-align-center"},Ml={class:"tab-border"},zl={key:0,class:"datasource-table"},Hl={class:"search-operate"},Rl={class:"info-table"},Pl={class:"flex-align-center"},Bl={key:0,class:"api-card-content"},Fl={class:"name"},Ol=["title"],Ul={key:0,class:"de-tag error-color"},Al={key:1,class:"de-tag success-color"},jl={class:"req-title"},Wl={class:"req-value"},Zl={key:0,class:"excel-table"},ql={class:"sheet-table-content"},Jl={class:"table-name"},Yl={class:"table-value"},Gl={class:"table-name"},Kl={class:"table-value"},Xl={class:"flex-align-center icon"},Ql={class:"flex-align-center"},es={class:"flex-align-center"},ts={class:"dialog-footer"};function as(O){return typeof O=="function"||Object.prototype.toString.call(O)==="[object Object]"&&!ho(O)}const os=fo({__name:"index",setup(O){const D=Ba(),Xt=Qo(),{wsCache:K}=Fa(),{t:l}=Za(),we=Oa(),Te=Yo(),h=oe({datasourceTree:[],dsTableData:[],paginationConfig:{currentPage:1,pageSize:10,total:0},curSortType:"time_desc",filterTable:[]}),X=oe({paginationConfig:{currentPage:1,pageSize:10,total:0}}),Ve=de(()=>Te.getIsDataEaseBi),st=de(()=>Te.getIsIframe),Ie=Ua(),nt=o=>{if(Ve.value){Ie.clearState(),Ie.setDatasourceId(n.id),Ie.setTableName(o),Aa().emitter.emit("changeCurrentComponent","DatasetEditor");return}K.set("ds-info-id",n.id),we.push({path:"/dataset-form",query:{datasourceId:n.id,tableName:o}})},{width:$e,node:Qt}=Xo("DATASOURCE"),Me=oe({tableName:"",name:""}),ze=C(!1),ue=C(""),pe=C(""),He=C(!1),ea=C([]),xe=C(!1),ke=C(!0),se=C(),ne=C(""),it=[{label:l("chart.move_to"),svgName:wo,command:"move"},{label:l("data_set.rename"),svgName:ko,command:"rename"},{label:l("common.delete"),divided:!0,svgName:Co,command:"delete"}],rt=Io.reduce((o,s)=>(o[s.type]=s.name,o),{}),ta=de(()=>[{label:l("datasource.create"),svgName:bo,command:"datasource"},{label:l("deDataset.new_folder"),divided:!0,svgName:Mt,command:"folder"}]),Re=C(!1),aa=o=>{Object.assign(Me,o),He.value=!0,Re.value=!0,$o({tableName:o.tableName,datasourceId:n.id,isCross:!1}).then(s=>{h.dsTableData=s.data}).finally(()=>{Re.value=!1})},me=Ne([]),oa=o=>{h.datasourceTree=Wt(me.value,o),h.curSortType=o,K.set("TreeSort-datasource",h.curSortType)},ct=o=>{h.datasourceTree=Wt(me.value,o),h.curSortType=o},la=o=>{h.paginationConfig.currentPage=1,h.paginationConfig.pageSize=o},Pe=o=>{h.paginationConfig.currentPage=o},sa=o=>{X.paginationConfig.currentPage=1,X.paginationConfig.pageSize=o,Je()},na=o=>{X.paginationConfig.currentPage=o,Je()};let dt=0;const ia=o=>{dt=o.scrollTop},ut=C(),ra=o=>o.map(s=>({key:s.originName,deType:s.deType,dataKey:s.originName,title:s.name,width:150,headerCellRenderer:({column:r})=>{let u;return t("div",{class:"flex-align-center"},[t(L,{style:{marginRight:"6px"}},{default:()=>[t(w,{className:`field-icon-${le[r.deType]}`},as(u=be(Zt[le[r.deType]],{class:`svg-icon field-icon-${le[r.deType]}`}))?u:{default:()=>[u]})]}),t("span",{class:"ellipsis",title:r.title,style:{width:"120px"}},[r.title])])}})),Be=C(!1),pt=C([]),ca=o=>{Be.value=!0,Uo(o).then(s=>{var r,u;pt.value=ra(((r=s==null?void 0:s.data)==null?void 0:r.fields)||[]),yt.value=((u=s==null?void 0:s.data)==null?void 0:u.data)||[]}).finally(()=>{Be.value=!1})},da=()=>{let o=oe(F(Y));Object.assign(o,F(n)),Mo(o.id).then(s=>{if(s.data.type.startsWith("API")){let r=0;const u=JSON.parse(s.data.status);for(let f=0;f<u.length;f++){u[f].status==="Error"&&r++;for(let T=0;T<o.apiConfiguration.length;T++)n.apiConfiguration[T].name===u[T].name&&(n.apiConfiguration[T].status=u[T].status)}r===0?(fe(h.datasourceTree,o.id,Math.abs(o.extraFlag)),j.success(l("data_source.verification_successful"))):(fe(h.datasourceTree,o.id,-Math.abs(o.extraFlag)),j.error(l("data_source.verification_failed")))}else fe(h.datasourceTree,o.id,Math.abs(o.extraFlag)),j.success(l("data_source.verification_successful"))}).catch(()=>{fe(h.datasourceTree,o.id,-Math.abs(o.extraFlag))})},Se=C(!1),mt=C(""),ua=o=>{const{syncRate:s,simpleCronValue:r,simpleCronType:u,startTime:f,endTime:T,cron:M}=o;let R="-",P="-";f&&(R=At(new Date(f)).format("YYYY-MM-DD HH:mm:ss")),T&&(P=At(new Date(T)).format("YYYY-MM-DD HH:mm:ss"));let N=[];switch(s){case"RIGHTNOW":N.push(l("dataset.execute_once"));break;case"CRON":N.push(`${l("dataset.cron_config")}: ${M}`),N.push(`${l("dataset.start_time")}: ${R}`),N.push(`${l("dataset.end_time")}: ${P}`);break;case"SIMPLE_CRON":const V=l(`common.${u}`);N.push(`${l("dataset.simple_cron")}: ${l("common.every")}${r}${V}${l("data_source.update_once")}`),N.push(`${l("dataset.start_time")}: ${R}`),N.push(`${l("dataset.end_time")}: ${P}`);break}return N},pa=o=>{mt.value=o,Se.value=!0},W=C([]),ma=o=>{W.value=o,W.value.forEach(s=>{rt[s.type]=s.name})},fa=o=>{if((W==null?void 0:W.value.length)===0||!o.leaf)return null;const s=W.value.filter(r=>r.type===o.type);return s&&s.length>0?s[0].icon:null},_a=o=>{const s=W.value.filter(r=>r.type===o);return s&&s.length>0?s[0].icon:null},ga=o=>o.leaf?qt[o.type]:Mt,ft=o=>{ne.value=o.value,ca({table:o.value,id:n.id})},Ee=Ne([]),_t=()=>{Pe(1),h.filterTable=Z.value.filter(o=>o.tableName.toLowerCase().includes(ue.value.toLowerCase())),h.paginationConfig.total=h.filterTable.length},va=de(()=>{const{currentPage:o,pageSize:s}=h.paginationConfig;return h.filterTable.slice((o-1)*s,o*s)}),Y={name:"",createBy:"",creator:"",createTime:"",description:"",id:0,size:0,nodeType:"",type:"",fileName:"",configuration:null,syncSetting:null,apiConfiguration:[],weight:0,enableDataFill:!1,extraFlag:0},n=oe(F(Y)),gt=de(()=>({creator:n.creator,createTime:Ce(n.createTime)})),ha=(o,s,r,u)=>{let f=at,T=l("data_set.moved_successfully");switch(u){case"move":f=at,T=l("data_set.moved_successfully");break;case"rename":f=jo,T=l("data_set.rename_successful");break;default:f=Ao,T=l("data_source.create_successfully");break}f(o).then(M=>{M!==void 0&&(s(),j.success(T),re())}).finally(()=>{r()})},Fe=C(!1),Oe=C(!1),ie=C(!1),U=C(""),re=()=>{ea.value=[],Fe.value=!0;let o=Ae[Number(K.get("TreeSort-backend"))??1].value;o=K.get("TreeSort-datasource")??o;const s={busiFlag:"datasource"};Xt.setInteractive(s).then(r=>{const u=r||[];if(u.length&&u[0].id==="0"&&u[0].name==="root"){ze.value=u[0].weight>=7,h.datasourceTree=u[0].children||[],me.value=F(e(h.datasourceTree)),ct(o);return}me.value=F(e(h.datasourceTree)),h.datasourceTree=u,ct(o)}).finally(()=>{Oe.value=!0,Fe.value=!1,ba();const r=n.id;r&&(Object.assign(n,F(Y)),vt(h.datasourceTree,r),setTimeout(()=>{pe.value&&_e.value.filter(pe.value),_e.value.setCurrentKey(n.id,!0)},100))})},ya=()=>{zo().then(o=>{ie.value=o.data}).catch(o=>{console.warn(o==null?void 0:o.message)})},fe=(o,s,r)=>{o.some(u=>{var f;return u.id===s?(u.extraFlag=r,!0):((f=u.children)!=null&&f.length&&fe(u.children,s,r),!1)})},vt=(o,s)=>{o.some(r=>{var u;return r.id===s?(je(r),!0):((u=r.children)!=null&&u.length&&vt(r.children,s),!1)})},Ue=C(),Ae=[{name:l("visualization.time_asc"),value:"time_asc"},{name:l("visualization.time_desc"),value:"time_desc",divided:!0},{name:l("visualization.name_asc"),value:"name_asc"},{name:l("visualization.name_desc"),value:"name_desc"}],ht=de(()=>Ae.find(o=>o.value===h.curSortType).name),Z=Ne([]),yt=Ne([]),je=o=>{if(!o.leaf){_e.value.setCurrentKey(null);return}let s=Wo;return o.weight<7&&(s=Zo),s(o.id).then(r=>{let{name:u,createBy:f,id:T,createTime:M,creator:R,type:P,pid:N,configuration:V,syncSetting:B,apiConfigurationStr:I,paramsStr:x,fileName:b,size:k,description:Q,lastSyncTime:ee,enableDataFill:q}=r.data;V&&(V=JSON.parse(J(V,U.value))),x&&(x=JSON.parse(J(x,U.value))),I&&(I=JSON.parse(J(I,U.value))),Object.assign(n,{name:u,pid:N,description:Q,fileName:b,size:k,createTime:M,creator:R,createBy:f,id:T,type:P,configuration:V,syncSetting:B,apiConfiguration:I,paramsConfiguration:x,weight:o.weight,lastSyncTime:ee,enableDataFill:q,extraFlag:o.extraFlag}),ne.value="",ge.value="config",ue.value="",Pe(1),xt(ge.value)})},We=o=>{se.value.init(null,o==null?void 0:o.id,null,ie.value)},Ze=C(!1),_e=C(),De=C([]),qe=C(!0);_o(pe,o=>{_e.value.filter(o)});const ba=()=>{qe.value=!1,Vt(()=>{qe.value=!0,Vt(()=>{var o;(o=ut.value)==null||o.setScrollTop(dt)})})},bt=C([]),Je=()=>{Ze.value=!0,Ho(X.paginationConfig.currentPage,X.paginationConfig.pageSize,n.id).then(o=>{bt.value=o.data.records,X.paginationConfig.total=o.data.total})},Ca=o=>{Ro({name:o.name,tableName:o.deTableName,datasourceId:n.id}).then(()=>{j.success(l("datasource.req_completed"))})},wa=()=>{Po({datasourceId:n.id}).then(()=>{j.success(l("datasource.req_completed"))})},Ta=o=>{o.id&&De.value.push(o.id)},xa=o=>{o.id&&De.value.splice(De.value.indexOf(o.id),1)},ka=(o,s)=>{var r;return o?(r=s.name)==null?void 0:r.toLowerCase().includes(o.toLowerCase()):!0},Ct=o=>(n.type.startsWith("Excel")&&(n.editType=o),Ot(n.id).then(s=>{var te;let r=W.value.filter(A=>A.type==s.data.type),{name:u,createBy:f,id:T,createTime:M,creator:R,type:P,pid:N,configuration:V,syncSetting:B,apiConfigurationStr:I,paramsStr:x,fileName:b,size:k,description:Q,lastSyncTime:ee,enableDataFill:q}=s.data;V&&(V=JSON.parse(J(V,U.value))),x&&(x=JSON.parse(J(x,U.value))),I&&(I=JSON.parse(J(I,U.value)));let $=oe(F(Y));Object.assign($,{name:u,pid:N,description:Q,fileName:b,size:k,createTime:M,creator:R,createBy:f,id:T,type:P,configuration:V,syncSetting:B,apiConfiguration:I,paramsConfiguration:x,lastSyncTime:ee,enableDataFill:q,isPlugin:r&&r.length>0,staticMap:(te=r[0])==null?void 0:te.staticMap}),se.value.init($,null,null,ie.value)})),Sa=async o=>{await je(o),Ct()},{handleDrop:Ea,allowDrop:Da,handleDragStart:Na}=xo(h,"datasourceTree",at,"datasource",me),La=async o=>{Ot(o.id).then(s=>{var te;let{name:r,createBy:u,id:f,createTime:T,creator:M,type:R,pid:P,configuration:N,syncSetting:V,apiConfigurationStr:B,paramsStr:I,fileName:x,size:b,description:k,lastSyncTime:Q,enableDataFill:ee}=s.data,q=W.value.filter(A=>A.type==s.data.type);N&&(N=JSON.parse(J(N,U.value))),I&&(I=JSON.parse(J(I,U.value))),B&&(B=JSON.parse(J(B,U.value)));let $=oe(F(Y));if(Object.assign($,{name:r,pid:P,description:k,fileName:x,size:b,createTime:T,creator:M,createBy:u,id:f,type:R,configuration:N,syncSetting:V,apiConfiguration:B,paramsConfiguration:I,lastSyncTime:Q,enableDataFill:ee,isPlugin:q&&q.length>0,staticMap:(te=q[0])==null?void 0:te.staticMap}),$.id="",$.copy=!0,$.name=l("datasource.copy"),$.type.startsWith("API"))for(let A=0;A<$.apiConfiguration.length;A++)$.apiConfiguration[A].deTableName="";se.value.init($,null,null,ie.value)})},wt=(o,s)=>{o==="datasource"&&We(s),o==="folder"&&Ue.value.createInit(o,s||{})},Tt=C(),Va=(o,s,r)=>{var u;if(o==="copy"){La(s);return}if(o==="delete"){let f={confirmButtonText:l("common.sure"),cancelButtonText:l("common.cancel"),confirmButtonType:"danger",type:"warning",tip:"",autofocus:!1,showClose:!1};(u=s.children)!=null&&u.length?f.tip=l("data_source.operate_with_caution"):delete f.tip,r!=="folder"?Bo(s.id).then(T=>{if(T===!0){const M=()=>{Tt.value.getChartData({queryType:"datasource",num:s.id,label:s.name})};Ke.confirm("",{confirmButtonType:"danger",type:"warning",autofocus:!1,confirmButtonText:l("common.sure"),showClose:!1,dangerouslyUseHTMLString:!0,message:be("div",null,[be("p",{style:"margin-bottom: 8px;"},l("datasource.this_data_source")),be("p",{class:"tip"},l("data_source.confirm_to_delete")),be(z,{text:!0,onClick:M,style:"margin-left: -4px;"},l("data_source.view_blood_relationship"))])}).then(()=>{ot(s.id).then(()=>{s.id===n.id&&Object.assign(n,F(Y)),re(),j.success(l("dataset.delete_success"))})})}else Ke.confirm(l("datasource.this_data_source"),f).then(()=>{ot(s.id).then(()=>{s.id===n.id&&Object.assign(n,F(Y)),re(),j.success(l("dataset.delete_success"))})})}):Ke.confirm(l("data_set.delete_this_folder"),f).then(()=>{ot(s.id).then(()=>{s.id===n.id&&Object.assign(n,F(Y)),re(),j.success(l("dataset.delete_success"))})})}else Ue.value.createInit(r,s,o)},xt=o=>{switch(o){case"config":Z.value=[],n.type.startsWith("Excel")&&Ut({datasourceId:n.id}).then(s=>{Ee.value=s.data.map(r=>{const{name:u,tableName:f}=r;return{value:u,label:f}}),Ee.value.length&&!ne.value&&(ne.value=Ee.value[0].value,ft(ne)),Z.value=s.data});break;case"table":Z.value=[],Ut({datasourceId:n.id}).then(s=>{Z.value=s.data,_t(),(n.type.startsWith("API")||n.type==="ExcelRemote")&&Fo({datasourceId:n.id}).then(r=>{for(let u=0;u<h.filterTable.length;u++)for(let f=0;f<r.data.length;f++)h.filterTable[u].tableName===r.data[f].tableName&&(h.filterTable[u].lastUpdateTime=r.data[f].lastUpdateTime,h.filterTable[u].status=r.data[f].status);for(let u=0;u<Z.value.length;u++)for(let f=0;f<r.data.length;f++)Z.value[u].tableName===r.data[f].tableName&&(Z.value[u].lastUpdateTime=r.data[f].lastUpdateTime,Z.value[u].status=r.data[f].status)})});break}},Ia=()=>{re()};let kt=null;const St=o=>{kt=o},Ye=C(!1),Ge=C(!1),Et=o=>{const s=new FormData;return s.append("file",kt.raw),s.append("type",""),s.append("editType",o),s.append("id",n.id||0),Ye.value=o===0,Ge.value=o===1,Oo(s).then(r=>{(r==null?void 0:r.code)===0&&(n.editType=o,se.value.init(n,n.id,r,ie.value))}).finally(()=>{Ye.value=!1,Ge.value=!1})},ge=C("table"),$a={children:"children",label:"name"},Ma=()=>{const o=K.get("TreeSort-datasource");o&&(h.curSortType=o)},za=el((o,s)=>{const u=["dashboard","dataV","dataset","datasource"].findIndex(f=>f==="datasource");return u<0||!qa(s,u+1)?Da(o,s):(j.warning(l("free.save_error")),!1)},300);go(()=>{var r,u;const o=K.get("ds-info-id")||D.params.id;n.id=o||D.query.id||"",K.delete("ds-info-id"),Ma(),re(),ya();const{opt:s}=((u=(r=we==null?void 0:we.currentRoute)==null?void 0:r.value)==null?void 0:u.query)||{};s&&s==="create"&&se.value.init(null,null,null,ie.value),Ja().then(f=>{U.value=f.data})});const ce=C(!0),Dt=o=>{ce.value=o},Ha=()=>{Te.setArrowSide(!0)},Ra=()=>{Te.setArrowSide(!1)},Pa=o=>o?[{label:l("common.copy"),svgName:yo,command:"copy"}].concat(it):it;return(o,s)=>{const r=al,u=Ya,f=co,T=uo,M=po,R=ro,P=io,N=no,V=so,B=oo,I=lo,x=Ka,b=ao,k=to,Q=Qa,ee=eo,q=Xa,$=Ga,te=Wa,A=vo("permission"),ve=ja;return H((i(),g("div",hl,[t(Bt,{style:Xe({left:(ce.value?e($e)-12:0)+"px"}),onChangeSideTreeStatus:Dt,isInside:!ce.value},null,8,["style","isInside"]),t(e(tl),{onMouseenter:Ha,onMouseleave:Ra,class:G(["resource-area",{retract:!ce.value}]),ref_key:"node",ref:Qt,style:Xe({width:e($e)+"px"})},{default:a(()=>[t(Bt,{isInside:!ce.value,style:Xe({left:(ce.value?e($e)-12:0)+"px"}),onChangeSideTreeStatus:Dt},null,8,["isInside","style"]),p("div",yl,[p("div",bl,[p("div",Cl,[p("span",wl,c(e(l)("datasource.datasource")),1),ze.value?(i(),g("div",Tl,[t(r,{effect:"dark",content:e(l)("deDataset.new_folder"),placement:"top"},{default:a(()=>[t(e(L),{class:"custom-icon btn",style:{marginRight:"20px"},onClick:s[0]||(s[0]=d=>wt("folder"))},{default:a(()=>[t(e(w),{name:"dv-new-folder"},{default:a(()=>[t(e(So),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"]),t(r,{effect:"dark",content:e(l)("datasource.create"),placement:"top"},{default:a(()=>[t(e(L),{class:"custom-icon btn",onClick:We},{default:a(()=>[t(e(w),{name:"icon_file-add_outlined"},{default:a(()=>[t(e(Eo),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"])])):m("",!0)]),t(u,{placeholder:e(l)("commons.search"),modelValue:pe.value,"onUpdate:modelValue":s[1]||(s[1]=d=>pe.value=d),clearable:"",class:"search-bar"},{prefix:a(()=>[t(e(L),null,{default:a(()=>[t(e(w),{name:"icon_search-outline_outlined"},{default:a(()=>[t(e(zt),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),t(M,{onCommand:oa,trigger:"click"},{dropdown:a(()=>[t(T,{style:{width:"246px"}},{default:a(()=>[(i(),g(E,null,Qe(Ae,d=>(i(),g(E,{key:d.value},[t(f,{class:G(["ed-select-dropdown__item",d.value===h.curSortType&&"selected"]),command:d.value},{default:a(()=>[_(c(d.name),1)]),_:2},1032,["class","command"]),d.divided?(i(),g("li",xl)):m("",!0)],64))),64))]),_:1})]),default:a(()=>[t(e(L),{class:"filter-icon-span"},{default:a(()=>[t(r,{offset:16,effect:"dark",content:ht.value,placement:"top"},{default:a(()=>[t(e(w),{name:"dv-sort-asc",class:"opt-icon"},{default:a(()=>[h.curSortType.includes("asc")?(i(),v(e(Do),{key:0,class:"svg-icon opt-icon"})):m("",!0)]),_:1})]),_:1},8,["content"]),t(r,{offset:16,effect:"dark",content:ht.value,placement:"top"},{default:a(()=>[t(e(w),{name:"dv-sort-desc",class:"opt-icon"},{default:a(()=>[h.curSortType.includes("desc")?(i(),v(e(No),{key:0,class:"svg-icon opt-icon"})):m("",!0)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})]),t(e(Nt),{onScroll:ia,ref_key:"scrollbarRef",ref:ut,class:"custom-tree"},{default:a(()=>[qe.value?(i(),v(R,{key:0,menu:"",ref_key:"dsListTree",ref:_e,"node-key":"id",onNodeExpand:Ta,onNodeCollapse:xa,"filter-node-method":ka,"default-expanded-keys":De.value,data:h.datasourceTree,props:$a,onNodeDragStart:e(Na),"allow-drop":e(za),onNodeDrop:e(Ea),draggable:"",onNodeClick:je},{default:a(({node:d,data:y})=>[p("span",kl,[t(e(L),{class:G(y.leaf&&"icon-border"),style:{"font-size":"18px"}},{default:a(()=>[t(e(w),{"static-content":fa(y)},{default:a(()=>[(i(),v(he(ga(y)),{class:"svg-icon"}))]),_:2},1032,["static-content"])]),_:2},1032,["class"]),y.extraFlag<=-1?(i(),v(e(L),{key:0,style:{position:"absolute",top:"10px",left:"10px","font-size":"12px"}},{default:a(()=>[t(e(w),null,{default:a(()=>[t(e(nl),{class:"svg-icon"})]),_:1})]),_:1})):m("",!0),y.extraFlag>-1?(i(),g("span",{key:1,title:d.label,class:G(["label-tooltip ellipsis",y.type==="Excel"&&"excel"])},c(d.label),11,Sl)):(i(),v(r,{key:2,effect:"dark",content:`${e(l)("data_set.invalid_data_source")}: ${d.label}`,placement:"top"},{default:a(()=>[p("span",{title:d.label,class:G(["label-tooltip ellipsis",y.type==="Excel"&&"excel"])},c(d.label),11,El)]),_:2},1032,["content"])),y.weight>=7?(i(),g("div",Dl,[y.leaf?y.type!=="Excel"?(i(),v(e(L),{key:1,class:"hover-icon",onClick:et(ae=>Sa(y),["stop"])},{default:a(()=>[t(e(w),{name:"icon_edit_outlined"},{default:a(()=>[t(e(tt),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])):m("",!0):(i(),v(e(Ft),{key:0,"icon-size":"24px",onHandleCommand:ae=>wt(ae,y),"menu-list":ta.value,"icon-name":e(Ht),placement:"bottom-start"},null,8,["onHandleCommand","menu-list","icon-name"])),t(e(Ft),{onHandleCommand:ae=>Va(ae,y,y.leaf?"datasource":"folder"),"menu-list":Pa(!["Excel"].includes(y.type)&&y.leaf)},null,8,["onHandleCommand","menu-list"])])):m("",!0)])]),_:1},8,["default-expanded-keys","data","onNodeDragStart","allow-drop","onNodeDrop"])):m("",!0)]),_:1},512)])]),_:1},8,["class","style"]),p("div",{class:G(["datasource-content",{auto:st.value||Ve.value,h100:Ve.value||st.value}])},[!h.datasourceTree.length&&Oe.value?(i(),v(lt,{key:0,description:e(l)("data_source.no_data_source"),"img-type":"none"},{default:a(()=>[ze.value?(i(),v(e(z),{key:0,onClick:s[2]||(s[2]=()=>We()),type:"primary"},{icon:a(()=>[t(e(w),{name:"icon_add_outlined"},{default:a(()=>[t(e(Ht),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("datasource.create")),1)]),_:1})):m("",!0)]),_:1},8,["description"])):n.id?(i(),g(E,{key:1},[p("div",Nl,[p("div",Ll,[t(e(L),{class:"icon-border"},{default:a(()=>[t(e(w),{"static-content":_a(n.type)},{default:a(()=>[(i(),v(he(e(qt)[n.type]),{class:"svg-icon"}))]),_:1},8,["static-content"])]),_:1}),p("span",{title:n.name,class:"name ellipsis"},c(n.name),9,Vl),t(P,{style:{margin:"0 12px"},direction:"vertical"}),p("span",Il,c(e(l)("visualization.create_by"))+":"+c(n.creator),1),t(N,{offset:8,"show-arrow":"",placement:"bottom",width:"290",trigger:"hover"},{reference:a(()=>[t(e(L),{size:"16px",class:"create-user"},{default:a(()=>[t(e(w),{name:"icon_info_outlined"},{default:a(()=>[t(e(Lo),{class:"svg-icon"})]),_:1})]),_:1})]),default:a(()=>[t(Jo,{"create-time":gt.value.createTime,creator:gt.value.creator},null,8,["create-time","creator"])]),_:1}),p("div",$l,[H((i(),v(e(z),{secondary:"",onClick:s[3]||(s[3]=d=>nt(null))},{icon:a(()=>[t(e(w),{name:"icon_dataset_outlined"},{default:a(()=>[t(e(Jt),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("data_set.a_new_dataset")),1)]),_:1})),[[A,["dataset"]]]),n.type!=="Excel"&&n.weight>=7?(i(),v(e(z),{key:0,secondary:"",onClick:da},{default:a(()=>[_(c(e(l)("datasource.validate")),1)]),_:1})):m("",!0),n.type==="Excel"?(i(),g(E,{key:1},[n.weight>=7?(i(),v(V,{key:0,action:"",multiple:!1,ref:"uploadAgain","show-file-list":!1,accept:".xls,.xlsx,.csv","on-change":St,"http-request":()=>Et(0),name:"file"},{trigger:a(()=>[H((i(),v(e(z),{class:"replace-excel",type:"primary"},{icon:a(()=>[t(e(w),{name:"icon_edit_outlined"},{default:a(()=>[t(e(tt),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("data_source.replace_data")),1)]),_:1})),[[ve,Ye.value]])]),_:1},8,["http-request"])):m("",!0),n.weight>=7?(i(),v(V,{key:1,action:"",multiple:!1,ref:"uploadAgain","show-file-list":!1,accept:".xls,.xlsx,.csv","on-change":St,"http-request":()=>Et(1),name:"file"},{trigger:a(()=>[H((i(),v(e(z),{type:"primary"},{icon:a(()=>[t(e(w),{name:"icon_new-item_outlined"},{default:a(()=>[t(e(ul),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("data_source.append_data")),1)]),_:1})),[[ve,Ge.value]])]),_:1},8,["http-request"])):m("",!0)],64)):n.weight>=7?(i(),v(e(z),{key:2,onClick:s[4]||(s[4]=d=>Ct()),type:"primary"},{icon:a(()=>[t(e(w),{name:"icon_edit_outlined"},{default:a(()=>[t(e(tt),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("chart.edit")),1)]),_:1})):m("",!0)])]),p("div",Ml,[t(I,{modelValue:ge.value,"onUpdate:modelValue":s[5]||(s[5]=d=>ge.value=d),onTabChange:xt},{default:a(()=>[t(B,{label:e(l)("datasource.config"),name:"config"},null,8,["label"]),t(B,{label:e(l)("datasource.table"),name:"table"},null,8,["label"])]),_:1},8,["modelValue"])])]),ge.value==="table"?(i(),g("div",zl,[p("div",Hl,[t(u,{ref:"search",modelValue:ue.value,"onUpdate:modelValue":s[6]||(s[6]=d=>ue.value=d),placeholder:e(l)("commons.search"),clearable:"",onInput:_t,style:{width:"240px"}},{prefix:a(()=>[t(e(L),null,{default:a(()=>[t(e(w),{name:"icon_search-outline_outlined"},{default:a(()=>[t(e(zt),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),p("div",Rl,[t(Pt,{pagination:h.paginationConfig,"table-data":va.value,"is-search":!!ue.value.trim(),onSizeChange:la,onCurrentChange:Pe},{default:a(()=>[t(x,{key:"tableName",prop:"tableName",label:e(l)("datasource.table_name")},null,8,["label"]),n.type.startsWith("API")?(i(),v(x,{key:"status",prop:"status",label:e(l)("data_source.latest_update_status")},{default:a(d=>[p("div",Pl,[d.row.status==="Completed"?(i(),g(E,{key:0},[t(e(L),{style:{"margin-right":"8px"}},{default:a(()=>[t(e(w),{name:"icon_succeed_filled"},{default:a(()=>[t(e(Gt),{class:"svg-icon"})]),_:1})]),_:1}),_(" "+c(e(l)("dataset.completed")),1)],64)):m("",!0),d.row.status==="UnderExecution"?(i(),g(E,{key:1},[_(c(e(l)("dataset.underway")),1)],64)):m("",!0),d.row.status==="Error"||d.row.status==="Warning"?(i(),g(E,{key:2},[t(e(L),{style:{"margin-right":"8px"}},{default:a(()=>[t(e(w),{class:"field-icon-red",name:"icon_close_filled"},{default:a(()=>[t(e(Kt),{class:"svg-icon field-icon-red"})]),_:1})]),_:1}),_(" "+c(e(l)("dataset.error")),1)],64)):m("",!0)])]),_:1},8,["label"])):m("",!0),["excel","api"].includes(n.type.toLowerCase())||n.type.startsWith("API")?(i(),v(x,{key:"lastUpdateTime",prop:"lastUpdateTime",label:e(l)("data_source.latest_update_time")},{default:a(d=>[p("span",null,c(e(Ce)(d.row.lastUpdateTime)),1)]),_:1},8,["label"])):m("",!0),t(x,{key:"__operation",label:e(l)("commons.operating"),fixed:"right",width:"108"},{default:a(d=>[t(r,{effect:"dark",content:e(l)("data_set.a_new_dataset"),placement:"top"},{default:a(()=>[H((i(),v(e(z),{onClick:et(y=>nt(d.row.tableName),["stop"]),text:""},{icon:a(()=>[t(e(w),{name:"icon_dataset_outlined"},{default:a(()=>[t(e(Jt),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])),[[A,["dataset"]]])]),_:2},1032,["content"]),t(r,{effect:"dark",content:e(l)("visualization.details"),placement:"top"},{default:a(()=>[t(e(z),{onClick:et(y=>aa(d.row),["stop"]),text:""},{icon:a(()=>[t(e(w),{name:"icon_describe_outlined"},{default:a(()=>[t(e(Yt),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["pagination","table-data","is-search"])])])):(i(),g(E,{key:1},[t(Le,{name:e(l)("datasource.base_info")},{default:a(d=>[d.active?(i(),g(E,{key:0},[t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("data_source.data_source_name")},{default:a(()=>[_(c(n.name),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.type")},{default:a(()=>[_(c(e(rt)[n.type]),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(k,{gutter:24},{default:a(()=>[n.type==="Excel"?(i(),v(b,{key:0,span:12},{default:a(()=>[t(S,{label:e(l)("data_source.document")},{default:a(()=>[t(jt,{name:n.fileName,size:n.size},null,8,["name","size"])]),_:1},8,["label"])]),_:1})):m("",!0),n.type==="ExcelRemote"?(i(),v(b,{key:1,span:12},{default:a(()=>[t(S,{label:e(l)("datasource.remote_excel_url")},{default:a(()=>[_(c(n.configuration.url),1)]),_:1},8,["label"])]),_:1})):m("",!0),n.type==="ExcelRemote"?(i(),v(b,{key:2,span:12},{default:a(()=>[t(S,{label:e(l)("data_source.document")},{default:a(()=>[t(jt,{name:n.fileName,size:n.size},null,8,["name","size"])]),_:1},8,["label"])]),_:1})):m("",!0),n.type.startsWith("Excel")?m("",!0):(i(),v(b,{key:3,span:24},{default:a(()=>[t(S,{label:e(l)("common.description")},{default:a(()=>[_(c(n.description),1)]),_:1},8,["label"])]),_:1}))]),_:1}),!["Excel","es"].includes(n.type)&&!n.type.startsWith("API")&&!n.type.startsWith("Excel")&&n.weight>=7?(i(),g(E,{key:0},[H(t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.host")},{default:a(()=>[_(c(n.configuration.host),1)]),_:1},8,["label"])]),_:1})]),_:1},512),[[ye,n.configuration.urlType!=="jdbcUrl"]]),H(t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.port")},{default:a(()=>[_(c(n.configuration.port),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.data_base")},{default:a(()=>[_(c(n.configuration.dataBase),1)]),_:1},8,["label"])]),_:1})]),_:1},512),[[ye,n.configuration.urlType!=="jdbcUrl"]]),H(t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.user_name")},{default:a(()=>[_(c(n.configuration.username),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.extra_params")},{default:a(()=>[_(c(n.configuration.extraParams),1)]),_:1},8,["label"])]),_:1})]),_:1},512),[[ye,n.configuration.urlType!=="jdbcUrl"]]),H(t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.jdbcUrl")},{default:a(()=>[_(c(n.configuration.jdbcUrl),1)]),_:1},8,["label"])]),_:1})]),_:1},512),[[ye,n.configuration.urlType==="jdbcUrl"]]),H(t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.user_name")},{default:a(()=>[_(c(n.configuration.username),1)]),_:1},8,["label"])]),_:1})]),_:1},512),[[ye,n.configuration.urlType==="jdbcUrl"]]),t(k,{gutter:24},{default:a(()=>[!["es","api"].includes(n.type.toLowerCase())&&n.configuration.urlType!=="jdbcUrl"?(i(),g("span",{key:0,class:"de-expand",onClick:s[7]||(s[7]=y=>ke.value=!ke.value)},[_(c(e(l)("data_source.ssh_settings"))+" ",1),t(e(L),null,{default:a(()=>[t(e(w),null,{default:a(()=>[(i(),v(he(ke.value?e($t):e(It))))]),_:1})]),_:1})])):m("",!0)]),_:1}),ke.value?(i(),g(E,{key:0},[n.configuration.useSSH?(i(),v(k,{key:0,gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("data_source.host")},{default:a(()=>[_(c(n.configuration.sshHost),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("data_source.port")},{default:a(()=>[_(c(n.configuration.sshPort),1)]),_:1},8,["label"])]),_:1})]),_:1})):m("",!0),n.configuration.useSSH?(i(),v(k,{key:1,gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.user_name")},{default:a(()=>[_(c(n.configuration.sshUserName),1)]),_:1},8,["label"])]),_:1})]),_:1})):m("",!0)],64)):m("",!0),t(k,{gutter:24},{default:a(()=>[["es","api"].includes(n.type.toLowerCase())?m("",!0):(i(),g("span",{key:0,class:"de-expand",onClick:s[8]||(s[8]=y=>xe.value=!xe.value)},[_(c(e(l)("datasource.priority"))+" ",1),t(e(L),null,{default:a(()=>[t(e(w),null,{default:a(()=>[(i(),v(he(xe.value?e($t):e(It))))]),_:1})]),_:1})]))]),_:1}),xe.value?(i(),g(E,{key:1},[t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.initial_pool_size")},{default:a(()=>[_(c(n.configuration.initialPoolSize||5),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.min_pool_size")},{default:a(()=>[_(c(n.configuration.minPoolSize||5),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.max_pool_size")},{default:a(()=>[_(c(n.configuration.maxPoolSize||5),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{value:n.configuration.queryTimeout,label:e(l)("datasource.query_timeout")},{default:a(()=>[_(c(n.configuration.queryTimeout||"30")+c(e(l)("common.second")),1)]),_:1},8,["value","label"])]),_:1})]),_:1})],64)):m("",!0),t(e(Lt),{nodeInfo:n,jsname:"L2NvbXBvbmVudC9kYXRhLWZpbGxpbmcvRGF0YXNvdXJjZURhdGFGaWxsaW5nSW5mbw=="},null,8,["nodeInfo"])],64)):m("",!0),["es"].includes(n.type)&&n.weight>=7?(i(),v(k,{key:1,gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("datasource.datasource_url")},{default:a(()=>[_(c(n.configuration.url),1)]),_:1},8,["label"])]),_:1})]),_:1})):m("",!0)],64)):m("",!0)]),_:1},8,["name"]),n.type.startsWith("API")&&n.weight>=7?(i(),v(Le,{key:0,name:e(l)("datasource.data_table")},{default:a(d=>[d.active?(i(),g("div",Bl,[(i(!0),g(E,null,Qe(n.apiConfiguration,y=>(i(),g("div",{key:y.id,class:"api-card"},[t(k,null,{default:a(()=>[t(b,{span:19},{default:a(()=>[p("span",Fl,[p("span",{class:"ellipsis",title:y.name},c(y.name),9,Ol)]),y.status==="Error"?(i(),g("span",Ul,c(e(l)("datasource.invalid")),1)):m("",!0),y.status==="Success"?(i(),g("span",Al,c(e(l)("datasource.valid")),1)):m("",!0)]),_:2},1024),t(b,{style:{"text-align":"right"},span:5},{default:a(()=>[t(e(z),{onClick:ae=>Ca(y),text:""},{icon:a(()=>[t(e(w),{name:"icon_replace_outlined"},{default:a(()=>[t(e(Rt),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024),p("div",null,c(e(l)("data_source.data_time"))+" "+c(e(Ce)(y.updateTime)),1),p("div",jl,[p("span",null,c(e(l)("datasource.method")),1),p("span",null,c(e(l)("datasource.url")),1)]),p("div",Wl,[p("span",null,c(y.method),1),t(r,{effect:"dark",content:y.url,placement:"top"},{default:a(()=>[p("span",null,c(y.url),1)]),_:2},1032,["content"])])]))),128))])):m("",!0),t(e(z),{onClick:wa,class:"update-records",text:""},{icon:a(()=>[t(e(w),{name:"icon_replace_outlined"},{default:a(()=>[t(e(Rt),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("data_source.update_all")),1)]),_:1})]),_:1},8,["name"])):m("",!0),n.type.startsWith("Excel")?(i(),v(Le,{key:1,name:e(l)("dataset.data_preview"),time:n.lastSyncTime,showTime:n.type==="ExcelRemote"},{default:a(d=>[d.active?(i(),g("div",Zl,[t(Ko,{"active-tab":ne.value,onTabClick:ft,"tab-list":Ee.value},null,8,["active-tab","tab-list"]),p("div",ql,[t(ee,null,{default:a(({height:y,width:ae})=>[H((i(),v(Q,{columns:pt.value,"header-class":"excel-header-cell",data:yt.value,width:ae,height:y,fixed:""},{empty:a(()=>[t(lt,{description:e(l)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),_:1},8,["columns","data","width","height"])),[[ve,Be.value]])]),_:1})])])):m("",!0)]),_:1},8,["name","time","showTime"])):m("",!0),(n.type.startsWith("API")||n.type==="ExcelRemote")&&n.weight>=7?(i(),v(Le,{key:2,name:e(l)("dataset.update_setting"),time:n.lastSyncTime},{default:a(d=>[d.active?(i(),v(k,{key:0,gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("dataset.update_type")},{default:a(()=>[_(c(e(l)(`dataset.${n.syncSetting.updateType}`)),1)]),_:1},8,["label"])]),_:1}),t(b,{span:12},{default:a(()=>[t(S,{label:e(l)("dataset.execute_rate")},{default:a(()=>[(i(!0),g(E,null,Qe(ua(n.syncSetting),y=>(i(),g("p",{class:"value",key:y},c(y),1))),128))]),_:1},8,["label"])]),_:1})]),_:1})):m("",!0),t(e(z),{onClick:Je,class:"update-records",text:""},{icon:a(()=>[t(e(w),{name:"icon_describe_outlined"},{default:a(()=>[t(e(Yt),{class:"svg-icon"})]),_:1})]),default:a(()=>[_(" "+c(e(l)("dataset.update_records")),1)]),_:1})]),_:1},8,["name","time"])):m("",!0)],64))],64)):Oe.value?(i(),v(lt,{key:2,description:e(l)("data_source.on_the_left"),"img-type":"select"},null,8,["description"])):m("",!0)],2),t(Go,{onRefresh:Ia,ref_key:"datasourceEditor",ref:se},null,512),t($,{title:e(l)("common.detail"),modelValue:He.value,"onUpdate:modelValue":s[9]||(s[9]=d=>He.value=d),class:"ds-table-drawer",width:"840px",top:"60px"},{default:a(()=>[t(k,{gutter:24},{default:a(()=>[t(b,{span:12},{default:a(()=>[p("p",Jl,c(e(l)("datasource.table_name")),1),p("p",Yl,c(Me.tableName),1)]),_:1}),t(b,{span:12},{default:a(()=>[p("p",Gl,c(e(l)("datasource.table_description")),1),p("p",Kl,c(Me.name||"-"),1)]),_:1})]),_:1}),t(e(Nt),null,{default:a(()=>[H((i(),v(q,{"header-cell-class-name":"header-cell",data:h.dsTableData,stripe:"",style:{width:"100%"}},{default:a(()=>[t(x,{prop:"originName",label:e(l)("datasource.column_name")},null,8,["label"]),t(x,{prop:"type",label:e(l)("datasource.field_type")},{default:a(d=>[p("div",Xl,[t(e(L),null,{default:a(()=>[t(e(w),{class:G(`field-icon-${e(le)[d.row.deType]}`)},{default:a(()=>[(i(),v(he(e(Zt)[e(le)[d.row.deType]]),{class:G(["svg-icon",`field-icon-${e(le)[d.row.deType]}`])},null,8,["class"]))]),_:2},1032,["class"])]),_:2},1024),_(" "+c(e(l)(`dataset.${e(le)[d.row.deType]}`)+`${d.row.deType===3?"("+e(l)("dataset.float")+")":""}`),1)])]),_:1},8,["label"]),t(x,{prop:"name","show-overflow-tooltip":"",label:e(l)("datasource.field_description")},null,8,["label"])]),_:1},8,["data"])),[[ve,Re.value]])]),_:1})]),_:1},8,["title","modelValue"]),t(qo,{onFinish:ha,ref_key:"creatDsFolder",ref:Ue},null,512),t(te,{modelValue:Ze.value,"onUpdate:modelValue":s[10]||(s[10]=d=>Ze.value=d),title:e(l)("dataset.update_records"),"close-on-press-escape":!1,"close-on-click-modal":!1,"modal-class":"record-drawer",direction:"rtl",size:"840px"},{default:a(()=>[t(Pt,{pagination:X.paginationConfig,"table-data":bt.value,onSizeChange:sa,onCurrentChange:na},{default:a(()=>[t(x,{prop:"name",label:e(l)("datasource.data_table")},null,8,["label"]),t(x,{prop:"triggerType",label:e(l)("datasource.sync_rate")},{default:a(d=>[p("div",Ql,[d.row.triggerType==="CRON"?(i(),g(E,{key:0},[_(c(e(l)("datasource.cron_config")),1)],64)):m("",!0),d.row.triggerType==="RIGHTNOW"?(i(),g(E,{key:1},[_(c(e(l)("datasource.execute_once")),1)],64)):m("",!0),d.row.triggerType==="SIMPLE_CRON"?(i(),g(E,{key:2},[_(c(e(l)("datasource.simple_cron")),1)],64)):m("",!0),d.row.triggerType==="MANUAL"?(i(),g(E,{key:3},[_(c(e(l)("datasource.manual")),1)],64)):m("",!0)])]),_:1},8,["label"]),t(x,{prop:"startTime",label:e(l)("datasource.start_time")},{default:a(d=>[p("span",null,c(e(Ce)(d.row.startTime)),1)]),_:1},8,["label"]),t(x,{prop:"endTime",label:e(l)("datasource.end_time")},{default:a(d=>[p("span",null,c(e(Ce)(d.row.endTime)),1)]),_:1},8,["label"]),t(x,{prop:"taskStatus",label:e(l)("data_source.update_result")},{default:a(d=>[p("div",es,[d.row.taskStatus==="Completed"?(i(),g(E,{key:0},[t(e(L),{style:{"margin-right":"8px"}},{default:a(()=>[t(e(w),{name:"icon_succeed_filled"},{default:a(()=>[t(e(Gt),{class:"svg-icon"})]),_:1})]),_:1}),_(" "+c(e(l)("dataset.completed")),1)],64)):m("",!0),d.row.taskStatus==="UnderExecution"?(i(),g(E,{key:1},[_(c(e(l)("dataset.underway")),1)],64)):m("",!0),d.row.taskStatus==="Error"||d.row.taskStatus==="Warning"?(i(),g(E,{key:2},[t(e(L),{style:{"margin-right":"8px"}},{default:a(()=>[t(e(w),{class:"field-icon-red",name:"icon_close_filled"},{default:a(()=>[t(e(Kt),{class:"svg-icon field-icon-red"})]),_:1})]),_:1}),_(" "+c(e(l)("dataset.error"))+" ",1),t(e(L),{onClick:y=>pa(d.row.info),class:"error-info"},{default:a(()=>[t(e(w),{name:"icon-maybe_outlined"},{default:a(()=>[t(e(Vo),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])],64)):m("",!0)])]),_:1},8,["label"])]),_:1},8,["pagination","table-data"])]),_:1},8,["modelValue","title"]),t($,{modelValue:Se.value,"onUpdate:modelValue":s[12]||(s[12]=d=>Se.value=d),"close-on-press-escape":!1,"close-on-click-modal":!1,title:e(l)("data_source.failure_details"),width:"600px"},{footer:a(()=>[p("span",ts,[t(e(z),{secondary:"",onClick:s[11]||(s[11]=d=>Se.value=!1)},{default:a(()=>[_(c(e(l)("chart.close")),1)]),_:1})])]),default:a(()=>[p("span",null,c(mt.value),1)]),_:1},8,["modelValue","title"]),t(To,{ref_key:"relationChartRef",ref:Tt},null,512),t(e(Lt),{jsname:"L2NvbXBvbmVudC9wbHVnaW5zLWhhbmRsZXIvRHNDYXRlZ29yeUhhbmRsZXI=",onLoadDsPlugin:ma})])),[[ve,Fe.value]])}}});const Ri=ol(os,[["__scopeId","data-v-cb0b5c48"]]);export{Ri as default};
