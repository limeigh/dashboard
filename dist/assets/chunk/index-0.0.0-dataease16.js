import{e as T,s as dl,E as G,b as ml,o as cl,g as ul,p as pl,A as fl,y as vl,f as hl,i as gl,z as yl,w as xl,r as Cl,P as kl,B as _l,Q as bl,a7 as wl,R as El,S as Sl,l as Al,n as Fl,x as Il,M as Tl,v as ql,G as Nl,H as Dl,I as Ol}from"./element-plus-secondary-0.0.0-dataease.js";import{d as Vl,r as z,k as L,t as Ml,a7 as Bl,e as zl,b as Pl,l as Ia,w as Ge,ae as vt,o as u,c as F,a as p,u as o,T as x,U as n,W as i,S as ce,R as h,$ as ht,z as g,Y as C,Z as Ke,V as Le,a8 as Je,_ as O,X as j,ai as $l,a6 as Rl,n as Ne,q as gt}from"./@vue-0.0.0-dataease.js";import{d as Ql}from"./dv-info-0.0.0-dataease.js";import{i as Ll}from"./icon_down_outlined-1-0.0.0-dataease.js";import{i as K}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as yt}from"./icon_info_outlined-0.0.0-dataease.js";import{i as Ta}from"./icon-filter-0.0.0-dataease.js";import{i as Jl}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as Ul}from"./icon_refresh_outlined-0.0.0-dataease.js";import{i as jl}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as qa}from"./icon_copy_outlined-0.0.0-dataease.js";import{e as I,i as Hl,f as Wl}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{useAppStoreWithOut as Yl}from"./app-0.0.0-dataease.js";import{a as Xl,e as Gl,u as te,g as xt}from"./index-0.0.0-dataease.js";import{d as ne}from"./vuedraggable-0.0.0-dataease.js";import Ce from"./DimensionItem-0.0.0-dataease.js";import{f as ke}from"./attr-0.0.0-dataease23.js";import Ue from"./QuotaItem-0.0.0-dataease.js";import se from"./DragPlaceholder-0.0.0-dataease.js";import{_ as Kl}from"./FilterTree.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import Na from"./ChartStyle-0.0.0-dataease.js";import Da from"./VQueryChartStyle-0.0.0-dataease.js";import Zl from"./Senior-0.0.0-dataease.js";import ei from"./QuotaFilterEditor-0.0.0-dataease.js";import ti from"./ResultFilterEditor-0.0.0-dataease.js";import ai from"./DrillItem-0.0.0-dataease.js";import{d as oi}from"./dvMain-0.0.0-dataease.js";import{s as li}from"./pinia-0.0.0-dataease.js";import{B as ii,n as Oa,ag as ni,ah as si}from"./chart-0.0.0-dataease.js";import ri from"./ChartType-0.0.0-dataease.js";import{b as di,u as mi}from"./vue-router_2-0.0.0-dataease.js";import ci from"./CompareEdit-0.0.0-dataease.js";import ui from"./ValueFormatterEdit-0.0.0-dataease.js";import pi from"./CustomSortEdit-0.0.0-dataease.js";import fi from"./SortPriorityEdit-0.0.0-dataease.js";import{s as vi}from"./snapshot-0.0.0-dataease.js";import hi from"./CalcFieldEdit-0.0.0-dataease.js";import{g as gi,b as yi}from"./util-0.0.0-dataease.js";import{D as Va,E as xi}from"./dataset-0.0.0-dataease.js";import{c as Ma}from"./index-0.0.0-dataease12.js";import Ci from"./DatasetSelect-0.0.0-dataease.js";import{q as ki}from"./@vueuse-0.0.0-dataease.js";import{_ as Ze}from"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{g as _i,c as bi,d as wi}from"./chart-0.0.0-dataease2.js";import Ei from"./ChartTemplateInfo-0.0.0-dataease.js";import{a as Si}from"./chart-list-0.0.0-dataease.js";import{i as Ct}from"./field-list-0.0.0-dataease.js";import{i as Ai,a as Fi}from"./field-calculated-list-0.0.0-dataease.js";import{d as Ii}from"./canvasUtils-0.0.0-dataease.js";import{N as Ti,d as Ba,H as qi,g as et,s as tt,h as qe,A as za}from"./lodash-es-0.0.0-dataease.js";import{_ as Ni}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./icon_sort_outlined-0.0.0-dataease.js";import"./icon_right_outlined-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./icon_invisible_outlined-0.0.0-dataease.js";import"./utils-0.0.0-dataease.js";import"./RowAuth-0.0.0-dataease.js";import"./AuthTree-0.0.0-dataease.js";import"./FilterFiled-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./TimeDialog-0.0.0-dataease.js";import"./time-format-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";import"./MiscSelector-0.0.0-dataease.js";import"./LabelSelector-0.0.0-dataease.js";import"./StringUtils-0.0.0-dataease.js";import"./TooltipSelector-0.0.0-dataease.js";import"./XAxisSelector-0.0.0-dataease.js";import"./YAxisSelector-0.0.0-dataease.js";import"./DualYAxisSelector-0.0.0-dataease.js";import"./DualYAxisSelectorInner-0.0.0-dataease.js";import"./TitleSelector-0.0.0-dataease.js";import"./icon_letter-spacing_outlined-0.0.0-dataease.js";import"./icon_italic_outlined-0.0.0-dataease.js";import"./icon_right-alignment_outlined-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./LegendSelector-0.0.0-dataease.js";import"./icon_bottom-align_outlined-0.0.0-dataease.js";import"./SummarySelector-0.0.0-dataease.js";import"./CollapseSwitchItem-0.0.0-dataease.js";import"./BasicStyleSelector-0.0.0-dataease.js";import"./CustomColorStyleSelect-0.0.0-dataease.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./GradientColorSelector-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./SymbolicStyleSelector-0.0.0-dataease.js";import"./DualBasicStyleSelector-0.0.0-dataease.js";import"./CommonBorderSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./style-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";import"./BackgroundOverallCommon-0.0.0-dataease.js";import"./board-list-0.0.0-dataease.js";import"./ImgViewDialog-0.0.0-dataease.js";import"./TableHeaderSelector-0.0.0-dataease.js";import"./TableHeaderGroupConfig-0.0.0-dataease.js";import"./vue-uuid-0.0.0-dataease.js";import"./uuid-0.0.0-dataease.js";import"./TableCellSelector-0.0.0-dataease.js";import"./TableTotalSelector-0.0.0-dataease.js";import"./CustomAggrEdit-0.0.0-dataease.js";import"./icon_adjustment_outlined-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease2.js";import"./@codemirror-0.0.0-dataease.js";import"./@lezer-0.0.0-dataease.js";import"./style-mod-0.0.0-dataease.js";import"./crelt-0.0.0-dataease.js";import"./@marijn-0.0.0-dataease.js";import"./w3c-keyname-0.0.0-dataease.js";import"./codemirror-0.0.0-dataease.js";import"./MiscStyleSelector-0.0.0-dataease.js";import"./IndicatorValueSelector-0.0.0-dataease.js";import"./IndicatorNameSelector-0.0.0-dataease.js";import"./QuadrantSelector-0.0.0-dataease.js";import"./FlowMapLineSelector-0.0.0-dataease.js";import"./FlowMapPointSelector-0.0.0-dataease.js";import"./BulletTargetSelector.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./BulletMeasureSelector.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./BulletRangeSelector.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./FunctionCfg-0.0.0-dataease.js";import"./ScrollCfg-0.0.0-dataease.js";import"./AssistLine-0.0.0-dataease.js";import"./AssistLineEdit-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./Threshold-0.0.0-dataease.js";import"./TableThresholdEdit-0.0.0-dataease.js";import"./icon_info_filled-0.0.0-dataease.js";import"./TextLabelThresholdEdit-0.0.0-dataease.js";import"./TextThresholdEdit-0.0.0-dataease.js";import"./LineThresholdEdit-0.0.0-dataease.js";import"./PictureGroupThresholdEdit-0.0.0-dataease.js";import"./MapMapping-0.0.0-dataease.js";import"./LinkageSet-0.0.0-dataease.js";import"./dv-link-target-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./dv-screen-spine-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./treeSortUtils-0.0.0-dataease.js";import"./dv-empty-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./BubbleAnimateCfg-0.0.0-dataease.js";import"./CarouselSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./vant-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";import"./chart-dark-list-0.0.0-dataease.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./icon_dataset-0.0.0-dataease.js";import"./ModelUtil-0.0.0-dataease.js";const Di={key:0,class:"collapse-title"},Oi={style:{"font-size":"14px"}},Vi={key:1,style:{width:"240px"},class:"view-panel-row"},Mi={style:{display:"flex","align-items":"center",width:"calc(100% - 24px)"}},Bi={style:{"margin-bottom":"4px","font-size":"14px",color:"#646a73"}},zi={style:{"font-size":"14px",color:"#1f2329"}},Pi={class:"query-style-tab"},$i={style:{"padding-top":"1px"}},Ri={class:"data-area-label"},Qi={class:"data-area-label"},Li={class:"area-tree-select"},Ji={class:"form-draggable-title"},Ui={key:0,class:"required"},ji={class:"form-draggable-title"},Hi={key:0,class:"required"},Wi={class:"form-draggable-title"},Yi={key:0,class:"required"},Xi={class:"form-draggable-title"},Gi={key:0,class:"required"},Ki={class:"form-draggable-title"},Zi={key:0,class:"required"},en={class:"form-draggable-title"},tn={key:0,class:"required"},an={class:"form-draggable-title"},on={class:"data-area-label"},ln={style:{"margin-right":"4px"}},nn={key:0,class:"required"},sn={class:"form-draggable-title"},rn={key:0,class:"required"},dn={class:"form-draggable-title"},mn={key:0,class:"required"},cn={class:"form-draggable-title"},un={key:0,class:"required"},pn={class:"form-draggable-title"},fn={key:0,class:"required"},vn={class:"form-draggable-title"},hn={class:"data-area-label"},gn={style:{"margin-right":"4px"}},yn={key:0,class:"required"},xn={class:"form-draggable-title"},Cn={class:"data-area-label"},kn={style:{"margin-right":"4px"}},_n={class:"form-draggable-title"},bn={class:"result-style-input"},wn={key:0},En={key:1,style:{"padding-left":"8px"}},Sn={style:{"font-size":"12px"}},An={key:0,class:"collapse-title"},Fn={style:{"font-size":"14px"}},In={style:{"font-size":"14px"}},Tn=["onClick","onDragstart"],qn=["title"];const Nn=["onClick","onDragstart"],Dn=["title"];const On={class:"text"},Vn={class:"dialog-footer"},Mn={class:"dialog-footer"},Bn={class:"dialog-footer"},zn={class:"dialog-footer"},Pn={class:"dialog-footer"},$n={class:"dialog-footer"},Rn={style:{"font-size":"15px","font-weight":"bold",color:"#1f2329"}},Qn={style:{color:"#1f2329"}},Ln={class:"dialog-footer"},Jn=["effect"],Un=Vl({__name:"index",props:{view:{type:Object,required:!1,default(){return{...ii}}},datasetTree:{type:Array,default:()=>[]},themes:{type:String,default:"dark"}},setup(f){const{wsCache:at}=Xl("localStorage"),ot=Gl(),_e=vi(),Pa=oi(),{canvasCollapse:re,curComponent:q,componentData:$a,editMode:kt,mobileInPc:be,fullscreenFlag:Ra,dvInfo:je}=li(Pa),_t=di();let He=z(!1),H=z({id:null,name:null}),bt=z(null);const{t:v}=Wl(),Qa=z(!1),wt=z("data"),We=z(null),Et=z(0),St=z(),{emitter:J}=te({name:"set-table-column-width",callback:e=>Oo(e)});te({name:"set-page-size",callback:e=>Vo(e)});const $=f,De=z(!1),lt=z(!0),Oe=z(),La=mi(),Ja=()=>{_e.recordSnapshotCache("onComponentNameChange")},Ua=()=>{if(He.value=!1,q.value.id===H.value.id&&!(!H.value.name||!H.value.name.trim())&&H.value.name.trim()!==a.value.title){if(H.value.name.trim().length>64||H.value.name.trim().length<2){G.warning("名称字段长度2-64个字符"),At();return}a.value.title=H.value.name,a.value.type==="VQuery"&&(a.value.customStyle.component.title=H.value.name),q.value&&(q.value.label=H.value.name,q.value.name=H.value.name),H.value.name="",H.value.id=""}},At=()=>{He.value=!0,H.value.name=a.value.title,H.value.id=a.value.id,Ne(()=>{bt.value.focus()})},R=L(()=>$.themes||"dark"),Ft=L(()=>a.value.dataFrom==="template"&&a.value.type!=="picture-group"&&!be.value),{view:a}=Ml($);let Ve="";const ja=e=>{e&&e.forEach(t=>Y(t))};Bl(()=>{Ve=La.query.id}),zl(()=>{Ve=""}),Pl(()=>{te({name:"clear-remove",callback:ja})});const Ye=Yl(),Ha=L(()=>Ye.getIsDataEaseBi||Ye.getIsIframe),Wa=Ia({chartShowName:[{required:!0,message:v("commons.input_content"),trigger:"change"},{max:200,message:v("commons.char_count_limit",{count:200}),trigger:"change"}]}),l=Ia({extData:"",moveId:-1,dimension:[],quota:[],dimensionData:[],quotaData:[],renameItem:!1,itemForm:{name:"",chartShowName:"",index:0,renameType:""},quotaFilterEdit:!1,quotaItem:{},resultFilterEdit:!1,filterItem:{},chartForFilter:{},searchField:"",quotaItemCompare:{},showEditQuotaCompare:!1,showValueFormatter:!1,valueFormatterItem:{},showCustomSort:!1,showSortPriority:!1,sortPriority:[],customSortList:[],customSortField:{},currEditField:{},worldTree:[],areaId:"",chartTypeOptions:[],useless:null}),Ya=L(()=>[...l.dimension,...l.quota].filter(e=>e.id!=="count"&&!!e.summary));gt("filedList",()=>Ya.value),gt("quota",()=>l.quota),Ge([()=>a.value.tableId],()=>{Ne(()=>{var s;if($.view.type==="picture-group")return;Se($.view.tableId,$.view.id,$.view.type);const e=a.value.tableId;e&&(Ve=e);const t=(s=We==null?void 0:We.value)==null?void 0:s.getNode(e);t!=null&&t.data&&(Et.value=t.data.weight)})},{deep:!0,immediate:!0});const Se=(e,t,s)=>{e&&t?(ye.value=!0,_i(e,t,{type:s}).then(c=>{l.dimension=c.dimensionList||[],l.quota=c.quotaList||[],l.dimensionData=JSON.parse(JSON.stringify(l.dimension)),l.quotaData=JSON.parse(JSON.stringify(l.quota)),ye.value=!1,J.emit("dataset-change")}).catch(()=>{l.dimension=[],l.quota=[],l.dimensionData=[],l.quotaData=[],ye.value=!1})):(l.dimension=[],l.quota=[],l.dimensionData=[],l.quotaData=[],ye.value=!1)},It=L(()=>!["richText","Picture"].includes(a.value.type)&&q.value&&q.value.component==="UserView"),w=L(()=>Ma.getChartView(a.value.render,a.value.type)),Z=e=>{var t,s;return(s=(t=w.value)==null?void 0:t.axis)==null?void 0:s.includes(e)},it=z(),Tt=z([]);Ge(()=>[a.value.type,a.value],e=>{var t,s,c,y,b,E;Z("area")&&((t=l.worldTree)!=null&&t.length?l.areaId=(y=(c=(s=a.value)==null?void 0:s.customAttr)==null?void 0:c.map)==null?void 0:y.id:ni().then(async k=>{var S,A,ge;const P=(await si()).data,Q={id:"customRoot",name:"自定义区域",disabled:!0};P.length&&(Q.children=P),l.worldTree.splice(0,l.worldTree.length,k.data,Q),l.areaId=(ge=(A=(S=a.value)==null?void 0:S.customAttr)==null?void 0:A.map)==null?void 0:ge.id}),(b=it.value)==null||b.blur(),Tt.value.splice(0),(E=it.value)==null||E.setCurrentKey(l.areaId)),l.chartTypeOptions.splice(0,l.chartTypeOptions.length,Oa(e[0])),l.useless=e[0]},{immediate:!0,deep:!1});const Xa={label:"name",children:"children",disabled:"disabled"},N=e=>{a.value.dataFrom="calc",_e.recordSnapshotCache(e,a.value.id)},Ga=()=>{a.value.calParams=[],N("calcData")},Ka=(e,t)=>{var s;return e?(s=t.name)==null?void 0:s.includes(e):!0},Me=L(()=>Ti(l.quotaData,l.dimensionData)),Za=L(()=>{let e=[];return $a.value.forEach(t=>{t.innerType==="VQuery"&&e.push(t),t.innerType==="DeTabs"&&t.propValue.forEach(s=>{e=[...s.componentData.filter(c=>c.innerType==="VQuery"),...e]})}),e}),nt=L(()=>{var t;let e=JSON.parse(JSON.stringify(l.quota));return((t=a.value)==null?void 0:t.type)==="table-info"&&(e=e==null?void 0:e.filter(s=>s.id!=="-1")),l.searchField&&(e=e.filter(s=>s.name.toLowerCase().includes(l.searchField.toLowerCase()))),e}),st=L(()=>{let e=JSON.parse(JSON.stringify(l.dimensionData));return l.searchField&&(e=e.filter(t=>t.name.toLowerCase().includes(l.searchField.toLowerCase()))),e}),eo=L(()=>{var t;let e=JSON.parse(JSON.stringify(l.quota));return((t=a.value)==null?void 0:t.type)==="table-info"&&(e=e==null?void 0:e.filter(s=>s.id!=="-1")),e});gt("quotaData",eo);const to=(e,t)=>{e.dataTransfer.setData("dimension",JSON.stringify(t.filter(s=>s.id).map(s=>({...qe(o(s)),datasetId:a.value.tableId}))))},ue=e=>{var t,s;N("calcData"),a.value.type==="bar-range"&&(e.axisType==="quota"?(t=a.value.yAxisExt)==null||t.forEach(c=>{c.dateStyle=e.dateStyle,c.datePattern=e.datePattern}):e.axisType==="quotaExt"&&((s=a.value.yAxis)==null||s.forEach(c=>{c.dateStyle=e.dateStyle,c.datePattern=e.datePattern})))},pe=e=>{N("calcData"),e.removeType==="dimension"?a.value.xAxis.splice(e.index,1):e.removeType==="dimensionExt"?a.value.xAxisExt.splice(e.index,1):e.removeType==="dimensionStack"?a.value.extStack.splice(e.index,1):e.removeType==="quota"?a.value.yAxis.splice(e.index,1):e.removeType==="quotaExt"?a.value.yAxisExt.splice(e.index,1):e.removeType==="xAxisExtRight"?a.value.extBubble.splice(e.index,1):e.removeType==="flowMapStartName"?a.value.flowMapStartName.splice(e.index,1):e.removeType==="flowMapEndName"?a.value.flowMapEndName.splice(e.index,1):e.removeType==="extColor"&&a.value.extColor.splice(e.index,1)},Be=(e,t)=>{N("calcData"),J.emit("updateAxis",{axisType:t,axis:[e],editType:"update"})},ao=()=>{N("calcData")},ze=e=>{N("calcData");let t=e.removeType,s;e.removeType==="quota"?(t="yAxis",s=a.value.yAxis.splice(e.index,1)):e.removeType==="quotaExt"?(t="yAxisExt",s=a.value.yAxisExt.splice(e.index,1)):e.removeType==="extLabel"?s=a.value.extLabel.splice(e.index,1):e.removeType==="extTooltip"?s=a.value.extTooltip.splice(e.index,1):e.removeType==="extBubble"&&(s=a.value.extBubble.splice(e.index,1)),te().emitter.emit("removeAxis",{axisType:t,axis:s,editType:"remove"})},qt=L(()=>{var e,t;return!!((t=(e=a.value.customFilter)==null?void 0:e.items)!=null&&t.length)}),oo=L(()=>{var s,c;if(!((c=(s=a.value.customFilter)==null?void 0:s.items)!=null&&c.length)||!a.value.tableId)return!1;const e=a.value.customFilter.items[0];return!Me.value.some(y=>y.id===e.fieldId)}),lo=()=>{N("calcData")},io=e=>{N("calcData"),a.value.drillFields.splice(e.index,1)},fe=z("xAxis"),we=()=>{l.showCustomSort=!0},no=e=>{l.customSortList=e},Nt=()=>{l.showCustomSort=!1,l.customSortField={},l.customSortList=[]},so=()=>{a.value[fe.value].forEach(e=>{e.id===l.customSortField.id&&(e.sort="custom_sort",e.customSort=l.customSortList)}),Nt()},Dt=e=>{N("render"),l.customSortField=a.value.xAxis[e.index],fe.value="xAxis",we()},ro=e=>{N("render"),l.customSortField=a.value.extStack[e.index],fe.value="extStack",we()},rt=e=>{N("render"),l.customSortField=a.value.xAxisExt[e.index],fe.value="xAxisExt",we()},mo=e=>{N("render"),l.customSortField=a.value.extBubble[e.index],fe.value="extBubble",we()},co=e=>{N("render"),l.customSortField=a.value.flowMapStartName[e.index],fe.value="flowMapStartName",we()},uo=e=>{N("render"),l.customSortField=a.value.flowMapEndName[e.index],fe.value="flowMapEndName",we()},po=e=>{N("render"),l.customSortField=a.value.extColor[e.index],fe.value="extColor",we()},fo=e=>{N("render"),l.customSortField=a.value.drillFields[e.index],fe.value="drillFields",we()},ae=e=>(N("calcData"),l.moveId=e.draggedContext.element.id,!0),Ot=(e,t)=>{if(e&&e.length>0){let s=!0;for(let c=0;c<e.length;c++)e[c].groupType!==t&&(e.splice(c,1),s=!1);return s||G({message:v(t==="d"?"chart.error_q_2_d":"chart.error_d_2_q"),type:"warning"}),s}},Vt=(e,t,s)=>{if(s==="ds")e.splice(t.newDraggableIndex,1);else{const c=e.filter(function(y){return y.id===l.moveId});if(c&&c.length>1)return e.splice(t.newDraggableIndex,1),c}},vo=(e,t)=>{const s=e.filter(function(c){return c.id===l.moveId});s&&s.length>0&&s[0].summary===""&&e.splice(t.newDraggableIndex,1)},ho=L(()=>{if(a.value.type==="bar-range"){const e=a.value.yAxis[0],t=a.value.yAxisExt[0];if(e&&e.groupType==="d"||t&&t.groupType==="d")return!0}return!1}),go=L(()=>{let e=!1;if(a.value.type==="table-info"||!w.value)return e;const t=w.value.axisConfig;if(!t)return e;for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const c=a.value[s];c instanceof Array&&c.forEach(y=>{y.desensitized&&(e=!0)})}return e}),yo=e=>{if(e&&e.length>0){let t=!0;for(let s=0;s<e.length;s++)e[s].deType!==5&&(e.splice(s,1),t=!1);return t||G({message:v("chart.error_d_not_coordinates"),type:"warning"}),t}},ve=(e,t)=>{var P,Q,S,A,ge;N("calcData");const s=(P=w.value)==null?void 0:P.axisConfig[t];if(!s)return;const{type:c,limit:y,duplicate:b}=s;let E,k;if(a.value.type==="bar-range"&&(t==="yAxis"||t==="yAxisExt")){const _=a.value[t];if(_&&_.length>0){let B=!0;for(let V=0;V<_.length;V++)_[V].groupType==="d"&&_[V].deType===1&&(_[V].sort="asc"),_[V].groupType==="q"||_[V].groupType==="d"&&_[V].deType===1||(_.splice(V,1),B=!1);B||G({message:v("chart.error_d_not_time_2_q"),type:"warning"}),E=B}}else(a.value.type==="symbolic-map"||a.value.type==="heat-map")&&t==="xAxis"||a.value.type==="flow-map"&&(t==="xAxis"||t==="xAxisExt")?E=yo(a.value[t]):c&&(E=Ot(a.value[t],c));if(E&&c==="q"&&a.value.type==="indicator"){const _=a.value[t];if(_&&_.length>0){let B=!0;for(let V=0;V<_.length;V++)_[V].deType!==2&&_[V].deType!==3&&(_.splice(V,1),B=!1);E=B,E||G({message:v("chart.error_not_number"),type:"warning"})}}if(b||(k=Vt(a.value[t],e,"chart")),a.value[t].length>y){const _=a.value[t].splice(y);e.newDraggableIndex+1<=y&&(J.emit("removeAxis",{axisType:t,axis:_,editType:"remove"}),J.emit("addAxis",{axisType:t,axis:[a.value[t][e.newDraggableIndex]],editType:"add"}))}else if(!k&&E){const _=a.value.type==="gauge"||a.value.type==="liquid",B=qe(l.quotaData);J.emit("addAxis",{axisType:t,axis:[a.value[t][e.newDraggableIndex]],editType:"add",..._?{quotaData:B}:{}})}if(a.value.type==="line"&&(S=(Q=a.value)==null?void 0:Q.xAxisExt)!=null&&S.length&&((ge=(A=a.value)==null?void 0:A.yAxis)==null?void 0:ge.length)>1){const _=a.value.yAxis.splice(1);J.emit("removeAxis",{axisType:"yAxis",axis:_,editType:"remove"})}if(a.value.type.includes("chart-mix")){if(t==="yAxis"){if(a.value.yAxisExt.length>0){const _=a.value.yAxisExt[0].chartType;za(a.value.yAxis,B=>{_==="bar"?B.chartType="line":_==="line"&&(B.chartType="bar")})}}else if(t==="yAxisExt"&&a.value.yAxis.length>0){const _=a.value.yAxis[0].chartType;za(a.value.yAxisExt,B=>{_==="bar"?B.chartType="line":_==="line"&&(B.chartType="bar")})}}if(E&&a.value.type==="bar-range"){let _=null,B=null;if(t==="yAxis"&&a.value.yAxisExt[0]?(_=a.value.yAxisExt[0].groupType,B=a.value.yAxisExt[0].deType):t==="yAxisExt"&&a.value.yAxis[0]&&(_=a.value.yAxis[0].groupType,B=a.value.yAxis[0].deType),_!==null){const V=a.value[t];if(V&&V.length>0){let de=!0;for(let xe=0;xe<V.length;xe++)V[xe].groupType===_&&(_==="q"||_==="d"&&V[xe].deType===B)||(V.splice(xe,1),de=!1);de||G({message:v("chart.error_bar_range_axis_type_not_equal"),type:"warning"}),E=de}}}},xo=e=>{ve(e,"xAxis")},Co=e=>{ve(e,"xAxisExt")},ko=e=>{ve(e,"extStack")},Mt=e=>{ve(e,"yAxis")},Bt=e=>{ve(e,"yAxisExt")},zt=e=>{ve(e,"extBubble")},Pt=e=>{N("calcData"),Ot(a.value.drillFields,"d"),Vt(a.value.drillFields,e,""),vo(a.value.drillFields,e)},_o=e=>{ve(e,"flowMapStartName")},bo=e=>{ve(e,"flowMapEndName")},wo=e=>{ve(e,"extColor")},Ae=(e,t)=>{if(e.removed){const{element:s}=e.removed;J.emit("removeAxis",{axisType:t,axis:[s],editType:"remove"})}},Fe=(e,t=!1,s="")=>{if(e.refreshTime===""||parseFloat(e.refreshTime).toString()==="NaN"||parseFloat(e.refreshTime)<1){G.error(v("chart.only_input_number"));return}t?te().emitter.emit("resetDrill-"+e.id,0):be.value?te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"calcData",component:JSON.parse(JSON.stringify(e))}}):(te().emitter.emit("calcData-"+e.id,e),_e.recordSnapshotCache("renderChart",e.id)),_e.recordSnapshotCache("calcData",e.id),s==="updateQuery"&&Za.value.forEach(c=>{te().emitter.emit(`updateQueryCriteria${c.id}`)})},Eo=e=>{q.value.state="ready",te().emitter.emit("checkShowEmpty",{allFields:Me.value,view:e}),Fe(e,!0,"updateQuery")},M=e=>{be.value?te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"renderChart",component:JSON.parse(JSON.stringify(e))}}):(te().emitter.emit("renderChart-"+e.id,e),_e.recordSnapshotCache("renderChart",e.id))},So=e=>{e.id!=="customRoot"&&(a.value.customAttr.map={id:e.id,level:e.level},M(a.value))},Ao=(e,t)=>{var y,b,E,k,P;const s=Oa(t);s.isPlugin?(a.value.plugin={isPlugin:!0,staticMap:s.staticMap},a.value.isPlugin=!0):(a.value.isPlugin=!1,delete a.value.plugin),a.value.render=e,a.value.type=t,J.emit("chart-type-change"),J.emit("chart-type-change-"+a.value.id);const c=Ma.getChartView(a.value.render,a.value.type);if(c){a.value=c.setupDefaultOptions(a.value);const Q=c.axisConfig;if(qi(Q).forEach(S=>{const A=a.value[S];if(!(A!=null&&A.length))return;const ge=Q[S],{type:_,limit:B}=ge,V=[];if(_){for(let de=A.length-1;de>=0;de--)if(A[de].groupType!==_){const[xe]=A.splice(de,1);V.push(xe)}}B&&B<A.length&&A.splice(B).forEach(de=>V.push(de)),V.length&&J.emit("removeAxis",{axisType:S,axis:V,editType:"remove"})}),a.value.type==="line"&&(b=(y=a.value)==null?void 0:y.xAxisExt)!=null&&b.length&&((k=(E=a.value)==null?void 0:E.yAxis)==null?void 0:k.length)>1){const S=a.value.yAxis.splice(1);J.emit("removeAxis",{axisType:"yAxis",axis:S,editType:"remove"})}if((a.value.type==="liquid"||a.value.type==="gauge"||a.value.type==="indicator")&&Y("drillFields"),!["line","area","bar","bar-group"].includes(a.value.type)){const S=document.getElementById("point_"+a.value.id);S&&(S.remove(),(P=S.parentNode)==null||P.removeChild(S))}}q.value.innerType=t,Fe(a.value,!0)},$t=(e,t)=>{const{data:s,requestData:c,render:y}=e,b=et(s,t);tt(a.value.customAttr.basicStyle,t,b),c&&Fe(a.value),y!==!1&&M(a.value)},Rt=e=>{a.value.customAttr.tableHeader=e,M(a.value)},Qt=e=>{a.value.customAttr.tableCell=e,M(a.value)},Lt=e=>{a.value.customAttr.tableTotal=e,M(a.value)},Jt=e=>{a.value.customAttr.color=e,M(a.value)},Ut=e=>{a.value.customAttr.misc=e.data,e.requestData?Fe(a.value):M(a.value)},jt=(e,t)=>{const{data:s,render:c}=e;let y=s;if(s||(y=e),t){const b=et(y,t);tt(a.value.customAttr.label,t,b)}else a.value.customAttr.label=y;c!==!1&&M(a.value)},Ht=(e,t)=>{(t==="color"||t==="suffixColor")&&(a.value.customAttr.basicStyle.alpha=void 0,e.indicatorName!==void 0&&(a.value.customAttr.indicatorName=e.indicatorName)),a.value.customAttr.indicator=e.indicatorValue,M(a.value)},Wt=(e,t)=>{t==="color"&&(a.value.customAttr.basicStyle.alpha=void 0,e.indicatorValue!==void 0&&(a.value.customAttr.indicator=e.indicatorValue)),a.value.customAttr.indicatorName=e.indicatorName,M(a.value)},Yt=(e,t)=>{const{data:s,requestData:c,render:y}=e;let b=s;if(s||(b=e),t){const E=et(b,t);tt(a.value.customAttr.tooltip,t,E)}else a.value.customAttr.tooltip=b;if(c){Fe(a.value);return}y!==!1&&M(a.value)},Xt=e=>{a.value.customStyle.xAxis=e,M(a.value)},Gt=e=>{a.value.customStyle.yAxis=e,M(a.value)},Kt=e=>{a.value.customStyle.yAxisExt=e,M(a.value)},Zt=e=>{a.value.customStyle.misc=e,M(a.value)},ea=e=>{a.value.customStyle.text=e,q.value&&(q.value.name=a.value.title,q.value.title=a.value.title),be.value?te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"updateTitle",component:JSON.parse(JSON.stringify(a.value))}}):(te().emitter.emit("updateTitle-"+a.value.id),_e.recordSnapshotCache("renderChart",a.value.id))},ta=e=>{a.value.customStyle.legend=e,M(a.value)},Fo=e=>{a.value.senior.functionCfg=e,M(a.value)},aa=e=>{var t;q.value.id===((t=a.value)==null?void 0:t.id)&&(q.value.commonBackground=e,be.value&&te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"commonBackground",component:JSON.parse(JSON.stringify(q.value))}}))},oa=e=>{q.value.style[e.property]=e.value,be.value&&te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"style",component:JSON.parse(JSON.stringify(q.value))}})},Io=e=>{a.value.senior.assistLineCfg=e.data,e.requestData?Fe(a.value):M(a.value)},To=e=>{var s,c;a.value.senior.threshold=e;let t;(c=(s=a.value.senior.threshold)==null?void 0:s.tableThreshold)==null||c.some(y=>y.conditions.some(b=>b.type==="dynamic")?(t="calcData",!0):!1),t||a.value.type==="rich-text"?Fe(a.value):M(a.value)},qo=e=>{a.value.senior.areaMapping=e,M(a.value)},No=e=>{a.value.senior.scrollCfg=e,M(a.value)},Do=e=>{a.value.senior.bubbleCfg=e,M(a.value)},Oo=e=>{kt.value==="edit"&&(a.value.customAttr.basicStyle.tableFieldWidth=e,_e.recordSnapshotCache("renderChart",a.value.id))},Vo=e=>{kt.value==="edit"&&(a.value.customAttr.basicStyle.tablePageSize=e,_e.recordSnapshotCache("renderChart",a.value.id))},la=e=>{a.value.extTooltip=e},ia=e=>{a.value.customAttr.quadrant=e,M(a.value)},na=(e,t)=>{const s=et(e,t);tt(a.value.customAttr.misc.flowMapConfig.lineConfig,t,s),M(a.value)},sa=e=>{a.value.customAttr.misc.flowMapConfig.pointConfig=e,M(a.value)},W=e=>{N("render"),l.itemForm=JSON.parse(JSON.stringify(e)),l.itemForm.chartShowName||(l.itemForm.chartShowName=l.itemForm.name),l.renameItem=!0},ra=()=>{l.renameItem=!1},Y=e=>{var s,c,y,b,E,k,P,Q,S,A;N("calcData");let t=[];switch(e){case"xAxis":t=(s=a.value.xAxis)==null?void 0:s.splice(0);break;case"xAxisExt":t=(c=a.value.xAxisExt)==null?void 0:c.splice(0);break;case"extStack":t=(y=a.value.extStack)==null?void 0:y.splice(0);break;case"yAxis":t=(b=a.value.yAxis)==null?void 0:b.splice(0);break;case"yAxisExt":t=(E=a.value.yAxisExt)==null?void 0:E.splice(0);break;case"extBubble":t=(k=a.value.extBubble)==null?void 0:k.splice(0);break;case"customFilter":a.value.customFilter={};return;case"drillFields":t=(P=a.value.drillFields)==null?void 0:P.splice(0);break;case"flowMapStartName":t=(Q=a.value.flowMapStartName)==null?void 0:Q.splice(0);break;case"flowMapEndName":t=(S=a.value.flowMapEndName)==null?void 0:S.splice(0);break;case"extColor":t=(A=a.value.extColor)==null?void 0:A.splice(0);break}t!=null&&t.length&&J.emit("removeAxis",{axisType:e,axis:t,editType:"remove"})},Mo=e=>{e&&e.validate(t=>{if(t){const{renameType:s,index:c,chartShowName:y}=l.itemForm;let b,E;switch(s){case"quota":b="yAxis",E=a.value.yAxis[c],a.value.yAxis[c].chartShowName=y;break;case"dimension":a.value.xAxis[c].chartShowName=y;break;case"quotaExt":b="yAxisExt",E=a.value.yAxisExt[c],a.value.yAxisExt[c].chartShowName=y;break;case"dimensionExt":a.value.xAxisExt[c].chartShowName=y;break;case"xAxisExtRight":a.value.extBubble[c].chartShowName=y;break;case"dimensionStack":a.value.extStack[c].chartShowName=y;break;case"extBubble":b="extBubble",E=a.value.extBubble[c],a.value.extBubble[c].chartShowName=y;break;case"extLabel":a.value.extLabel[c].chartShowName=y;break;case"extTooltip":a.value.extTooltip[c].chartShowName=y;case"flowMapStartName":b="flowMapStartName",E=a.value.flowMapStartName[c],a.value.flowMapStartName[c].chartShowName=y;break;case"flowMapEndName":b="flowMapEndName",E=a.value.flowMapEndName[c],a.value.flowMapEndName[c].chartShowName=y;break;case"extColor":b="extColor",E=a.value.extColor[c],a.value.extColor[c].chartShowName=y;break;case"drillFields":b="drillFields",E=a.value.drillFields[c],a.value.drillFields[c].chartShowName=y}b&&J.emit("updateAxis",{axisType:b,axis:[E],editType:"update"}),ra()}else return!1})},Pe=e=>{N("calcData"),l.quotaItem=JSON.parse(JSON.stringify(e)),l.quotaItem.logic||(l.quotaItem.logic="and"),l.quotaFilterEdit=!0},da=()=>{l.quotaFilterEdit=!1},Bo=()=>{for(let e=0;e<l.quotaItem.filter.length;e++){const t=l.quotaItem.filter[e];if(!t.term.includes("null")&&!t.term.includes("empty")&&(!t.value||t.value==="")){G.error(v("chart.filter_value_can_null"));return}if(!t.term.includes("null")&&!t.term.includes("empty")&&isNaN(t.value)){G.error(v("chart.filter_value_can_not_str"));return}}l.quotaItem.filterType==="quota"?(a.value.yAxis[l.quotaItem.index].filter=l.quotaItem.filter,a.value.yAxis[l.quotaItem.index].logic=l.quotaItem.logic):l.quotaItem.filterType==="quotaExt"&&(a.value.yAxisExt[l.quotaItem.index].filter=l.quotaItem.filter,a.value.yAxisExt[l.quotaItem.index].logic=l.quotaItem.logic),da()},zo=e=>{a.value.customFilter=qe(e)},ma=z(),ca=()=>{ma.value.init(qe(a.value.customFilter))},ua=()=>{l.resultFilterEdit=!1},Po=()=>{if((l.filterItem.deType===0||l.filterItem.deType===5)&&l.filterItem.filterType!=="enum"||l.filterItem.deType===1||l.filterItem.deType===2||l.filterItem.deType===3)for(let e=0;e<l.filterItem.filter.length;e++){const t=l.filterItem.filter[e];if(!t.term.includes("null")&&!t.term.includes("empty")&&(!t.value||t.value==="")){G.error(v("chart.filter_value_can_null"));return}if((l.filterItem.deType===2||l.filterItem.deType===3)&&!t.term.includes("null")&&!t.term.includes("empty")&&isNaN(t.value)){G.error(v("chart.filter_value_can_not_str"));return}}a.value.customFilter[l.filterItem.index].filter=l.filterItem.filter,a.value.customFilter[l.filterItem.index].logic=l.filterItem.logic,a.value.customFilter[l.filterItem.index].filterType=l.filterItem.filterType,a.value.customFilter[l.filterItem.index].enumCheckField=l.filterItem.enumCheckField,ua()},pa=e=>{re.value[e]=!re.value[e]},$e=z(null),dt=e=>{if($e!=null&&$e.value){const t={methodName:"initOpenHandler",args:e};$e.value.invokeMethod(t)}},$o=()=>{if(!je.value.id){G.warning(v("visualization.save_page_tips"));return}const e=ot.getToken&&Ye.getIsIframe?"dataset-embedded-form":"/dataset-form";let t=_t.resolve(e);const s=at.get(xt("open-backend"))==="1"?"_self":"_blank",c=window.open(t.href,s);dt(c)},Ro=()=>{const e=ot.getToken&&Ye.getIsIframe?"dataset-embedded-form":"/dataset-form",t=at.get(xt("open-backend"))==="1"?"_self":"_blank";if(t==="_self"&&!je.value.id){G.warning(v("visualization.save_page_tips"));return}let s=_t.resolve({path:e,query:{id:a.value.tableId}});if(t==="_self"){if(!je.value.id){G.warning(v("visualization.save_page_tips"));return}Ii(()=>{at.delete(xt("DE-DV-CATCH-"+je.value.id));const c=window.open(s.href,t);dt(c)})}else{const c=window.open(s.href,t);dt(c)}},Re=e=>{N("calcData"),l.quotaItemCompare=JSON.parse(JSON.stringify(e)),l.showEditQuotaCompare=!0},fa=()=>{l.showEditQuotaCompare=!1},Qo=()=>{l.quotaItemCompare.calcType==="quota"?a.value.yAxis[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc:l.quotaItemCompare.calcType==="quotaExt"?a.value.yAxisExt[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc:l.quotaItemCompare.calcType==="extLabel"?a.value.extLabel[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc:l.quotaItemCompare.calcType==="extTooltip"&&(a.value.extTooltip[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc),fa()},va=e=>{switch(N("render"),e.axisType){case"dimension":a.value.xAxis[e.index].hide=e.hide;break;case"quota":a.value.yAxis[e.index].hide=e.hide;break}M(a.value)},ee=()=>{l.showSortPriority=!0},ha=()=>{l.showSortPriority=!1},Lo=()=>{a.value.sortPriority=l.sortPriority,N("render"),ha()},Jo=e=>{l.sortPriority=e},he=e=>{N("render"),l.valueFormatterItem=JSON.parse(JSON.stringify(e)),l.showValueFormatter=!0},ga=()=>{l.showValueFormatter=!1},Uo=()=>{const e=l.valueFormatterItem.formatterCfg.decimalCount;if(e===void 0||e.toString().indexOf(".")>-1||parseInt(e).toString()==="NaN"||parseInt(e)<0||parseInt(e)>10){G.error(v("chart.formatter_decimal_count_error"));return}l.valueFormatterItem.formatterType==="quota"?a.value.yAxis[l.valueFormatterItem.index].formatterCfg=l.valueFormatterItem.formatterCfg:l.valueFormatterItem.formatterType==="quotaExt"?a.value.yAxisExt[l.valueFormatterItem.index].formatterCfg=l.valueFormatterItem.formatterCfg:l.valueFormatterItem.formatterType==="dimension"&&(a.value.xAxis[l.valueFormatterItem.index].formatterCfg=l.valueFormatterItem.formatterCfg),ga()},jo=L(()=>({height:ot.getToken?"calc(100% - 45px)":"calc(100vh - 110px)"})),jn=e=>{De.value=!0,lt.value=!0,Ne(()=>{Oe.value.initEdit({groupType:e,id:gi()},l.dimension,l.quota.filter(t=>t.id!=="-1"))})},Ho=e=>{De.value=!0,lt.value=!1,Ne(()=>{Oe.value.initEdit(e,l.dimension,l.quota.filter(t=>t.id!=="-1"))})},ya=()=>{De.value=!1},Wo=()=>{Oe.value.setFieldForm();const e=qe(Oe.value.fieldForm);Ca(e),Va(e).then(()=>{Se(a.value.tableId,a.value.id,a.value.type),ya()})},xa=(e,t,s=!1)=>t===2?(s?Ai:Fi)[e]:Ct[ke[e]],Hn=e=>{var t;switch(l.currEditField=JSON.parse(JSON.stringify(e.item)),e.type){case"copy":Ca(l.currEditField),l.currEditField.id=null,l.currEditField.originName=e.item.extField===2?e.item.originName:"["+e.item.id+"]",l.currEditField.name=yi(l.dimension.concat(l.quota),e.item.name),Va(l.currEditField).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)});break;case"edit":Ho(e.item);break;case"delete":xi((t=e.item)==null?void 0:t.id).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)});break}},Wn=(e,t)=>({type:t,item:e}),Ca=e=>{e.extField=2,e.chartId=a.value.id,e.datasetGroupId=a.value.tableId,e.dataeaseName=null,e.lastSyncTime=null,e.columnIndex=l.dimension.length+l.quota.length,e.deExtractType=e.deType},ka=z(null),mt=z(null),{y:ct,isDragging:_a}=ki(ka,{initialValue:{x:0,y:400},draggingElement:mt}),Ie=z(0),Yo=Ba(()=>{Ne(()=>{Ie.value=mt.value.offsetHeight,ct.value=Ie.value/2+200})},500),Xo=Ba(()=>{Ne(()=>{!Ve||a.value.tableId||Ft.value||["rich-text","picture-group"].includes(a.value.type)||(a.value.tableId=Ve)})},500);Ge(()=>q.value,e=>{!e||Ie.value||Yo()}),Ge(()=>q.value,e=>{e&&Xo()});const Go=L(()=>{const e=ct.value-200;return e<53?53:e>Ie.value-50?Ie.value-50:e}),Ko=L(()=>{const e=ct.value-200;return e<50?50:e>Ie.value-53?Ie.value-53:e}),Zo=e=>{if(N("render"),e===""||parseFloat(e).toString()==="NaN"||parseFloat(e)<1){G.error(v("chart.only_input_number"));return}},ut=z(!1),Te=z(!1),U=z([]),X=z([]),ba=(e,t="dimension")=>{ut.value&&(ut.value=!1);const s=t==="dimension"?U:X,c=t==="quota"?U:X;c.value=[],s.value=s.value.some(y=>y.id===e.id)?[]:[e]},Xe=(e,t="dimension")=>{ut.value=!0;const s=t==="dimension"?U:X,c=t==="quota"?U:X;c.value=[];const y=s.value.findIndex(b=>b.id===e.id);if(y!==-1){s.value.splice(y,1);return}s.value.push(e)},wa=(e,t="dimension")=>{const s=t==="dimension"?U:X,c=t==="quota"?U:X,y=t==="dimension"?st:nt;c.value=[];const b=y.value.map(k=>k.id),E=s.value.filter(k=>b.includes(k.id));if(E.length){const k=y.value.findIndex(Q=>Q.id===E[E.length-1].id),P=y.value.findIndex(Q=>Q.id===e.id);if(k===P)return;k>P&&(s.value=[...s.value,...y.value.slice(P,k)]),k<P&&(s.value=[...s.value,...y.value.slice(k+1,P+1)])}else{const k=s.value.findIndex(P=>P.id===e.id);if(k!==-1){s.value.splice(k,1);return}s.value.push(e)}},Qe=z(!1),el=()=>{Qe.value=!0,setTimeout(()=>{Te.value=!0},0)},tl=(e,t,s)=>{const c=s==="dimension"?U:X,y=s==="quota"?U:X;y.value=[],c.value.length||(c.value=[o(t)]),to(e,o(U.value))},al=()=>{Qe.value=!0,setTimeout(()=>{Te.value=!0},0)},ol=(e,t,s)=>{const c=s==="dimension"?U:X,y=s==="quota"?U:X;y.value=[],c.value.length||(c.value=[t]),e.dataTransfer.setData("quota",JSON.stringify(X.value.filter(b=>b.id).map(b=>({...qe(o(b)),datasetId:a.value.tableId}))))},pt=()=>{Qe.value=!1,Te.value=!1},Ea=()=>{U.value=[],X.value=[],pt()},oe=e=>{e.preventDefault()},le=e=>{e.preventDefault()},ie=(e,t="xAxis")=>{var c;e.preventDefault();const s=U.value.length?U.value:X.value;for(let y=0;y<s.length;y++){const b=qe(s[y]);l.moveId=b.id,(c=a.value)[t]??(c[t]=[]),a.value[t].push(b);const E={newDraggableIndex:a.value[t].length-1};t==="drillFields"?Pt(E):ve(E,t)}},ye=z(!1),Sa=e=>{ye.value=!0,bi(e,a.value.id).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)}).catch(()=>{ye.value=!1})},Aa=e=>{ye.value=!0,wi(e).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)}).catch(()=>{ye.value=!1})};return(e,t)=>{const s=ml,c=cl,y=vt("Fold"),b=vt("Expand"),E=ul,k=pl,P=fl,Q=vl,S=hl,A=gl,ge=yl,_=xl,B=Cl,V=kl,de=_l,xe=bl,ll=wl,ft=El,il=Sl,nl=Al,Yn=vt("Setting"),Xn=Nl,Gn=Dl,Kn=Ol,sl=Fl,rl=Il,Ee=Tl,Fa=ql;return u(),F(ce,null,[p("div",{class:g(["chart-edit","editor-"+f.themes]),onKeydown:t[87]||(t[87]=j(()=>{},["stop"])),onKeyup:t[88]||(t[88]=j(()=>{},["stop"]))},[o(be)?(u(),x(c,{key:0,direction:"vertical"},{default:n(()=>[i(s,{class:"drag_main_area"},{default:n(()=>{var d,m,r,D,me;return[o(a).type==="VQuery"&&o(q)?(u(),x(Da,{key:0,element:o(q),"common-background-pop":(d=o(q))==null?void 0:d.commonBackground,chart:o(a),themes:f.themes},null,8,["element","common-background-pop","chart","themes"])):(m=o(a).plugin)!=null&&m.isPlugin?(u(),x(o(Ze),{key:1,jsname:o(a).plugin.staticMap["editor-style"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(J)},null,8,["jsname","view","dimension","quota","themes","emitter"])):(u(),F(ce,{key:2},[It.value?(u(),x(Na,{key:0,properties:w.value.properties,"property-inner-all":w.value.propertyInner,"selector-spec":w.value.selectorSpec,"common-background-pop":(r=o(q))==null?void 0:r.commonBackground,"common-border-pop":(D=o(q))==null?void 0:D.style,"event-info":(me=o(q))==null?void 0:me.events,chart:o(a),themes:f.themes,"dimension-data":l.dimension,"quota-data":l.quota,"all-fields":Me.value,onOnColorChange:Jt,onOnMiscChange:Ut,onOnLabelChange:jt,onOnTooltipChange:Yt,onOnChangeXAxisForm:Xt,onOnChangeYAxisForm:Gt,onOnChangeYAxisExtForm:Kt,onOnTextChange:ea,onOnIndicatorChange:Ht,onOnIndicatorNameChange:Wt,onOnLegendChange:ta,onOnBackgroundChange:aa,onOnStyleAttrChange:oa,onOnBasicStyleChange:$t,onOnTableHeaderChange:Rt,onOnTableCellChange:Qt,onOnTableTotalChange:Lt,onOnChangeMiscStyleForm:Zt,onOnExtTooltipChange:la,onOnChangeQuadrantForm:ia,onOnChangeFlowMapLineForm:na,onOnChangeFlowMapPointForm:sa},null,8,["properties","property-inner-all","selector-spec","common-background-pop","common-border-pop","event-info","chart","themes","dimension-data","quota-data","all-fields"])):h("",!0)],64))]}),_:1})]),_:1})):h("",!0),o(be)?h("",!0):ht((u(),x(k,{key:1,class:"de-chart-editor"},{default:n(()=>[p("div",{class:g(["content-area",{"content-area-close":o(re).chartAreaCollapse,"content-area-left-open":!o(re).chartAreaCollapse}])},[i(o(T),{title:o(a).title,class:"custom-icon",size:"20px",onClick:t[0]||(t[0]=d=>pa("chartAreaCollapse"))},{default:n(()=>[o(re).chartAreaCollapse?(u(),x(y,{key:0,class:"collapse-icon"})):(u(),x(b,{key:1,class:"collapse-icon"}))]),_:1},8,["title"]),o(re).chartAreaCollapse?(u(),F("div",Di,[p("span",Oi,C(o(a).title),1)])):h("",!0),o(re).chartAreaCollapse?h("",!0):(u(),F("div",Vi,[i(k,{class:"editor-title"},{default:n(()=>[p("div",Mi,[p("div",{id:"component-name",class:g(["name-area",{"component-name-dark":f.themes==="dark"}]),style:Ke([{"max-width":"180px","text-overflow":"ellipsis","white-space":"nowrap"},{width:o(He)?"300px":"auto"}]),onDblclick:At},C(o(a).title),39),i(E,{"show-arrow":"",offset:8,placement:"bottom",width:"200",trigger:"click"},{reference:n(()=>[i(o(T),{style:{"margin-left":"4px",cursor:"pointer"}},{default:n(()=>[i(I,null,{default:n(()=>[i(o(Ql),{class:"svg-icon"})]),_:1})]),_:1})]),default:n(()=>[p("div",Bi,C(o(v)("visualization.view_id")),1),p("div",zi,C(o(a).id),1)]),_:1})])]),_:1}),i(k,{style:Ke(jo.value)},{default:n(()=>[o(a).type==="VQuery"&&o(q)?(u(),x(s,{key:0},{default:n(()=>{var d;return[p("div",Pi,[p("div",$i,[i(Da,{element:o(q),"common-background-pop":(d=o(q))==null?void 0:d.commonBackground,chart:o(a),themes:f.themes},null,8,["element","common-background-pop","chart","themes"])])])]}),_:1})):(u(),x(il,{key:1,modelValue:wt.value,"onUpdate:modelValue":t[66]||(t[66]=d=>wt.value=d),class:g(["tab-header",{dark:f.themes==="dark"}])},{default:n(()=>[i(ft,{name:"data",label:o(v)("chart.chart_data"),class:"padding-tab"},{default:n(()=>[i(c,{direction:"vertical"},{default:n(()=>[i(s,{class:"has-footer drag_main_area attr-style theme-border-class"},{default:n(()=>{var d;return[["rich-text","Picture","picture-group"].includes(o(a).type)?h("",!0):(u(),x(k,{key:0,class:"drag-data padding-lr"},{default:n(()=>[p("span",Ri,C(o(v)("chart.switch_chart")),1),i(E,{offset:4,placement:"bottom-end",width:"434",trigger:"click","append-to-body":!0,"popper-class":"chart-type-style-"+f.themes,persistent:!1},{reference:n(()=>[i(Q,{modelValue:l.useless,"onUpdate:modelValue":t[1]||(t[1]=m=>l.useless=m),"popper-class":"chart-type-hide-options",class:"chart-type-select","suffix-icon":o(Ll),effect:f.themes,size:"small"},{prefix:n(()=>{var m,r;return[(m=l.chartTypeOptions[0])!=null&&m.isPlugin?(u(),x(I,{key:0,"class-name":"chart-type-select-icon","static-content":(r=l.chartTypeOptions[0])==null?void 0:r.icon},null,8,["static-content"])):(u(),x(I,{key:1,"class-name":"chart-type-select-icon"},{default:n(()=>[(u(),x(Le(o(Si)[l.chartTypeOptions[0].icon]),{class:"svg-icon chart-type-select-icon"}))]),_:1}))]}),default:n(()=>[(u(!0),F(ce,null,Je(l.chartTypeOptions,m=>(u(),x(P,{key:m.value,label:m.title,value:m.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","suffix-icon","effect"])]),default:n(()=>[i(ri,{themes:f.themes,type:o(a).type,onOnTypeChange:Ao},null,8,["themes","type"])]),_:1},8,["popper-class"])]),_:1})),(d=o(a).plugin)!=null&&d.isPlugin?(u(),x(o(Ze),{key:1,jsname:o(a).plugin.staticMap["editor-data"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(J),onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:Dt,onValueFormatter:he},null,8,["jsname","view","dimension","quota","themes","emitter"])):(u(),F(ce,{key:2},[Z("area")?(u(),x(k,{key:0,class:"padding-lr drag-data"},{default:n(()=>[p("span",Qi,[O(C(o(v)("chart.area"))+" ",1),t[90]||(t[90]=p("i",{class:"required"},null,-1))]),p("div",Li,[i(o(dl),{ref_key:"areaSelect",ref:it,modelValue:l.areaId,"onUpdate:modelValue":t[2]||(t[2]=m=>l.areaId=m),effect:f.themes,data:l.worldTree,props:Xa,filterNodeMethod:Ka,"current-node-key":l.areaId,teleported:!1,"default-expanded-keys":Tt.value,"empty-text":"请选择区域","node-key":"id","check-strictly":"",filterable:"",onNodeClick:So},null,8,["modelValue","effect","data","current-node-key","default-expanded-keys"])])]),_:1})):h("",!0),Z("xAxis")?(u(),x(k,{key:1,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Ji,[p("span",null,[O(C(w.value.axisConfig.xAxis.name)+" ",1),(m=w.value.axisConfig.xAxis)!=null&&m.allowEmpty?h("",!0):(u(),F("i",Ui))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[3]||(t[3]=r=>Y("xAxis"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[4]||(t[4]=r=>ie(r)),onDragenter:oe,onDragover:t[5]||(t[5]=r=>le(r))},[i(o(ne),{list:o(a).xAxis,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:xo},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"dimension",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:Dt,onValueFormatter:he,onOnToggleHide:va,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).xAxis},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),Z("xAxisExt")?(u(),x(k,{key:2,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",ji,[p("span",null,[O(C(w.value.axisConfig.xAxisExt.name)+" ",1),(m=w.value.axisConfig.xAxisExt)!=null&&m.allowEmpty?h("",!0):(u(),F("i",Hi))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[6]||(t[6]=r=>Y("xAxisExt"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[7]||(t[7]=r=>ie(r,"xAxisExt")),onDragenter:oe,onDragover:t[8]||(t[8]=r=>le(r))},[i(o(ne),{list:o(a).xAxisExt,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Co},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"dimensionExt",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:rt,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).xAxisExt},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("flowMapStartName")?(u(),x(k,{key:3,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Wi,[p("span",null,[O(C(w.value.axisConfig.flowMapStartName.name)+" ",1),(m=w.value.axisConfig.flowMapStartName)!=null&&m.allowEmpty?h("",!0):(u(),F("i",Yi))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[9]||(t[9]=r=>Y("flowMapStartName"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[10]||(t[10]=r=>ie(r,"flowMapStartName")),onDragenter:oe,onDragover:t[11]||(t[11]=r=>le(r))},[i(o(ne),{list:o(a).flowMapStartName,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:_o},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"flowMapStartName",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:co,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).flowMapStartName},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),Z("flowMapEndName")?(u(),x(k,{key:4,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Xi,[p("span",null,[O(C(w.value.axisConfig.flowMapEndName.name)+" ",1),(m=w.value.axisConfig.flowMapEndName)!=null&&m.allowEmpty?h("",!0):(u(),F("i",Gi))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[12]||(t[12]=r=>Y("flowMapEndName"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[13]||(t[13]=r=>ie(r,"flowMapEndName")),onDragenter:oe,onDragover:t[14]||(t[14]=r=>le(r))},[i(o(ne),{list:o(a).flowMapEndName,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:bo},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"flowMapEndName",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:uo,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).flowMapEndName},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),Z("extStack")?(u(),x(k,{key:5,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Ki,[p("span",null,[O(C(w.value.axisConfig.extStack.name)+" ",1),(m=w.value.axisConfig.extStack)!=null&&m.allowEmpty?h("",!0):(u(),F("i",Zi))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[15]||(t[15]=r=>Y("extStack"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[16]||(t[16]=r=>ie(r,"extStack")),onDragenter:oe,onDragover:t[17]||(t[17]=r=>le(r))},[i(o(ne),{list:o(a).extStack,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:ko},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"dimensionStack",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:ro,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).extStack},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("extColor")?(u(),x(k,{key:6,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",en,[p("span",null,[O(C(w.value.axisConfig.extColor.name)+" ",1),(m=w.value.axisConfig.extColor)!=null&&m.allowEmpty?h("",!0):(u(),F("i",tn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[18]||(t[18]=r=>Y("extColor"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[20]||(t[20]=r=>ie(r,"extColor")),onDragenter:oe,onDragover:t[21]||(t[21]=r=>le(r))},[i(o(ne),{list:o(a).extColor,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:wo,onChange:t[19]||(t[19]=r=>Ae(r,"extColor"))},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"extColor",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:po,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).extColor},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),o(a).type!=="bar-range"?(u(),F(ce,{key:7},[Z("yAxis")?(u(),x(k,{key:0,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",an,[p("span",on,[p("span",ln,[O(C(w.value.axisConfig.yAxis.name)+" ",1),(m=w.value.axisConfig.yAxis)!=null&&m.allowEmpty?h("",!0):(u(),F("i",nn))]),w.value.axisConfig.yAxis.tooltip?(u(),x(S,{key:0,class:"item",effect:R.value,placement:"top"},{content:n(()=>[p("span",null,C(w.value.axisConfig.yAxis.tooltip),1)]),default:n(()=>[i(o(T),{class:g(["hint-icon",{"hint-icon--dark":f.themes==="dark"}])},{default:n(()=>[i(I,{name:"icon_info_outlined"},{default:n(()=>[i(o(yt),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect"])):h("",!0)]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[22]||(t[22]=r=>Y("yAxis"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[25]||(t[25]=r=>ie(r,"yAxis")),onDragenter:oe,onDragover:t[26]||(t[26]=r=>le(r))},[i(o(ne),{list:o(a).yAxis,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Mt,onChange:t[24]||(t[24]=r=>Ae(r,"yAxis"))},{item:n(({element:r,index:D})=>[i(Ue,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,type:"quota",themes:$.themes,onOnQuotaItemChange:t[23]||(t[23]=me=>Be(me,"yAxis")),onOnQuotaItemRemove:ze,onOnNameEdit:W,onEditItemFilter:Pe,onEditItemCompare:Re,onValueFormatter:he,onOnToggleHide:va,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"margin-top":o(a).type==="stock-line"?"9px":"0","drag-list":o(a).yAxis},null,8,["margin-top","drag-list"])],32)]}),_:1})):h("",!0),Z("xAxisExtRight")?(u(),x(k,{key:1,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",sn,[p("span",null,[O(C(w.value.axisConfig.extBubble.name)+" ",1),(m=w.value.axisConfig.extBubble)!=null&&m.allowEmpty?h("",!0):(u(),F("i",rn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[27]||(t[27]=r=>Y("extBubble"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[29]||(t[29]=r=>ie(r,"extBubble")),onDragenter:oe,onDragover:t[30]||(t[30]=r=>le(r))},[i(o(ne),{list:o(a).extBubble,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:zt,onChange:t[28]||(t[28]=r=>Ae(r,"extBubble"))},{item:n(({element:r,index:D})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"xAxisExtRight",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:mo,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).extBubble},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("yAxisExt")?(u(),x(k,{key:2,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",dn,[p("span",null,[O(C(w.value.axisConfig.yAxisExt.name)+" ",1),(m=w.value.axisConfig.yAxisExt)!=null&&m.allowEmpty?h("",!0):(u(),F("i",mn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[31]||(t[31]=r=>Y("yAxisExt"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[34]||(t[34]=r=>ie(r,"yAxisExt")),onDragenter:oe,onDragover:t[35]||(t[35]=r=>le(r))},[i(o(ne),{list:o(a).yAxisExt,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Bt,onChange:t[33]||(t[33]=r=>Ae(r,"yAxisExt"))},{item:n(({element:r,index:D})=>[i(Ue,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,type:"quotaExt",themes:$.themes,onOnQuotaItemChange:t[32]||(t[32]=me=>Be(me,"yAxisExt")),onOnQuotaItemRemove:ze,onOnNameEdit:W,onEditItemFilter:Pe,onEditItemCompare:Re,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).yAxisExt},null,8,["drag-list"])],32)]}),_:1})):h("",!0)],64)):o(a).type==="bar-range"?(u(),F(ce,{key:8},[Z("yAxis")?(u(),x(k,{key:0,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",cn,[p("span",null,[O(C(w.value.axisConfig.yAxis.name)+" ",1),(m=w.value.axisConfig.yAxis)!=null&&m.allowEmpty?h("",!0):(u(),F("i",un))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[36]||(t[36]=r=>Y("yAxis"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[39]||(t[39]=r=>ie(r,"yAxis")),onDragenter:oe,onDragover:t[40]||(t[40]=r=>le(r))},[i(o(ne),{list:o(a).yAxis,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Mt,onChange:t[38]||(t[38]=r=>Ae(r,"yAxis"))},{item:n(({element:r,index:D})=>[r.groupType==="d"?(u(),x(Ce,{key:0,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"quota",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:rt,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):r.groupType==="q"?(u(),x(Ue,{key:1,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,type:"quota",themes:$.themes,onOnQuotaItemChange:t[37]||(t[37]=me=>Be(me,"yAxis")),onOnQuotaItemRemove:ze,onOnNameEdit:W,onEditItemFilter:Pe,onEditItemCompare:Re,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):h("",!0)]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).yAxis},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("yAxisExt")?(u(),x(k,{key:1,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",pn,[p("span",null,[O(C(w.value.axisConfig.yAxisExt.name)+" ",1),(m=w.value.axisConfig.yAxisExt)!=null&&m.allowEmpty?h("",!0):(u(),F("i",fn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[41]||(t[41]=r=>Y("yAxisExt"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[44]||(t[44]=r=>ie(r,"yAxisExt")),onDragenter:oe,onDragover:t[45]||(t[45]=r=>le(r))},[i(o(ne),{list:o(a).yAxisExt,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Bt,onChange:t[43]||(t[43]=r=>Ae(r,"yAxisExt"))},{item:n(({element:r,index:D})=>[r.groupType==="d"?(u(),x(Ce,{key:0,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,themes:$.themes,type:"quotaExt",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:W,onOnCustomSort:rt,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):r.groupType==="q"?(u(),x(Ue,{key:1,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,type:"quotaExt",themes:$.themes,onOnQuotaItemChange:t[42]||(t[42]=me=>Be(me,"yAxisExt")),onOnQuotaItemRemove:ze,onOnNameEdit:W,onEditItemFilter:Pe,onEditItemCompare:Re,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):h("",!0)]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).yAxisExt},null,8,["drag-list"])],32)]}),_:1})):h("",!0)],64)):h("",!0),Z("extBubble")?(u(),x(k,{key:9,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",vn,[p("span",hn,[p("span",gn,[O(C(w.value.axisConfig.extBubble.name)+" ",1),(m=w.value.axisConfig.extBubble)!=null&&m.allowEmpty?h("",!0):(u(),F("i",yn))]),w.value.axisConfig.extBubble.tooltip?(u(),x(S,{key:0,class:"item",effect:R.value,placement:"top"},{content:n(()=>[p("span",null,C(w.value.axisConfig.extBubble.tooltip),1)]),default:n(()=>[i(o(T),{class:g(["hint-icon",{"hint-icon--dark":f.themes==="dark"}])},{default:n(()=>[i(I,{name:"icon_info_outlined"},{default:n(()=>[i(o(yt),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect"])):h("",!0)]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[46]||(t[46]=r=>Y("extBubble"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[49]||(t[49]=r=>ie(r,"extBubble")),onDragenter:oe,onDragover:t[50]||(t[50]=r=>le(r))},[i(o(ne),{list:o(a).extBubble,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:zt,onChange:t[48]||(t[48]=r=>Ae(r,"extBubble"))},{item:n(({element:r,index:D})=>[i(Ue,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:D,type:"extBubble",themes:$.themes,onOnQuotaItemChange:t[47]||(t[47]=me=>Be(me,"extBubble")),onOnQuotaItemRemove:ze,onOnNameEdit:W,onEditItemFilter:Pe,onEditItemCompare:Re,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).extBubble},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("drill")?(u(),x(k,{key:10,class:"padding-lr drag-data"},{default:n(()=>[p("div",xn,[p("span",Cn,[p("span",kn,C(o(v)("chart.drill"))+" / "+C(o(v)("chart.dimension")),1),i(S,{class:"item",effect:R.value,placement:"top"},{content:n(()=>[p("span",null,C(o(v)("chart.drill_dimension_tip")),1)]),default:n(()=>[i(o(T),{class:g(["hint-icon",{"hint-icon--dark":f.themes==="dark"}])},{default:n(()=>[i(I,{name:"icon_info_outlined"},{default:n(()=>[i(o(yt),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect"])]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[51]||(t[51]=m=>Y("drillFields"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[52]||(t[52]=m=>ie(m,"drillFields")),onDragenter:oe,onDragover:t[53]||(t[53]=m=>le(m))},[i(o(ne),{list:o(a).drillFields,"item-key":"id",group:"drag",animation:"300",move:ae,class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Pt},{item:n(({element:m,index:r})=>[(u(),x(ai,{key:m.id,index:r,chart:o(a),item:m,"dimension-data":l.dimension,"quota-data":l.quota,themes:$.themes,onOnDimensionItemChange:lo,onOnDimensionItemRemove:io,onOnNameEdit:W,onOnCustomSort:fo,onEditSortPriority:ee},null,8,["index","chart","item","dimension-data","quota-data","themes"]))]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).drillFields},null,8,["drag-list"])],32)]),_:1})):h("",!0),i(k,{class:"padding-lr drag-data no-top-border no-top-padding"},{default:n(()=>[p("div",_n,[p("span",null,C(o(v)("chart.result_filter")),1),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[54]||(t[54]=m=>Y("customFilter"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),qt.value||f.themes==="dark"?(u(),F("div",{key:0,class:g(["tree-btn",{"tree-btn--dark":f.themes==="dark",active:qt.value,invalid:oo.value}]),onClick:ca},[i(o(T),{style:{"margin-right":"2px","font-size":"12px"}},{default:n(()=>[i(I,{class:"svg-background",name:"icon-filter"},{default:n(()=>[i(o(Ta),{class:"svg-icon svg-background"})]),_:1})]),_:1}),p("span",null,C(e.$t("chart.filter")),1)],2)):(u(),x(A,{key:1,class:"tree-btn_secondary",secondary:"",onClick:ca},{icon:n(()=>[i(I,null,{default:n(()=>[i(o(Ta),{class:"svg-icon svg-background"})]),_:1})]),default:n(()=>[p("span",null,C(e.$t("chart.filter")),1)]),_:1}))]),_:1}),ho.value?(u(),x(k,{key:11,class:"refresh-area"},{default:n(()=>[i(_,{class:g(["form-item no-margin-bottom","form-item-"+f.themes])},{default:n(()=>[i(ge,{modelValue:o(a).aggregate,"onUpdate:modelValue":t[55]||(t[55]=m=>o(a).aggregate=m),effect:f.themes,size:"small",onChange:ao},{default:n(()=>[O(C(o(v)("chart.aggregate_time")),1)]),_:1},8,["modelValue","effect"])]),_:1},8,["class"])]),_:1})):h("",!0)],64))]}),_:1}),i(ll,{class:g({"refresh-active-footer":o(a).refreshViewEnable})},{default:n(()=>[i(k,{class:"refresh-area"},{default:n(()=>[i(_,{class:g(["form-item no-margin-bottom","form-item-"+f.themes])},{default:n(()=>[i(ge,{modelValue:o(a).refreshViewEnable,"onUpdate:modelValue":t[56]||(t[56]=d=>o(a).refreshViewEnable=d),effect:f.themes,size:"small",onChange:t[57]||(t[57]=d=>N("render"))},{default:n(()=>[O(C(o(v)("visualization.refresh_frequency")),1)]),_:1},8,["modelValue","effect"])]),_:1},8,["class"]),o(a).refreshViewEnable?(u(),x(k,{key:0},{default:n(()=>[i(_,{class:g(["form-item no-margin-bottom select-append","form-item-"+f.themes])},{default:n(()=>[i(B,{modelValue:o(a).refreshTime,"onUpdate:modelValue":t[60]||(t[60]=d=>o(a).refreshTime=d),modelModifiers:{number:!0},effect:f.themes,class:g([f.themes==="dark"&&"dv-dark"]),size:"small",min:1,max:3600,disabled:!o(a).refreshViewEnable,onChange:Zo},{append:n(()=>[i(Q,{modelValue:o(a).refreshUnit,"onUpdate:modelValue":t[58]||(t[58]=d=>o(a).refreshUnit=d),effect:f.themes,size:"small",placeholder:"Select",style:{width:"80px"},onChange:t[59]||(t[59]=d=>N("render"))},{default:n(()=>[i(P,{effect:f.themes,label:o(v)("visualization.minute"),value:"minute"},null,8,["effect","label"]),i(P,{effect:f.themes,label:o(v)("visualization.second"),value:"second"},null,8,["effect","label"])]),_:1},8,["modelValue","effect"])]),_:1},8,["modelValue","effect","class","disabled"])]),_:1},8,["class"])]),_:1})):h("",!0)]),_:1}),i(k,{class:g(["result-style","result-style-"+f.themes])},{default:n(()=>[p("div",bn,[o(a).type!=="richTextView"?(u(),F("span",wn,C(o(v)("chart.result_count")),1)):h("",!0),o(a).type!=="richTextView"?(u(),F("span",En,[i(xe,{modelValue:o(a).resultMode,"onUpdate:modelValue":t[63]||(t[63]=d=>o(a).resultMode=d),effect:f.themes,class:"radio-span",size:"small",onChange:t[64]||(t[64]=d=>N("render"))},{default:n(()=>[i(V,{class:"margin20-radio",label:"all",effect:f.themes},{default:n(()=>[p("span",{class:g(["result-count-label",{dark:f.themes==="dark"}])},C(o(v)("chart.result_mode_all")),3)]),_:1},8,["effect"]),i(V,{label:"custom",effect:f.themes},{default:n(()=>[i(de,{modelValue:o(a).resultCount,"onUpdate:modelValue":t[61]||(t[61]=d=>o(a).resultCount=d),min:1,max:1e6,controls:!1,effect:f.themes,"step-strictly":!0,"value-on-clear":1e3,disabled:o(a).resultMode==="all",class:"result-count",size:"small",onChange:t[62]||(t[62]=d=>N("calcData"))},null,8,["modelValue","effect","disabled"])]),_:1},8,["effect"])]),_:1},8,["modelValue","effect"])])):h("",!0)]),i(A,{disabled:go.value,type:"primary",class:"result-style-button",onClick:t[65]||(t[65]=d=>Eo(o(a)))},{default:n(()=>[p("span",Sn,C(o(v)("chart.update_chart_data")),1)]),_:1},8,["disabled"])]),_:1},8,["class"])]),_:1},8,["class"])]),_:1})]),_:1},8,["label"]),i(ft,{name:"style",label:o(v)("chart.chart_style"),class:"padding-tab",style:{width:"100%"}},{default:n(()=>[i(c,{direction:"vertical"},{default:n(()=>[i(s,{class:"drag_main_area"},{default:n(()=>{var d,m,r,D;return[(d=o(a).plugin)!=null&&d.isPlugin?(u(),x(o(Ze),{key:0,jsname:o(a).plugin.staticMap["editor-style"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(J)},null,8,["jsname","view","dimension","quota","themes","emitter"])):(u(),F(ce,{key:1},[It.value?(u(),x(Na,{key:0,properties:w.value.properties,"property-inner-all":w.value.propertyInner,"selector-spec":w.value.selectorSpec,"common-background-pop":(m=o(q))==null?void 0:m.commonBackground,"common-border-pop":(r=o(q))==null?void 0:r.style,"event-info":(D=o(q))==null?void 0:D.events,chart:o(a),themes:f.themes,"dimension-data":l.dimension,"quota-data":l.quota,"all-fields":Me.value,onOnColorChange:Jt,onOnMiscChange:Ut,onOnLabelChange:jt,onOnTooltipChange:Yt,onOnChangeXAxisForm:Xt,onOnChangeYAxisForm:Gt,onOnChangeYAxisExtForm:Kt,onOnTextChange:ea,onOnIndicatorChange:Ht,onOnIndicatorNameChange:Wt,onOnLegendChange:ta,onOnBackgroundChange:aa,onOnStyleAttrChange:oa,onOnBasicStyleChange:$t,onOnTableHeaderChange:Rt,onOnTableCellChange:Qt,onOnTableTotalChange:Lt,onOnChangeMiscStyleForm:Zt,onOnExtTooltipChange:la,onOnChangeQuadrantForm:ia,onOnChangeFlowMapLineForm:na,onOnChangeFlowMapPointForm:sa},null,8,["properties","property-inner-all","selector-spec","common-background-pop","common-border-pop","event-info","chart","themes","dimension-data","quota-data","all-fields"])):h("",!0)],64))]}),_:1})]),_:1})]),_:1},8,["label"]),i(ft,{name:"senior",label:o(v)("chart.senior"),class:"padding-tab",style:{width:"100%"}},{default:n(()=>[i(c,{direction:"vertical"},{default:n(()=>[i(s,{class:"drag_main_area"},{default:n(()=>{var d,m;return[(d=o(a).plugin)!=null&&d.isPlugin?(u(),x(o(Ze),{key:0,jsname:o(a).plugin.staticMap["editor-senior"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(J)},null,8,["jsname","view","dimension","quota","themes","emitter"])):(u(),x(Zl,{key:1,chart:o(a),"quota-data":o(a).yAxis,"quota-ext-data":o(a).yAxisExt,"fields-data":Me.value,themes:f.themes,properties:w.value.properties,"property-inner-all":w.value.propertyInner,"event-info":(m=o(q))==null?void 0:m.events,onOnFunctionCfgChange:Fo,onOnAssistLineChange:Io,onOnScrollCfgChange:No,onOnThresholdChange:To,onOnMapMappingChange:qo,onOnBubbleAnimateChange:Do},null,8,["chart","quota-data","quota-ext-data","fields-data","themes","properties","property-inner-all","event-info"]))]}),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue","class"]))]),_:1},8,["style"])]))],2),p("div",{class:g(["dataset-main content-area",{"content-area-close":o(re).datasetAreaCollapse,"content-area-right-open":!o(re).datasetAreaCollapse}])},[i(o(T),{title:e.$t("visualization.dataset"),class:"custom-icon",size:"20px",onClick:t[67]||(t[67]=d=>pa("datasetAreaCollapse"))},{default:n(()=>[o(re).datasetAreaCollapse?(u(),x(y,{key:0,class:"collapse-icon"})):(u(),x(b,{key:1,class:"collapse-icon"}))]),_:1},8,["title"]),o(re).datasetAreaCollapse?(u(),F("div",An,[p("span",Fn,C(o(v)("visualization.dataset")),1)])):h("",!0),o(re).datasetAreaCollapse?h("",!0):(u(),x(c,{key:1,direction:"vertical",class:"dataset-area view-panel-row"},{default:n(()=>[i(nl,{class:"editor-title"},{default:n(()=>[p("span",In,C(o(v)("visualization.dataset")),1)]),_:1}),i(sl,{class:"dataset-main-top"},{default:n(()=>[i(k,{class:"dataset-select"},{default:n(()=>[i(Ci,{ref_key:"datasetSelector",ref:We,modelValue:o(a).tableId,"onUpdate:modelValue":t[68]||(t[68]=d=>o(a).tableId=d),style:{flex:"1"},"view-id":o(a).id,"state-obj":l,themes:f.themes,onAddDsWindow:$o,onOnDatasetChange:Ga},null,8,["modelValue","view-id","state-obj","themes"]),i(S,{effect:R.value,content:e.$t("deDataset.edit_dataset"),placement:"top"},{default:n(()=>[Et.value>=7&&!Ha.value?(u(),x(o(T),{key:0,class:g(["field-search-icon-btn",{dark:f.themes==="dark"}]),style:{"margin-left":"8px"},onClick:Ro},{default:n(()=>[i(I,{name:"icon_edit_outlined",class:"el-icon-arrow-down el-icon-delete"},{default:n(()=>[i(o(Jl),{class:"svg-icon el-icon-arrow-down el-icon-delete"})]),_:1})]),_:1},8,["class"])):h("",!0)]),_:1},8,["effect","content"])]),_:1}),i(k,{class:"dataset-search padding-lr"},{default:n(()=>[p("div",{class:g(["dataset-search-label",{dark:f.themes==="dark"}])},[p("span",null,C(o(v)("chart.field")),1),p("span",null,[i(S,{effect:R.value,content:e.$t("visualization.refresh"),placement:"top"},{default:n(()=>[i(o(T),{class:g(["field-search-icon-btn",{dark:f.themes==="dark"}]),onClick:t[69]||(t[69]=d=>Se(o(a).tableId,o(a).id,o(a).type))},{default:n(()=>[i(I,{name:"icon_refresh_outlined",class:"el-icon-arrow-down el-icon-delete"},{default:n(()=>[i(o(Ul),{class:"svg-icon el-icon-arrow-down el-icon-delete"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"]),h("",!0)])],2),i(B,{modelValue:l.searchField,"onUpdate:modelValue":t[71]||(t[71]=d=>l.searchField=d),size:"middle",effect:f.themes,class:g(["dataset-search-input",{dark:f.themes==="dark"}]),placeholder:o(v)("chart.search")+" "+o(v)("chart.field"),clearable:""},{prefix:n(()=>[i(o(T),{class:"el-input__icon"},{default:n(()=>[i(I,{name:"icon_search-outline_outlined"},{default:n(()=>[i(o(jl),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","effect","class","placeholder"])]),_:1}),ht((u(),F("div",{ref_key:"elDrag",ref:mt,style:{height:"calc(100% - 137px)","min-height":"120px"}},[p("div",{class:g(["padding-lr field-height first right-dimension",{dark:f.themes==="dark","user-select":o(_a)}]),style:Ke({height:Go.value+"px"})},[p("label",null,C(o(v)("chart.dimension")),1),i(s,{class:"drag-list"},{default:n(()=>[(u(!0),F(ce,null,Je(st.value,d=>(u(),F("div",{key:d.id,draggable:!0,class:"item father",onClick:[j(m=>Xe(d),["ctrl"]),j(m=>Xe(d),["meta"]),j(m=>ba(d),["exact"]),j(m=>wa(d),["shift"])],onDragstart:m=>tl(m,d,"dimension"),onDragend:Ea},[p("div",{class:g(["items flex-align-center",["item-dimension--"+f.themes,Te.value&&"is-dragging-item",U.value.map(m=>m.id).includes(d.id)&&"active"]])},[i(o(T),null,{default:n(()=>[i(I,null,{default:n(()=>[(u(),x(Le(xa(d.deType,d.extField)),{class:g(["svg-icon",`field-icon-${o(ke)[[2,3].includes(d.deType)?2:0]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}]),title:d.name},C(d.name),11,qn),d.id!=="-1"&&!d.chartId?(u(),x(o(T),{key:0,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>Sa(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_copy_outlined"},{default:n(()=>[i(o(qa),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class","onClick"])):h("",!0),d.id!=="-1"&&d.chartId?(u(),x(o(T),{key:1,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>Aa(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class","onClick"])):h("",!0),(d.id,h("",!0))],2),U.value.map(m=>m.id).includes(d.id)?(u(),F("div",{key:0,draggable:!0,class:g(["shadow",Te.value&&"is-dragging"]),onDragstart:el,onDragend:pt},[Qe.value?(u(!0),F(ce,{key:0},Je(U.value,m=>(u(),F("div",{key:m.id,class:"items flex-align-center"},[i(o(T),null,{default:n(()=>[i(I,null,{default:n(()=>[(u(),x(Le(o(Ct)[o(ke)[m.deType]]),{class:g(["svg-icon",`field-icon-${o(ke)[[2,3].includes(m.deType)?2:0]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}])},C(m.name),3),(m.id,h("",!0))]))),128)):h("",!0)],34)):h("",!0)],40,Tn))),128))]),_:1}),p("div",{ref_key:"el",ref:ka,style:Ke({top:Ko.value+"px"}),class:g(["drag-vertical",o(_a)&&"is-hovering"])},null,6)],6),p("div",{class:g(["padding-lr field-height right-dimension",{dark:f.themes==="dark"}])},[t[91]||(t[91]=p("div",{class:"divider"},null,-1)),p("label",null,C(o(v)("chart.quota")),1),i(s,{class:"drag-list"},{default:n(()=>[(u(!0),F(ce,null,Je(nt.value,d=>(u(),F("div",{key:d.id,class:"item father",draggable:!0,onClick:[j(m=>Xe(d,"quota"),["ctrl"]),j(m=>Xe(d,"quota"),["meta"]),j(m=>ba(d,"quota"),["exact"]),j(m=>wa(d,"quota"),["shift"])],onDragstart:m=>ol(m,d,"quota"),onDragend:Ea},[p("div",{class:g(["items flex-align-center",["item-dimension--"+f.themes,Te.value&&"is-dragging-item",X.value.map(m=>m.id).includes(d.id)&&"active"]])},[i(o(T),null,{default:n(()=>[i(I,{"class-name":`field-icon-${o(ke)[d.deType]}`},{default:n(()=>[(u(),x(Le(xa(d.deType,d.extField,!0)),{class:g(["svg-icon",`field-icon-${o(ke)[d.deType]}`])},null,8,["class"]))]),_:2},1032,["class-name"])]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}]),title:d.name},C(d.name),11,Dn),d.id!=="-1"&&!d.chartId?(u(),x(o(T),{key:0,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>Sa(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_copy_outlined"},{default:n(()=>[i(o(qa),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class","onClick"])):h("",!0),d.id!=="-1"&&d.chartId?(u(),x(o(T),{key:1,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>Aa(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(K),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class","onClick"])):h("",!0),(d.id,h("",!0))],2),X.value.map(m=>m.id).includes(d.id)?(u(),F("div",{key:0,draggable:!0,class:g(["shadow",Te.value&&"is-dragging"]),onDragstart:al,onDragend:pt},[Qe.value?(u(!0),F(ce,{key:0},Je(X.value,m=>(u(),F("div",{key:m.id,class:"items flex-align-center"},[i(o(T),null,{default:n(()=>[i(I,{"class-name":`field-icon-${o(ke)[m.deType]}`},{default:n(()=>[(u(),x(Le(o(Ct)[o(ke)[m.deType]]),{class:"svg-icon","class-name":`field-icon-${o(ke)[m.deType]}`},null,8,["class-name"]))]),_:2},1032,["class-name"])]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}])},C(m.name),3),(m.id,h("",!0))]))),128)):h("",!0)],34)):h("",!0)],40,Nn))),128))]),_:1})],2)])),[[Fa,ye.value&&!o(Ra)]])]),_:1})]),_:1}))],2)]),_:1})),[[Fa,Qa.value]]),Ft.value?(u(),x(Ei,{key:2,themes:f.themes},null,8,["themes"])):h("",!0),i(Ee,{modelValue:l.renameItem,"onUpdate:modelValue":t[77]||(t[77]=d=>l.renameItem=d),title:o(v)("chart.show_name_set"),visible:l.renameItem,width:"420px","close-on-click-modal":!1},{footer:n(()=>[p("div",Vn,[i(A,{onClick:ra},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:t[76]||(t[76]=d=>Mo(St.value))},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[p("div",{onKeydown:t[74]||(t[74]=j(()=>{},["stop"])),onKeyup:t[75]||(t[75]=j(()=>{},["stop"]))},[i(rl,{ref_key:"renameForm",ref:St,"label-width":"80px","require-asterisk-position":"right",model:l.itemForm,rules:Wa,"label-position":"top",onSubmit:t[73]||(t[73]=j(()=>{},["prevent"]))},{default:n(()=>[i(_,{label:o(v)("dataset.field_origin_name"),class:"name-edit-form"},{default:n(()=>[p("span",On,C(l.itemForm.name),1)]),_:1},8,["label"]),i(_,{label:o(v)("chart.show_name"),class:"name-edit-form no-margin-bottom",prop:"chartShowName"},{default:n(()=>[i(B,{modelValue:l.itemForm.chartShowName,"onUpdate:modelValue":t[72]||(t[72]=d=>l.itemForm.chartShowName=d),class:"text",clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])],32)]),_:1},8,["modelValue","title","visible"]),l.quotaFilterEdit?(u(),x(Ee,{key:3,modelValue:l.quotaFilterEdit,"onUpdate:modelValue":t[78]||(t[78]=d=>l.quotaFilterEdit=d),title:o(v)("chart.add_filter"),visible:l.quotaFilterEdit,"close-on-click-modal":!1,width:"600px",class:"dialog-css"},{footer:n(()=>[p("div",Mn,[i(A,{onClick:da},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Bo},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ei,{item:l.quotaItem},null,8,["item"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.resultFilterEdit?(u(),x(Ee,{key:4,modelValue:l.resultFilterEdit,"onUpdate:modelValue":t[79]||(t[79]=d=>l.resultFilterEdit=d),title:o(v)("chart.add_filter"),visible:l.resultFilterEdit,"close-on-click-modal":!1,width:"600px",class:"dialog-css"},{footer:n(()=>[p("div",Bn,[i(A,{onClick:ua},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Po},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ti,{chart:l.chartForFilter,item:l.filterItem},null,8,["chart","item"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.showEditQuotaCompare?(u(),x(Ee,{key:5,modelValue:l.showEditQuotaCompare,"onUpdate:modelValue":t[80]||(t[80]=d=>l.showEditQuotaCompare=d),title:o(v)("chart.yoy_setting"),visible:l.showEditQuotaCompare,"close-on-click-modal":!1,width:"600px",class:"dialog-css"},{footer:n(()=>[p("div",zn,[i(A,{onClick:fa},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Qo},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ci,{"compare-item":l.quotaItemCompare,chart:o(a),"dimension-data":st.value,"quota-data":nt.value},null,8,["compare-item","chart","dimension-data","quota-data"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.showValueFormatter?(u(),x(Ee,{key:6,modelValue:l.showValueFormatter,"onUpdate:modelValue":t[81]||(t[81]=d=>l.showValueFormatter=d),title:o(v)("chart.value_formatter")+" - "+l.valueFormatterItem.name,visible:l.showValueFormatter,"close-on-click-modal":!1,width:"420px",class:"dialog-css"},{footer:n(()=>[p("div",Pn,[i(A,{onClick:ga},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Uo},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ui,{"formatter-item":l.valueFormatterItem,chart:o(a)},null,8,["formatter-item","chart"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.showCustomSort?(u(),x(Ee,{key:7,modelValue:l.showCustomSort,"onUpdate:modelValue":t[82]||(t[82]=d=>l.showCustomSort=d),title:o(v)("chart.custom_sort")+o(v)("chart.sort"),visible:l.showCustomSort,"close-on-click-modal":!1,width:"372px",class:"dialog-css custom_sort_dialog"},{footer:n(()=>[p("div",$n,[i(A,{onClick:Nt},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:so},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(pi,{chart:o(a),"field-type":fe.value,field:l.customSortField,onOnSortChange:no},null,8,["chart","field-type","field"])]),_:1},8,["modelValue","title","visible"])):h("",!0),i(Ee,{modelValue:l.showSortPriority,"onUpdate:modelValue":t[83]||(t[83]=d=>l.showSortPriority=d),"close-on-click-modal":!1,width:"372px",class:"dialog-css custom_sort_dialog","destroy-on-close":""},{header:n(()=>[p("span",Rn,C(o(v)("chart.sort_priority")),1),p("span",Qn,"("+C(o(v)("chart.sort_priority_tip"))+")",1)]),footer:n(()=>[p("div",Ln,[i(A,{onClick:ha},{default:n(()=>[O(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Lo},{default:n(()=>[O(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(fi,{chart:o(a),onOnPriorityChange:Jo},null,8,["chart"])]),_:1},8,["modelValue"]),i(Ee,{modelValue:De.value,"onUpdate:modelValue":t[86]||(t[86]=d=>De.value=d),width:"1000px",title:lt.value?o(v)("dataset.add_calc_field"):o(v)("dataset.edit_calc_field"),"close-on-click-modal":!1},{footer:n(()=>[i(A,{secondary:"",onClick:t[84]||(t[84]=d=>ya())},{default:n(()=>[O(C(o(v)("dataset.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:t[85]||(t[85]=d=>Wo())},{default:n(()=>[O(C(o(v)("dataset.confirm")),1)]),_:1})]),default:n(()=>[i(hi,{ref_key:"calcEdit",ref:Oe},null,512)]),_:1},8,["modelValue","title"])],34),i(Kl,{ref_key:"filterTree",ref:ma,onFilterData:zo},null,512),i(o(Hl),{ref_key:"openHandler",ref:$e,jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvT3BlbkhhbmRsZXI="},null,512),o(He)?(u(),x(Rl,{key:0,to:"#component-name"},[ht(p("input",{ref_key:"componentNameInput",ref:bt,"onUpdate:modelValue":t[89]||(t[89]=d=>o(H).name=d),effect:f.themes,width:"100%",onChange:Ja,onBlur:Ua},null,40,Jn),[[$l,o(H).name]])])):h("",!0)],64)}}});const Rc=Ni(Un,[["__scopeId","data-v-f2c61755"]]);export{Rc as default};
