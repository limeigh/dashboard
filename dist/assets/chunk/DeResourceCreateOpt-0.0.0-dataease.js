import{E as v,P as $,C as M,i as q,p as P,r as W,M as A,v as J}from"./element-plus-secondary-0.0.0-dataease.js";import{d as X,r as Y,l as Z,k as w,w as j,o as f,T as _,U as o,$ as G,W as a,_ as s,Y as u,u as n,a as H,R as y,Z as h,X as K}from"./@vue-0.0.0-dataease.js";import{i as Q}from"./template-0.0.0-dataease.js";import{h as tt}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as et}from"./imgUtils-0.0.0-dataease.js";import{h as ot}from"./dataVisualization-0.0.0-dataease.js";import at from"./DeTemplatePreviewList-0.0.0-dataease.js";import{_ as it}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./icon_operation-analysis_outlined-0.0.0-dataease.js";const rt=X({__name:"DeResourceCreateOpt",props:{curCanvasType:{type:String,required:!0}},emits:["finish"],setup(S,{expose:D,emit:V}){const{t:r}=tt(),I=V,C=Y(null),k=S,t=Z({dialogShow:!1,loading:!1,inputType:"new_outer_template",fieldName:"name",tableRadio:null,keyWordSearch:"",columnLabel:r("visualization.belong_to_category"),templateList:[],importTemplateInfo:{snapshot:""},dvCreateInfo:{pid:-1,name:null,canvasStyleData:null,componentData:null,templateId:null,dynamicData:null,staticResource:null},templateSelected:!1}),b=w(()=>t.dvCreateInfo.name&&t.templateSelected),g=w(()=>t.importTemplateInfo.snapshot?{background:`url(${et(t.importTemplateInfo.snapshot)}) no-repeat`}:{});j(()=>t.inputType,()=>{T()});const T=()=>{t.templateSelected=!1,t.dvCreateInfo.name=null,t.dvCreateInfo.canvasStyleData=null,t.dvCreateInfo.componentData=null,t.importTemplateInfo.snapshot=null,t.dvCreateInfo.templateId=null},z=i=>{t.dvCreateInfo.templateId=i.id,i.nodeType==="folder"?(t.dvCreateInfo.name=null,t.importTemplateInfo.snapshot=null,t.templateSelected=!1):(t.dvCreateInfo.name=i.name,t.importTemplateInfo.snapshot=i.snapshot,t.templateSelected=!0)},R=()=>{const i={level:"0",leafDvType:k.curCanvasType,withChildren:!0};t.loading=!0,Q(i).then(e=>{t.templateList=e.data,t.loading=!1})},x=()=>{I("finish")},E=()=>{if(!t.dvCreateInfo.name)return v.warning(r("common.save_success")),!1;if(t.dvCreateInfo.name.length>50)return v.warning(r("common.char_can_not_more_50")),!1;if(!t.dvCreateInfo.templateId&&t.inputType==="new_inner_template")return v.warning("chart.template_can_not_empty"),!1;t.dvCreateInfo.newFrom=t.inputType,t.loading=!0,ot(t.dvCreateInfo).then(i=>{t.loading=!1,I("finish",i.data)}).catch(()=>{t.loading=!1})},L=i=>{const e=i.target.files[0],d=new FileReader;d.onload=l=>{t.templateSelected=!0;const c=l.target.result;t.importTemplateInfo=JSON.parse(c),t.dvCreateInfo.name=t.importTemplateInfo.name.name,t.dvCreateInfo.canvasStyleData=t.importTemplateInfo.canvasStyleData,t.dvCreateInfo.componentData=t.importTemplateInfo.componentData,t.dvCreateInfo.dynamicData=t.importTemplateInfo.dynamicData,t.dvCreateInfo.staticResource=t.importTemplateInfo.staticResource},d.readAsText(e)},N=()=>{C.value.click()},U=()=>{t.dialogShow=!1};return D({optInit:()=>{t.dialogShow=!0,T()}}),(i,e)=>{const d=$,l=M,c=q,m=P,B=W,F=A,O=J;return f(),_(F,{class:"create-dialog",title:n(r)("visualization.new_from_template"),modelValue:t.dialogShow,"onUpdate:modelValue":e[5]||(e[5]=p=>t.dialogShow=p),width:"700","before-close":U,onSubmit:e[6]||(e[6]=K(()=>{},["prevent"]))},{default:o(()=>[G((f(),_(m,{class:"create-main"},{default:o(()=>[a(m,null,{default:o(()=>[a(l,{span:18,style:{height:"40px"}},{default:o(()=>[a(d,{modelValue:t.inputType,"onUpdate:modelValue":e[0]||(e[0]=p=>t.inputType=p),label:"new_outer_template"},{default:o(()=>[s(u(n(r)("visualization.import_template")),1)]),_:1},8,["modelValue"]),a(d,{modelValue:t.inputType,"onUpdate:modelValue":e[1]||(e[1]=p=>t.inputType=p),label:"new_inner_template",onClick:R},{default:o(()=>[s(u(n(r)("visualization.copy_template")),1)]),_:1},8,["modelValue"])]),_:1}),t.inputType==="new_outer_template"?(f(),_(l,{key:0,span:6,class:"button-main"},{default:o(()=>[a(c,{class:"el-icon-upload",size:"small",type:"primary",onClick:N},{default:o(()=>[s(u(n(r)("visualization.upload_template")),1)]),_:1}),H("input",{id:"input",ref_key:"files",ref:C,type:"file",accept:".DET2",hidden:"",onChange:L},null,544)]),_:1})):y("",!0)]),_:1}),a(m,{style:{"margin-top":"5px"}},{default:o(()=>[a(l,{span:4,class:"name-area"},{default:o(()=>[s(u(n(r)("visualization.name")),1)]),_:1}),a(l,{span:20},{default:o(()=>[a(B,{modelValue:t.dvCreateInfo.name,"onUpdate:modelValue":e[2]||(e[2]=p=>t.dvCreateInfo.name=p),clearable:"",size:"small"},null,8,["modelValue"])]),_:1})]),_:1}),t.inputType==="new_inner_template"?(f(),_(m,{key:0,class:"preview"},{default:o(()=>[a(l,{span:8,style:{height:"100%","overflow-y":"auto"}},{default:o(()=>[a(at,{"template-list":t.templateList,onShowCurrentTemplateInfo:z},null,8,["template-list"])]),_:1}),a(l,{span:16,style:h(g.value),class:"preview-show"},null,8,["style"])]),_:1})):y("",!0),t.inputType==="new_outer_template"?(f(),_(m,{key:1,class:"preview",style:h(g.value)},null,8,["style"])):y("",!0),a(m,{class:"root-class"},{default:o(()=>[a(c,{size:"small",onClick:e[3]||(e[3]=p=>x())},{default:o(()=>[s(u(n(r)("commons.cancel")),1)]),_:1}),a(c,{type:"primary",size:"small",disabled:!b.value,onClick:e[4]||(e[4]=p=>E())},{default:o(()=>[s(u(n(r)("commons.confirm")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})),[[O,t.loading]])]),_:1},8,["title","modelValue"])}}});const zo=it(rt,[["__scopeId","data-v-afa0ea15"]]);export{zo as default};
