import{_ as M,A as U,y as Y,w as F,B as L,a9 as O,x as I}from"./element-plus-secondary-0.0.0-dataease.js";import{g as j,a as z,c as P,d as R,e as S,f as $,h as A,i as W,j as q}from"./time-format-0.0.0-dataease.js";import{d as B,r as G,t as H,k as V,w as J,a7 as K,o as i,T as d,u as k,U as n,W as o,c as T,S as g,a8 as C,a as Q,z as X,R as x}from"./@vue-0.0.0-dataease.js";import{f as Z}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{_ as ee}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const ae=B({__name:"DynamicTimeForViewFilter",props:{config:{type:Object,default:()=>({relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",arbitraryTime:new Date,timeGranularity:"year"})}},setup(w){const h=w,r=G(),{config:v}=H(h),e=V(()=>{const{relativeToCurrent:m,timeNum:u,relativeToCurrentType:s,around:p,arbitraryTime:y,timeGranularity:t}=v.value;return{relativeToCurrent:m,timeNum:u,relativeToCurrentType:s,around:p,arbitraryTime:y,timeGranularity:t}});J(()=>e.value,()=>{c()},{deep:!0});const c=()=>{const{relativeToCurrent:m,timeNum:u,relativeToCurrentType:s,around:p,arbitraryTime:y,timeGranularity:t}=e.value;if(m==="custom")r.value=j(u,s,t,p,t==="datetime"?y:null);else switch(m){case"thisYear":r.value=q();break;case"lastYear":r.value=W();break;case"thisMonth":r.value=A();break;case"lastMonth":r.value=$();break;case"today":r.value=S();break;case"yesterday":r.value=R();break;case"monthBeginning":r.value=P();break;case"yearBeginning":r.value=z();break}};return K(()=>{c()}),(m,u)=>{const s=M;return i(),d(s,{disabled:"",class:"date-editor_granularity",key:k(v).timeGranularity,modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=p=>r.value=p),type:k(v).timeGranularity,placeholder:m.$t("commons.date.select_date_time")},null,8,["modelValue","type","placeholder"])}}});const te=B({__name:"TimeDialog",setup(w,{expose:h}){const{t:r}=Z(),v={relativeToCurrent:"custom",timeGranularity:"year",timeNum:0,relativeToCurrentType:"year",around:"b",arbitraryTime:new Date},e=G({...v}),c=t=>{e.value={...v,...t}},m=[{label:"前",value:"f"},{label:"后",value:"b"}],u=V(()=>{let t=[];if(!e.value)return t;switch(e.value.timeGranularity){case"year":t=[{label:"今年",value:"thisYear"},{label:"去年",value:"lastYear"}];break;case"month":t=[{label:"本月",value:"thisMonth"},{label:"上月",value:"lastMonth"}];break;case"date":t=[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"月初",value:"monthBeginning"},{label:"年初",value:"yearBeginning"}];break;case"datetime":t=[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"月初",value:"monthBeginning"},{label:"年初",value:"yearBeginning"}];break}return[...t,{label:"自定义",value:"custom"}]}),s=V(()=>{if(!e.value)return[];let t=["year","month","date","datetime"].indexOf(e.value.timeGranularity)+1;return[{label:"年",value:"year"},{label:"月",value:"month"},{label:"日",value:"date"}].slice(0,t)}),p=t=>{var l;["year","month","date","datetime"].indexOf(t)<["year","month","date"].indexOf(e.value.relativeToCurrentType)&&(e.value.relativeToCurrentType="year"),e.value.relativeToCurrent!=="custom"&&(e.value.relativeToCurrent=(l=u.value[0])==null?void 0:l.value)},y=[{label:"年",value:"year"},{label:"年月",value:"month"},{label:"年月日",value:"date"},{label:"年月日时分秒",value:"datetime"}];return h({init:c,curComponent:e}),(t,l)=>{const b=U,_=Y,f=F,N=L,D=O,E=I;return i(),d(E,{"label-position":"top"},{default:n(()=>[o(f,{label:"时间粒度"},{default:n(()=>[o(_,{onChange:p,style:{width:"100%"},placeholder:"请选择时间粒度",modelValue:e.value.timeGranularity,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.timeGranularity=a)},{default:n(()=>[(i(),T(g,null,C(y,a=>o(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"相对当前"},{default:n(()=>[o(_,{style:{width:"100%"},modelValue:e.value.relativeToCurrent,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.relativeToCurrent=a)},{default:n(()=>[(i(!0),T(g,null,C(u.value,a=>(i(),d(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.value.relativeToCurrent==="custom"?(i(),d(f,{key:0},{default:n(()=>[Q("div",{style:{width:"100%"},class:X(["no-with-date",e.value.timeGranularity==="datetime"&&"with-date"])},[o(N,{modelValue:e.value.timeNum,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.timeNum=a),min:0,"controls-position":"right"},null,8,["modelValue"]),o(_,{modelValue:e.value.relativeToCurrentType,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.relativeToCurrentType=a)},{default:n(()=>[(i(!0),T(g,null,C(s.value,a=>(i(),d(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(_,{modelValue:e.value.around,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.around=a)},{default:n(()=>[(i(),T(g,null,C(m,a=>o(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e.value.timeGranularity==="datetime"?(i(),d(D,{key:0,style:{width:"108px","margin-left":"8px"},modelValue:e.value.arbitraryTime,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.arbitraryTime=a)},null,8,["modelValue"])):x("",!0)],2)]),_:1})):x("",!0),o(f,{label:k(r)("template_manage.preview")},{default:n(()=>[o(ae,{style:{width:"100%"},config:e.value,isConfig:""},null,8,["config"])]),_:1},8,["label"])]),_:1})}}});const ia=ee(te,[["__scopeId","data-v-02becde4"]]);export{ia as default};
