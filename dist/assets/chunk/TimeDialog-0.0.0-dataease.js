import"./index-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{E as M}from"./el-time-picker-0.0.0-dataease.js";import{o as Y}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import{E as F,a as L}from"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{a as U,E as O}from"./el-select-0.0.0-dataease.js";import{E as j}from"./el-date-picker-0.0.0-dataease.js";import{g as I,a as P,c as S,d as $,e as z,f as R,h as W,i as q,j as A}from"./time-format-0.0.0-dataease.js";import{d as B,r as E,t as H,y as V,w as J,aj as K,f as u,g as p,u as k,i,j as o,O as g,W as T,a6 as C,P as Q,S as X,_ as x}from"./vue-0.0.0-dataease.js";import{E as Z}from"./index-0.0.0-dataease20.js";import{_ as ee}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./dayjs.min-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";const ae=B({__name:"DynamicTimeForViewFilter",props:{config:{type:Object,default:()=>({relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",arbitraryTime:new Date,timeGranularity:"year"})}},setup(w){const h=w,r=E(),{config:d}=H(h),e=V(()=>{const{relativeToCurrent:m,timeNum:n,relativeToCurrentType:s,around:v,arbitraryTime:y,timeGranularity:t}=d.value;return{relativeToCurrent:m,timeNum:n,relativeToCurrentType:s,around:v,arbitraryTime:y,timeGranularity:t}});J(()=>e.value,()=>{c()},{deep:!0});const c=()=>{const{relativeToCurrent:m,timeNum:n,relativeToCurrentType:s,around:v,arbitraryTime:y,timeGranularity:t}=e.value;if(m==="custom")r.value=I(n,s,t,v,t==="datetime"?y:null);else switch(m){case"thisYear":r.value=A();break;case"lastYear":r.value=q();break;case"thisMonth":r.value=W();break;case"lastMonth":r.value=R();break;case"today":r.value=z();break;case"yesterday":r.value=$();break;case"monthBeginning":r.value=S();break;case"yearBeginning":r.value=P();break}};return K(()=>{c()}),(m,n)=>{const s=j;return u(),p(s,{disabled:"",class:"date-editor_granularity",key:k(d).timeGranularity,modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=v=>r.value=v),type:k(d).timeGranularity,placeholder:m.$t("commons.date.select_date_time")},null,8,["modelValue","type","placeholder"])}}});const te=B({__name:"TimeDialog",setup(w,{expose:h}){const{t:r}=Y(),d={relativeToCurrent:"custom",timeGranularity:"year",timeNum:0,relativeToCurrentType:"year",around:"b",arbitraryTime:new Date},e=E({...d}),c=t=>{e.value={...d,...t}},m=[{label:"前",value:"f"},{label:"后",value:"b"}],n=V(()=>{let t=[];if(!e.value)return t;switch(e.value.timeGranularity){case"year":t=[{label:"今年",value:"thisYear"},{label:"去年",value:"lastYear"}];break;case"month":t=[{label:"本月",value:"thisMonth"},{label:"上月",value:"lastMonth"}];break;case"date":t=[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"月初",value:"monthBeginning"},{label:"年初",value:"yearBeginning"}];break;case"datetime":t=[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"月初",value:"monthBeginning"},{label:"年初",value:"yearBeginning"}];break}return[...t,{label:"自定义",value:"custom"}]}),s=V(()=>{if(!e.value)return[];let t=["year","month","date","datetime"].indexOf(e.value.timeGranularity)+1;return[{label:"年",value:"year"},{label:"月",value:"month"},{label:"日",value:"date"}].slice(0,t)}),v=t=>{var l;["year","month","date","datetime"].indexOf(t)<["year","month","date"].indexOf(e.value.relativeToCurrentType)&&(e.value.relativeToCurrentType="year"),e.value.relativeToCurrent!=="custom"&&(e.value.relativeToCurrent=(l=n.value[0])==null?void 0:l.value)},y=[{label:"年",value:"year"},{label:"年月",value:"month"},{label:"年月日",value:"date"},{label:"年月日时分秒",value:"datetime"}];return h({init:c,curComponent:e}),(t,l)=>{const b=U,_=O,f=F,G=Z,N=M,D=L;return u(),p(D,{"label-position":"top"},{default:i(()=>[o(f,{label:"时间粒度"},{default:i(()=>[o(_,{onChange:v,style:{width:"100%"},placeholder:"请选择时间粒度",modelValue:e.value.timeGranularity,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.timeGranularity=a)},{default:i(()=>[(u(),g(T,null,C(y,a=>o(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"相对当前"},{default:i(()=>[o(_,{style:{width:"100%"},modelValue:e.value.relativeToCurrent,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.relativeToCurrent=a)},{default:i(()=>[(u(!0),g(T,null,C(n.value,a=>(u(),p(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.value.relativeToCurrent==="custom"?(u(),p(f,{key:0},{default:i(()=>[Q("div",{style:{width:"100%"},class:X(["no-with-date",e.value.timeGranularity==="datetime"&&"with-date"])},[o(G,{modelValue:e.value.timeNum,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.timeNum=a),min:0,"controls-position":"right"},null,8,["modelValue"]),o(_,{modelValue:e.value.relativeToCurrentType,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.relativeToCurrentType=a)},{default:i(()=>[(u(!0),g(T,null,C(s.value,a=>(u(),p(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(_,{modelValue:e.value.around,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.around=a)},{default:i(()=>[(u(),g(T,null,C(m,a=>o(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e.value.timeGranularity==="datetime"?(u(),p(N,{key:0,style:{width:"108px","margin-left":"8px"},modelValue:e.value.arbitraryTime,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.arbitraryTime=a)},null,8,["modelValue"])):x("",!0)],2)]),_:1})):x("",!0),o(f,{label:k(r)("template_manage.preview")},{default:i(()=>[o(ae,{style:{width:"100%"},config:e.value,isConfig:""},null,8,["config"])]),_:1},8,["label"])]),_:1})}}});const De=ee(te,[["__scopeId","data-v-02becde4"]]);export{De as default};
