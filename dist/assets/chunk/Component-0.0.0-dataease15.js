import{k as E}from"./DeShortcutKey-0.0.0-dataease.js";import{e as z}from"./eventBus-0.0.0-dataease.js";import{d as $}from"./dvMain-0.0.0-dataease.js";import{d as N,r as n,t as j,af as A,y as _,a as U,o as F,u as m,f as x,O as g,P as k,S as G,T as h,n as J}from"./vue-0.0.0-dataease.js";import{_ as Q}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./snapshot-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./util-0.0.0-dataease.js";import"./canvasStyle-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./style-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./index-0.0.0-dataease21.js";import"./antv-0.0.0-dataease.js";import"./index-0.0.0-dataease22.js";import"./tslib.es6-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./canvasUtils-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./ModelUtil-0.0.0-dataease.js";const X=["contenteditable","innerHTML"],Y=["innerHTML"],Z=N({__name:"Component",props:{propValue:{type:String,required:!0,default:""},element:{type:Object,default(){return{id:null,propValue:""}}},showPosition:{required:!1,type:String,default:"preview"}},emits:["input"],setup(C,{emit:T}){const o=n(!1),v=n(17),s=n(!1),M=T,r=n(null),u=n(null),p=n("100%"),c=n("100%");let i=null;const d=n(200),S=C,{element:t,showPosition:f}=j(S),w=$(),{editMode:V,curComponent:L}=A(w),P=()=>{L.value.id!==t.value.id&&(o.value=!1)},b=e=>{M("input",t.value,e.target.innerHTML)},B=e=>{o.value&&e.stopPropagation(),e.keyCode==v.value?s.value=!0:(s.value&&o.value&&E.includes(e.keyCode)||e.keyCode==46)&&e.stopPropagation()},H=e=>{o.value&&e.stopPropagation(),e.keyCode==v.value&&(s.value=!1)},I=e=>{o.value&&e.stopPropagation()},O=e=>{e.preventDefault();const l=e.clipboardData.getData("text/plain")||"";l!==""&&document.execCommand("insertText",!1,l)},D=e=>{t.value.propValue=e.target.innerHTML||"",e.target.innerHTML!==""?t.value.propValue=e.target.innerHTML:(t.value.propValue="",J(function(){t.value.propValue=""})),o.value=!1},q=_(()=>!o.value&&!t.value.resizing&&!t.value.dragging),K=()=>{["canvas","canvasDataV","edit"].includes(f.value)&&!t.value.isLock&&(o.value=!0,R(r.value))},R=e=>{const a=window.getSelection(),l=document.createRange();l.selectNodeContents(e),a.removeAllRanges(),a.addRange(l)};U(()=>{z.off("componentClick",P),i&&(clearInterval(i),i=null)});const y=_(()=>[{"--scroll-speed":`${t.value.style.scrollSpeed===0||!u.value?0:(d.value+r.value.clientWidth)/t.value.style.scrollSpeed}s`,"--scroll-scale0":`${p.value}`,"--scroll-scale100":`${c.value}`}]),W=()=>{i=setInterval(()=>{const e=["canvas","canvasDataV","edit"].includes(f.value)?"shape-id-"+t.value.id:"wrapper-outer-id-"+t.value.id,a=document.getElementById(e);if(a&&r.value){const l=r.value.clientWidth;d.value=a.clientWidth,p.value=d.value*100/l+"%",c.value="-100%"}else p.value="100%",c.value="-100%"},1e3)};return F(()=>{W()}),(e,a)=>m(V)=="edit"?(x(),g("div",{key:0,style:h(y.value),class:"v-text",ref_key:"textOut",ref:u,onKeydown:B,onKeyup:H,onDblclick:K},[k("div",{ref_key:"text",ref:r,contenteditable:o.value,class:G({"can-edit":o.value,"marquee-txt":q.value}),tabindex:"0",onPaste:O,onMousedown:I,onBlur:D,onInput:b,innerHTML:m(t).propValue},null,42,X)],36)):(x(),g("div",{key:1,class:"v-text preview",ref_key:"textOut",ref:u,style:h(y.value)},[k("div",{class:"marquee-txt",ref_key:"text",ref:r,innerHTML:m(t).propValue},null,8,Y)],4))}});const ze=Q(Z,[["__scopeId","data-v-262be76f"]]);export{ze as default};
