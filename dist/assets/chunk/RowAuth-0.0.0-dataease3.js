import{h as G}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import H from"./AuthTree-0.0.0-dataease3.js";import{d as J,r as M,k as I,o as k,c as A,W as K,a as N}from"./@vue-0.0.0-dataease.js";import{_ as Q}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./element-plus-secondary-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./FilterFiled-0.0.0-dataease3.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./field-list-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";const Z={class:"rowAuth"},b={width:"388",height:"100%",class:"real-line"},j=["d"],tt={width:"388",height:"100%",class:"dash-line"},et=["d"],it=J({__name:"RowAuth",emits:["save"],setup(rt,{expose:B,emit:Y}){const{t:u}=G(),p=M(""),_=M("or"),a=M([]),O=I(()=>{const i=a.value.length;let t={x:0,y:0,child:a.value};return t.y=Math.floor(C(t,0)/2),i?R(t):""}),P=I(()=>{const i=a.value.length;let t={x:0,y:0,child:a.value};return t.y=Math.floor(C(t,0)/2),i?E(t):"M48 20 L68 20"}),S=i=>{const{items:t}=i;_.value=i.logic||"or",a.value=T(t||[])},z=()=>{p.value="",q("save",{logic:_.value,items:x(a.value),errorMessage:p.value})},F=({enumValue:i,deType:t,filterType:e,term:r,value:l,name:o})=>{if(!o){p.value=u("data_set.cannot_be_empty_");return}if(e==="logic"){if(!r){p.value=u("data_set.cannot_be_empty_de_ruler");return}if(!r.includes("null")&&!r.includes("empty")&&l===""){p.value=u("chart.filter_value_can_null");return}if([2,3].includes(t)&&parseFloat(l).toString()==="NaN"){p.value=u("chart.filter_value_can_not_str");return}}if(e==="enum"&&i.length<1){p.value=u("chart.enum_value_can_not_null");return}},T=i=>{const t=[];return i.forEach(e=>{const{subTree:r}=e;if(r){const{items:l=[],logic:o}=r,n=T(l);t.push({logic:o,child:n})}else{const{enumValue:l,fieldId:o,filterType:n,term:s,value:c,field:h}=e,{name:d,deType:v}=h||{};t.push({enumValue:l.join(","),fieldId:o,filterType:n,term:s,value:c,name:d,deType:v})}}),t},x=i=>{const t=[];return i.forEach(e=>{const{child:r=[]}=e;if(r.length){const{logic:l}=e,o=x(r);t.push({enumValue:[],fieldId:"",filterType:"",term:"",type:"tree",value:"",subTree:{logic:l,items:o}})}else{const{enumValue:l,fieldId:o,filterType:n,deType:s,term:c,value:h,name:d}=e;F({deType:s,enumValue:l,filterType:n,term:c,value:h,name:d}),o&&t.push({enumValue:l?l.split(","):[],fieldId:o,filterType:n,term:c,value:h,type:"item",subTree:null})}}),t},U=()=>{a.value=[]},f=i=>{var e;const[t]=i;return(e=t.child)!=null&&e.length?f(t.child):t.y},E=i=>{var r,l;const t=(r=i.child)==null?void 0:r.length;let e="";if(!t&&Array.isArray(i.child)){const{x:o,y:n}=i;e+=`M${48+o*68} ${n*41.4+20} L${88+o*68} ${n*41.4+20}`}else if((l=i.child)!=null&&l.length){let o=Math.max(D(i,0),m(i.child,0)+f(i.child)-1),n=m(i.child,0)*41.4/2+(f(i.child)||0)*41.4;const{x:s}=i;e+=`M${24+s*68} ${n} L${24+s*68} ${o*41.4+20} L${64+s*68} ${o*41.4+20}`,i.child.forEach(c=>{e+=E(c)})}return e},R=i=>{const t=i.child.length;if(!t)return"";let e="";const{x:r,y:l}=i;return i.child.forEach((o,n)=>{var h,d,v,V;const{y:s,z:c}=o;if((h=o.child)!=null&&h.length){let y=m(i.child,0)*41.4/2+(f(i.child)||0)*41.4,$=m(o.child,0)*41.4/2+f(o.child)*41.4,L=0,g=0;y<$?(L=y,g=$):[L,g]=[$,y],l>=s&&(L=y,g=$),e+=`M${24+r*68} ${L} L${24+r*68} ${g} L${68+r*68} ${g}`,e+=R(o)}(d=o.child)!=null&&d.length||(s>=l?e+=`M${24+r*68} ${l*40} L${24+r*68} ${(s+1)*41.4-20.69921875} L${68+r*68} ${(s+1)*41.4-20.69921875}`:e+=`M${24+r*68} ${(s+(t===1&&n===0?0:1)+((V=(v=i.child[n+1])==null?void 0:v.child)!=null&&V.length?l-s-1:0))*41.4+20+(t===1&&n===0?26:0)} L${24+r*68} ${(s+1)*41.4-20.69921875-(t===1&&n===0?(c||0)*1.4:0)} L${68+r*68} ${(s+1)*41.4-20.69921875-(t===1&&n===0?(c||0)*1.4:0)}`)}),e},w=(i,t)=>{i.forEach(e=>{e.child&&(e.logic=t==="and"?"or":"and",w(e.child,e.logic))})},m=(i,t)=>(i.forEach(e=>{var r;(r=e.child)!=null&&r.length?t=m(e.child,t):t+=1}),t+=1,t),D=(i,t)=>(i.child.forEach(e=>{var r;(r=e.child)!=null&&r.length?t=D(e,t):t=Math.max(t,e.y,i.y)}),t),C=(i,t)=>(i.child.forEach(e=>{var r;if(e.x=i.x+1,(r=e.child)!=null&&r.length){let l=m(e.child,0);e.y=Math.floor(l/2)+t,t=C(e,t)}else t+=1,e.y=t-1}),t+=1,t),W=(i,t)=>{a.value.push(i==="condition"?{fieldId:"",value:"",enumValue:"",term:"",filterType:"logic",name:"",deType:""}:{child:[],logic:t})},X=i=>{a.value.splice(i,1)};B({init:S,submit:z});const q=Y;return(i,t)=>(k(),A("div",Z,[K(H,{onDel:t[0]||(t[0]=e=>X(e)),onAddCondReal:W,onRemoveRelationList:U,onChangeAndOrDfs:t[1]||(t[1]=e=>w(a.value,e)),relationList:a.value,logic:_.value,"onUpdate:logic":t[2]||(t[2]=e=>_.value=e)},null,8,["relationList","logic"]),(k(),A("svg",b,[N("path",{"stroke-linejoin":"round","stroke-linecap":"round",d:O.value,fill:"none",stroke:"#CCCCCC","stroke-width":"0.5"},null,8,j)])),(k(),A("svg",tt,[N("path",{"stroke-linejoin":"round","stroke-linecap":"round",d:P.value,fill:"none",stroke:"#CCCCCC","stroke-width":"0.5","stroke-dasharray":"4,4"},null,8,et)]))]))}});const ge=Q(it,[["__scopeId","data-v-21e8b8eb"]]);export{ge as default};
