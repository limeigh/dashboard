import{e as ot,T as it,f as at,y as rt,h as lt,A as nt}from"./element-plus-secondary-0.0.0-dataease.js";import{h as st,f as pt}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{o as a,c as s,a as y,aU as ct,d as dt,r as H,b as mt,n as W,w as ut,k as N,x as A,W as n,U as m,T as Z,V as G,u as f,Y as S,_ as ft,R as b,S as j,z as E,$ as vt,a0 as ht,a8 as wt}from"./@vue-0.0.0-dataease.js";import{c as Ct}from"./copilot-0.0.0-dataease.js";import{X as K,Y as P,_ as Y}from"./@antv-0.0.0-dataease.js";import{n as _t}from"./@vueuse-0.0.0-dataease.js";import{d as gt}from"./imgUtils-0.0.0-dataease.js";import{E as yt}from"./exceljs-0.0.0-dataease.js";import{_ as xt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./mathjs-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";const Vt={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function kt(i,t){return a(),s("svg",Vt,[...t[0]||(t[0]=[y("path",{d:"M0.713135 21.4739V1.80273C0.713135 1.52659 0.936992 1.30273 1.21313 1.30273H2.26008C2.53623 1.30273 2.76008 1.52659 2.76008 1.80273V20.5523H22.5686C22.8447 20.5523 23.0686 20.7761 23.0686 21.0523V22.0992C23.0686 22.3754 22.8447 22.5992 22.5686 22.5992H1.83907C1.54045 22.5992 1.25407 22.4806 1.04291 22.2694C0.83176 22.0583 0.713135 21.7725 0.713135 21.4739Z"},null,-1),y("path",{d:"M4.19544 18.3911C3.96872 18.2313 3.91539 17.9175 4.07659 17.6918L8.90155 10.9358C8.97757 10.8235 9.07516 10.7274 9.18865 10.6531C9.30213 10.5788 9.42925 10.5278 9.56262 10.5031C9.69599 10.4784 9.83293 10.4804 9.96551 10.5091C10.0981 10.5377 10.2236 10.5925 10.3349 10.6701L15.7191 14.2624L20.9481 8.16625C21.1291 7.95528 21.4474 7.93239 21.6567 8.11531L22.4497 8.80844C22.6562 8.98892 22.6788 9.30208 22.5003 9.51031L16.6806 16.2998C16.5179 16.4883 16.2919 16.611 16.0452 16.6449C15.7984 16.6788 15.5478 16.6215 15.3402 16.4839L10.0275 12.9315L5.77196 18.8941C5.61221 19.118 5.30171 19.1708 5.07694 19.0124L4.19544 18.3911Z"},null,-1)])])}const Ht={render:kt},bt={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function Tt(i,t){return a(),s("svg",bt,[...t[0]||(t[0]=[y("path",{d:"M2.49993 20V11.5455C2.49993 10.9681 2.97962 10.5 3.57136 10.5H7.99993V3.05263C7.99993 2.47128 8.5116 2 9.14279 2H14.8571C15.4883 2 15.9999 2.47128 15.9999 3.05263V8H20.4285C21.0202 8 21.4999 8.44772 21.4999 9V20H22.4998C22.7759 20 22.9998 20.2239 22.9998 20.5V21.5C22.9998 21.7761 22.7759 22 22.4998 22H1.49976C1.22361 22 0.999756 21.7761 0.999756 21.5V20.5C0.999756 20.2239 1.22361 20 1.49976 20H2.49993ZM19.4999 20V10H15.9999V20H19.4999ZM13.9999 20V4H9.99993V20H13.9999ZM7.99993 20V12.5H4.49993V20H7.99993Z"},null,-1)])])}const $t={render:Tt},Lt={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function It(i,t){return a(),s("svg",Lt,[...t[0]||(t[0]=[y("path",{d:"M12.0001 21.3333C17.1547 21.3333 21.3334 17.1547 21.3334 12C18.2223 12 15.1112 12 12.0001 12C12.0001 8.26667 12.0001 5.15556 12.0001 2.66667C6.84542 2.66667 2.66675 6.84534 2.66675 12C2.66675 17.1547 6.84542 21.3333 12.0001 21.3333ZM10.1667 12.7667C10.1667 13.3558 10.6443 13.8333 11.2334 13.8333H19.3334C18.5064 17.0465 15.4714 19.3333 12.0001 19.3333C7.88571 19.3333 4.66675 15.9961 4.66675 11.8817C4.66675 8.41043 6.95363 5.49367 10.1667 4.66667V12.7667Z"},null,-1),y("path",{d:"M14.8939 10C14.4002 10 14.0001 9.59984 14.0001 9.10621V2C18.2227 2.41925 21.5808 5.77735 22.0001 10H14.8939ZM16.0001 4.66667V8H19.3334C18.721 6.4875 17.5126 5.27905 16.0001 4.66667Z"},null,-1)])])}const Mt={render:It},Zt={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function St(i,t){return a(),s("svg",Zt,[...t[0]||(t[0]=[ct('<g id="Default avatar"><circle id="icon-member-default" cx="12" cy="12" r="12" fill="#3370FF"></circle><g id="Union"><path d="M14 12.3333H10C8.15905 12.3333 6 13.621 6 15.9333V17.7333C6 18.0647 6.29848 18.3333 6.66667 18.3333H17.3333C17.7015 18.3333 18 18.0647 18 17.7333V15.9333C18 13.619 15.841 12.3333 14 12.3333Z" fill="url(#paint0_linear_4039_14436)"></path><path d="M8.66667 8.33333C8.66667 10.1743 10.1591 11.6667 12 11.6667C13.8409 11.6667 15.3333 10.1743 15.3333 8.33333C15.3333 6.49238 13.8409 5 12 5C10.1591 5 8.66667 6.49238 8.66667 8.33333Z" fill="url(#paint1_linear_4039_14436)"></path></g></g><defs><linearGradient id="paint0_linear_4039_14436" x1="12" y1="5" x2="12" y2="18.6667" gradientUnits="userSpaceOnUse"><stop stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></linearGradient><linearGradient id="paint1_linear_4039_14436" x1="12" y1="5" x2="12" y2="18.6667" gradientUnits="userSpaceOnUse"><stop stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></linearGradient></defs>',2)])])}const Et={render:St},Dt={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function Bt(i,t){return a(),s("svg",Dt,[...t[0]||(t[0]=[y("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.68833 5.68831C5.91562 5.46102 6.2239 5.33333 6.54534 5.33333H17.4547C17.7761 5.33333 18.0844 5.46102 18.3117 5.68831C18.539 5.91561 18.6667 6.22389 18.6667 6.54533V17.4547C18.6667 17.7761 18.539 18.0844 18.3117 18.3117C18.0844 18.539 17.7761 18.6667 17.4547 18.6667H6.54534C5.87601 18.6667 5.33334 18.124 5.33334 17.4547V6.54533C5.33334 6.22389 5.46104 5.91561 5.68833 5.68831ZM6.66668 10.6667V13.3333H9.33334V10.6667H6.66668ZM6.66668 14.6667V17.3333H9.33334V14.6667H6.66668ZM10.6667 17.3333H13.3333V14.6667H10.6667V17.3333ZM14.6667 17.3333H17.3333V14.6667H14.6667V17.3333ZM17.3333 13.3333V10.6667H14.6667V13.3333H17.3333ZM13.3333 10.6667H10.6667V13.3333H13.3333V10.6667ZM17.3333 6.66666H6.66668V9.33333H17.3333V6.66666Z"},null,-1)])])}const Ut={render:Bt},Ft={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Rt(i,t){return a(),s("svg",Ft,[...t[0]||(t[0]=[y("path",{d:"M18 16.3333V18C18 18.3682 17.7015 18.6667 17.3333 18.6667H6.66667C6.29848 18.6667 6 18.3682 6 18V16.3333C6 16.1492 6.14924 16 6.33333 16H7C7.18409 16 7.33333 16.1492 7.33333 16.3333V17.3333H16.6667V16.3333C16.6667 16.1492 16.8159 16 17 16H17.6667C17.8508 16 18 16.1492 18 16.3333ZM12.6667 13.3571L14.6736 11.3502C14.8038 11.22 15.0149 11.22 15.1451 11.3502L15.6165 11.8216C15.7466 11.9517 15.7466 12.1628 15.6165 12.293L12.3166 15.5928C12.2515 15.6579 12.1662 15.6904 12.0809 15.6904C11.9956 15.6904 11.9103 15.6579 11.8452 15.5928L8.54539 12.293C8.41521 12.1628 8.41521 11.9517 8.54539 11.8216L9.01679 11.3502C9.14697 11.22 9.35802 11.22 9.4882 11.3502L11.3333 13.1953V5.99999C11.3333 5.81589 11.4826 5.66666 11.6667 5.66666H12.3333C12.5174 5.66666 12.6667 5.81589 12.6667 5.99999V13.3571Z",fill:"#646A73"},null,-1)])])}const zt={render:Rt},qt={key:0,class:"question-or-title",style:{"font-size":"16px","font-weight":"500"}},Ot={key:1,class:"question-or-title",style:{"font-size":"16px","font-weight":"500"}},Wt={key:2,class:"question-or-title"},Nt={key:3,class:"is-welcome"},At=["id"],Gt=dt({__name:"DialogueChart",props:{copilotInfo:{type:Object,default:()=>({msgType:"api",chart:{},id:"",loading:!1,question:"",chartData:{data:{},title:""},msgStatus:0})},isWelcome:{type:Boolean},isAnswer:{type:Boolean}},setup(i){const{t}=st(),x=i,U=H(),F=H();let p=null;const R=H(),{width:J}=_t(R);mt(()=>{var l,h,_,u,d,T,$,L;const{chart:e,msgType:o,msgStatus:c,chartData:r,id:v}=x.copilotInfo;if(c===1&&o==="api"&&r)if(["bar","line"].includes(e.type)){C.value=e.type;const g=e.type==="bar"?K:P;p=new g(`de-${v}-ed`,{data:r.data.data,xField:(h=(l=e.axis)==null?void 0:l.x)==null?void 0:h.value,yField:(u=(_=e.axis)==null?void 0:_.y)==null?void 0:u.value,legend:{layout:"horizontal",position:"left"}}),p.render()}else e.type==="pie"?(C.value=e.type,p=new Y(`de-${v}-ed`,{appendPadding:10,data:r.data.data,angleField:(T=(d=e.axis)==null?void 0:d.y)==null?void 0:T.value,colorField:(L=($=e.axis)==null?void 0:$.x)==null?void 0:L.value,radius:.9,interactions:[{type:"element-active"}]}),p.render()):(D.value=e.columns.map(g=>({key:`${g.value}`,dataKey:`${g.value}`,title:`${g.name}`,width:150})),B.value=r.data.data.map((g,M)=>({...g,id:M+"row"})),w.value=!0);W(()=>{(F.value||U.value).scrollIntoView({block:"end",inline:"nearest",behavior:"smooth"})})});const X=()=>{const{chartData:e,chart:o}=x.copilotInfo,c=new yt.Workbook,r=c.addWorksheet("Sheet1");r.columns=o.columns.map(l=>({header:l.name,key:l.value}));const v=o.columns.map(l=>l.value);e.data.data.forEach(l=>{r.addRow(v.map(h=>l[h]))}),c.xlsx.writeBuffer().then(l=>{const h=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_=window.URL.createObjectURL(h),u=document.createElement("a");u.href=_,u.download=o.title+".xlsx",u.click(),window.URL.revokeObjectURL(_)})},w=H(!1),Q=()=>{I(C.value)},I=e=>{w.value=!1,W(()=>{var h,_,u,d,T,$,L,g,M;p!=null&&p.chart&&!p.chart.wrapperElement&&(p.chart.wrapperElement=document.querySelector(`#de-${x.copilotInfo.id}-ed > div`)),(h=p==null?void 0:p.chart)!=null&&h.wrapperElement&&p.destroy(),["bar","line","pie"].includes(e)&&(C.value=e);const{chart:o,msgType:c,msgStatus:r,chartData:v,id:l}=x.copilotInfo;if(r===1&&c==="api"&&v){if(["bar","line"].includes(e)){const V=e==="bar"?K:P;new V(`de-${l}-ed`,{data:v.data.data,xField:(u=(_=o.axis)==null?void 0:_.x)==null?void 0:u.value,yField:(T=(d=o.axis)==null?void 0:d.y)==null?void 0:T.value,legend:{layout:"horizontal",position:"left"}}).render();return}if(e==="pie"){p=new Y(`de-${l}-ed`,{appendPadding:10,data:v.data.data,angleField:(L=($=o.axis)==null?void 0:$.y)==null?void 0:L.value,colorField:(M=(g=o.axis)==null?void 0:g.x)==null?void 0:M.value,radius:.9,interactions:[{type:"element-active"}]}),p.render();return}D.value=o.columns.map(V=>({key:`${V.value}`,dataKey:`${V.value}`,title:`${V.name}`,width:150})),B.value=v.data.data.map((V,O)=>({...V,id:O+"row"})),w.value=!0}})},z=H(),tt=()=>{if(w.value){X();return}gt("img",z.value,t("copilot.chart"))};ut(()=>x.copilotInfo.loading,e=>{e||I(w.value?"table":C.value)});const k=N(()=>{const{chart:e,msgType:o,msgStatus:c,chartData:r}=x.copilotInfo;return o==="api"&&c===1&&!["bar","line","pie"].includes(e==null?void 0:e.type)&&r.data}),C=H(""),q=[{label:t("copilot.line"),value:"line",icon:Ht},{label:t("copilot.bar"),icon:$t,value:"bar"},{label:t("copilot.pie"),icon:Mt,value:"pie"}],D=A([]),B=A([]),et=N(()=>{const{chart:e,msgType:o,question:c,msgStatus:r}=x.copilotInfo;return o==="api"&&r===1?e.title:r===0?t("copilot.sorry"):o==="user"?c:""});return(e,o)=>{const c=pt,r=ot,v=it,l=at,h=nt,_=rt,u=lt;return a(),s("div",{class:E(["dialogue-chart",[i.copilotInfo.msgType==="user"?"user-dialogue":"api-dialogue",i.copilotInfo.msgType==="api"&&i.copilotInfo.msgStatus===1&&"chart-dialogue"]])},[n(r,{style:{"font-size":"32px"},class:"dialogue-chart_icon"},{default:m(()=>[n(c,null,{default:m(()=>[(a(),Z(G(i.copilotInfo.msgType==="api"?f(Ct):f(Et)),{class:"svg-icon"}))]),_:1})]),_:1}),y("div",{ref_key:"content",ref:U,class:"content"},[i.isWelcome?(a(),s("div",qt,S(f(t)("copilot.hello1")),1)):i.isAnswer?(a(),s("div",Ot,[ft(S(f(t)("copilot.answer")),1),o[3]||(o[3]=y("span",{class:"dot"},"...",-1))])):(a(),s("div",Wt,S(et.value),1)),i.isWelcome?(a(),s("div",Nt,S(f(t)("copilot.example")),1)):i.copilotInfo.msgType==="api"&&i.copilotInfo.msgStatus===1?(a(),s("div",{key:4,class:"chart-type",ref_key:"chartTypeRef",ref:z},[i.copilotInfo.loading?b("",!0):(a(),s("div",{key:0,ref_key:"chartRef",ref:R,class:"column-plot_de",id:`de-${i.copilotInfo.id}-ed`},[k.value||w.value?(a(),Z(v,{key:0,columns:D.value,data:B.value,width:f(J),height:335,fixed:""},null,8,["columns","data","width"])):b("",!0)],8,At))],512)):b("",!0)],512),i.copilotInfo.msgType==="api"&&i.copilotInfo.msgStatus===1?(a(),s("div",{key:0,ref_key:"chartTypeList",ref:F,class:"chart-type_list"},[k.value?b("",!0):(a(),s(j,{key:0},[C.value?(a(),Z(r,{key:0,class:E([!(k.value||w.value)&&"active","select-prefix"])},{default:m(()=>[n(c,null,{default:m(()=>[(a(),Z(G(q.find(d=>d.value===C.value).icon),{class:"svg-icon"}))]),_:1})]),_:1},8,["class"])):b("",!0),n(l,{effect:"dark",content:f(t)("copilot.switch_chart"),placement:"top"},{default:m(()=>[vt(y("div",{onClick:o[0]||(o[0]=d=>I(C.value)),class:"fake-mask_select"},null,512),[[ht,k.value||w.value]])]),_:1},8,["content"]),n(l,{effect:"dark",content:f(t)("copilot.switch_chart"),placement:"top"},{default:m(()=>[n(_,{"popper-class":"copilot-select_popper",class:E(["select-copilot-list",!(k.value||w.value)&&"active"]),modelValue:C.value,"onUpdate:modelValue":o[1]||(o[1]=d=>C.value=d),size:"small",onChange:Q},{default:m(()=>[(a(),s(j,null,wt(q,d=>n(h,{key:d.label,label:d.label,value:d.value},null,8,["label","value"])),64))]),_:1},8,["class","modelValue"])]),_:1},8,["content"]),n(u,{direction:"vertical"})],64)),n(l,{effect:"dark",content:f(t)("copilot.switch_table"),placement:"top"},{default:m(()=>[n(r,{class:E([(k.value||w.value)&&"active","ed-icon_chart"]),onClick:o[2]||(o[2]=d=>I("table"))},{default:m(()=>[n(c,{name:"chart-table"},{default:m(()=>[n(f(Ut),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["content"]),n(u,{direction:"vertical"}),n(l,{effect:"dark",content:f(t)("copilot.download"),placement:"top"},{default:m(()=>[n(r,{class:"ed-icon_chart",onClick:tt},{default:m(()=>[n(c,{name:"chart-download"},{default:m(()=>[n(f(zt),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"])],512)):b("",!0)],2)}}});const po=xt(Gt,[["__scopeId","data-v-68fc9219"]]);export{po as default};
