import{N as we,C as k,B as Ae,d as ae,ac as Ee,r as f,y as $,a as Oe,o as $e,f as S,g as Se,i as v,P as Z,S as V,u as s,T as x,j as F,O as P,Z as b,W as Ve,a6 as Fe,a3 as Te,a4 as Be,a2 as Ne,a9 as A,a8 as Q,at as Ie,A as R}from"./vue-0.0.0-dataease.js";import{l as Ce,q as ee,a3 as We,i as _e,at as ke,R as Pe,W as Re,_ as Ke,t as De,w as Me}from"./index-0.0.0-dataease.js";import{a3 as T,al as D,ah as se,I as Le,a4 as je,ac as Ue,j as He,G as qe}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{u as ze,E as Ge}from"./index-0.0.0-dataease4.js";import{h as Ye}from"./lodash-0.0.0-dataease.js";const Je=Ce({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:ee(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:ee([Function,Array]),default:we},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:ze.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...We(["ariaLabel"])}),Xe={[T]:o=>k(o),[D]:o=>k(o),[se]:o=>k(o),focus:o=>o instanceof FocusEvent,blur:o=>o instanceof FocusEvent,clear:()=>!0,select:o=>Ae(o)},le="ElAutocomplete",Ze=ae({name:le,inheritAttrs:!1}),xe=ae({...Ze,props:Je,emits:Xe,setup(o,{expose:t,emit:l}){const a=o,B=Le(),oe=Ee(),M=je(),d=_e("autocomplete"),i=f(),L=f(),E=f(),j=f();let U=!1,N=!1;const c=f([]),r=f(-1),H=f(""),p=f(!1),O=f(!1),g=f(!1),y=Ue(),re=$(()=>oe.style),h=$(()=>(c.value.length>0||g.value)&&p.value),q=$(()=>!a.hideLoading&&g.value),ie=$(()=>i.value?Array.from(i.value.$el.querySelectorAll("input")):[]),ue=()=>{h.value&&(H.value=`${i.value.$el.offsetWidth}px`)},ce=()=>{r.value=-1},z=async e=>{if(O.value)return;const n=u=>{g.value=!1,!O.value&&(R(u)?(c.value=u,r.value=a.highlightFirstItem?0:-1):De(le,"autocomplete suggestions must be an array"))};if(g.value=!0,R(a.fetchSuggestions))n(a.fetchSuggestions);else{const u=await a.fetchSuggestions(e,n);R(u)&&n(u)}},G=Ye(z,a.debounce),de=e=>{const n=!!e;if(l(D,e),l(T,e),O.value=!1,p.value||(p.value=n),!a.triggerOnFocus&&!e){O.value=!0,c.value=[];return}G(e)},fe=e=>{var n;M.value||(((n=e.target)==null?void 0:n.tagName)!=="INPUT"||ie.value.includes(document.activeElement))&&(p.value=!0)},pe=e=>{l(se,e)},ve=e=>{N?N=!1:(p.value=!0,l("focus",e),a.triggerOnFocus&&!U&&G(String(a.modelValue)))},he=e=>{setTimeout(()=>{var n;if((n=E.value)!=null&&n.isFocusInsideContent()){N=!0;return}p.value&&w(),l("blur",e)})},ge=()=>{p.value=!1,l(T,""),l("clear")},Y=async()=>{h.value&&r.value>=0&&r.value<c.value.length?I(c.value[r.value]):a.selectWhenUnmatched&&(l("select",{value:a.modelValue}),c.value=[],r.value=-1)},me=e=>{h.value&&(e.preventDefault(),e.stopPropagation(),w())},w=()=>{p.value=!1},be=()=>{var e;(e=i.value)==null||e.focus()},ye=()=>{var e;(e=i.value)==null||e.blur()},I=async e=>{l(D,e[a.valueKey]),l(T,e[a.valueKey]),l("select",e),c.value=[],r.value=-1},C=e=>{if(!h.value||g.value)return;if(e<0){r.value=-1;return}e>=c.value.length&&(e=c.value.length-1);const n=L.value.querySelector(`.${d.be("suggestion","wrap")}`),m=n.querySelectorAll(`.${d.be("suggestion","list")} li`)[e],W=n.scrollTop,{offsetTop:X,scrollHeight:_}=m;X+_>W+n.clientHeight&&(n.scrollTop+=_),X<W&&(n.scrollTop-=_),r.value=e,i.value.ref.setAttribute("aria-activedescendant",`${y.value}-item-${r.value}`)},J=ke(j,()=>{var e;(e=E.value)!=null&&e.isFocusInsideContent()||h.value&&w()});return Oe(()=>{J==null||J()}),$e(()=>{i.value.ref.setAttribute("role","textbox"),i.value.ref.setAttribute("aria-autocomplete","list"),i.value.ref.setAttribute("aria-controls","id"),i.value.ref.setAttribute("aria-activedescendant",`${y.value}-item-${r.value}`),U=i.value.ref.hasAttribute("readonly")}),t({highlightedIndex:r,activated:p,loading:g,inputRef:i,popperRef:E,suggestions:c,handleSelect:I,handleKeyEnter:Y,focus:be,blur:ye,close:w,highlight:C,getData:z}),(e,n)=>(S(),Se(s(Ge),{ref_key:"popperRef",ref:E,visible:s(h),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[s(d).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${s(d).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:ue,onHide:ce},{content:v(()=>[Z("div",{ref_key:"regionRef",ref:L,class:V([s(d).b("suggestion"),s(d).is("loading",s(q))]),style:x({[e.fitInputWidth?"width":"minWidth"]:H.value,outline:"none"}),role:"region"},[F(s(Pe),{id:s(y),tag:"ul","wrap-class":s(d).be("suggestion","wrap"),"view-class":s(d).be("suggestion","list"),role:"listbox"},{default:v(()=>[s(q)?(S(),P("li",{key:0},[b(e.$slots,"loading",{},()=>[F(s(He),{class:V(s(d).is("loading"))},{default:v(()=>[F(s(Re))]),_:1},8,["class"])])])):(S(!0),P(Ve,{key:1},Fe(c.value,(u,m)=>(S(),P("li",{id:`${s(y)}-item-${m}`,key:m,class:V({highlighted:r.value===m}),role:"option","aria-selected":r.value===m,onClick:W=>I(u)},[b(e.$slots,"default",{item:u},()=>[Te(Be(u[e.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:v(()=>[Z("div",{ref_key:"listboxRef",ref:j,class:V([s(d).b(),e.$attrs.class]),style:x(s(re)),role:"combobox","aria-haspopup":"listbox","aria-expanded":s(h),"aria-owns":s(y)},[F(s(qe),Ne({ref_key:"inputRef",ref:i},s(B),{clearable:e.clearable,disabled:s(M),name:e.name,"model-value":e.modelValue,"aria-label":e.ariaLabel,onInput:de,onChange:pe,onFocus:ve,onBlur:he,onClear:ge,onKeydown:[A(Q(u=>C(r.value-1),["prevent"]),["up"]),A(Q(u=>C(r.value+1),["prevent"]),["down"]),A(Y,["enter"]),A(w,["tab"]),A(me,["esc"])],onMousedown:fe}),Ie({_:2},[e.$slots.prepend?{name:"prepend",fn:v(()=>[b(e.$slots,"prepend")])}:void 0,e.$slots.append?{name:"append",fn:v(()=>[b(e.$slots,"append")])}:void 0,e.$slots.prefix?{name:"prefix",fn:v(()=>[b(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:v(()=>[b(e.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var Qe=Ke(xe,[["__file","autocomplete.vue"]]);const nt=Me(Qe);class ne{set(t,l){t=this.initOptions(t);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(this[a]instanceof Array||(l===!0?this[a]=t[a]===void 0?this[a]:t[a]:this[a]=t[a]))}sets(t,l){if(l=this.initOptions(l),t)for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&Object.prototype.hasOwnProperty.call(l,a)&&l[a].forEach(B=>{this[a].push(new t[a](B))})}initOptions(t){return t||{}}isValid(){return!0}}class te extends ne{constructor(t){t=t||{},t.enable=t.enable===void 0?!0:t.enable,super(),this.name=void 0,this.value=void 0,this.type=void 0,this.files=void 0,this.enable=void 0,this.uuid=void 0,this.time=void 0,this.contentType=void 0,this.set(t)}isValid(){return(!!this.name||!!this.value)&&this.type!=="file"}isFile(){return(!!this.name||!!this.value)&&this.type==="file"}}class ot extends ne{constructor(t){super(),this.type="KeyValue",this.raw=void 0,this.kvs=[],this.binary=[],this.set(t),this.sets({kvs:te},{binary:te},t)}isValid(){return this.isKV()?this.kvs.some(t=>t.isValid()):!!this.raw}isKV(){return[K.FORM_DATA,K.WWW_FORM,K.BINARY].indexOf(this.type)>0}}const K={KV:"KeyValue",FORM_DATA:"Form_Data",RAW:"Raw",WWW_FORM:"WWW_FORM",XML:"XML",JSON:"JSON"};export{K as B,nt as E,te as K,ot as a};
