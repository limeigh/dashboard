import{d as E,f as M}from"./dvMain-0.0.0-dataease.js";import{m as T,n as q,o as L}from"./DePreview-0.0.0-dataease.js";import{r as n}from"./mobile-0.0.0-dataease.js";import{D as F,V as N,i as R}from"./canvasUtils-0.0.0-dataease.js";import{g}from"./dataset-0.0.0-dataease.js";import{p as G,c as J}from"./index-0.0.0-dataease.js";import{v as x,o as W,D as Z,W as A}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as U}from"./EmptyBackground-0.0.0-dataease.js";import{d as z,X,o as $,f as d,O as I,j as h,g as k,_ as f,u as B,W as H}from"./vue-0.0.0-dataease.js";import{_ as K}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./lodash-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./index-0.0.0-dataease21.js";import"./antv-0.0.0-dataease.js";import"./index-0.0.0-dataease22.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./tslib.es6-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./style-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./Component-0.0.0-dataease18.js";import"./DeShortcutKey-0.0.0-dataease.js";import"./snapshot-0.0.0-dataease.js";import"./canvasStyle-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./ModelUtil-0.0.0-dataease.js";import"./Component-0.0.0-dataease17.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-popover-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./el-tree-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tree-select-0.0.0-dataease.js";import"./el-checkbox-group-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./el-dropdown-menu-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import"./icon_more_outlined-0.0.0-dataease.js";import"./more_v-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./icon_dataset-0.0.0-dataease.js";import"./icon_warning_filled-0.0.0-dataease.js";import"./icon_info_outlined-0.0.0-dataease.js";import"./vuedraggable-es-0.0.0-dataease.js";import"./time-format-0.0.0-dataease.js";import"./dayjs.min-0.0.0-dataease.js";import"./time-format-dayjs-0.0.0-dataease.js";import"./attr-0.0.0-dataease23.js";import"./el-time-picker-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";import"./el-input-number-0.0.0-dataease.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease27.js";import"./index-0.0.0-dataease20.js";import"./index-0.0.0-dataease28.js";import"./index-0.0.0-dataease29.js";import"./use-route-0.0.0-dataease.js";import"./index-0.0.0-dataease30.js";import"./index-0.0.0-dataease31.js";import"./index-0.0.0-dataease32.js";import"./index-0.0.0-dataease33.js";import"./el-virtual-list-0.0.0-dataease.js";import"./raf-0.0.0-dataease.js";import"./el-select-v2-0.0.0-dataease.js";import"./fixed-size-list-0.0.0-dataease.js";import"./chart-list-0.0.0-dataease.js";import"./field-list-0.0.0-dataease.js";import"./treeSortUtils-0.0.0-dataease.js";import"./Attr-0.0.0-dataease22.js";import"./CommonAttr-0.0.0-dataease.js";import"./el-collapse-item-0.0.0-dataease.js";import"./CommonBorderSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-color-picker-0.0.0-dataease.js";import"./position-0.0.0-dataease.js";import"./BackgroundOverallCommon-0.0.0-dataease.js";import"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import"./board-list-0.0.0-dataease.js";import"./ImgViewDialog-0.0.0-dataease.js";import"./el-space-0.0.0-dataease.js";import"./icon_italic_outlined-0.0.0-dataease.js";import"./icon_right-alignment_outlined-0.0.0-dataease.js";import"./CarouselSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./CollapseSwitchItem-0.0.0-dataease.js";import"./el-switch-0.0.0-dataease.js";import"./icon_replace_outlined-0.0.0-dataease.js";import"./icon_download_outlined-0.0.0-dataease.js";import"./Component.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./watermark-0.0.0-dataease2.js";import"./user-0.0.0-dataease.js";import"./el-divider-0.0.0-dataease.js";import"./ChartComponentS2-0.0.0-dataease.js";import"./ViewTrackBar-0.0.0-dataease.js";import"./el-pagination-0.0.0-dataease.js";import"./ChartError-0.0.0-dataease.js";import"./el-main-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./LinkageSet-0.0.0-dataease.js";import"./el-footer-0.0.0-dataease.js";import"./el-aside-0.0.0-dataease.js";import"./dv-link-target-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./dv-screen-spine-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease.js";import"./dv-empty-0.0.0-dataease.js";import"./Attr.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./Component-0.0.0-dataease16.js";import"./index-0.0.0-dataease34.js";import"./ChartComponentG2Plot-0.0.0-dataease.js";import"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./DrillPath-0.0.0-dataease.js";import"./DeRichTextView-0.0.0-dataease.js";import"./Component-0.0.0-dataease12.js";import"./ChartEmptyInfo-0.0.0-dataease.js";import"./chart-dark-list-0.0.0-dataease.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./Component-0.0.0-dataease13.js";import"./Attr-0.0.0-dataease16.js";import"./Component-0.0.0-dataease10.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease2.js";import"./Component-0.0.0-dataease5.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease3.js";import"./Attr-0.0.0-dataease.js";import"./Component-0.0.0-dataease3.js";import"./Attr.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import"./Attr-0.0.0-dataease9.js";import"./Component-0.0.0-dataease6.js";import"./Attr-0.0.0-dataease6.js";import"./Component-0.0.0-dataease4.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease4.js";import"./Component-0.0.0-dataease14.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease5.js";import"./Component.vue_vue_type_script_setup_true_lang-0.0.0-dataease2.js";import"./Attr-0.0.0-dataease10.js";import"./Component-0.0.0-dataease11.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease6.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease7.js";import"./Attr-0.0.0-dataease7.js";import"./Component-0.0.0-dataease9.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease8.js";import"./Component-0.0.0-dataease7.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease9.js";import"./Component-0.0.0-dataease15.js";import"./Attr-0.0.0-dataease19.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease10.js";import"./Attr-0.0.0-dataease15.js";import"./DatasetSelect-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./Threshold-0.0.0-dataease.js";import"./TableThresholdEdit-0.0.0-dataease.js";import"./icon_info_filled-0.0.0-dataease.js";import"./TextLabelThresholdEdit-0.0.0-dataease.js";import"./TextThresholdEdit-0.0.0-dataease.js";import"./LineThresholdEdit-0.0.0-dataease.js";import"./PictureGroupThresholdEdit-0.0.0-dataease.js";import"./Component-0.0.0-dataease2.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";const Q={key:0,class:"content"},Y=z({__name:"PreviewCanvasMobile",props:{publicLinkStatus:{type:Boolean,required:!1,default:!1},isSelector:{type:Boolean,default:!1},ticketArgs:G.string.def(null)},setup(C,{expose:V}){const i=E(),{t:w}=W(),P=J(),t=X({canvasDataPreview:null,canvasStylePreview:null,canvasViewInfoPreview:null,dvInfo:null,curPreviewGap:0,initState:!0}),s=C,y=async(r,e)=>{const c=P.jumpInfoParam||n.currentRoute.value.query.jumpInfoParam;let a;if(c){a=JSON.parse(g.decode(decodeURIComponent(c)));const o={sourceDvId:a.sourceDvId,sourceViewId:a.sourceViewId,sourceFieldId:null,targetDvId:r};try{await F(o).then(p=>{i.setNowTargetPanelJumpInfo(p.data)})}catch(p){console.error(p)}}let l=null;try{l=JSON.parse(s.ticketArgs)}catch(o){console.error(o)}const S=l&&Object.keys(l);let m;await L(r).then(o=>{i.setNowPanelOuterParamsInfoV2(o.data,r)});const v=n.currentRoute.value.query.attachParams;if(v||S)try{v&&(m=JSON.parse(g.decode(decodeURIComponent(v)))),S&&(m=Object.assign({},m,l))}catch(o){console.error(o),Z.error(w("visualization.outer_param_decode_error"));return}(e==="dashboard"?N:R)(r,{busiFlag:e},async function({canvasDataResult:o,canvasStyleResult:p,dvInfo:u,canvasViewInfoPreview:O,curPreviewGap:j}){if(!u.mobileLayout&&e==="dashboard"){await n.push("/DashboardEmpty");return}t.dvInfo=u,t.dvInfo.status&&(a||m)&&await M(o),t.canvasDataPreview=o,t.canvasStylePreview=p,t.canvasViewInfoPreview=O,t.curPreviewGap=j,t.dvInfo.status&&(a&&i.addViewTrackFilter(a),t.initState=!1,i.addOuterParamsFilter(m),t.initState=!0),s.publicLinkStatus&&(document.title=u.name,A(u.name)),D()})};let _=null;const b=()=>_(!0);$(async()=>{await new Promise(a=>_=a),i.setMobileInPc(!0),i.setInMobile(!0);const r=P.dvId||n.currentRoute.value.query.dvId,{dvType:e,callBackFlag:c}=n.currentRoute.value.query;if(r){y(r,e);return}i.setEmbeddedCallBack(c||"no"),i.setPublicLinkStatus(s.publicLinkStatus)});const D=()=>{if(t.canvasStylePreview.refreshBrowserEnable){const r=t.canvasStylePreview.refreshBrowserUnit==="minute"?60:1,e=t.canvasStylePreview.refreshBrowserTime*r*1e3;setTimeout(()=>{window.location.reload()},e)}};return V({loadCanvasDataAsync:y}),(r,e)=>(d(),I(H,null,[t.initState?(d(),I("div",Q,[h(T,{"canvas-id":"canvas-main","canvas-style-data":t.canvasStylePreview||{},"component-data":t.canvasDataPreview||[]},null,8,["canvas-style-data","component-data"]),t.canvasStylePreview?(d(),k(q,{key:0,ref:"dvPreview","component-data":t.canvasDataPreview,"canvas-style-data":t.canvasStylePreview,"canvas-view-info":t.canvasViewInfoPreview,"dv-info":t.dvInfo,"cur-gap":t.curPreviewGap,"show-linkage-button":!1,"is-selector":s.isSelector},null,8,["component-data","canvas-style-data","canvas-view-info","dv-info","cur-gap","is-selector"])):f("",!0)])):f("",!0),t.initState?f("",!0):(d(),k(U,{key:1,description:B(w)("visualization.no_params_tips"),"img-type":"noneWhite"},null,8,["description"])),h(B(x),{jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvTmV3V2luZG93SGFuZGxlcg==",onLoaded:b,onLoadFail:b})],64))}});const Zi=K(Y,[["__scopeId","data-v-6aae4da0"]]);export{Zi as default};
