import{E as I,A as H,y as Q,w as X,r as ee,B as oe,e as te,C as ae,p as re,x as ie,i as le,Z as ne,a as se}from"./element-plus-secondary-0.0.0-dataease.js";import{h as ue,k as O,f as me}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as pe}from"./icon_down_outlined-1-0.0.0-dataease.js";import{i as de}from"./icon_down_outlined-0.0.0-dataease.js";import{d as ce}from"./option-0.0.0-dataease.js";import{g as fe}from"./datasource-0.0.0-dataease.js";import{_ as ge}from"./CustomPassword.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{g as j}from"./js-base64-0.0.0-dataease.js";import{b as _e}from"./login-0.0.0-dataease.js";import{s as be}from"./encryption-0.0.0-dataease.js";import{h as x}from"./lodash-es-0.0.0-dataease.js";import{d as ye,r as v,l as Ve,o as m,T as f,U as l,a as $,W as r,_ as S,Y as w,u as o,c as F,S as J,a8 as xe,R as z,V as ve}from"./@vue-0.0.0-dataease.js";import{_ as Se}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./icon_invisible_outlined-0.0.0-dataease.js";import"./jsencrypt-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";const we={class:"dialog-footer"},ze=ye({__name:"EngineEdit",emits:["saved"],setup(Ee,{expose:D,emit:R}){const{t:e}=ue(),_=v(!1),B=v(null),L={name:[{required:!0,message:e("datasource.input_name"),trigger:"blur"},{min:2,max:64,message:e("datasource.input_limit_2_25",[2,64]),trigger:"blur"}]},A={"configuration.dataBase":[{required:!0,message:e("datasource.please_input_data_base"),trigger:"blur"}],"configuration.username":[{required:!0,message:e("datasource.please_input_user_name"),trigger:"blur"}],"configuration.password":[{required:!0,message:e("datasource.please_input_password"),trigger:"blur"}],"configuration.host":[{required:!0,message:e("datasource._ip_address"),trigger:"blur"}],"configuration.jdbc":[{required:!0,message:e("datasource.please_input_jdbc_url"),trigger:"blur"}],"configuration.extraParams":[{required:!1,message:e("datasource.please_input_url"),trigger:"blur"}],"configuration.port":[{required:!0,message:e("datasource.please_input_port"),trigger:"blur"}],"configuration.initialPoolSize":[{required:!0,message:e("common.inputText")+" "+e("datasource.initial_pool_size"),trigger:"blur"}],"configuration.minPoolSize":[{required:!0,message:e("common.inputText")+" "+e("datasource.min_pool_size"),trigger:"blur"}],"configuration.maxPoolSize":[{required:!0,message:e("common.inputText")+" "+e("datasource.max_pool_size"),trigger:"blur"}],"configuration.queryTimeout":[{required:!0,message:e("common.inputText")+" "+e("datasource.query_timeout"),trigger:"blur"}]},K={...x(A),...x(L)},M=R,N=()=>{_.value=!1,Object.assign(i,x(C))},W=()=>{N()},U=()=>{B.value=se.service({target:".basic-param-drawer"})},b=()=>{var s;(s=B.value)==null||s.close()},y=v(!1),C={name:"",createBy:"",creator:"",createTime:"",description:"",id:0,size:0,nodeType:"",type:"",fileName:"",configuration:{host:"",jdbc:"",port:8081,dataBase:"",username:"",password:"",extraParams:"",initialPoolSize:5,minPoolSize:5,maxPoolSize:5,queryTimeout:30},syncSetting:null,apiConfiguration:[],weight:0},i=Ve(x(C)),Y=()=>{_e().then(s=>{fe().then(t=>{let{name:p,createBy:T,id:n,createTime:d,creator:c,type:q,pid:h,configuration:u,syncSetting:V,fileName:P,size:g,description:k,lastSyncTime:a}=t.data;u&&(u=JSON.parse(be(u,s.data))),Object.assign(i,{name:p,pid:h,description:k,fileName:P,size:g,createTime:d,creator:c,createBy:T,id:n,type:q,configuration:u,syncSetting:V,lastSyncTime:a})}).finally(()=>{_.value=!0})})},E=v(),Z=async()=>{let s=JSON.parse(JSON.stringify(i));s.configuration=j.encode(JSON.stringify(s.configuration)),E.value.validate(t=>{t&&(U(),O.post({url:"/engine/save",data:s}).then(p=>{p!==void 0&&(I.success(e("common.save_success")),M("saved"),W()),b()}).catch(()=>{b()}))})},G=async()=>{let s=JSON.parse(JSON.stringify(i));s.configuration=j.encode(JSON.stringify(s.configuration)),E.value.validate(t=>{t&&(U(),O.post({url:"/engine/validate",data:s}).then(p=>{p!==void 0&&I.success(e("datasource.validate_success")),b()}).catch(()=>{b()}))})};return D({edit:Y}),(s,t)=>{const p=H,T=Q,n=X,d=ee,c=oe,q=me,h=te,u=ae,V=re,P=ie,g=le,k=ne;return m(),f(k,{title:o(e)("system.engine_settings"),modelValue:_.value,"onUpdate:modelValue":t[16]||(t[16]=a=>_.value=a),"modal-class":"basic-param-drawer",size:"600px",direction:"rtl"},{footer:l(()=>[$("span",we,[r(g,{secondary:"",onClick:t[13]||(t[13]=a=>N())},{default:l(()=>[S(w(o(e)("common.cancel")),1)]),_:1}),r(g,{secondary:"",onClick:t[14]||(t[14]=a=>G())},{default:l(()=>[S(w(o(e)("datasource.validate")),1)]),_:1}),r(g,{type:"primary",onClick:t[15]||(t[15]=a=>Z())},{default:l(()=>[S(w(o(e)("commons.save")),1)]),_:1})])]),default:l(()=>[r(P,{ref_key:"basicForm",ref:E,"require-asterisk-position":"right",model:i,rules:K,"label-width":"80px","label-position":"top"},{default:l(()=>[r(n,{label:o(e)("datasource.type")},{default:l(()=>[r(T,{modelValue:i.type,"onUpdate:modelValue":t[0]||(t[0]=a=>i.type=a),class:"de-select",disabled:""},{default:l(()=>[(m(!0),F(J,null,xe(o(ce),a=>(m(),f(p,{key:a.type,label:a.name,value:a.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),i.type==="h2"?(m(),f(n,{key:0,label:o(e)("datasource.host"),prop:"configuration.jdbc"},{default:l(()=>[r(d,{modelValue:i.configuration.jdbc,"onUpdate:modelValue":t[1]||(t[1]=a=>i.configuration.jdbc=a),placeholder:o(e)("data_source.jdbc_connection_string"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):z("",!0),i.type!=="h2"?(m(),f(n,{key:1,label:o(e)("datasource.host"),prop:"configuration.host"},{default:l(()=>[r(d,{modelValue:i.configuration.host,"onUpdate:modelValue":t[2]||(t[2]=a=>i.configuration.host=a),placeholder:o(e)("datasource._ip_address"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):z("",!0),i.type!=="h2"?(m(),f(n,{key:2,label:o(e)("datasource.port"),prop:"configuration.port"},{default:l(()=>[r(c,{modelValue:i.configuration.port,"onUpdate:modelValue":t[3]||(t[3]=a=>i.configuration.port=a),autocomplete:"off","step-strictly":"",class:"text-left",min:0,placeholder:o(e)("common.inputText")+o(e)("datasource.port"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):z("",!0),r(n,{label:o(e)("datasource.data_base"),prop:"configuration.dataBase"},{default:l(()=>[r(d,{modelValue:i.configuration.dataBase,"onUpdate:modelValue":t[4]||(t[4]=a=>i.configuration.dataBase=a),placeholder:o(e)("datasource.please_input_data_base"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(n,{label:o(e)("datasource.user_name")},{default:l(()=>[r(d,{placeholder:o(e)("common.inputText")+o(e)("datasource.user_name"),modelValue:i.configuration.username,"onUpdate:modelValue":t[5]||(t[5]=a=>i.configuration.username=a),autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),r(n,{label:o(e)("datasource.password")},{default:l(()=>[r(o(ge),{placeholder:o(e)("common.inputText")+o(e)("datasource.password"),"show-password":"",type:"password",modelValue:i.configuration.password,"onUpdate:modelValue":t[6]||(t[6]=a=>i.configuration.password=a)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),r(n,{label:o(e)("datasource.extra_params")},{default:l(()=>[r(d,{placeholder:o(e)("common.inputText")+o(e)("datasource.extra_params"),modelValue:i.configuration.extraParams,"onUpdate:modelValue":t[7]||(t[7]=a=>i.configuration.extraParams=a),autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),r(n,null,{default:l(()=>[$("span",{class:"de-expand_engine",onClick:t[8]||(t[8]=a=>y.value=!y.value)},[S(w(o(e)("datasource.priority"))+" ",1),r(h,null,{default:l(()=>[r(q,null,{default:l(()=>[(m(),f(ve(y.value?o(de):o(pe)),{class:"svg-icon"}))]),_:1})]),_:1})])]),_:1}),y.value?(m(),F(J,{key:3},[r(V,{gutter:24,class:"mb16"},{default:l(()=>[r(u,{span:12},{default:l(()=>[r(n,{label:o(e)("datasource.initial_pool_size"),prop:"configuration.initialPoolSize"},{default:l(()=>[r(c,{modelValue:i.configuration.initialPoolSize,"onUpdate:modelValue":t[9]||(t[9]=a=>i.configuration.initialPoolSize=a),"controls-position":"right",autocomplete:"off",class:"w100-input",placeholder:o(e)("common.inputText")+o(e)("datasource.initial_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),r(u,{span:12},{default:l(()=>[r(n,{label:o(e)("datasource.min_pool_size"),prop:"configuration.minPoolSize"},{default:l(()=>[r(c,{modelValue:i.configuration.minPoolSize,"onUpdate:modelValue":t[10]||(t[10]=a=>i.configuration.minPoolSize=a),"controls-position":"right",autocomplete:"off",class:"w100-input",placeholder:o(e)("common.inputText")+o(e)("datasource.min_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),r(V,{gutter:24},{default:l(()=>[r(u,{span:12},{default:l(()=>[r(n,{label:o(e)("datasource.max_pool_size"),prop:"configuration.maxPoolSize"},{default:l(()=>[r(c,{modelValue:i.configuration.maxPoolSize,"onUpdate:modelValue":t[11]||(t[11]=a=>i.configuration.maxPoolSize=a),class:"w100-input","controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.max_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),r(u,{span:12},{default:l(()=>[r(n,{label:`${o(e)("datasource.query_timeout")}(${o(e)("common.second")})`,prop:"configuration.queryTimeout"},{default:l(()=>[r(c,{class:"w100-input",modelValue:i.configuration.queryTimeout,"onUpdate:modelValue":t[12]||(t[12]=a=>i.configuration.queryTimeout=a),"controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.query_timeout"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})],64)):z("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}});const Do=Se(ze,[["__scopeId","data-v-5a344ef9"]]);export{Do as default};
