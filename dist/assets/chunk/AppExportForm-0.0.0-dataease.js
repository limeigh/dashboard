import{i as b,w as u,r as d,x as F,Z as k}from"./element-plus-secondary-0.0.0-dataease.js";import{f as C}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{z as B}from"./dataVisualization-0.0.0-dataease.js";import{d as O,r as j,t as T,l as L,o as S,T as G,U as n,a as x,W as p,_ as y,Y as D,u as e}from"./@vue-0.0.0-dataease.js";import{_ as J}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const Q={class:"app-export"},R={class:"apply",style:{width:"100%"}},W=O({__name:"AppExportForm",props:{componentData:{type:Object,required:!0},canvasViewInfo:{type:Object,required:!0},dvInfo:{type:Object,required:!0}},emits:["closeDraw","downLoadApp"],setup(g,{expose:q,emit:E}){const{t:r}=C(),_=E,v=j(null),h=g,{componentData:z,canvasViewInfo:w,dvInfo:V}=T(h),o=L({applyDownloadDrawer:!1,form:{appName:null,icon:null,version:null,creator:null,required:"2.8.0",description:null},rule:{appName:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],creator:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],required:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],version:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}]}}),A=s=>{o.applyDownloadDrawer=!0,o.form=s},N=()=>{_("closeDraw"),o.applyDownloadDrawer=!1},f=(s,a,l)=>{l.forEach(t=>{var m;if(t.component==="VQuery"&&((m=t.propValue)!=null&&m.length))t.propValue.forEach(i=>{var c;(c=i.dataset)!=null&&c.id&&a.push(i.dataset.id)});else if(t.component==="UserView"&&w.value[t.id]){const i=w.value[t.id],{id:c,tableId:U}=i;s.push(c),a.push(U)}else t.component==="Group"?f(s,a,t.propValue):t.component==="DeTabs"&&t.propValue.forEach(i=>{f(s,a,i.componentData)})})},I=()=>{var s;(s=v.value)==null||s.validate(a=>{if(a){const l=[],t=[];f(l,t,z.value),B({dvId:V.value.id,viewIds:l,dsIds:t}).then(m=>{const i={...m.data,...o.form,visualizationInfo:JSON.stringify(V.value)};_("downLoadApp",i),o.applyDownloadDrawer=!1})}else return!1})};return q({init:A}),(s,a)=>(S(),G(e(k),{title:e(r)("visualization.app_export"),modelValue:o.applyDownloadDrawer,"onUpdate:modelValue":a[5]||(a[5]=l=>o.applyDownloadDrawer=l),"modal-class":"de-user-drawer",size:"600px",direction:"rtl"},{footer:n(()=>[x("div",R,[p(e(b),{secondary:"",onClick:N},{default:n(()=>[y(D(e(r)("commons.cancel")),1)]),_:1}),p(e(b),{type:"primary",onClick:I},{default:n(()=>[y(D(e(r)("chart.export")),1)]),_:1})])]),default:n(()=>[x("div",Q,[p(e(F),{ref_key:"applyDownloadForm",ref:v,model:o.form,rules:o.rule,class:"de-form-item","label-width":"180px","label-position":"top"},{default:n(()=>[p(e(u),{label:e(r)("visualization.app_name"),prop:"appName"},{default:n(()=>[p(e(d),{modelValue:o.form.appName,"onUpdate:modelValue":a[0]||(a[0]=l=>o.form.appName=l),autocomplete:"off",placeholder:e(r)("common.input_name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(e(u),{label:e(r)("visualization.app_version"),prop:"version"},{default:n(()=>[p(e(d),{modelValue:o.form.version,"onUpdate:modelValue":a[1]||(a[1]=l=>o.form.version=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),p(e(u),{label:e(r)("visualization.app_export"),prop:"required"},{default:n(()=>[p(e(d),{modelValue:o.form.required,"onUpdate:modelValue":a[2]||(a[2]=l=>o.form.required=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),p(e(u),{label:e(r)("visualization.creator"),prop:"creator"},{default:n(()=>[p(e(d),{modelValue:o.form.creator,"onUpdate:modelValue":a[3]||(a[3]=l=>o.form.creator=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),p(e(u),{label:e(r)("visualization.description"),prop:"description"},{default:n(()=>[p(e(d),{placeholder:e(r)("commons.input_content"),"show-word-limit":"",modelValue:o.form.description,"onUpdate:modelValue":a[4]||(a[4]=l=>o.form.description=l),type:"textarea"},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"]))}});const P=J(W,[["__scopeId","data-v-61b2d79c"]]);export{P as A};
