import{y as J,b as Fe,c as Ue,z as Ge}from"./index-0.0.0-dataease.js";import{E as $e}from"./el-empty-0.0.0-dataease.js";import{a as Ae}from"./el-table-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{a as Oe,v as Q,o as je,n as K,j as Be,G as Pe}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as ze}from"./el-row-0.0.0-dataease.js";import{E as Ze}from"./el-col-0.0.0-dataease.js";import{E as Re,a as qe}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{a as He,E as Xe}from"./el-tabs-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import{d as Je,r as m,X as Qe,y as Y,w as Ke,o as et,f as n,O as u,R as tt,S as k,j as l,i as o,W as w,a6 as F,u as s,g as c,_,P as g,l as U,a3 as at,a4 as f,a8 as V,T as ot}from"./vue-0.0.0-dataease.js";import{v as ee,i as nt}from"./visual-star-0.0.0-dataease.js";import{i as lt}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{S as rt,i as st,a as it}from"./ShareGrid-0.0.0-dataease.js";import{i as te}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as ae}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{d as oe,a as ct}from"./dv-dashboard-spine-mobile-disabled-0.0.0-dataease.js";import{i as ne}from"./icon_pc_outlined-0.0.0-dataease.js";import{G as dt}from"./GridTable-0.0.0-dataease.js";import{d as ut}from"./dayjs.min-0.0.0-dataease.js";import{s as L}from"./ShortcutOption-0.0.0-dataease.js";import{i as pt}from"./interactive-0.0.0-dataease.js";import{f as le}from"./dataVisualization-0.0.0-dataease.js";import mt from"./ShareHandler-0.0.0-dataease.js";import{useAppStoreWithOut as _t}from"./app-0.0.0-dataease.js";import{u as bt}from"./share-0.0.0-dataease.js";import{e as ft}from"./lodash-0.0.0-dataease.js";import{E as vt}from"./index-0.0.0-dataease4.js";import{_ as ht}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./raf-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./el-pagination-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";import"./el-switch-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./icon_refresh_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./ShareTicket-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease19.js";import"./TicketEdit-0.0.0-dataease.js";import"./el-drawer-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./index-0.0.0-dataease20.js";import"./CustomLinkPwd-0.0.0-dataease.js";import"./TicketDialog-0.0.0-dataease.js";const yt={class:"custom-tabs-label"},kt={key:1},wt={key:2,class:"panel-table"},gt={key:0},Ct={key:1},St={key:2},xt={key:3},Dt=Je({__name:"ShortcutTable",props:{expand:{type:Boolean,default:!1}},setup(re){const se=Oe(),{resolve:G}=J(),{t:r}=je(),ie=pt(),{wsCache:$}=Fe(),ce=_t(),de=Ue(),ue=bt(),{push:A}=J(),O=$.get("app.desktop"),C=m(),i=m("recent"),E=m("all_types"),h=Qe({tableData:[],curTypeList:[],tableColumn:[]}),j=Y(()=>ie.getData),W=Y(()=>ue.getShareDisable||O),B={panel:te,panelMobile:oe,dashboard:te,dashboardMobile:oe,dashboardMobileDisabled:ct,screen:ae,dataV:ae,dataset:st,datasource:it},P=t=>t&&["dashboard","panel","dataV","screen"].includes(t.type),z=t=>{(t.paneName==="recent"||t.paneName==="store")&&(D.value=!0,L.setBusiFlag(t.paneName),h.curTypeList=L.getBusiList().filter(a=>a==="all_types"||T.includes(a)),h.tableColumn=L.getColmunList(),S())},pe=()=>{const t=["panel","screen","dataset","datasource"],a=[];for(const d in j.value)j.value[d].menuAuth&&a.push(t[parseInt(d)]);return I.value[0].disabled=!(a!=null&&a.length),I.value[1].disabled=!a.includes("panel")&&!a.includes("screen"),a},me=()=>{S()},_e=$.get("open-backend")==="1"?"_self":"_blank",be=(t,a=!1)=>{if(!a){const d=G({path:"/preview",query:{dvId:t}});window.open(d.href,"_blank")}},fe=t=>{const a=G({path:"/dataset-form",query:{id:t}});window.open(a.href,_e)},ve=(t,a,d)=>ut(new Date(d)).format("YYYY-MM-DD HH:mm:ss"),he={screen:r("work_branch.big_data_screen"),dataV:r("work_branch.big_data_screen"),dashboard:r("work_branch.dashboard"),panel:r("work_branch.dashboard"),dataset:r("work_branch.data_set"),datasource:r("work_branch.data_source")},S=()=>{D.value=!0;const t=E.value==="all_types"?"":E.value;L.loadData({type:t,keyword:C.value,asc:!M.value}).then(a=>{h.tableData=a.data}).finally(()=>{q.value=xe(),H.value=De(),D.value=!1})},I=m([{title:r("work_branch.recently_used"),name:"recent",disabled:!1},{title:r("work_branch.my_collection"),name:"store",disabled:!1},{title:r("visualization.share_out"),name:"share",disabled:!1}]),Z=m([]),ye=t=>{Z.value.push(t)},T=pe(),x=Y(()=>{const t=ft(T.length?I.value:[]);for(const a of Z.value)t.push(a);return t}),R=m(!1);Ke(()=>x.value.length,()=>{x.value.length>0&&!R.value&&(R.value=!0,i.value=x.value[0].name)}),et(()=>{T.length&&z({paneName:"recent",uid:0,slots:void 0,props:void 0,active:!1,index:"",isClosable:!1})});const M=m(!0),D=m(!1),ke=t=>{M.value=!0;const a=t.order.substring(0,t.order.indexOf("ending"));M.value=a==="desc",S()},we=t=>{if(t&&!p(t)){const a=i.value==="recent"?t.id:t.resourceId;if(["dashboard","panel"].includes(t.type))window.open("#/panel/index?dvId="+a,"_self");else if(["dataV","screen"].includes(t.type))window.open("#/screen/index?dvId="+a,"_self");else if(["dataset"].includes(t.type)){const d=de.getToken&&ce.getIsIframe?"dataset-embedded":"dataset";A({name:d,params:{id:a}})}else["datasource"].includes(t.type)&&A({name:"datasource",params:{id:a}})}},ge=t=>{D.value=t},Ce=t=>{const a={id:t.id,type:t.type};le(a).then(()=>{t.favorite=!t.favorite})},p=t=>i.value==="store"&&!t.extFlag1,Se=t=>{if(!p(t)){const a={id:t.resourceId,type:t.type==="dataV"?"screen":"panel"};le(a).then(()=>{S()})}},q=m(),H=m(""),xe=()=>C.value?"tree":"noneWhite",De=()=>C.value?r("work_branch.relevant_content_found"):i.value==="recent"?r("work_branch.no_content_yet"):i.value==="store"?r("work_branch.no_favorites_yet"):"";return(t,a)=>{const d=vt,Ee=Xe,Te=He,Ve=qe,Le=Re,X=Ze,y=K,v=Be,We=Pe,Ie=ze,Me=K,N=Ae,Ne=$e,Ye=Ge;return n(),u(w,null,[x.value.length?tt((n(),u("div",{key:0,class:k(["dashboard-type",re.expand&&"expand"])},[l(Te,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),class:"dashboard-type-tabs",onTabClick:z},{default:o(()=>[(n(!0),u(w,null,F(x.value.filter(e=>!W.value||e.name!=="share"),e=>(n(),c(Ee,{key:e.name,disabled:e.disabled,label:e.title,name:e.name},{label:o(()=>[g("span",yt,[e.disabled?(n(),c(d,{key:0,placement:"top",content:s(r)("work_branch.permission_denied")},{default:o(()=>[g("span",null,f(e.title),1)]),_:2},1032,["content"])):(n(),u("span",kt,f(e.title),1))])]),_:2},1032,["disabled","label","name"]))),128))]),_:1},8,["modelValue"]),s(T).length?(n(),u(w,{key:0},[W.value?_("",!0):(n(),c(rt,{key:0,"active-name":i.value,onSetLoading:ge},null,8,["active-name"])),i.value==="recent"||i.value==="store"?(n(),c(Ie,{key:1},{default:o(()=>[l(X,{span:12},{default:o(()=>[l(Le,{"popper-class":"menu-panel-select_popper",class:"select-type-list",modelValue:E.value,"onUpdate:modelValue":a[1]||(a[1]=e=>E.value=e),onChange:S},{default:o(()=>[(n(!0),u(w,null,F(h.curTypeList,e=>(n(),c(Ve,{key:e,label:s(r)(`auth.${e}`),value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(X,{class:"search",span:12},{default:o(()=>[l(We,{modelValue:C.value,"onUpdate:modelValue":a[2]||(a[2]=e=>C.value=e),clearable:"",onChange:me,placeholder:s(r)("work_branch.search_keyword")},{prefix:o(()=>[l(v,null,{default:o(()=>[l(y,{name:"icon_search-outline_outlined"},{default:o(()=>[l(s(lt),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1})):_("",!0),i.value==="recent"||i.value==="store"?(n(),u("div",wt,[l(dt,{"show-pagination":!1,"table-data":h.tableData,onSortChange:ke,onCellClick:we,"empty-desc":H.value,"empty-img":q.value,class:"workbranch-grid"},{default:o(()=>[l(N,{key:"name",width:"280",prop:"name",label:s(r)("common.name")+"a"},{default:o(e=>[g("div",{class:k(["name-content",{"jump-active":P(e.row)}])},[e.row.extFlag?(n(),c(v,{key:0,style:{"margin-right":"12px","font-size":"18px"}},{default:o(()=>[l(y,null,{default:o(()=>[(n(),c(U(B[e.row.type+"Mobile"+(p(e.row)?"Disabled":"")]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1024)):(n(),c(v,{key:1,class:k(`main-color color-${e.row.type} custom-color${p(e.row)?"-disabled":""}`)},{default:o(()=>[l(y,null,{default:o(()=>[(n(),c(U(B[e.row.type]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1032,["class"])),l(d,{placement:"top"},{content:o(()=>[at(f(e.row.name),1)]),default:o(()=>[g("span",{class:k(["ellipsis",{"color-disabled":p(e.row)}]),style:{"max-width":"250px"}},f(e.row.name),3)]),_:2},1024),i.value==="recent"&&["screen","panel"].includes(e.row.type)?(n(),c(v,{key:2,class:"custom-icon",onClick:V(b=>Ce(e.row),["stop"]),style:ot({color:e.row.favorite?"#FFC60A":"#646A73"})},{default:o(()=>[l(Me,null,{default:o(()=>[(n(),c(U(e.row.favorite?s(ee):s(nt))))]),_:2},1024)]),_:2},1032,["onClick","style"])):_("",!0)],2)]),_:1},8,["label"]),(n(!0),u(w,null,F(h.tableColumn,e=>(n(),c(N,{key:e.label,prop:e.field,"show-overflow-tooltip":"",sortable:e.type==="time",label:e.label},{default:o(b=>[g("span",{class:k({"jump-active":P(b.row)})},[e.type&&e.type==="time"?(n(),u("span",gt,f(ve(null,null,b.row[e.field])),1)):e.field&&e.field==="type"?(n(),u("span",Ct,f(he[b.row[e.field]]),1)):s(O)&&e.field&&e.field.endsWith("tor")?(n(),u("span",St,f(s(se).getName),1)):(n(),u("span",xt,f(b.row[e.field]),1))],2)]),_:2},1032,["prop","sortable","label"]))),128)),l(N,{width:"100",fixed:"right",key:"_operation",label:t.$t("common.operate")},{default:o(e=>[g("div",{style:{display:"flex","flex-direction":"row","align-items":"center"},class:k({"opt-disabled":p(e.row)})},[["dashboard","dataV","panel","screen"].includes(e.row.type)?(n(),u(w,{key:0},[l(d,{effect:"dark",content:s(r)("work_branch.new_page_preview"),disabled:p(e.row),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:V(b=>be(i.value==="recent"?e.row.id:e.row.resourceId,p(e.row)),["stop"])},{default:o(()=>[l(y,{name:"icon_pc_outlined"},{default:o(()=>[l(s(ne),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["content","disabled"]),W.value?_("",!0):(n(),c(mt,{key:0,"in-grid":!0,disabled:p(e.row),weight:e.row.weight,"resource-id":i.value==="recent"?e.row.id:e.row.resourceId,"resource-type":e.row.type},null,8,["disabled","weight","resource-id","resource-type"])),i.value==="store"?(n(),c(d,{key:1,effect:"dark",disabled:p(e.row),content:s(r)("work_branch.cancel_favorites"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:V(b=>Se(e.row),["stop"])},{default:o(()=>[l(y,{name:"icon_cancel_store"},{default:o(()=>[l(s(ee),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["disabled","content"])):_("",!0)],64)):_("",!0),["dataset"].includes(e.row.type)?(n(),c(d,{key:1,effect:"dark",content:s(r)("work_branch.open_dataset"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:V(b=>fe(i.value==="recent"?e.row.id:e.row.resourceId),["stop"])},{default:o(()=>[l(y,{name:"icon_pc_outlined"},{default:o(()=>[l(s(ne),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["content"])):_("",!0)],2)]),_:1},8,["label"])]),_:1},8,["table-data","empty-desc","empty-img"])])):_("",!0)],64)):_("",!0),i.value==="data-filling"?(n(),c(s(Q),{key:1,jsname:"L21lbnUvZGF0YS9kYXRhLWZpbGxpbmcvZmlsbC9UYWJQYW5lVGFibGU="})):_("",!0)],2)),[[Ye,D.value]]):(n(),c(Ne,{key:1,class:"dashboard-type",description:s(r)("work_branch.administrator_for_authorization")},null,8,["description"])),l(s(Q),{jsname:"L21lbnUvZGF0YS9kYXRhLWZpbGxpbmcvZmlsbC9UYWJQYW5l",onLoaded:ye})],64)}}});const Za=ht(Dt,[["__scopeId","data-v-d20384b5"]]);export{Za as default};
