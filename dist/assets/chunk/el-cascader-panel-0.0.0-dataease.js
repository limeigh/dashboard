import{i as X,_ as se,ai as we,W as Ne,m as Le,R as Se,E as De,aF as ne,U as Me,l as Ve,q as Y,O as _e,w as Pe}from"./index-0.0.0-dataease.js";import{j as ye,ac as Te,aP as Ae,a3 as oe,ah as ie,ag as Ie,E as z,aN as Q,aO as He}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as G,h as Oe,x as be,y,e as $,f as k,O as P,_,g as H,a8 as de,i as F,P as qe,j,S as L,W,r as B,a6 as Ce,a3 as ce,a4 as re,Z as Ee,q as ze,K as ue,A as he,N as Be,L as Fe,X as pe,w as ee,aG as Ke,o as Ue,n as je}from"./vue-0.0.0-dataease.js";import{E as Ze}from"./el-checkbox-0.0.0-dataease.js";import{E as Re}from"./index-0.0.0-dataease27.js";import{c as fe}from"./strings-0.0.0-dataease.js";import{n as R,T as xe,e as We}from"./lodash-0.0.0-dataease.js";import{u as ve,c as me}from"./arrays-0.0.0-dataease.js";var Xe=G({name:"NodeContent",setup(){return{ns:X("cascader-node")}},render(){const{ns:e}=this,{node:n,panel:a}=this.$parent,{data:s,label:t}=n,{renderLabelFn:i}=a;return Oe("span",{class:e.e("label")},i?i({node:n,data:s}):t)}});const te=Symbol(),Ge=G({name:"ElCascaderNode",components:{ElCheckbox:Ze,ElRadio:Re,NodeContent:Xe,ElIcon:ye,Check:we,Loading:Ne,ArrowRight:Le},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:n}){const a=be(te),s=X("cascader-node"),t=y(()=>a.isHoverMenu),i=y(()=>a.config.multiple),o=y(()=>a.config.checkStrictly),u=y(()=>{var p;return(p=a.checkedNodes[0])==null?void 0:p.uid}),r=y(()=>e.node.isDisabled),f=y(()=>e.node.isLeaf),h=y(()=>o.value&&!f.value||!r.value),N=y(()=>K(a.expandingNode)),b=y(()=>o.value&&a.checkedNodes.some(K)),K=p=>{var E;const{level:I,uid:J}=e.node;return((E=p==null?void 0:p.pathNodes[I-1])==null?void 0:E.uid)===J},S=()=>{N.value||a.expandNode(e.node)},O=p=>{const{node:E}=e;p!==E.checked&&a.handleCheckChange(E,p)},w=()=>{a.lazyLoad(e.node,()=>{f.value||S()})},T=p=>{t.value&&(A(),!f.value&&n("expand",p))},A=()=>{const{node:p}=e;!h.value||p.loading||(p.loaded?S():w())},q=()=>{t.value&&!f.value||(f.value&&!r.value&&!o.value&&!i.value?D(!0):A())},U=p=>{o.value?(O(p),e.node.loaded&&S()):D(p)},D=p=>{e.node.loaded?(O(p),!o.value&&S()):w()};return{panel:a,isHoverMenu:t,multiple:i,checkStrictly:o,checkedNodeId:u,isDisabled:r,isLeaf:f,expandable:h,inExpandingPath:N,inCheckedPath:b,ns:s,handleHoverExpand:T,handleExpand:A,handleClick:q,handleCheck:D,handleSelectCheck:U}}});function Je(e,n,a,s,t,i){const o=$("el-checkbox"),u=$("el-radio"),r=$("node-content"),f=$("check"),h=$("el-icon"),N=$("loading"),b=$("arrow-right");return k(),P("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?void 0:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:L([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[_(" prefix "),e.multiple?(k(),H(o,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:de(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(k(),H(u,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:de(()=>{},["stop"])},{default:F(()=>[_(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),qe("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):_("v-if",!0),_(" content "),j(r),e.isLeaf&&e.node.checked?(k(),H(h,{key:2,class:L(e.ns.e("prefix"))},{default:F(()=>[j(f)]),_:1},8,["class"])):_("v-if",!0),_(" postfix "),e.isLeaf?_("v-if",!0):(k(),P(W,{key:3},[e.node.loading?(k(),H(h,{key:0,class:L([e.ns.is("loading"),e.ns.e("postfix")])},{default:F(()=>[j(N)]),_:1},8,["class"])):(k(),H(h,{key:1,class:L(["arrow-right",e.ns.e("postfix")])},{default:F(()=>[j(b)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var Ye=se(Ge,[["render",Je],["__file","node.vue"]]);const Qe=G({name:"ElCascaderMenu",components:{Loading:Ne,ElIcon:ye,ElScrollbar:Se,ElCascaderNode:Ye},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const n=ze(),a=X("cascader-menu"),{t:s}=De(),t=Te();let i=null,o=null;const u=be(te),r=B(null),f=y(()=>!e.nodes.length),h=y(()=>!u.initialLoaded),N=y(()=>`${t.value}-${e.index}`),b=w=>{i=w.target},K=w=>{if(!(!u.isHoverMenu||!i||!r.value))if(i.contains(w.target)){S();const T=n.vnode.el,{left:A}=T.getBoundingClientRect(),{offsetWidth:q,offsetHeight:U}=T,D=w.clientX-A,p=i.offsetTop,E=p+i.offsetHeight;r.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${D} ${p} L${q} 0 V${p} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${D} ${E} L${q} ${U} V${E} Z" />
        `}else o||(o=window.setTimeout(O,u.config.hoverThreshold))},S=()=>{o&&(clearTimeout(o),o=null)},O=()=>{r.value&&(r.value.innerHTML="",S())};return{ns:a,panel:u,hoverZone:r,isEmpty:f,isLoading:h,menuId:N,t:s,handleExpand:b,handleMouseMove:K,clearHoverZone:O}}});function en(e,n,a,s,t,i){const o=$("el-cascader-node"),u=$("loading"),r=$("el-icon"),f=$("el-scrollbar");return k(),H(f,{key:e.menuId,tag:"ul",role:"menu",class:L(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:F(()=>{var h;return[(k(!0),P(W,null,Ce(e.nodes,N=>(k(),H(o,{key:N.uid,node:N,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(k(),P("div",{key:0,class:L(e.ns.e("empty-text"))},[j(r,{size:"14",class:L(e.ns.is("loading"))},{default:F(()=>[j(u)]),_:1},8,["class"]),ce(" "+re(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(k(),P("div",{key:1,class:L(e.ns.e("empty-text"))},[Ee(e.$slots,"empty",{},()=>[ce(re(e.t("el.cascader.noData")),1)])],2)):(h=e.panel)!=null&&h.isHoverMenu?(k(),P(W,{key:2},[_(" eslint-disable-next-line vue/html-self-closing "),(k(),P("svg",{ref:"hoverZone",class:L(e.ns.e("hover-zone"))},null,2))],2112)):_("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var nn=se(Qe,[["render",en],["__file","menu.vue"]]);let an=0;const sn=e=>{const n=[e];let{parent:a}=e;for(;a;)n.unshift(a),a=a.parent;return n};class Z{constructor(n,a,s,t=!1){this.data=n,this.config=a,this.parent=s,this.root=t,this.uid=an++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:i,label:o,children:u}=a,r=n[u],f=sn(this);this.level=t?0:s?s.level+1:1,this.value=n[i],this.label=n[o],this.pathNodes=f,this.pathValues=f.map(h=>h.value),this.pathLabels=f.map(h=>h.label),this.childrenData=r,this.children=(r||[]).map(h=>new Z(h,a,this)),this.loaded=!a.lazy||this.isLeaf||!ne(r)}get isDisabled(){const{data:n,parent:a,config:s}=this,{disabled:t,checkStrictly:i}=s;return(ue(t)?t(n,this):!!n[t])||!i&&(a==null?void 0:a.isDisabled)}get isLeaf(){const{data:n,config:a,childrenData:s,loaded:t}=this,{lazy:i,leaf:o}=a,u=ue(o)?o(n,this):n[o];return Me(u)?i&&!t?!1:!(he(s)&&s.length):!!u}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(n){const{childrenData:a,children:s}=this,t=new Z(n,this.config,this);return he(a)?a.push(n):this.childrenData=[n],s.push(t),t}calcText(n,a){const s=n?this.pathLabels.join(a):this.label;return this.text=s,s}broadcast(n,...a){const s=`onParent${fe(n)}`;this.children.forEach(t=>{t&&(t.broadcast(n,...a),t[s]&&t[s](...a))})}emit(n,...a){const{parent:s}=this,t=`onChild${fe(n)}`;s&&(s[t]&&s[t](...a),s.emit(n,...a))}onParentCheck(n){this.isDisabled||this.setCheckState(n)}onChildCheck(){const{children:n}=this,a=n.filter(t=>!t.isDisabled),s=a.length?a.every(t=>t.checked):!1;this.setCheckState(s)}setCheckState(n){const a=this.children.length,s=this.children.reduce((t,i)=>{const o=i.checked?1:i.indeterminate?.5:0;return t+o},0);this.checked=this.loaded&&this.children.filter(t=>!t.isDisabled).every(t=>t.loaded&&t.checked)&&n,this.indeterminate=this.loaded&&s!==a&&s>0}doCheck(n){if(this.checked===n)return;const{checkStrictly:a,multiple:s}=this.config;a||!s?this.checked=n:(this.broadcast("check",n),this.setCheckState(n),this.emit("check"))}}const ae=(e,n)=>e.reduce((a,s)=>(s.isLeaf?a.push(s):(!n&&a.push(s),a=a.concat(ae(s.children,n))),a),[]);class ge{constructor(n,a){this.config=a;const s=(n||[]).map(t=>new Z(t,this.config));this.nodes=s,this.allNodes=ae(s,!1),this.leafNodes=ae(s,!0)}getNodes(){return this.nodes}getFlattedNodes(n){return n?this.leafNodes:this.allNodes}appendNode(n,a){const s=a?a.appendChild(n):new Z(n,this.config);a||this.nodes.push(s),this.appendAllNodesAndLeafNodes(s)}appendNodes(n,a){n.forEach(s=>this.appendNode(s,a))}appendAllNodesAndLeafNodes(n){this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n),n.children&&n.children.forEach(a=>{this.appendAllNodesAndLeafNodes(a)})}getNodeByValue(n,a=!1){return!n&&n!==0?null:this.getFlattedNodes(a).find(t=>R(t.value,n)||R(t.pathValues,n))||null}getSameNode(n){return n&&this.getFlattedNodes(!1).find(({value:s,level:t})=>R(n.value,s)&&n.level===t)||null}}const tn=Ve({modelValue:{type:Y([Number,String,Array])},options:{type:Y(Array),default:()=>[]},props:{type:Y(Object),default:()=>({})}}),ln={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:Be,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},on=e=>y(()=>({...ln,...e.props})),ke=e=>{if(!e)return 0;const n=e.id.split("-");return Number(n[n.length-2])},dn=e=>{if(!e)return;const n=e.querySelector("input");n?n.click():Ae(e)&&e.click()},cn=(e,n)=>{const a=n.slice(0),s=a.map(i=>i.uid),t=e.reduce((i,o)=>{const u=s.indexOf(o.uid);return u>-1&&(i.push(o),a.splice(u,1),s.splice(u,1)),i},[]);return t.push(...a),t},rn=G({name:"ElCascaderPanel",components:{ElCascaderMenu:nn},props:{...tn,border:{type:Boolean,default:!0},renderLabel:Function},emits:[oe,ie,"close","expand-change"],setup(e,{emit:n,slots:a}){let s=!1;const t=X("cascader"),i=on(e);let o=null;const u=B(!0),r=B([]),f=B(null),h=B([]),N=B(null),b=B([]),K=y(()=>i.value.expandTrigger==="hover"),S=y(()=>e.renderLabel||a.default),O=()=>{const{options:l}=e,d=i.value;s=!1,o=new ge(l,d),h.value=[o.getNodes()],d.lazy&&ne(e.options)?(u.value=!1,w(void 0,c=>{c&&(o=new ge(c,d),h.value=[o.getNodes()]),u.value=!0,I(!1,!0)})):I(!1,!0)},w=(l,d)=>{const c=i.value;l=l||new Z({},c,void 0,!0),l.loading=!0;const v=m=>{const g=l,M=g.root?null:g;m&&(o==null||o.appendNodes(m,M)),g.loading=!1,g.loaded=!0,g.childrenData=g.childrenData||[],d&&d(m)};c.lazyLoad(l,v)},T=(l,d)=>{var c;const{level:v}=l,m=h.value.slice(0,v);let g;l.isLeaf?g=l.pathNodes[v-2]:(g=l,m.push(l.children)),((c=N.value)==null?void 0:c.uid)!==(g==null?void 0:g.uid)&&(N.value=l,h.value=m,!d&&n("expand-change",(l==null?void 0:l.pathValues)||[]))},A=(l,d,c=!0)=>{const{checkStrictly:v,multiple:m}=i.value,g=b.value[0];s=!0,!m&&(g==null||g.doCheck(!1)),l.doCheck(d),E(),c&&!m&&!v&&n("close"),!c&&!m&&!v&&q(l)},q=l=>{l&&(l=l.parent,q(l),l&&T(l))},U=l=>o==null?void 0:o.getFlattedNodes(l),D=l=>{var d;return(d=U(l))==null?void 0:d.filter(c=>c.checked!==!1)},p=()=>{b.value.forEach(l=>l.doCheck(!1)),E(),h.value=h.value.slice(0,1),N.value=null,n("expand-change",[])},E=()=>{var l;const{checkStrictly:d,multiple:c}=i.value,v=b.value,m=D(!d),g=cn(v,m),M=g.map(C=>C.valueByOption);b.value=g,f.value=c?M:(l=M[0])!=null?l:null},I=(l=!1,d=!1)=>{const{modelValue:c}=e,{lazy:v,multiple:m,checkStrictly:g}=i.value,M=!g;if(!(!u.value||s||!d&&R(c,f.value)))if(v&&!l){const x=ve(xe(me(c))).map(V=>o==null?void 0:o.getNodeByValue(V)).filter(V=>!!V&&!V.loaded&&!V.loading);x.length?x.forEach(V=>{w(V,()=>I(!1,d))}):I(!0,d)}else{const C=m?me(c):[c],x=ve(C.map(V=>o==null?void 0:o.getNodeByValue(V,M)));J(x,d),f.value=We(c)}},J=(l,d=!0)=>{const{checkStrictly:c}=i.value,v=b.value,m=l.filter(C=>!!C&&(c||C.isLeaf)),g=o==null?void 0:o.getSameNode(N.value),M=d&&g||m[0];M?M.pathNodes.forEach(C=>T(C,!0)):N.value=null,v.forEach(C=>C.doCheck(!1)),pe(m).forEach(C=>C.doCheck(!0)),b.value=m,je(le)},le=()=>{_e&&r.value.forEach(l=>{const d=l==null?void 0:l.$el;if(d){const c=d.querySelector(`.${t.namespace.value}-scrollbar__wrap`),v=d.querySelector(`.${t.b("node")}.${t.is("active")}`)||d.querySelector(`.${t.b("node")}.in-active-path`);Ie(c,v)}})},$e=l=>{const d=l.target,{code:c}=l;switch(c){case z.up:case z.down:{l.preventDefault();const v=c===z.up?-1:1;Q(He(d,v,`.${t.b("node")}[tabindex="-1"]`));break}case z.left:{l.preventDefault();const v=r.value[ke(d)-1],m=v==null?void 0:v.$el.querySelector(`.${t.b("node")}[aria-expanded="true"]`);Q(m);break}case z.right:{l.preventDefault();const v=r.value[ke(d)+1],m=v==null?void 0:v.$el.querySelector(`.${t.b("node")}[tabindex="-1"]`);Q(m);break}case z.enter:case z.numpadEnter:dn(d);break}};return Fe(te,pe({config:i,expandingNode:N,checkedNodes:b,isHoverMenu:K,initialLoaded:u,renderLabelFn:S,lazyLoad:w,expandNode:T,handleCheckChange:A})),ee([i,()=>e.options],O,{deep:!0,immediate:!0}),ee(()=>e.modelValue,()=>{s=!1,I()},{deep:!0}),ee(()=>f.value,l=>{R(l,e.modelValue)||(n(oe,l),n(ie,l))}),Ke(()=>r.value=[]),Ue(()=>!ne(e.modelValue)&&I()),{ns:t,menuList:r,menus:h,checkedNodes:b,handleKeyDown:$e,handleCheckChange:A,getFlattedNodes:U,getCheckedNodes:D,clearCheckedNodes:p,calculateCheckedValue:E,scrollToExpandingNode:le}}});function un(e,n,a,s,t,i){const o=$("el-cascader-menu");return k(),P("div",{class:L([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(k(!0),P(W,null,Ce(e.menus,(u,r)=>(k(),H(o,{key:r,ref_for:!0,ref:f=>e.menuList[r]=f,index:r,nodes:[...u]},{empty:F(()=>[Ee(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var hn=se(rn,[["render",un],["__file","index.vue"]]);const bn=Pe(hn);export{tn as C,bn as E};
