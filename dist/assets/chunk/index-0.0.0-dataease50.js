import{z as j}from"./index-0.0.0-dataease.js";import{E as q}from"./EmptyBackground-0.0.0-dataease.js";import{o as z,D as L,F as A,n as W,j as G,G as H,y as K}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as R}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as U}from"./icon_add_outlined-0.0.0-dataease.js";import{_ as J}from"./UploadDetail.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{u as Q}from"./appearance-0.0.0-dataease.js";import{a as X,e as Y,d as Z}from"./font-0.0.0-dataease.js";import{e as B}from"./lodash-0.0.0-dataease.js";import{d as tt,r as h,y as et,o as ot,f as i,O as u,R as st,P as c,a3 as _,a4 as a,u as s,j as d,i as l,W as N,a6 as nt,_ as p,S as at,g}from"./vue-0.0.0-dataease.js";import{_ as it}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./icon_upload_outlined-0.0.0-dataease.js";import"./FontInfo-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./tslib.es6-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";const lt={class:"font-management_system"},rt={class:"route-title"},ct={class:"search-font"},dt={class:"font-content_overflow"},ut={key:0,class:"font-content_list"},mt={key:0,class:"font-default"},_t={class:"font-name"},ft=["title"],pt={key:0,class:"font-type"},yt=["title"],vt=["title"],ht={class:"font-upload_btn"},gt={key:1,style:{height:"178px","margin-top":"142px"}},kt=tt({__name:"index",setup(Ct){const v=Q(),{t:o}=z(),k=h(""),C=h([]),b="./de2api",$=h(),r=h(!1),w=(n,t,f)=>{$.value.init(n,t,f)},x=async()=>{r.value=!0,await v.setFontList(),C.value=B(v.fontList),r.value=!1},E=et(()=>C.value.filter(n=>{var t;return(t=n.name)==null?void 0:t.toLocaleLowerCase().includes(k.value.trim().toLocaleLowerCase())})),T=n=>{if(n.isDefault){L.warning(o("system.fonts_before_deleting"));return}A.confirm(o("system.sure_to_delete"),{confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1}).then(()=>{r.value=!0,X(n.id).then(()=>{L.success(o("common.delete_success")),x(),D()}).finally(()=>{r.value=!1})})},S=n=>{n.isDefault=1,r.value=!0,Y(n).then(()=>{L.success(o("system.setting_successful")),D(),x()}).finally(()=>{r.value=!1})},V=(n,t,f)=>{let m=document.querySelector("#de-custom_font");!m&&t&&(m=document.createElement("style"),m.setAttribute("id","de-custom_font"),document.querySelector("head").appendChild(m)),m.innerHTML=t&&f?`@font-face {
              font-family: '${t}';
              src: url(${n});
              font-weight: normal;
              font-style: normal;
              }`:"",document.documentElement.style.setProperty("--de-custom_font",`${t||""}`),document.documentElement.style.setProperty("--van-base-font",`${t||""}`)},D=()=>{Z().then(n=>{const[t]=n||[];V(`${b}/typeface/download/${t==null?void 0:t.fileTransName}`,t==null?void 0:t.name,t==null?void 0:t.fileTransName)})},I=async()=>{r.value=!0,await v.setFontList(),C.value=B(v.fontList),r.value=!1,D()};return ot(()=>{x()}),(n,t)=>{const f=W,m=G,M=H,y=K,P=q,O=j;return i(),u(N,null,[st((i(),u("div",lt,[c("div",rt,[_(a(s(o)("system.font_management"))+" ",1),c("div",ct,[d(M,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e),clearable:"",style:{width:"240px"},placeholder:s(o)("system.search_font_name")},{prefix:l(()=>[d(m,null,{default:l(()=>[d(f,{name:"icon_search-outline_outlined"},{default:l(()=>[d(s(R),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),d(y,{type:"primary",onClick:t[1]||(t[1]=e=>w(s(o)("system.a_new_font"),"create",{}))},{icon:l(()=>[d(f,{name:"icon_add_outlined"},{default:l(()=>[d(s(U),{class:"svg-icon"})]),_:1})]),default:l(()=>[_(" "+a(s(o)("system.add_font")),1)]),_:1})])]),c("div",dt,[E.value.length?(i(),u("div",ut,[(i(!0),u(N,null,nt(E.value,e=>(i(),u("div",{class:"font-content_item",key:e},[e.isDefault?(i(),u("span",mt,a(s(o)("system.default_font")),1)):p("",!0),c("div",_t,[c("span",{title:e.name,class:at(!e.isBuiltin&&"font-name_text")},a(e.name),11,ft),e.isBuiltin?(i(),u("span",pt,a(s(o)("system.system_built_in")),1)):p("",!0)]),c("div",{title:e.fileName,class:"font-update_time"},[_(a(s(o)("system.update_time"))+" "+a(new Date(e.updateTime).toLocaleString())+" ",1),t[2]||(t[2]=c("span",{class:"line"},null,-1)),c("span",{title:e.fileName,class:"font-update_text"},a(s(o)("system.font_file"))+" "+a(e.fileName),9,vt)],8,yt),c("div",ht,[e.fileTransName?p("",!0):(i(),g(y,{key:0,onClick:F=>w(s(o)("system.upload_font_file"),"uploadFile",e),secondary:""},{default:l(()=>[_(a(s(o)("system.upload_font_file")),1)]),_:1},8,["onClick"])),e.fileTransName?(i(),g(y,{key:1,onClick:F=>w(s(o)("system.replace_font_file"),"uploadFile",e),secondary:""},{default:l(()=>[_(a(s(o)("system.replace_font_file")),1)]),_:1},8,["onClick"])):p("",!0),e.isDefault?p("",!0):(i(),g(y,{key:2,onClick:F=>S(e),secondary:""},{default:l(()=>[_(a(s(o)("system.as_default_font")),1)]),_:1},8,["onClick"])),e.id!=="1"?(i(),g(y,{key:3,onClick:F=>T(e),secondary:""},{default:l(()=>[_(a(s(o)("common.delete")),1)]),_:1},8,["onClick"])):p("",!0)])]))),128))])):(i(),u("div",gt,[d(P,{description:n.$t("work_branch.relevant_content_found"),"img-type":"tree"},null,8,["description"])]))])])),[[O,r.value]]),d(J,{onFinish:I,ref_key:"uploadDetail",ref:$},null,512)],64)}}});const te=it(kt,[["__scopeId","data-v-5c1da0fd"]]);export{te as default};
