import{p as E}from"./index-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import{o as I}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import P from"./ApiVariable-0.0.0-dataease.js";import{_ as k}from"./CodeEdit.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{U as b,x as $,V as F,W as D,K as J,X as L,j as U}from"./lodash-0.0.0-dataease.js";import{B as _,K}from"./ApiTestModel-0.0.0-dataease.js";import{E as X,a as Y}from"./index-0.0.0-dataease27.js";import{d as G,t as H,w as q,aj as z,f as g,O as w,j as m,i as j,u as i,a3 as x,a4 as S,_ as C}from"./vue-0.0.0-dataease.js";import{_ as Q}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./util-0.0.0-dataease.js";import"./vuedraggable-es-0.0.0-dataease.js";const A=Array.isArray;class Z{constructor(){this._option={$id:"http://example.com/root.json",$schema:"http://json-schema.org/draft-07/schema#"},this._object=null}format(a,d={}){if(!b(a))throw new TypeError("传入参数只能是对象或数组");this._option=Object.assign(this._option,d),this._object=a;let n;return A(a)?n=this._arrayToSchema():n=this._objectToSchema(),this._object=null,n}_arrayToSchema(){const a=this._value2object(this._object,this._option.$id,"",!0);if(this._object.length>0){const d=[];for(let n=0;n<this._object.length;n++){const r=this._object[n];let s=this._value2object(r,"#/items","items");if(b(r)&&!$(r)){const u=this._json2schema(r,"#/items");s=Object.assign(s,u)}d.push(s)}a.items=d}return a}_objectToSchema(){let a=this._value2object(this._object,this._option.$id,"",!0);const d=this._json2schema(this._object);return a=Object.assign(a,d),a}_json2schema(a,d=""){if(!b(a))return;(d===""||d===void 0)&&(d="#");const n={};A(a)?n.items={}:n.properties={};for(const r in a)if(Object.prototype.hasOwnProperty.call(a,r)){const s=a[r];if(s===void 0)continue;const u=`${d}/properties/${r}`;if(!n.properties)continue;if(b(s))if(n.properties[r]=this._value2object(s,u,r),A(s)){if(s.length>0){const t=[];for(let y=0;y<s.length;y++){const f=s[y];let v=this._value2object(f,`${u}/items`,r+"items");b(f)&&!$(f)&&(v=Object.assign(v,this._json2schema(f,`${u}/items`))),t.push(v)}n.properties[r].items=t}}else n.properties[r]=Object.assign(n.properties[r],this._json2schema(s,u));else n.properties&&(n.properties[r]=this._value2object(s,u,r))}return n}_value2object(a,d,n="",r=!1){const s={$id:d,title:`The ${n} Schema`,mock:{mock:a}};return r&&(s.$schema=this._option.$schema,s.title="The Root Schema",s.mock=void 0),F(a)?s.type="boolean":D(a)?s.type="integer":J(a)?s.type="number":L(a)?s.type="string":U(a)?s.type="null":A(a)?(s.type="array",s.mock=void 0):b(a)&&(s.type="object",s.mock=void 0),s}}const ee=Z,te={class:"radio-group_api"},oe={key:0,style:{"padding-top":"16px"}},se={key:1,class:"ms-body"},ae={key:2,class:"ms-body"},ie={key:3,class:"ms-body"},ne=G({__name:"ApiBody",props:{isReadOnly:E.bool.def(!1),isShowEnable:E.bool.def(!1),body:{type:Object,default:()=>({raw:"",typeChange:"",format:"",jsonSchema:"",type:"",kvs:[]})},headers:{type:Array,default:()=>[]},valueList:{type:Array,default:()=>[]}},emits:["headersChange"],setup(c,{emit:a}){const d=c,{t:n}=I(),r=["text","json","xml","html"],s=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,{body:t,headers:y}=H(d);q(()=>t.value.raw,()=>{if(t.value.format!=="JSON-SCHEMA"&&t.value.raw)try{const o=new ee().format(JSON.parse(t.value.raw));t.value.jsonSchema?t.value.jsonSchema=N(o):t.value.jsonSchema=o}catch{t.value.jsonSchema=""}}),z(()=>{t.value.type||(t.value.type=_.FORM_DATA),t.value.kvs&&t.value.kvs.forEach(e=>{e.type||(e.type="text")})});const f=e=>{const o=typeof e;return e!==null&&(o==="object"||o==="function")},v=e=>{if(e!=null)return Object(e)},T=(e,o,l)=>{const p=o[l];p!=null&&(!s.call(e,l)||!f(p)?e[l]=p:e[l]=V(Object(e[l]),o[l]))},V=(e,o)=>{if(e===o)return e;o=Object(o);for(const l in o)s.call(o,l)&&T(e,o,l);if(Object.getOwnPropertySymbols){const l=Object.getOwnPropertySymbols(o);for(let p=0;p<l.length;p++)u.call(o,l[p])&&T(e,o,l[p])}return e},N=function(e){e=v(e);for(let o=1;o<arguments.length;o++)V(e,arguments[o]);return e},O=()=>{switch(t.value.type){case"JSON":R("application/json");break;case"XML":R("text/xml");break;case"WWW_FORM":R("application/x-www-form-urlencoded");break;case"BINARY":R("application/octet-stream");break;default:B();break}},R=e=>{let o=!1;y.value.forEach(l=>{l.name==="Content-Type"&&(l.value=e,o=!0)}),o||y.value.unshift(new K({name:"Content-Type",value:e}))},B=()=>{for(const e in y.value)if(y.value[e].name==="Content-Type"){y.value.splice(parseInt(e),1),W("headersChange");return}},M=e=>{isNaN(e)?t.value.kvs.push(e):t.value.kvs.splice(e,1)},W=a;return(e,o)=>{const l=X,p=Y;return g(),w("div",te,[m(p,{modelValue:i(t).type,"onUpdate:modelValue":o[0]||(o[0]=h=>i(t).type=h)},{default:j(()=>[m(l,{disabled:c.isReadOnly,label:i(_).FORM_DATA,onChange:O},{default:j(()=>[x(S(i(n)("datasource.body_form_data")),1)]),_:1},8,["disabled","label"]),m(l,{disabled:c.isReadOnly,label:i(_).WWW_FORM,onChange:O},{default:j(()=>[x(S(i(n)("datasource.body_x_www_from_urlencoded")),1)]),_:1},8,["disabled","label"]),m(l,{disabled:c.isReadOnly,label:i(_).JSON,onChange:O},{default:j(()=>[x(S(i(n)("datasource.body_json")),1)]),_:1},8,["disabled","label"]),m(l,{disabled:c.isReadOnly,label:i(_).XML,onChange:O},{default:j(()=>[x(S(i(n)("datasource.body_xml")),1)]),_:1},8,["disabled","label"]),m(l,{disabled:c.isReadOnly,label:i(_).RAW,onChange:O},{default:j(()=>[x(S(i(n)("datasource.body_raw")),1)]),_:1},8,["disabled","label"])]),_:1},8,["modelValue"]),i(t).type=="Form_Data"||i(t).type=="WWW_FORM"?(g(),w("div",oe,[m(P,{"is-read-only":c.isReadOnly,parameters:i(t).kvs,"is-show-enable":c.isShowEnable,type:"body",onChangeParameters:M,"value-list":c.valueList},null,8,["is-read-only","parameters","is-show-enable","value-list"])])):C("",!0),i(t).type=="JSON"?(g(),w("div",se,[m(k,{ref:"codeEdit","read-only":c.isReadOnly,modelValue:i(t).raw,"onUpdate:modelValue":o[1]||(o[1]=h=>i(t).raw=h),class:"api-body-code",data:i(t).raw,modes:r,mode:"json",height:"200px"},null,8,["read-only","modelValue","data"])])):C("",!0),i(t).type=="XML"?(g(),w("div",ae,[m(k,{ref:"codeEdit","read-only":c.isReadOnly,class:"api-body-code",modelValue:i(t).raw,"onUpdate:modelValue":o[2]||(o[2]=h=>i(t).raw=h),data:i(t).raw,height:"200px",mode:"xml",modes:r},null,8,["read-only","modelValue","data"])])):C("",!0),i(t).type=="Raw"?(g(),w("div",ie,[m(k,{ref:"codeEdit","read-only":c.isReadOnly,modelValue:i(t).raw,"onUpdate:modelValue":o[3]||(o[3]=h=>i(t).raw=h),data:i(t).raw,height:"200px",class:"api-body-code",modes:r},null,8,["read-only","modelValue","data"])])):C("",!0)])}}});const Pe=Q(ne,[["__scopeId","data-v-d24e55ee"]]);export{Pe as default};
