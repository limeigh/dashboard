import{b as te,y as ae}from"./index-0.0.0-dataease.js";import{o as oe,n as re,j as ne,G as se}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{a as le,b as ie,E as ce}from"./el-dropdown-menu-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import{d as de}from"./dv-folder-0.0.0-dataease.js";import{i as ue}from"./icon_dashboard-0.0.0-dataease.js";import{i as j}from"./icon_right_outlined-0.0.0-dataease.js";import{i as me}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as pe,a as ve}from"./dv-sort-desc-0.0.0-dataease.js";import{d as _e,r as f,af as fe,y as he,w as ge,ai as be,o as ye,f as i,O as m,j as n,i as s,u as d,P as N,a4 as S,W as C,a6 as L,_ as g,g as D,S as M,a3 as ke,T as we}from"./vue-0.0.0-dataease.js";import{d as Ce}from"./dvMain-0.0.0-dataease.js";import{t as De}from"./treeSortUtils-0.0.0-dataease.js";import{i as Te}from"./interactive-0.0.0-dataease.js";import xe from"./DashboardCell-0.0.0-dataease.js";import{s as Ie}from"./index-0.0.0-dataease33.js";import{s as Ne}from"./index-0.0.0-dataease59.js";import"./index-0.0.0-dataease30.js";import"./index-0.0.0-dataease60.js";import{e as y}from"./lodash-0.0.0-dataease.js";import{_ as Se}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./dropdown-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./index-0.0.0-dataease21.js";import"./antv-0.0.0-dataease.js";import"./index-0.0.0-dataease22.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./tslib.es6-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./index-0.0.0-dataease29.js";const Le={class:"mobile-dashboard"},Me={key:0,class:"direct-name-arr"},Ee={class:"label primary-name"},Ve=["onClick"],Fe={key:0,class:"dashboard-cell-group_filter"},Oe={key:0,class:"ed-dropdown-menu__item--divided"},Be=_e({__name:"index",emits:["hiddenTabbar","setLoading"],setup($e,{emit:q}){const z=f(!1),R=f(!1),p=f([]),a=f([]),u=f([]),v=f(""),E=Te(),V=Ce(),{dvInfo:T}=fe(V),{wsCache:l}=te("sessionStorage"),{t:k}=oe(),F=(e,o)=>{const t=e.shift();return o.reduce((c,_)=>{if(t&&_.id===t){if(!e.length)return _.children||[];c=F([...e],_.children||[])||[]}return c},[])};let b=[];const U=he(()=>u.value.length?F([...u.value],p.value):p.value),O=q,A=()=>{a.value.pop(),v.value=a.value[a.value.length-1],u.value.pop(),a.value.length&&(p.value=y(b),O("hiddenTabbar",!1))},G=()=>{a.value=[],u.value=[],v.value=""},J=ae(),H=e=>{l.set("directName",a.value),l.set("activeDirectName",v.value),l.set("activeTabbar","direct"),l.set("directId",u.value),J.push({path:"/panel/mobile",query:{dvId:e.id}})},x=f(""),h=f("time_desc"),K=[{name:"按创建时间升序",value:"time_asc"},{name:"按创建时间降序",value:"time_desc",divided:!0},{name:"按照名称升序",value:"name_asc"},{name:"按照名称降序",value:"name_desc"}],B=e=>{p.value=De(y(b),e),h.value=e},$=(e,o)=>e.filter(t=>{var c,_;return(c=t.name)!=null&&c.toLocaleLowerCase().includes(o.toLocaleLowerCase())?!0:(_=t.children)!=null&&_.length?(t.children=$(t.children,o),!!t.children.length):!1});ge(x,e=>{p.value=$(y(b),e)});const Q=e=>{if(e.extraFlag1!==0){if(e.leaf){O("hiddenTabbar",!0),H(e);return}a.value.push(e.name),v.value=e.name,u.value.push(e.id)}},X=e=>{e!==u.value.length-1&&(u.value=u.value.slice(0,e+1),a.value=a.value.slice(0,e+1),v.value=a.value[a.value.length-1])},I=e=>e.filter(o=>{var t,c;return(t=o.children)!=null&&t.length&&(o.children=I(o.children)),o.extraFlag===1||((c=o.children)==null?void 0:c.length)}),Y=async()=>{const e={busiFlag:"dashboard",resourceTable:"core"};await E.setInteractive(e);const o=E.getPanel,t=o.treeNodes;if(R.value=o.rootManage,z.value=o.anyManage,T.value&&T.value.id&&!JSON.stringify(t).includes(T.value.id)&&V.resetDvInfo(),t.length&&t[0].id==="0"&&t[0].name==="root"){p.value=I(t[0].children||[]),b=y(p.value),P();return}p.value=I(t),b=y(p.value),P()},P=()=>{const e=l.get("mobile-sort-type");B(e||h.value)};return be(()=>{l.set("mobile-sort-type",h.value)}),ye(()=>{Y(),v.value=l.get("activeDirectName"),!(l.get("activeTabbar")!=="direct"||!v.value)&&(a.value=l.get("directName"),u.value=l.get("directId"),l.set("directName",[]),l.set("activeDirectName",""),l.set("directId",[]),l.set("activeTabbar",""))}),(e,o)=>{const t=re,c=ne,_=se,W=ce,Z=le,ee=ie;return i(),m("div",Le,[n(d(Ie),null,{default:s(()=>[n(d(Ne),{"safe-area-inset-top":"",title:v.value||d(k)("work_branch.dashboard"),"left-arrow":!!v.value,onClickLeft:A},null,8,["title","left-arrow"]),a.value.length?(i(),m("div",Me,[(i(),m("div",{onClick:G,key:d(k)("work_branch.dashboard")},[N("span",Ee,S(d(k)("work_branch.dashboard")),1),n(c,null,{default:s(()=>[n(t,{name:"icon_right_outlined"},{default:s(()=>[n(d(j),{class:"svg-icon"})]),_:1})]),_:1})])),(i(!0),m(C,null,L([...a.value],(r,w)=>(i(),m("div",{onClick:Pe=>X(w),key:r},[N("span",{class:M(["label ellipsis",w!==a.value.length-1&&"primary-name"])},S(r),3),w!==a.value.length-1?(i(),D(c,{key:0},{default:s(()=>[n(t,{name:"icon_right_outlined"},{default:s(()=>[n(d(j),{class:"svg-icon"})]),_:1})]),_:1})):g("",!0)],8,Ve))),128))])):g("",!0)]),_:1}),N("div",{class:M([!!a.value.length&&"dashboard-cell-group-tab","dashboard-cell-group"])},[a.value.length?g("",!0):(i(),m("div",Fe,[n(_,{placeholder:d(k)("commons.search"),modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=r=>x.value=r),clearable:"",class:"search-bar"},{prefix:s(()=>[n(c,null,{default:s(()=>[n(t,{name:"icon_search-outline_outlined"},{default:s(()=>[n(d(me),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),n(ee,{onCommand:B,trigger:"click"},{dropdown:s(()=>[n(Z,{style:{width:"246px"}},{default:s(()=>[(i(),m(C,null,L(K,r=>(i(),m(C,{key:r.value},[n(W,{class:M(["ed-select-dropdown__item",r.value===h.value&&"selected"]),command:r.value},{default:s(()=>[ke(S(r.name),1)]),_:2},1032,["class","command"]),r.divided?(i(),m("li",Oe)):g("",!0)],64))),64))]),_:1})]),default:s(()=>[n(c,{class:"filter-icon-span"},{default:s(()=>[h.value.includes("asc")?(i(),D(t,{key:0,name:"dv-sort-asc",class:"opt-icon"},{default:s(()=>[n(d(pe),{class:"svg-icon opt-icon"})]),_:1})):g("",!0),h.value.includes("desc")?(i(),D(t,{key:1,name:"dv-sort-desc",class:"opt-icon"},{default:s(()=>[n(d(ve),{class:"svg-icon opt-icon"})]),_:1})):g("",!0)]),_:1})]),_:1})])),(i(!0),m(C,null,L(U.value,r=>(i(),D(xe,{key:r.id,onClick:w=>Q(r),style:we({color:r.extraFlag1===0?"#bbbfc4":"#1f2329"}),label:r.name,nextlevel:!r.leaf,"prefix-icon":r.leaf?d(ue):d(de)},null,8,["onClick","style","label","nextlevel","prefix-icon"]))),128))],2)])}}});const Pt=Se(Be,[["__scopeId","data-v-37bdc9b3"]]);export{Pt as default};
