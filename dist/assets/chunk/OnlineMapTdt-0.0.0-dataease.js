import{d as w,r as l,b as C,e as g,o as M,c as E,R as I,n as k}from"./@vue-0.0.0-dataease.js";import{_ as B}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const x=["id"],b=w({__name:"OnlineMapTdt",props:{mapKey:{},securityCode:{}},setup(v){const c=l("de-map-container"),s=[116.397428,39.90923],t=l(null),r=l(!1),i=v;function u(){var e;const n=(e=t.value)==null?void 0:e.getContainer();for(;n.hasChildNodes();)n.removeChild(n.firstChild);t.value=null}const _=()=>{if(!i.mapKey)return;const e=`https://api.tianditu.gov.cn/api?v=4.0&tk=${i.mapKey}`;h(e).then(()=>{if(t.value){u(),r.value=!0,setTimeout(()=>{c.value=c.value+"-de-",r.value=!1,k(()=>{p()})},1500);return}p()}).catch(o=>{console.error(o),t.value&&u()})},p=()=>{window.T&&(t.value=new window.T.Map(c.value),t.value.centerAndZoom(new T.LngLat(s[0],s[1]),11))},h=n=>new Promise(function(e,o){var f;const m="de-tdt-script-id";let d=document.getElementById(m);d&&((f=d.parentElement)==null||f.removeChild(d),d=null,window.AMap=null);const a=document.createElement("script");a.id=m,a.onload=function(){return e(null)},a.onerror=function(){return o(new Error("Load script from ".concat(n," failed")))},a.src=n;const y=document.head||document.getElementsByTagName("head")[0];(document.body||y).appendChild(a)});return C(()=>{_()}),g(()=>{var o;const n="de-tdt-script-id";let e=document.getElementById(n);e&&((o=e.parentElement)==null||o.removeChild(e),e=null,window.T=null)}),(n,e)=>r.value?I("",!0):(M(),E("div",{key:0,class:"de-map-container",id:c.value},null,8,x))}});const N=B(b,[["__scopeId","data-v-8bfd0419"]]);export{N as default};
