import{E as L,a as F}from"./el-select-0.0.0-dataease.js";import{E as B}from"./el-tree-0.0.0-dataease.js";import{i as I,aF as $,O as X,E as G,a8 as J,_ as Q,w as W}from"./index-0.0.0-dataease.js";import{a3 as R,ap as Y}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{w as M,n as N,t as U,y as C,d as H,q as Z,A as q,K as ee,x as D,r as p,X as T,o as te,h as g}from"./vue-0.0.0-dataease.js";import{p as A,n as le,d as ce}from"./lodash-0.0.0-dataease.js";import{e as ae}from"./strings-0.0.0-dataease.js";import{s as ne}from"./token-0.0.0-dataease.js";const se=(e,{attrs:a,emit:r},{select:h,tree:i,key:n})=>{const v=I("tree-select");return M(()=>e.data,()=>{e.filterable&&N(()=>{var s,c;(c=i.value)==null||c.filter((s=h.value)==null?void 0:s.states.inputValue)})},{flush:"post"}),{...A(U(e),Object.keys(L.props)),...a,class:C(()=>a.class),style:C(()=>a.style),"onUpdate:modelValue":s=>r(R,s),valueKey:n,popperClass:C(()=>{const s=[v.e("popper")];return e.popperClass&&s.push(e.popperClass),s.join(" ")}),filterMethod:(s="")=>{var c;e.filterMethod?e.filterMethod(s):e.remoteMethod?e.remoteMethod(s):(c=i.value)==null||c.filter(s)}}},oe=H({extends:F,setup(e,a){const r=F.setup(e,a);delete r.selectOptionClick;const h=Z().proxy;return N(()=>{r.select.states.cachedOptions.get(h.value)||r.select.onOptionCreate(h)}),M(()=>a.attrs.visible,i=>{N(()=>{r.states.visible=i})},{immediate:!0}),r},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function P(e){return e||e===0}function j(e){return q(e)&&e.length}function E(e){return q(e)?e:P(e)?[e]:[]}function O(e,a,r,h,i){for(let n=0;n<e.length;n++){const v=e[n];if(a(v,n,e,i))return h?h(v,n,e,i):v;{const y=r(v);if(j(y)){const s=O(y,a,r,h,v);if(s)return s}}}}function S(e,a,r,h){for(let i=0;i<e.length;i++){const n=e[i];a(n,i,e,h);const v=r(n);j(v)&&S(v,a,r,n)}}const ie=(e,{attrs:a,slots:r,emit:h},{select:i,tree:n,key:v})=>{M(()=>e.modelValue,()=>{e.showCheckbox&&N(()=>{const t=n.value;t&&!le(t.getCheckedKeys(),E(e.modelValue))&&t.setCheckedKeys(E(e.modelValue))})},{immediate:!0,deep:!0});const y=C(()=>({value:v.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),s=C(()=>e.showBtn?Y:R),c=(t,l)=>{var o;const d=y.value[t];return ee(d)?d(l,(o=n.value)==null?void 0:o.getNode(c("value",l))):l[d]},_=E(e.modelValue).map(t=>O(e.data||[],l=>c("value",l)===t,l=>c("children",l),(l,o,d,f)=>f&&c("value",f))).filter(t=>P(t)),w=C(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return S(e.data.concat(e.cacheData),l=>{const o=c("value",l);t.push({value:o,currentLabel:c("label",l),isDisabled:c("disabled",l)})},l=>c("children",l)),t}),x=()=>{var t;return(t=n.value)==null?void 0:t.getCheckedKeys().filter(l=>{var o;const d=(o=n.value)==null?void 0:o.getNode(l);return!ce(d)&&$(d.childNodes)})};return{...A(U(e),Object.keys(B.props)),...a,nodeKey:v,expandOnClickNode:C(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:C(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(_):_),renderContent:(t,{node:l,data:o,store:d})=>t(oe,{value:c("value",o),label:c("label",o),disabled:c("disabled",o),visible:l.visible},e.renderContent?()=>e.renderContent(t,{node:l,data:o,store:d}):r.default?()=>r.default({node:l,data:o,store:d}):void 0),filterNodeMethod:(t,l,o)=>e.filterNodeMethod?e.filterNodeMethod(t,l,o):t?new RegExp(ae(t),"i").test(c("label",l)||""):!0,onNodeClick:(t,l,o)=>{var d,f,m,K;if((d=a.onNodeClick)==null||d.call(a,t,l,o),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||l.isLeaf)){if(!c("disabled",t)){const b=(f=i.value)==null?void 0:f.states.options.get(c("value",t));(m=i.value)==null||m.handleOptionSelect(b)}}else e.expandOnClickNode&&o.proxy.handleExpandIconClick();(K=i.value)==null||K.focus()}},onCheck:(t,l)=>{var o;if(!e.showCheckbox)return;const d=c("value",t),f={};S([n.value.store.root],u=>f[u.key]=u,u=>u.childNodes);const m=l.checkedKeys,K=e.multiple?E(e.modelValue).filter(u=>!(u in f)&&!m.includes(u)):[],b=K.concat(m);if(e.checkStrictly)h(s.value,e.multiple?b:b.includes(d)?d:void 0);else if(e.multiple){const u=x();h(s.value,K.concat(u))}else{const u=O([t],k=>!j(c("children",k))&&!c("disabled",k),k=>c("children",k)),V=u?c("value",u):void 0,z=P(e.modelValue)&&!!O([t],k=>c("value",k)===e.modelValue,k=>c("children",k));h(s.value,V===e.modelValue||z?void 0:V)}N(()=>{var u;const V=E(e.modelValue);!e.showBtn&&n.value.setCheckedKeys(V),(u=a.onCheck)==null||u.call(a,t,{checkedKeys:n.value.getCheckedKeys(),checkedNodes:n.value.getCheckedNodes(),halfCheckedKeys:n.value.getHalfCheckedKeys(),halfCheckedNodes:n.value.getHalfCheckedNodes()})}),(o=i.value)==null||o.focus()},onNodeExpand:(t,l,o)=>{var d;(d=a.onNodeExpand)==null||d.call(a,t,l,o),N(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&l.checked){const f={},m=n.value.getCheckedKeys();S([n.value.store.root],u=>f[u.key]=u,u=>u.childNodes);const K=E(e.modelValue).filter(u=>!(u in f)&&!m.includes(u)),b=x();h(s.value,K.concat(b))}})},cacheOptions:w}};var de=H({props:{data:{type:Array,default:()=>[]}},setup(e){const a=D(ne);return M(()=>e.data,()=>{var r;e.data.forEach(i=>{a.states.cachedOptions.has(i.value)||a.states.cachedOptions.set(i.value,i)});const h=((r=a.selectRef)==null?void 0:r.querySelectorAll("input"))||[];X&&!Array.from(h).includes(document.activeElement)&&a.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const ue=H({name:"ElTreeSelect",inheritAttrs:!1,props:{...L.props,...B.props,showBtn:{type:Boolean,default:!1},tagColor:{type:String,default:""},cacheData:{type:Array,default:()=>[]}},setup(e,a){const{slots:r,expose:h,emit:i}=a,n=I("select-tree"),{t:v}=G(),y=p(),s=p(),c=C(()=>e.nodeKey||e.valueKey||"value"),_=D("$custom-style-filter",{}),w=se(e,a,{select:y,tree:s,key:c}),{cacheOptions:x,...t}=ie(e,a,{select:y,tree:s,key:c}),l=()=>{var f;i("treeSelectClear",(f=s.value)==null?void 0:f.setCheckedKeys([]))},o=()=>{var f;i("treeSelectConfirm",(f=s.value)==null?void 0:f.getCheckedKeys()),y.value.hideMenu()},d=T({});return h(d),te(()=>{Object.assign(d,{...A(s.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...A(y.value,["focus","blur","selectedLabel"])})}),()=>g(L,T({...w,tagColor:e.tagColor,ref:f=>y.value=f}),{...r,default:()=>[g(de,{data:x.value}),g(B,T({...t,showBtn:e.showBtn,ref:f=>s.value=f})),e.showBtn?g("div",{class:n.b("btn-group"),style:J(_,["border"])},[g("div",{onClick:l,class:n.b("btn"),style:{color:"#000000",background:"#ffffff"}},v("el.datepicker.clear")),g("div",{onClick:o,class:n.b("btn"),style:{color:"#ffffff",background:"#3370FF"}},v("el.datepicker.confirm"))]):null]})}});var re=Q(ue,[["__file","tree-select.vue"]]);const be=W(re);export{be as E};
