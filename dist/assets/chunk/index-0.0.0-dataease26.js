import{e as oe,r as re,H as ae,I as ie,G as ne}from"./element-plus-secondary-0.0.0-dataease.js";import{f as se,e as le}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as me}from"./dv-folder-0.0.0-dataease.js";import{i as ce}from"./icon_dashboard-0.0.0-dataease.js";import{i as U}from"./icon_right_outlined-0.0.0-dataease.js";import{i as pe}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as de,a as ue}from"./dv-sort-desc-0.0.0-dataease.js";import{s as ve}from"./pinia-0.0.0-dataease.js";import{d as _e}from"./dvMain-0.0.0-dataease.js";import{a as fe,g as l}from"./index-0.0.0-dataease.js";import{t as he}from"./treeSortUtils-0.0.0-dataease.js";import{i as ge}from"./interactive-0.0.0-dataease.js";import be from"./DashboardCell-0.0.0-dataease.js";import{b as ye}from"./vue-router_2-0.0.0-dataease.js";import{d as ke,e as we}from"./vant-0.0.0-dataease.js";import{h as k}from"./lodash-es-0.0.0-dataease.js";import{d as Ce,r as h,k as De,w as Te,j as xe,b as Ie,o as m,c as u,W as i,U as n,u as p,a as N,Y as L,S as D,a8 as M,R as b,T,z as V,_ as Se,Z as Ne}from"./@vue-0.0.0-dataease.js";import{_ as Le}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";const Me={class:"mobile-dashboard"},Ve={key:0,class:"direct-name-arr"},Ee={class:"label primary-name"},Fe=["onClick"],Be={key:0,class:"dashboard-cell-group_filter"},Oe={key:0,class:"ed-dropdown-menu__item--divided"},$e=Ce({__name:"index",emits:["hiddenTabbar","setLoading"],setup(ze,{emit:W}){const q=h(!1),j=h(!1),v=h([]),o=h([]),d=h([]),_=h(""),E=ge(),F=_e(),{dvInfo:x}=ve(F),{wsCache:s}=fe("sessionStorage"),{t:w}=se(),B=(e,r)=>{const t=e.shift();return r.reduce((c,f)=>{if(t&&f.id===t){if(!e.length)return f.children||[];c=B([...e],f.children||[])||[]}return c},[])};let y=[];const A=De(()=>d.value.length?B([...d.value],v.value):v.value),O=W,G=()=>{o.value.pop(),_.value=o.value[o.value.length-1],d.value.pop(),o.value.length&&(v.value=k(y),O("hiddenTabbar",!1))},H=()=>{o.value=[],d.value=[],_.value=""},J=ye(),Y=e=>{s.set(l("directName"),o.value),s.set(l("activeDirectName"),_.value),s.set(l("activeTabbar"),"direct"),s.set(l("directId"),d.value),J.push({path:"/panel/mobile",query:{dvId:e.id}})},I=h(""),g=h("time_desc"),Z=[{name:"按创建时间升序",value:"time_asc"},{name:"按创建时间降序",value:"time_desc",divided:!0},{name:"按照名称升序",value:"name_asc"},{name:"按照名称降序",value:"name_desc"}],$=e=>{v.value=he(k(y),e),g.value=e},z=(e,r)=>e.filter(t=>{var c,f;return(c=t.name)!=null&&c.toLocaleLowerCase().includes(r.toLocaleLowerCase())?!0:(f=t.children)!=null&&f.length?(t.children=z(t.children,r),!!t.children.length):!1});Te(I,e=>{v.value=z(k(y),e)});const K=e=>{if(e.extraFlag1!==0){if(e.leaf){O("hiddenTabbar",!0),Y(e);return}o.value.push(e.name),_.value=e.name,d.value.push(e.id)}},Q=e=>{e!==d.value.length-1&&(d.value=d.value.slice(0,e+1),o.value=o.value.slice(0,e+1),_.value=o.value[o.value.length-1])},S=e=>e.filter(r=>{var t,c;return(t=r.children)!=null&&t.length&&(r.children=S(r.children)),r.extraFlag===1||((c=r.children)==null?void 0:c.length)}),X=async()=>{const e={busiFlag:"dashboard",resourceTable:"core"};await E.setInteractive(e);const r=E.getPanel,t=r.treeNodes;if(j.value=r.rootManage,q.value=r.anyManage,x.value&&x.value.id&&!JSON.stringify(t).includes(x.value.id)&&F.resetDvInfo(),t.length&&t[0].id==="0"&&t[0].name==="root"){v.value=S(t[0].children||[]),y=k(v.value),P();return}v.value=S(t),y=k(v.value),P()},P=()=>{const e=s.get(l("mobile-sort-type"));$(e||g.value)};return xe(()=>{s.set(l("mobile-sort-type"),g.value)}),Ie(()=>{X(),_.value=s.get(l("activeDirectName")),!(s.get(l("activeTabbar"))!=="direct"||!_.value)&&(o.value=s.get(l("directName")),d.value=s.get(l("directId")),s.set(l("directName"),[]),s.set(l("activeDirectName"),""),s.set(l("directId"),[]),s.set(l("activeTabbar"),""))}),(e,r)=>{const t=le,c=oe,f=re,R=ne,ee=ae,te=ie;return m(),u("div",Me,[i(p(we),null,{default:n(()=>[i(p(ke),{"safe-area-inset-top":"",title:_.value||p(w)("work_branch.dashboard"),"left-arrow":!!_.value,onClickLeft:G},null,8,["title","left-arrow"]),o.value.length?(m(),u("div",Ve,[(m(),u("div",{onClick:H,key:p(w)("work_branch.dashboard")},[N("span",Ee,L(p(w)("work_branch.dashboard")),1),i(c,null,{default:n(()=>[i(t,{name:"icon_right_outlined"},{default:n(()=>[i(p(U),{class:"svg-icon"})]),_:1})]),_:1})])),(m(!0),u(D,null,M([...o.value],(a,C)=>(m(),u("div",{onClick:Pe=>Q(C),key:a},[N("span",{class:V(["label ellipsis",C!==o.value.length-1&&"primary-name"])},L(a),3),C!==o.value.length-1?(m(),T(c,{key:0},{default:n(()=>[i(t,{name:"icon_right_outlined"},{default:n(()=>[i(p(U),{class:"svg-icon"})]),_:1})]),_:1})):b("",!0)],8,Fe))),128))])):b("",!0)]),_:1}),N("div",{class:V([!!o.value.length&&"dashboard-cell-group-tab","dashboard-cell-group"])},[o.value.length?b("",!0):(m(),u("div",Be,[i(f,{placeholder:p(w)("commons.search"),modelValue:I.value,"onUpdate:modelValue":r[0]||(r[0]=a=>I.value=a),clearable:"",class:"search-bar"},{prefix:n(()=>[i(c,null,{default:n(()=>[i(t,{name:"icon_search-outline_outlined"},{default:n(()=>[i(p(pe),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),i(te,{onCommand:$,trigger:"click"},{dropdown:n(()=>[i(ee,{style:{width:"246px"}},{default:n(()=>[(m(),u(D,null,M(Z,a=>(m(),u(D,{key:a.value},[i(R,{class:V(["ed-select-dropdown__item",a.value===g.value&&"selected"]),command:a.value},{default:n(()=>[Se(L(a.name),1)]),_:2},1032,["class","command"]),a.divided?(m(),u("li",Oe)):b("",!0)],64))),64))]),_:1})]),default:n(()=>[i(c,{class:"filter-icon-span"},{default:n(()=>[g.value.includes("asc")?(m(),T(t,{key:0,name:"dv-sort-asc",class:"opt-icon"},{default:n(()=>[i(p(de),{class:"svg-icon opt-icon"})]),_:1})):b("",!0),g.value.includes("desc")?(m(),T(t,{key:1,name:"dv-sort-desc",class:"opt-icon"},{default:n(()=>[i(p(ue),{class:"svg-icon opt-icon"})]),_:1})):b("",!0)]),_:1})]),_:1})])),(m(!0),u(D,null,M(A.value,a=>(m(),T(be,{key:a.id,onClick:C=>K(a),style:Ne({color:a.extraFlag1===0?"#bbbfc4":"#1f2329"}),label:a.name,nextlevel:!a.leaf,"prefix-icon":a.leaf?p(ce):p(me)},null,8,["onClick","style","label","nextlevel","prefix-icon"]))),128))],2)])}}});const pr=Le($e,[["__scopeId","data-v-9e54cb65"]]);export{pr as default};
