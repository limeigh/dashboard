import{b as ke,y as O,c as Ce,z as be}from"./index-0.0.0-dataease.js";import{E as ye}from"./el-row-0.0.0-dataease.js";import{E as ge}from"./el-divider-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{a as Se,u as Te,C as Fe,o as xe,n as Ee,j as Ae,D as Me}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{f as l,O as _,a5 as Ue,d as Ne,y as w,r as k,s as Pe,X as Re,w as De,R as C,u as s,P as a,j as n,i as p,a4 as m,_ as E,W as b,a6 as A,S as M,g as U,T as H,a3 as $,U as N,l as Le}from"./vue-0.0.0-dataease.js";import{i as qe,a as Be}from"./ShareGrid-0.0.0-dataease.js";import{i as Ie}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as Ve}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{u as Oe}from"./user-img-0.0.0-dataease.js";import{n as He,s as $e}from"./templateMarket-0.0.0-dataease.js";import{i as We}from"./interactive-0.0.0-dataease.js";import ze from"./ShortcutTable-0.0.0-dataease.js";import Ze from"./TemplateBranchItem-0.0.0-dataease.js";import{_ as je}from"./DeResourceCreateOptV2.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{g as Je}from"./dataset-0.0.0-dataease.js";import{useAppStoreWithOut as Xe}from"./app-0.0.0-dataease.js";import{u as Ge}from"./share-0.0.0-dataease.js";import{q as Ke}from"./dataVisualization-0.0.0-dataease.js";import{E as Qe}from"./index-0.0.0-dataease4.js";import{_ as Ye}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./el-table-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./raf-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./dv-dashboard-spine-mobile-disabled-0.0.0-dataease.js";import"./icon_pc_outlined-0.0.0-dataease.js";import"./GridTable-0.0.0-dataease.js";import"./el-pagination-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./dayjs.min-0.0.0-dataease.js";import"./ShareHandler-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";import"./el-switch-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./icon_refresh_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./ShareTicket-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease19.js";import"./TicketEdit-0.0.0-dataease.js";import"./el-drawer-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./index-0.0.0-dataease20.js";import"./CustomLinkPwd-0.0.0-dataease.js";import"./TicketDialog-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./visual-star-0.0.0-dataease.js";import"./ShortcutOption-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./decimal-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./index-0.0.0-dataease21.js";import"./antv-0.0.0-dataease.js";import"./index-0.0.0-dataease22.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./tslib.es6-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./index-0.0.0-dataease23.js";import"./el-tree-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./MarketPreviewV2-0.0.0-dataease.js";import"./el-main-0.0.0-dataease.js";import"./el-collapse-item-0.0.0-dataease.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./icon-filter-0.0.0-dataease.js";import"./TemplateMarketPreviewItem-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./CategoryTemplateV2-0.0.0-dataease.js";import"./TemplateMarketV2Item-0.0.0-dataease.js";import"./TemplateSkeleton-0.0.0-dataease.js";const et={width:"32",height:"32",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"};function tt(W,y){return l(),_("svg",et,[...y[0]||(y[0]=[Ue('<path d="M4 2.66666C4 1.93028 4.59695 1.33333 5.33333 1.33333H21.1477C21.3265 1.33333 21.4979 1.40515 21.6232 1.53267L27.8088 7.82587C27.9313 7.95055 28 8.11838 28 8.2932V29.3333C28 30.0697 27.403 30.6667 26.6667 30.6667H5.33333C4.59695 30.6667 4 30.0697 4 29.3333V2.66666Z" fill="#FF8800"></path><path d="M9.33398 11.3333C9.33398 10.9651 9.63246 10.6667 10.0007 10.6667H22.0007C22.3688 10.6667 22.6673 10.9651 22.6673 11.3333V12.6667C22.6673 13.0349 22.3688 13.3333 22.0007 13.3333H10.0007C9.63246 13.3333 9.33398 13.0349 9.33398 12.6667V11.3333Z" fill="white"></path><path d="M14.6673 16.6667C14.6673 16.2985 14.9658 16 15.334 16H22.0007C22.3688 16 22.6673 16.2985 22.6673 16.6667V23.3333C22.6673 23.7015 22.3688 24 22.0007 24H15.334C14.9658 24 14.6673 23.7015 14.6673 23.3333V16.6667Z" fill="white"></path><path d="M10.0007 16C9.63246 16 9.33398 16.2985 9.33398 16.6667V23.3333C9.33398 23.7015 9.63246 24 10.0007 24H11.334C11.7022 24 12.0007 23.7015 12.0007 23.3333V16.6667C12.0007 16.2985 11.7022 16 11.334 16H10.0007Z" fill="white"></path><path d="M21.334 1.33333C21.4429 1.36489 21.5429 1.424 21.6238 1.50632L27.8094 7.79952C27.8601 7.85104 27.9015 7.90993 27.9327 7.97364H22.8475C22.0116 7.97364 21.334 7.29602 21.334 6.46013V1.33333Z" fill="#D97400"></path>',5)])])}const at={render:tt},ot={class:"workbranch"},rt={class:"info-quick-creation"},st={class:"user-info"},nt={class:"info"},it={class:"name-role flex-align-center"},lt={class:"name"},mt={key:0,class:"id"},ct={class:"name"},pt={class:"num"},ut={class:"quick-creation"},dt={class:"label"},_t={class:"item-creation"},vt=["onClick"],ht={class:"name"},ft={class:"name"},wt={class:"template-market-dashboard"},kt={class:"label"},Ct={class:"expand-all"},bt={class:"tab-btn"},yt=["onClick"],gt={class:"template-list"},St={style:{"text-align":"center"}},Tt={class:"no-result-tips"},Ft=Ne({__name:"index",setup(W){const y=Ge(),P=Se(),z=We(),Z=Te(),j=Fe(),{t:i}=xe(),g=w(()=>z.getData),R=k([]),{wsCache:D}=ke(),{push:J}=O(),X=O(),L=k(null),G=Ce(),K=Xe(),h=D.get("open-backend")==="1"?"_self":"_blank",u=Pe([{icon:Ie,name:"panel",color:"#3370ff"},{icon:Ve,name:"screen",color:"#00d6b9"},{icon:qe,name:"dataset",color:"#16c0ff"},{icon:Be,name:"datasource",color:"#7f3bf6"}]),f=k("fold"),Q=()=>{f.value=f.value==="expand"?"fold":"expand"},Y=w(()=>({PANEL:S.value,SCREEN:T.value})),S=w(()=>u.value[0].menuAuth&&u.value[0].anyManage),T=w(()=>u.value[1].menuAuth&&u.value[1].anyManage),ee=e=>{F.value=e},te=[{name:i("work_branch.recommended_dashboard"),value:"PANEL"},{name:i("auth.screen"),value:"SCREEN"}],F=k("PANEL");u.value.map(e=>e.name).unshift("all_types");const t=Re({templateType:"PANEL",baseUrl:null,marketTemplatePreviewShowList:[],hasResult:!1,networkStatus:!0,loading:!1,dvCreateForm:{resourceName:null,templateId:null,name:null,pid:null,nodeType:"panel",templateUrl:null,newFrom:"new_market_template",panelType:"self",panelStyle:{},panelData:"[]"}});De(()=>F.value,()=>{q()});const ae=async()=>{await $e().then(e=>{t.baseUrl=e.data.baseUrl,t.marketTemplatePreviewShowList=e.data.contents,t.hasResult=!0,q()}).catch(()=>{t.networkStatus=!1})},q=()=>{t.hasResult=!1,t.marketTemplatePreviewShowList.forEach(e=>{e.showFlag=oe(e),e.showFlag&&(t.hasResult=!0)})},oe=e=>{let r=!1;return F.value===e.templateType&&(r=!0),r},re=()=>{for(const e in g.value)e!=="3"&&R.value.push(g.value[e]),u.value[e]&&(u.value[e].menuAuth=g.value[e].menuAuth,u.value[e].anyManage=g.value[e].anyManage)},se=(e,r)=>{if(r)switch(e){case 0:ne();break;case 1:ie();break;case 2:le();break;case 3:me();break}},ne=()=>{const e="#/dashboard?opt=create";window.open(e,h)},ie=()=>{const e="#/dvCanvas?opt=create";window.open(e,h)},le=()=>{let e=X.resolve({path:"/dataset-form"});window.open(e.href,h)},me=()=>{const e="#/data/datasource?opt=create";window.open(e,h)},ce=e=>{D.set("template-preview-id",e),B()},pe=e=>{t.dvCreateForm.name=e.title,t.dvCreateForm.nodeType=e.templateType,e.source==="market"?(t.dvCreateForm.newFrom="new_market_template",t.dvCreateForm.templateUrl=e.metas.theme_repo,t.dvCreateForm.resourceName=e.id):(t.dvCreateForm.newFrom="new_inner_template",t.dvCreateForm.templateId=e.id),de()},ue=w(()=>K.getIsDataEaseBi),de=()=>{if(t.dvCreateForm.newFrom==="new_market_template"&&!t.dvCreateForm.templateUrl)return Me.warning(i("work_branch.template_market_official")),!1;const e={newFrom:t.dvCreateForm.newFrom,templateUrl:t.dvCreateForm.templateUrl,resourceName:t.dvCreateForm.resourceName,templateId:t.dvCreateForm.templateId},r=(["dataV","SCREEN"].includes(t.dvCreateForm.nodeType)?"#/dvCanvas?opt=create&createType=template":"#/dashboard?opt=create&createType=template")+"&templateParams="+encodeURIComponent(Je.encode(JSON.stringify(e)));let c=null,d="";ue.value&&(d=G.baseUrl),t.pid?c=window.open(d+r+`&pid=${t.pid}`,h):c=window.open(d+r,h),_e(c)},x=k(null),_e=e=>{if(x!=null&&x.value){const r={methodName:"initOpenHandler",args:e};x.value.invokeMethod(r)}},B=()=>{J("/template-market/index")},ve=()=>{if(S.value||T.value){const e={curPosition:"branchCreate",templateType:"all"};L.value.optInit(e)}},he=()=>{Ke().then(e=>{var c,d;const r={shareDisable:(c=e.data)==null?void 0:c.disable,sharePeRequire:(d=e.data)==null?void 0:d.peRequire};y.setData(r)})};return re(),ae(),he(),(e,r)=>{const c=Ee,d=Ae,I=Qe,fe=ge,V=ye,we=be;return C((l(),_("div",ot,[a("div",rt,[a("div",st,[n(d,{class:"main-color user-icon-container"},{default:p(()=>[n(c,{name:"user-img"},{default:p(()=>[n(s(Oe),{class:"svg-icon"})]),_:1})]),_:1}),a("div",nt,[a("div",it,[a("span",lt,m(s(P).getName),1),r[0]||(r[0]=a("span",{class:"role main-btn"},null,-1))]),s(P).getUid?(l(),_("span",mt,m(`ID: ${s(P).getUid}`),1)):E("",!0)]),(l(!0),_(b,null,A(R.value,(o,v)=>(l(),_("div",{class:M(["item",{"de-item-hidden":!o.menuAuth}]),key:v},[a("span",ct,m(s(i)(`auth.${u.value[v].name}`)),1),a("span",pt,m(o.menuAuth?o.leafNodeCount:"*"),1)],2))),128))]),a("div",ut,[a("span",dt,m(s(i)("work_branch.create_quickly")),1),a("div",_t,[(l(!0),_(b,null,A(u.value,(o,v)=>(l(),_("div",{key:o.name,class:M(["item",{"quick-create-disabled":!o.menuAuth||!o.anyManage}]),onClick:Et=>se(v,o.menuAuth&&o.anyManage)},[!o.menuAuth||!o.anyManage?(l(),U(I,{key:0,class:"box-item",effect:"dark",content:s(i)("work_branch.permission_to_create"),placement:"top"},{default:p(()=>[...r[1]||(r[1]=[a("div",{class:"empty-tooltip-container"},null,-1)])]),_:1},8,["content"])):E("",!0),n(d,{class:"main-color",style:H({backgroundColor:o.color})},{default:p(()=>[n(c,null,{default:p(()=>[(l(),U(Le(o.icon),{class:"svg-icon"}))]),_:2},1024)]),_:2},1032,["style"]),a("span",ht,m(s(i)(`auth.${o.name}`)),1)],10,vt))),128)),a("div",{class:M(["item item-quick",{"quick-create-disabled":!(S.value||T.value)}]),onClick:ve},[S.value||T.value?E("",!0):(l(),U(I,{key:0,class:"box-item",effect:"dark",content:s(i)("work_branch.permission_to_create"),placement:"top"},{default:p(()=>[...r[2]||(r[2]=[a("div",{class:"empty-tooltip-container-template"},null,-1)])]),_:1},8,["content"])),n(d,{class:"main-color-quick template-create"},{default:p(()=>[n(c,{name:"icon_template_colorful"},{default:p(()=>[n(s(at),{class:"svg-icon"})]),_:1})]),_:1}),a("span",ft,m(s(i)("work_branch.new_using_template")),1)],2)])])]),a("div",wt,[a("div",{class:"template-market",style:H({paddingBottom:f.value!=="fold"?"24px":0})},[a("div",kt,[$(m(s(i)("work_branch.template_center"))+" ",1),a("div",Ct,[a("button",{class:"all flex-center",onClick:B},m(s(i)("work_branch.view_all")),1),n(fe,{direction:"vertical"}),a("button",{onClick:Q,class:"expand flex-center"},m(s(i)(`visualization.${f.value}`)),1)])]),f.value==="fold"?(l(),_(b,{key:0},[a("div",bt,[(l(),_(b,null,A(te,o=>a("div",{key:o.value,class:M([F.value===o.value&&"active","main-btn"]),onClick:v=>ee(o.value)},m(o.name),11,yt)),64))]),C(a("div",gt,[(l(!0),_(b,null,A(t.marketTemplatePreviewShowList,(o,v)=>C((l(),U(Ze,{key:v,template:o,"base-url":t.baseUrl,"create-auth":Y.value,onTemplateApply:pe,onTemplatePreview:ce},null,8,["template","base-url","create-auth"])),[[N,o.showFlag]])),128))],512),[[N,t.networkStatus&&t.hasResult]]),C(n(V,{class:"template-empty"},{default:p(()=>[a("div",St,[n(c,{name:"no_result",class:"no-result"},{default:p(()=>[n(s(He),{class:"svg-icon no-result"})]),_:1}),r[3]||(r[3]=a("br",null,null,-1)),a("span",Tt,m(s(i)("work_branch.relevant_templates_found")),1)])]),_:1},512),[[N,t.networkStatus&&!t.hasResult]]),C(n(V,{class:"template-empty"},{default:p(()=>[$(m(s(i)("visualization.market_network_tips",[t.baseUrl])),1)]),_:1},512),[[N,!t.networkStatus]])],64)):E("",!0)],4),n(ze,{expand:f.value==="expand"},null,8,["expand"])]),n(je,{ref_key:"resourceCreateOpt",ref:L},null,512)])),[[we,s(j).loadingMap[s(Z).currentPath]]])}}});const No=Ye(Ft,[["__scopeId","data-v-beaa255c"]]);export{No as default};
