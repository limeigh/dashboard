import{q as yt,e as st,r as xt,f as wt,s as kt,t as Lt}from"./element-plus-secondary-0.0.0-dataease.js";import{h as bt,f as Tt}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{o as p,c as S,aU as St,a,d as $t,x as R,r as d,k as V,w as Bt,W as o,U as i,u as r,_ as N,Y as g,Z as rt,S as It,a8 as Mt,T as m,R as T,z as v,X as Et,a9 as Ft,V as U,$ as z,a0 as A,n as nt}from"./@vue-0.0.0-dataease.js";import{c as Dt}from"./copilot-0.0.0-dataease.js";import{t as qt}from"./treeSortUtils-0.0.0-dataease.js";import{i as Rt}from"./icon_right_outlined-0.0.0-dataease.js";import{i as Vt}from"./icon_left_outlined-0.0.0-dataease.js";import{f as Nt,a as Ut,g as pt}from"./index-0.0.0-dataease.js";import{d as zt}from"./dv-folder-0.0.0-dataease.js";import{i as At}from"./icon_dataset-0.0.0-dataease.js";import{i as ct}from"./icon_expand-right_filled-0.0.0-dataease.js";import{g as Gt,a as Zt,c as Ot,b as Pt,d as Wt}from"./dataset-0.0.0-dataease.js";import{n as Ht}from"./@vueuse-0.0.0-dataease.js";import{f as B}from"./attr-0.0.0-dataease23.js";import G from"./DialogueChart-0.0.0-dataease.js";import{i as dt}from"./field-list-0.0.0-dataease.js";import{h as mt}from"./lodash-es-0.0.0-dataease.js";import{_ as Kt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./mathjs-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";const Qt={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Xt(I,u){return p(),S("svg",Qt,[...u[0]||(u[0]=[St('<path d="M20.1716 1.68834C20.6753 1.53273 21.0458 2.16193 20.6652 2.52691L12.2658 10.5836C11.0058 11.7921 9.32754 12.4668 7.5817 12.4668C5.68044 12.4668 3.8669 11.667 2.58487 10.263L1.45879 9.02985C1.33225 8.90313 1.24137 8.74527 1.19534 8.5722C1.14931 8.39913 1.14974 8.21698 1.19661 8.04413C1.24347 7.87129 1.3351 7.71386 1.46225 7.58775C1.5894 7.46164 1.74757 7.3713 1.92079 7.32585L20.1716 1.68834Z" fill="url(#paint0_linear_15885_149847)"></path><path d="M12 16.1851C12 14.2766 12.7377 12.4419 14.0588 11.0646L21.4664 3.34177C21.8268 2.96601 22.4499 3.32266 22.3084 3.82374L17.143 22.1182C17.0971 22.291 17.0064 22.4487 16.8801 22.5754C16.7538 22.7021 16.5964 22.7932 16.4237 22.8397C16.251 22.8862 16.0691 22.8864 15.8964 22.8402C15.7236 22.794 15.566 22.7031 15.4395 22.5767L14.4439 21.6791C12.8881 20.2764 12 18.2799 12 16.1851Z" fill="url(#paint1_linear_15885_149847)"></path><defs><linearGradient id="paint0_linear_15885_149847" x1="22.3289" y1="13.1532" x2="1.16113" y2="13.1532" gradientUnits="userSpaceOnUse"><stop stop-color="#9258F7"></stop><stop offset="1" stop-color="#3370FF"></stop></linearGradient><linearGradient id="paint1_linear_15885_149847" x1="22.3289" y1="13.1532" x2="1.16113" y2="13.1532" gradientUnits="userSpaceOnUse"><stop stop-color="#9258F7"></stop><stop offset="1" stop-color="#3370FF"></stop></linearGradient></defs>',3)])])}const Yt={render:Xt},jt={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Jt(I,u){return p(),S("svg",jt,[...u[0]||(u[0]=[a("path",{d:"M20.1716 1.68834C20.6753 1.53273 21.0458 2.16193 20.6652 2.52691L12.2658 10.5836C11.0058 11.7921 9.32754 12.4668 7.5817 12.4668C5.68044 12.4668 3.8669 11.667 2.58487 10.263L1.45879 9.02985C1.33225 8.90313 1.24137 8.74527 1.19534 8.5722C1.14931 8.39913 1.14974 8.21698 1.19661 8.04413C1.24347 7.87129 1.3351 7.71386 1.46225 7.58775C1.5894 7.46164 1.74757 7.3713 1.92079 7.32585L20.1716 1.68834Z",fill:"#BBBFC4"},null,-1),a("path",{d:"M12 16.1851C12 14.2766 12.7377 12.4419 14.0588 11.0646L21.4664 3.34177C21.8268 2.96601 22.4499 3.32266 22.3084 3.82374L17.143 22.1182C17.0971 22.291 17.0064 22.4487 16.8801 22.5754C16.7538 22.7021 16.5964 22.7932 16.4237 22.8397C16.251 22.8862 16.0691 22.8864 15.8964 22.8402C15.7236 22.794 15.566 22.7031 15.4395 22.5767L14.4439 21.6791C12.8881 20.2764 12 18.2799 12 16.1851Z",fill:"#BBBFC4"},null,-1)])])}const te={render:Jt},ee={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function oe(I,u){return p(),S("svg",ee,[...u[0]||(u[0]=[a("path",{d:"M5.29008 5.22068L5.29008 5.22068C3.5148 6.99712 2.49805 9.40416 2.49805 11.97C2.49805 17.2342 6.75182 21.5024 12.0004 21.5024C17.249 21.5024 21.5027 17.2342 21.5027 11.97C21.5027 11.6777 21.3866 11.3973 21.1799 11.1906C20.9731 10.9838 20.6928 10.8677 20.4004 10.8677C20.108 10.8677 19.8276 10.9838 19.6209 11.1906C19.4142 11.3973 19.298 11.6777 19.298 11.97C19.298 16.0178 16.0303 19.2977 12.0004 19.2977C7.97048 19.2977 4.70273 16.0178 4.70273 11.97M5.29008 5.22068L4.80039 11.97M5.29008 5.22068C5.39243 5.11826 5.51394 5.037 5.64769 4.98154C5.78145 4.92608 5.92481 4.89751 6.0696 4.89746C6.2144 4.89741 6.35778 4.92588 6.49157 4.98124C6.62536 5.0366 6.74694 5.11777 6.84936 5.22012C6.95178 5.32247 7.03304 5.44398 7.0885 5.57774C7.14396 5.71149 7.17253 5.85485 7.17258 5.99965C7.17263 6.14444 7.14417 6.28782 7.0888 6.42161C7.03344 6.55541 6.95227 6.67698 6.84992 6.7794M5.29008 5.22068L6.919 6.84843M4.70273 11.97H4.80039M4.70273 11.97C4.70273 11.9701 4.70273 11.9702 4.70273 11.9702L4.80039 11.97M4.70273 11.97C4.701 11.0061 4.88979 10.0512 5.25827 9.16045C5.62676 8.26965 6.16768 7.46047 6.84992 6.7794M4.80039 11.97C4.79865 11.0189 4.98493 10.0767 5.34851 9.19778C5.7121 8.31884 6.24582 7.52042 6.919 6.84843M6.84992 6.7794L6.919 6.84843M6.84992 6.7794C6.84995 6.77937 6.84998 6.77935 6.85001 6.77932L6.919 6.84843",fill:"#3370FF",stroke:"#3370FF","stroke-width":"0.195312"},null,-1)])])}const ie={render:oe},le={class:"copilot"},ae={class:"copilot-analysis"},se={class:"copilot-service"},re={class:"dialogue"},ne={style:{width:"100%",height:"calc(100% - 16px)"}},pe={class:"title-dataset_select"},ce={style:{margin:"0 16px"},class:"tree-select"},de={class:"content"},me=["title"],ue={class:"preview-field"},fe={class:"custom-tree-node father"},_e=["title"],ve={class:"custom-tree-node father"},he=["title"],ge=$t({__name:"index",setup(I){const u=Nt(),{wsCache:Z}=Ut(),{t:f}=bt(),O=R([]),P=R([]),C=R([]),_=d([]),c=d(""),y=d(""),x=d(!1),W={children:"children",label:"name"},ut={label:"name",children:"children",value:"id",isLeaf:e=>{var t;return!((t=e.children)!=null&&t.length)}},w=d(!0),k=d(!0),M=e=>e.filter(t=>{var l,n;return(l=t.children)!=null&&l.length&&!t.leaf?(t.children=M(t.children),!!((n=t.children)!=null&&n.length)):t.leaf}),H=d([]),K=V(()=>{var e;return((e=C.value[0])==null?void 0:e.id)==="0"?M(C.value[0].children):M(C.value)}),E=V(()=>y.value.trim().length&&!!c.value),ft=["time_asc","time_desc","name_asc","name_desc"],_t=async()=>{await Gt({}).then(e=>{C.value=e||[];let t=ft[Number(Z.get(pt("TreeSort-backend")))??1];t=Z.get(pt("TreeSort-dataset"))??t,H.value=mt(r(C)),C.value=qt(H.value,t)}),Zt().then(e=>{var l;const t=e||[];$=((l=t[t.length-1])==null?void 0:l.history)||[],_.value=mt(t).map(n=>({...n,loading:!1})),t.length&&(c.value=t[0].datasetGroupId,h=c.value,c.value&&D(c.value),h&&!L&&nt(()=>{X(K.value)}))})},F=d();let h="",Q="",L="";const vt=V(()=>u.baseUrl?{height:"100%"}:{height:`calc(100vh - ${j+152}px)`}),X=e=>e.filter(t=>{var l,n;return t.id===h&&(L=t.name),(l=t.children)!=null&&l.length&&!t.leaf?(t.children=X(t.children),!!((n=t.children)!=null&&n.length)):t.leaf}),ht=()=>{if(h&&_.value.length){Q=c.value,c.value=h;const e=f("copilot.ds_prefix")+L+f("copilot.ds_suffix");yt.confirm(f("copilot.confirm"),{confirmButtonType:"primary",type:"warning",tip:e,autofocus:!1,showClose:!1}).then(()=>{c.value=Q,h=c.value,L=F.value.getCurrentNode().name,D(c.value),Ot().then(()=>{_.value=[],$=[]})})}else h=c.value,L=F.value.getCurrentNode().name,D(c.value)},D=e=>{Pt(e).then(t=>{var l,n;P.value=((l=t.data)==null?void 0:l.dimensionList)||[],O.value=((n=t.data)==null?void 0:n.quotaList)||[]})};_t();let $=[];const Y=d(),q=d(!1),{height:j}=Ht(Y);Bt(()=>j.value,e=>{q.value=e>48});const J=e=>{x.value=e,_.value.forEach(t=>{t.loading=!0}),setTimeout(()=>{_.value.forEach(t=>{t.loading=!1})},300)},b=d(!1),tt=d(),et=e=>{if((e==null?void 0:e.keyCode)===229)return;(e==null?void 0:e.keyCode)===13&&e.preventDefault();let t=y.value;!E.value||b.value||(y.value="",tt.value.blur(),nt(()=>{q.value=!1}),_.value.push({msgType:"user",chart:{},id:`${+new Date}`,question:t,chartData:{data:{},title:""},msgStatus:1}),b.value=!0,Wt({datasetGroupId:c.value,question:t,history:$}).then(l=>{_.value.push({...l||{},loading:!1}),$=l.history||[]}).finally(()=>{b.value=!1}))};return(e,t)=>{const l=Tt,n=st,gt=xt,ot=wt,Ct=kt,it=st,lt=Lt;return p(),S("div",le,[a("div",ae,[o(n,{style:{"margin-right":"8px","font-size":"24px"}},{default:i(()=>[o(l,{name:"copilot"},{default:i(()=>[o(r(Dt),{class:"svg-icon"})]),_:1})]),_:1}),N(" "+g(r(f)("copilot.talking_analysis")),1)]),a("div",se,[a("div",re,[a("div",{class:"copilot-dialogue",style:rt(vt.value)},[o(G,{key:"isWelcome",isWelcome:""}),(p(!0),S(It,null,Mt(_.value,s=>(p(),m(G,{copilotInfo:s,key:s.id},null,8,["copilotInfo"]))),128)),b.value?(p(),m(G,{key:"isAnswer",isAnswer:""})):T("",!0)],4),a("div",{class:v(["question-input",q.value&&"over-height"]),ref_key:"questionInputRef",ref:Y},[o(gt,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),onKeydown:[t[1]||(t[1]=Et(()=>{},["stop"])),Ft(et,["enter"])],ref_key:"inputRef",ref:tt,autosize:{minRows:1,maxRows:8},type:"textarea",placeholder:e.$t("common.inputText")},null,8,["modelValue","placeholder"]),b.value?(p(),m(n,{key:0,class:"copilot-icon circular-input_icon"},{default:i(()=>[o(l,{name:"icon_loading_outlined"},{default:i(()=>[o(r(ie),{class:"svg-icon"})]),_:1})]),_:1})):(p(),m(n,{key:1,class:v(["copilot-icon",E.value&&"active"]),onClick:et},{default:i(()=>[o(l,null,{default:i(()=>[(p(),m(U(E.value?r(Yt):r(te)),{class:"svg-icon"}))]),_:1})]),_:1},8,["class"]))],2)]),a("div",{class:"dataset-select",style:rt({width:x.value?0:"280px"})},[o(ot,{effect:"dark",content:r(f)("relation.retract"),placement:"left"},{default:i(()=>[z(a("p",{class:"arrow-right",onClick:t[2]||(t[2]=s=>J(!0))},[o(n,null,{default:i(()=>[o(l,{name:"icon_right_outlined"},{default:i(()=>[o(r(Rt),{class:"svg-icon"})]),_:1})]),_:1})],512),[[A,!x.value]])]),_:1},8,["content"]),o(ot,{effect:"dark",content:r(f)("relation.expand"),placement:"left"},{default:i(()=>[z(a("p",{class:"left-outlined",onClick:t[3]||(t[3]=s=>J(!1))},[o(n,null,{default:i(()=>[o(l,{name:"icon_left_outlined"},{default:i(()=>[o(r(Vt),{class:"svg-icon"})]),_:1})]),_:1})],512),[[A,x.value]])]),_:1},8,["content"]),z(a("div",ne,[a("div",pe,g(r(f)("copilot.choose_dataset")),1),a("div",ce,[o(Ct,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=s=>c.value=s),data:K.value,placeholder:r(f)("copilot.pls_choose_dataset"),onChange:ht,props:ut,style:{width:"100%"},"node-key":"id",ref_key:"treeSelectRef",ref:F,placement:"bottom","render-after-expand":!1,filterable:"","popper-class":"dataset-tree"},{default:i(({node:s,data:at})=>[a("div",de,[at.leaf?T("",!0):(p(),m(n,{key:0,size:"18px"},{default:i(()=>[o(l,{name:"dv-folder"},{default:i(()=>[o(r(zt),{class:"svg-icon"})]),_:1})]),_:1})),at.leaf?(p(),m(n,{key:1,size:"18px"},{default:i(()=>[o(l,{name:"icon_dataset"},{default:i(()=>[o(r(At),{class:"svg-icon"})]),_:1})]),_:1})):T("",!0),a("span",{class:"label ellipsis",style:{"margin-left":"8px"},title:s.label},g(s.label),9,me)])]),_:1},8,["modelValue","data","placeholder"])]),a("div",ue,[a("div",{class:v(["field-d",{open:w.value}])},[a("div",{class:v(["title",{expanded:w.value}]),onClick:t[5]||(t[5]=s=>w.value=!w.value)},[o(it,{class:"expand"},{default:i(()=>[o(l,null,{default:i(()=>[o(r(ct),{class:"svg-icon"})]),_:1})]),_:1}),N("  "+g(e.$t("chart.dimension")),1)],2),w.value?(p(),m(lt,{key:0,data:P.value,props:W},{default:i(({data:s})=>[a("span",fe,[o(n,null,{default:i(()=>[o(l,null,{default:i(()=>[(p(),m(U(r(dt)[r(B)[s.deExtractType]]),{class:v(["svg-icon",`field-icon-${r(B)[[2,3].includes(s.deExtractType)?2:0]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),a("span",{title:s.name,class:"label-tooltip"},g(s.name),9,_e)])]),_:1},8,["data"])):T("",!0)],2),t[7]||(t[7]=a("div",{class:"line-bottom"},null,-1)),a("div",{class:v(["field-q",{open:k.value}])},[a("div",{class:v(["title",{expanded:k.value}]),onClick:t[6]||(t[6]=s=>k.value=!k.value)},[o(it,{class:"expand"},{default:i(()=>[o(l,{name:"icon_expand-right_filled"},{default:i(()=>[o(r(ct),{class:"svg-icon"})]),_:1})]),_:1}),N("  "+g(e.$t("chart.quota")),1)],2),k.value?(p(),m(lt,{key:0,data:O.value,props:W},{default:i(({data:s})=>[a("span",ve,[o(n,null,{default:i(()=>[o(l,null,{default:i(()=>[(p(),m(U(r(dt)[r(B)[s.deExtractType]]),{class:v(["svg-icon",`field-icon-${r(B)[[2,3].includes(s.deExtractType)?2:0]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),a("span",{title:s.name,class:"label-tooltip"},g(s.name),9,he)])]),_:1},8,["data"])):T("",!0)],2)])],512),[[A,!x.value]])],4)])])}}});const Pi=Kt(ge,[["__scopeId","data-v-59cf3bab"]]);export{Pi as default};
