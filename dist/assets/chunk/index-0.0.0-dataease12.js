var Ys=Object.defineProperty;var js=(m,u,e)=>u in m?Ys(m,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):m[u]=e;var _=(m,u,e)=>(js(m,typeof u!="symbol"?u+"":u,e),e);import{_ as it}from"./jspdf-0.0.0-dataease.js";import{p as T,v as D,q as Ei,r as jo,s as Gs,b as bt,t as Xs,u as q,w as At,x as po,y as Us,z as Js,A as Zs,E as Qs,G as Ks,H as tl,I as ye,J as K,K as Lt,L as Go,M as Xo,N as Fi,O as bo,P as zi,Q as ki,R as Ii,U as Oi,V as he,W as Ni,X as Fe,Y as el,Z as Re,_ as uo,$ as ol,a0 as fi,a1 as il,a2 as mi,a3 as Xe,a4 as sl,a5 as de,a6 as ll,a7 as rt,a8 as qt,a9 as pi,aa as Io,ab as Oo,ac as nl,ad as rl,ae as al}from"./chart-0.0.0-dataease.js";import{x as Rt,y as j,z as ae,h as Q,A as cl,B as ul,C as Ot,D as Ve,E as jt,F as ge,u as dl,o as kt,g as gt,G as Bi,H as So,I as Mi,J as Di,K as fl,w as ho,c as Pi,L as ml}from"./lodash-es-0.0.0-dataease.js";import{_ as pe}from"./lodash-0.0.0-dataease.js";import{D as hi,S as pl,G as hl,T as gl,a as yl,s as Uo,c as Ye,C as $i,L as Ri,I as Hi,Z as xl,b as bl,P as Sl,g as Wi,d as Ht,e as qi,f as Cl,h as gi,i as Vi,j as vl,k as _e,H as Al,l as wl,F as Yi,B as _l,m as Ll,n as Tl,o as ji,p as El,q as Fl,r as zl,u as Ne,t as Jo,v as kl,w as Il,x as Z,y as Gi,M as Xi,z as Ol,A as Nl,E as Be,J as go,K as Ui,N as He,O as No,Q as vt,R as Bl,U as Ml,V as Dl,W as yi}from"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import{e as yo}from"./@turf-0.0.0-dataease.js";import{h as U}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as Pl,l as st}from"./index-0.0.0-dataease.js";import{a as xo}from"./mathjs-0.0.0-dataease.js";import{q as $l}from"./sysParameter-0.0.0-dataease.js";import{W as Rl,as as Hl}from"./@vue-0.0.0-dataease.js";import Wl from"./TableTooltip-0.0.0-dataease.js";import{E as Co}from"./exceljs-0.0.0-dataease.js";import{a as vo}from"./file-saver-0.0.0-dataease.js";import{E as Ue}from"./element-plus-secondary-0.0.0-dataease.js";import{D as ee}from"./decimal.js-0.0.0-dataease.js";const{t:Ft}=U(),Ji=["background-overall-component","border-style","basic-style-selector","title-selector","label-selector","tooltip-selector","function-cfg","map-mapping","jump-set","linkage"],le={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","areaBorderColor","zoom"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"label-selector":["color","fontSize","labelBgColor","labelShadow","labelShadowColor","showDimension","showQuota"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"function-cfg":["emptyDataStrategy"],"map-mapping":[""]},Zi=["xAxis","yAxis","area","drill","filter","extLabel","extTooltip"],ql=[{name:Ft("chart.map_style_normal"),value:"normal"},{name:Ft("chart.map_style_darkblue"),value:"darkblue"},{name:Ft("chart.map_style_light"),value:"light"},{name:Ft("chart.map_style_dark"),value:"dark"},{name:Ft("chart.map_style_fresh"),value:"fresh"},{name:Ft("chart.map_style_grey"),value:"grey"},{name:Ft("chart.map_style_blue"),value:"blue"},{name:Ft("commons.custom"),value:"custom"}],Vl=[{name:Ft("chart.map_style_normal"),value:"normal"},{name:Ft("chart.map_style_dark"),value:"black"},{name:Ft("chart.map_style_darkblue"),value:"indigo"}],Yl=[{name:Ft("chart.map_style_normal"),value:"normal"},{name:Ft("commons.custom"),value:"custom"}],et=new Map,oe={COLUMN:["bar","bar-stack","bar-group","bar-group-stack","percentage-bar-stack"],LINE:["line","area","area-stack"],MIX:["chart-mix","chart-mix-group","chart-mix-stack","chart-mix-dual-line"],PIE:["pie","pie-donut"]};function jl(m){return oe.COLUMN.includes(m)}function Gl(m){return oe.PIE.includes(m)}function Xl(m){return oe.MIX.includes(m)}function $o(m){return Object.values(oe).some(u=>u.includes(m))}const Ul={xField:"",duration:2e3,interval:2e3,loop:!0};class Ro{constructor(u,e,o){_(this,"plot");_(this,"config");_(this,"currentIndex",0);_(this,"values",[]);_(this,"timers",{interval:null,carousel:null});_(this,"states",{paused:!1,destroyed:!1});_(this,"observers",new Map);_(this,"resizeObservers",new Map);_(this,"chartIsVisible");this.chart=e,this.plot=u,this.config={...Ul,...o},this.init()}static manage(u,e,o){if(!$o(e.type))return null;const i=e.container;let s=et.get(i);return et.forEach(l=>{i.includes("viewDialog")&&l.paused()}),s?(s.update(u,e,o),s):($o(e.type)&&(s=new this(u,e,o),et.set(i,s)),s)}static destroyByContainer(u){const e=et.get(u);e&&e.destroy()}static getInstanceByContainer(u){const e=et.get(u);return e||null}static closeEnlargeDialogDestroy(u){et==null||et.forEach((e,o)=>{if(e.chart.id===u&&e.chart.container.includes("viewDialog")){const i=et.get(o);i&&i.destroy()}}),setTimeout(()=>{et==null||et.forEach(e=>{e.chartIsVisible&&e.resume()})},400)}static paused(u){et==null||et.forEach(e=>{u&&e.chart.id===u&&setTimeout(()=>e.paused(),200),u||setTimeout(()=>e.paused(),200)})}static resume(u){et==null||et.forEach(e=>{e.chart.id===u&&(e.paused(),setTimeout(()=>e.resume(),500)),u||setTimeout(()=>e.resume(),200)})}init(){this.values=[].concat(this.getUniqueValues()),this.values.length&&(this.chartIsVisible=!0,this.states.paused=!1,this.states.destroyed=!1,this.bindEventListeners(),this.startCarousel())}getUniqueValues(){const u=this.plot instanceof hi?[...this.plot.options.data[0],...this.plot.options.data[1]]:this.plot.options.data;return[...new Set(u.map(e=>e[this.config.xField]))]}startCarousel(){if(!this.shouldStart()){this.stop();return}const u=()=>{this.currentIndex=0;const e=()=>{if(this.states.paused||this.states.destroyed||!this.isElementFullyVisible())return;const o=this.values[this.currentIndex],i=this.calculatePosition(o);this.highlightElement(o),i&&(this.plot.chart.showTooltip(i),this.plot.chart.getController("tooltip").update()),this.currentIndex++,this.currentIndex>this.values.length?(this.currentIndex=0,this.hideTooltip(),this.plot.chart.showTooltip({x:0,y:0}),this.plot.chart.getController("tooltip").update(),this.unHighlightPoint(o),this.timers.interval=setTimeout(()=>e(),this.config.interval)):this.timers.carousel=setTimeout(()=>e(),this.config.duration)};e()};this.stop(),u()}shouldStart(){var u,e,o,i,s;return((e=(u=this.chart.customAttr)==null?void 0:u.tooltip)==null?void 0:e.show)&&((s=(i=(o=this.chart.customAttr)==null?void 0:o.tooltip)==null?void 0:i.carousel)==null?void 0:s.enable)&&this.values.length>0&&this.chartIsVisible&&!this.hasParentWithSwitchHidden(this.plot.chart.ele)}isElementFullyVisible(){var l,r,a;const u=document.fullscreenElement!==null,e=(l=document.getElementById("enlarge-inner-content-"+this.chart.id))==null?void 0:l.getBoundingClientRect(),o=((r=document.getElementsByClassName("panel-mobile"))==null?void 0:r.length)>0;if(((a=document.getElementsByClassName("mobile-com-list"))==null?void 0:a.length)>0)return!1;const s=this.plot.chart.ele.getBoundingClientRect();return s.top>=(u||e||o?0:64)&&s.left>=0&&s.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&s.right<=(window.innerWidth||document.documentElement.clientWidth)}calculatePosition(u){var l,r,a;const e=((l=this.plot.chart.views)==null?void 0:l[0])||this.plot.chart;if(oe.PIE.includes(this.chart.type))return this.getPieTooltipPosition(e,u);if(this.plot instanceof hi)return this.getDualAxesTooltipPosition(e,u);const o=e.scale().getGeometries().map(n=>n.type);let i={x:0,y:0};if(!o.length)return i;o.forEach(n=>{var c;(n==="interval"||n==="point")&&(i=(c=e.scale().getGeometries().find(f=>f.type===n).elements.find(f=>f.data.field===u&&(f.model.x||f.model.y)))==null?void 0:c.model)});const s=oe.COLUMN.includes(this.chart.type)?0:(r=[].concat(i==null?void 0:i.y))==null?void 0:r[0];return{x:(a=[].concat(i==null?void 0:i.x))==null?void 0:a[0],y:s}}getPieTooltipPosition(u,e){var l,r;const o=(r=(l=u.scale().getGeometries()[0])==null?void 0:l.elements.find(a=>a.data.field===e))==null?void 0:r.getModel();if(!o)return{x:0,y:0};const i=[{x:[].concat(o.x)[0],y:o.y[0]},{x:o.x[0],y:o.y[1]},{x:o.x[1],y:o.y[0]},{x:o.x[1],y:o.y[1]}],s=i.findIndex(a=>this.plot.chart.getTooltipItems(a).some(c=>c.data.field===e));return s!==-1?i[s]:{x:o.x[0],y:o.y[0]}}getDualAxesTooltipPosition(u,e){var f,p,d;const o=u.getXScale();if(!o)return{x:0,y:0};const i=o.values;if(i.length<2)return((d=u.getGeometries())==null?void 0:d[0].elements[((p=(f=u.getGeometries())==null?void 0:f[0].elements)==null?void 0:p.length)-1].getModel())||{x:0,y:0};const[s,l]=o.range,r=i.length,a=(l-s)/r,n=i.indexOf(e),c=s+a*(n+.5);return u.getCoordinate().convert({x:c,y:0})}highlightElement(u){oe.LINE.includes(this.chart.type)||(this.unHighlightPoint(u),this.plot.setState(this.getHighlightType(),e=>e[this.config.xField]===u,!0))}unHighlightPoint(u){oe.LINE.includes(this.chart.type)||this.plot.setState(this.getHighlightType(),e=>e[this.config.xField]!==u,!1)}getHighlightType(){return"active"}hideTooltip(){const u=this.getTooltipContainer();u&&(u.style.display="none")}getTooltipContainer(){var e,o;const u=this.plot.chart.getController("tooltip");if(u)return(o=(e=u.tooltip)==null?void 0:e.cfg)==null?void 0:o.container}hasParentWithSwitchHidden(u){let e=u.parentElement;for(;e;){if(e.classList.contains("switch-hidden"))return!0;e=e.parentElement}return!1}bindEventListeners(){const u=["enlarge-inner-content-","enlarge-inner-shape-"];let e=null;for(const l of u)if(e=document.getElementById(l+this.chart.id),e)break;e==null||e.addEventListener("mouseenter",()=>this.paused()),e==null||e.addEventListener("mouseleave",l=>{setTimeout(()=>{const r=l.clientX,a=l.clientY,n=e.getBoundingClientRect(),c=r>=n.left+10&&r<=n.right-10&&a>=n.top+10&&a<=n.bottom-10;console.log(c),c||(this.paused(),this.resume())},300)});const o=this.debounce(()=>{et==null||et.forEach(l=>{this.hasParentWithSwitchHidden(l.plot.chart.ele)||(l.paused(),l.resume())})},50),i=l=>{o(l)},s=document.getElementById("de-preview-content")||document.getElementById("preview-canvas-main")||document.getElementById("dv-main-center")||document.getElementById("edit-canvas-main")||document.getElementById("canvas-mark-line")||document.getElementById("de-canvas-canvas-main");s&&(s.removeEventListener("wheel",o),s.addEventListener("wheel",o),s.removeEventListener("touchmove",i),s.addEventListener("touchmove",i)),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?et==null||et.forEach(l=>{l.paused()}):this.chartIsVisible&&(et==null||et.forEach(l=>{l.resume()}))}),this.setupIntersectionObserver(),this.setupResizeObserver()}setPaused(u){this.states.paused=u,u?this.stop():this.startCarousel()}setupIntersectionObserver(){setTimeout(()=>{this.observers.get(this.plot.chart.ele.id)||(this.observers.set(this.plot.chart.ele.id,new IntersectionObserver(u=>{u.forEach(e=>{e.intersectionRatio<.7?(this.paused(),this.chartIsVisible=!1):(this.paused(),this.chartIsVisible=!0,this.resume())})},{threshold:[.7]})),this.observers.get(this.plot.chart.ele.id).observe(this.plot.chart.ele))},100)}setupResizeObserver(){if(this.plot.chart.ele.id.includes("viewDialog"))return;const u=e=>{for(const o of e)o.target&&this.debounce(()=>{this.paused(),this.resume()},200)};this.resizeObservers.get(this.plot.chart.ele.id)||(this.resizeObservers.set(this.plot.chart.ele.id,new ResizeObserver(u)),this.resizeObservers.get(this.plot.chart.ele.id).observe(this.plot.chart.ele))}update(u,e,o){this.stop(),this.plot=u,this.chart=e,this.config={...this.config,...o},this.currentIndex=0,this.init()}stop(){clearTimeout(this.timers.interval),clearTimeout(this.timers.carousel),this.timers={interval:null,carousel:null}}destroy(){this.stop(),this.clearObserver(),this.states.destroyed=!0,et.delete(this.chart.container)}clearObserver(){const u=this.observers.get(this.plot.chart.ele.id);u&&(u.disconnect(),this.observers.delete(this.plot.chart.ele.id));const e=this.resizeObservers.get(this.plot.chart.ele.id);e&&(e.disconnect(),this.resizeObservers.delete(this.plot.chart.ele.id))}paused(){this.hideTooltip(),this.unHighlightPoint(),this.setPaused(!0)}resume(){this.setPaused(!1)}debounce(u,e){let o=null;return(...i)=>{o&&clearTimeout(o),o=window.setTimeout(()=>{u(...i)},e)}}}const{t:Jl}=U();function ct(m){return m.drill?[0,10,22,10]:[0,10,10,10]}function Zl(m){const u=[];let e,o,i,s,l,r,a,n,c;if(m.customAttr){if(c=T(m.customAttr),c.basicStyle){const d=JSON.parse(JSON.stringify(c.basicStyle));d.colors.forEach(h=>{u.push(q(h,d.alpha))})}if(c.label){const d=JSON.parse(JSON.stringify(c.label));o=d.fontSize,i=d.color}if(c.tooltip){const d=JSON.parse(JSON.stringify(c.tooltip));s=d.color,l=d.fontSize,r=d.backgroundColor}}let f;if(m.customStyle&&(f=T(m.customStyle),f.background&&(e=q(f.background.color,f.background.alpha)),f.legend)){const d=f.legend;a=d.color,n=d.fontSize}const p={styleSheet:{brandColor:u[0],paletteQualitative10:u,paletteQualitative20:u,backgroundColor:e},labels:{offset:4,style:{fill:i,fontSize:o}},innerLabels:{offset:4,style:{fill:i,fontSize:o}},pieLabels:{offset:4,style:{fill:i,fontSize:o}},components:{tooltip:{domStyles:{"g2-tooltip":{color:s,fontSize:l+"px",background:r,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.1)","z-index":2e3,position:"fixed"},"g2-tooltip-list-item":{display:"flex","align-items":"flex-start","justify-content":"space-between","line-height":l+"px"},"g2-tooltip-name":{display:"inline-block","line-height":l+"px"},"g2-tooltip-value":{flex:1,display:"inline-block","text-align":"end","line-height":l+"px"},"g2-tooltip-marker":{"margin-top":(l-8)/2+"px","min-width":"8px","min-height":"8px"}}},legend:{common:{itemName:{style:{fill:a,fontSize:n}}}}}};return m.fontFamily&&(p.styleSheet.fontFamily=m.fontFamily),p}function Je(m){let u,e;if(m.customAttr&&(e=T(m.customAttr),e.label)){const o=e.label;if(o.show){const i=[];o.fullDisplay||(m.type==="bar-stack"?i.push({type:"interval-hide-overlap"}):m.type.indexOf("-horizontal")>-1||["bidirectional-bar","progress-bar","pie-donut","radar","waterfall","t-heatmap","bar"].includes(m.type)?(i.push({type:"limit-in-canvas"}),i.push({type:"hide-overlap"})):m.type.includes("chart-mix")?(i.push({type:"limit-in-canvas"}),i.push({type:"limit-in-plot"}),i.push({type:"hide-overlap"})):(i.push({type:"limit-in-plot"}),i.push({type:"hide-overlap"}))),u={position:o.position,layout:i,style:{fill:o.color,fontSize:o.fontSize,fontFamily:m.fontFamily},formatter:function(s){return D(s.value,o.labelFormatter)}}}else u=!1}return u}function Ql(m){let u,e;if(m.customAttr&&(e=T(m.customAttr),e.tooltip)){const o=JSON.parse(JSON.stringify(e.tooltip));o.show?u={formatter:function(i){const s=D(i.value,o.tooltipFormatter);return{name:i.field,value:s}},container:ft(`tooltip-${m.id}`),itemTpl:mt,enterable:!0}:u=!1}return u}function Kl(m){var s;const e=T(m.customAttr).tooltip;if(!e.show)return!1;const o=(s=e.seriesTooltipFormatter)==null?void 0:s.filter(l=>l.show).reduce((l,r)=>(l[r.id]=r,l),{});return{showTitle:!0,customItems(l){var n,c;if(!((n=e.seriesTooltipFormatter)!=null&&n.length))return l;const r=l[0];if(!r.data.quotaList)return l;const a=[];return l.filter(f=>o[f.data.quotaList[0].id]).forEach(f=>{const p=o[f.data.quotaList[0].id],d=D(parseFloat(f.value),p.formatterCfg),h=j(p.chartShowName)?p.name:p.chartShowName,g=oi(f);a.push({...f,name:h,value:d,...g?{color:g}:{}})}),(c=r.data.dynamicTooltipValue)==null||c.forEach(f=>{const p=o[f.fieldId];if(p){const d=D(parseFloat(f.value),p.formatterCfg),h=j(p.chartShowName)?p.name:p.chartShowName;a.push({color:"grey",name:h,value:d})}}),a},container:ft(`tooltip-${m.id}`),itemTpl:mt,enterable:!0}}function tn(m){let u={},e;if(m.customStyle&&(e=T(m.customStyle),e.legend)){const o=ae(JSON.parse(JSON.stringify(e.legend)),At);if(o.show){let i,s,l;const r=o.orient,a=o.icon;o.hPosition==="center"?l=o.vPosition==="center"?"top":o.vPosition:o.vPosition==="center"?l=o.hPosition==="center"?"left":o.hPosition:r==="horizontal"?l=o.vPosition+"-"+o.hPosition:l=o.hPosition+"-"+o.vPosition,r==="horizontal"?(o.hPosition==="left"?i=16:o.hPosition==="right"?i=-16:i=0,o.vPosition==="top"?s=0:o.vPosition==="bottom"?m.drill&&(s=-12):s=0):(o.hPosition==="left"?i=10:o.hPosition==="right"?i=-10:i=0,o.vPosition==="top"?s=0:o.vPosition==="bottom"?m.drill?s=-18:s=-10:s=0),u={layout:r,position:l,offsetX:i,offsetY:s,marker:{symbol:a,style:{r:o.size}},itemName:{style:{fill:o.color,fontSize:o.fontSize}},itemHeight:(o.fontSize>o.size*2?o.fontSize:o.size*2)+4,radio:!1,pageNavigator:{marker:{style:{fill:"rgba(0,0,0,0.65)",stroke:"rgba(192,192,192,0.52)",size:o.size*2}},text:{style:{fill:o.color,fontSize:o.fontSize}}}}}else u=!1}return u}function Qi(m){let u={},e;if(m.customStyle&&(e=T(m.customStyle),e.xAxis)){const o=JSON.parse(JSON.stringify(e.xAxis));if(o.show){const i=o.nameShow&&o.name&&o.name!==""?{text:o.name,style:{fill:o.color,fontSize:o.fontSize},spacing:8}:null,s=o.splitLine.show?{line:{style:{stroke:o.splitLine.lineStyle.color,lineWidth:o.splitLine.lineStyle.width,lineDash:ne(o.splitLine.lineStyle.style)}}}:null,l=o.axisLine?o.axisLine:Ei.axisLine,r=l.show?{style:{stroke:l.lineStyle.color,lineWidth:l.lineStyle.width,lineDash:ne(l.lineStyle.style)}}:null,a=l.show?{style:{stroke:l.lineStyle.color,lineWidth:l.lineStyle.width}}:null;let n="center";const c=o.axisLabel.rotate;o.position==="top"&&(n=c>20?"end":c<-20?"start":"center"),o.position==="bottom"&&(n=c>20?"start":c<-20?"end":"center");const f=o.axisLabel.show?{rotate:c*Math.PI/180,style:{fill:o.axisLabel.color,fontSize:o.axisLabel.fontSize,textAlign:n,fontFamily:m.fontFamily},formatter:p=>m.type==="bidirectional-bar"&&p.length>o.axisLabel.lengthLimit?p.substring(0,o.axisLabel.lengthLimit)+"...":p}:null;u={position:o.position,title:i,grid:s,label:f,line:r,tickLine:a}}else u=!1}return u}function Ao(m){let u={};const e=T(m.customStyle).yAxis;if(!e.show)return!1;const o=e.nameShow&&e.name&&e.name!==""?{text:e.name,style:{fill:e.color,fontSize:e.fontSize},spacing:8}:null,i=e.splitLine.show?{line:{style:{stroke:e.splitLine.lineStyle.color,lineWidth:e.splitLine.lineStyle.width,lineDash:ne(e.splitLine.lineStyle.style)}}}:null,s=e.axisLine?e.axisLine:jo.axisLine,l=s.show?{style:{stroke:s.lineStyle.color,lineWidth:s.lineStyle.width,lineDash:ne(s.lineStyle.style)}}:null,r=s.show?{style:{stroke:s.lineStyle.color,lineWidth:s.lineStyle.width}}:null,a=e.axisLabel.rotate;let n="end",c="middle";e.position==="right"&&(n="start",Math.abs(a)>75&&(n="center"),a>75&&(c="bottom"),a<-75&&(c="top")),e.position==="left"&&(Math.abs(a)>75&&(n="center"),a>75&&(c="top"),a<-75&&(c="bottom"));const f=e.axisLabel.show?{rotate:a*Math.PI/180,style:{fill:e.axisLabel.color,fontSize:e.axisLabel.fontSize,textBaseline:c,textAlign:n,fontFamily:m.fontFamily},formatter:p=>p.length>e.axisLabel.lengthLimit?p.substring(0,e.axisLabel.lengthLimit)+"...":p}:null;return u={position:e.position,title:o,grid:i,label:f,line:l,tickLine:r,nice:!0},u}function Ki(m){let u={};const e=T(m.customStyle).yAxisExt;if(!e.show)return!1;const o=e.nameShow&&e.name&&e.name!==""?{text:e.name,style:{fill:e.color,fontSize:e.fontSize},spacing:8}:null,i=e.splitLine.show?{line:{style:{stroke:e.splitLine.lineStyle.color,lineWidth:e.splitLine.lineStyle.width,lineDash:ne(e.splitLine.lineStyle.style)}}}:null,s=e.axisLine?e.axisLine:jo.axisLine,l=s.show?{style:{stroke:s.lineStyle.color,lineWidth:s.lineStyle.width,lineDash:ne(s.lineStyle.style)}}:null,r=s.show?{style:{stroke:s.lineStyle.color,lineWidth:s.lineStyle.width}}:null,a=e.axisLabel.rotate;let n="end",c="middle";e.position==="right"&&(n="start",Math.abs(a)>75&&(n="center"),a>75&&(c="bottom"),a<-75&&(c="top")),e.position==="left"&&(Math.abs(a)>75&&(n="center"),a>75&&(c="top"),a<-75&&(c="bottom"));const f=e.axisLabel.show?{rotate:a*Math.PI/180,style:{fill:e.axisLabel.color,fontSize:e.axisLabel.fontSize,textBaseline:c,textAlign:n,fontFamily:m.fontFamily}}:null;return u={position:e.position,title:o,grid:i,label:f,line:l,tickLine:r,nice:!0},u}function en(m){let u;const e=T(m.senior);return e.functionCfg&&e.functionCfg.sliderShow&&(u={start:e.functionCfg.sliderRange[0]/100,end:e.functionCfg.sliderRange[1]/100},e.functionCfg.sliderBg&&(u.backgroundStyle={fill:e.functionCfg.sliderBg,stroke:e.functionCfg.sliderBg,lineWidth:1,strokeOpacity:.5}),e.functionCfg.sliderFillBg&&(u.foregroundStyle={fill:e.functionCfg.sliderFillBg,fillOpacity:.5}),e.functionCfg.sliderTextColor&&(u.textStyle={fill:e.functionCfg.sliderTextColor,fontFamily:m.fontFamily},u.handlerStyle={fill:e.functionCfg.sliderTextColor,fillOpacity:.5,highLightFill:e.functionCfg.sliderTextColor})),u}function ts(m){var i,s;const u=[],e=T(m.senior);if(!((i=e.assistLineCfg)!=null&&i.enable))return u;const o=e.assistLineCfg.assistLine;if((o==null?void 0:o.length)>0){const l=T(m.customStyle);let r,a,n,c;if(l.yAxis){const x=JSON.parse(JSON.stringify(l.yAxis));r=x.position,a=x.axisLabelFormatter?x.axisLabelFormatter:jo.axisLabelFormatter}if(l.yAxisExt){const x=JSON.parse(JSON.stringify(l.yAxisExt));n=x.position,c=x.axisLabelFormatter?x.axisLabelFormatter:Gs.axisLabelFormatter}const f=o.filter(x=>x.field==="0"),p=o.filter(x=>x.field==="1").map(x=>x.fieldId),d=pe.filter(m.yAxis,x=>x.summary!==""&&x.id!=="-1"),h=pe.filter(m.yAxisExt,x=>x.summary!==""&&x.id!=="-1"),g=(s=m.data.dynamicAssistLines)==null?void 0:s.filter(x=>(p==null?void 0:p.includes(x.fieldId))&&(!!pe.find(d,b=>b.id===x.fieldId)||!!pe.find(h,b=>b.id===x.fieldId)&&m.type.includes("chart-mix")));f.concat(g||[]).forEach(x=>{const b=parseFloat(x.value),S=x.name+" : "+D(b,x.yAxisType==="left"?a:c);u.push({type:"line",yAxisType:x.yAxisType,start:["start",b],end:["end",b],style:{stroke:x.color,lineDash:ne(x.lineType)}}),u.push({type:"text",yAxisType:x.yAxisType,position:[(x.yAxisType==="left"?r:n)==="left"?"start":"end",b],content:S,offsetY:-2,offsetX:(x.yAxisType==="left"?r:n)==="left"?2:-10*(S.length-2),style:{textBaseline:"bottom",fill:x.color,fontSize:x.fontSize?x.fontSize:10}})})}return u}function on(m){var i,s;const u=[],e=T(m.senior);if(!((i=e.assistLineCfg)!=null&&i.enable))return u;const o=e.assistLineCfg.assistLine;if((o==null?void 0:o.length)>0){const l=T(m.customStyle);let r;if(l.xAxis){const d=JSON.parse(JSON.stringify(l.xAxis));r=d.axisLabelFormatter?d.axisLabelFormatter:Ei.axisLabelFormatter}const a=o.filter(d=>d.field==="0"),n=o.filter(d=>d.field==="1").map(d=>d.fieldId),c=pe.filter(m.yAxis,d=>d.summary!==""&&d.id!=="-1"),f=(s=m.data.dynamicAssistLines)==null?void 0:s.filter(d=>(n==null?void 0:n.includes(d.fieldId))&&!!pe.find(c,h=>h.id===d.fieldId));a.concat(f||[]).forEach(d=>{const h=parseFloat(d.value),g=d.name+" : "+D(h,r);u.push({type:"line",start:["start",h],end:["end",h],style:{stroke:d.color,lineDash:ne(d.lineType)}}),u.push({type:"text",position:["start",h],content:g,offsetY:5,offsetX:2,rotate:Math.PI/2,style:{textBaseline:"bottom",fill:d.color,fontSize:d.fontSize?d.fontSize:10}})})}return u}function ne(m){switch(m){case"solid":return[0,0];case"dashed":return[10,8];case"dotted":return[2,2];default:return[0,0]}}function at(m,u=!1,e=0,o=0){const i=m.split(","),l=parseFloat(i[3].replace(")",""))*.3;i.splice(3,1,`${l})`);let r;return o==0?r=`l(${e}) 0:${i.join(",")} 1:${m}`:o>0?r=`l(${e}) 0:rgba(255,255,255,0) ${o}:${i.join(",")} 1:${m}`:r=`l(${e}) 0:rgba(255,255,255,0) 0.1:${i.join(",")} 1:${m}`,u?r:m}function es(m){const e=T(m.customAttr).label,o={fill:e.color,fontSize:e.fontSize,textAllowOverlap:!0,fontWeight:"bold"};return e.fullDisplay||(o.textAllowOverlap=!1,o.padding=[2,2]),m.fontFamily&&(o.fontFamily=m.fontFamily),{visible:e.show,style:o}}function sn(m){return{stroke:T(m.customAttr).basicStyle.areaBorderColor}}function os(m){var s;const e=T(m.customAttr).tooltip,o=(s=e.seriesTooltipFormatter)==null?void 0:s.filter(l=>l.show).reduce((l,r)=>(l[r.id]=r,l),{}),i=document.getElementById(m.container);return i&&i.addEventListener("mousemove",l=>{const r=i.getBoundingClientRect(),a=l.clientX-r.left,n=l.clientY-r.top,c=i.getElementsByClassName("l7plot-tooltip-container");for(let f=0;f<(c==null?void 0:c.length);f++){const p=c[f],d=i.clientWidth-a<=p.clientWidth,h=i.clientHeight-n<=p.clientHeight;let g="";d&&(g+="translateX(-120%) "),h&&(g+="translateY(-100%) "),g&&(p.style.transform=g.trim())}}),{customTitle(l){return l.name},customItems(l){var c,f,p;const r=[];if(j(o))return r;const a=l.properties;if(!a)return r;const n=o[(f=(c=a.quotaList)==null?void 0:c[0])==null?void 0:f.id];if(!j(n)){const d=parseFloat(a.value),h=D(d,n.formatterCfg),g=j(n.chartShowName)?n.name:n.chartShowName;r.push({...a,name:g,value:`${h??""}`})}return(p=a.dynamicTooltipValue)==null||p.forEach(d=>{const h=o[d.fieldId];if(h){const g=D(parseFloat(d.value),h.formatterCfg),y=j(h.chartShowName)?h.name:h.chartShowName;r.push({color:"grey",name:y,value:`${g??""}`})}}),r},showComponent:e.show,domStyles:{"l7plot-tooltip":{"background-color":e.backgroundColor,"font-size":`${e.fontSize}px`,"line-height":1.6,"font-family":m.fontFamily?m.fontFamily:void 0},"l7plot-tooltip__name":{color:e.color},"l7plot-tooltip__value":{color:e.color},"l7plot-tooltip__title":{color:e.color}}}}function is(m,u){m.features.forEach(e=>{if(!e.properties.centroid)if(e.properties.center)e.properties.centroid=e.properties.center;else{const i=yo(e.geometry);e.properties.centroid=i.geometry.coordinates}let o=e.properties.name;u!=null&&u[o]&&(o=u[o],e.properties.name=o)})}function wo(m){const u={};return m==null||m.forEach(e=>{var o;(o=e.dynamicTooltipValue)==null||o.forEach(i=>{u[i.fieldId]||(u[i.fieldId]=0),i.value&&(u[i.fieldId]=xo(u[i.fieldId],i.value))})}),u}const ln={circle:{borderRadius:"50%"},square:{},triangle:{borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"10px solid var(--bgColor)",background:"unset"},diamond:{transform:"rotate(45deg)"}};function nn(m){const{basicStyle:u}=T(m.customAttr);if(u.suspension===!1&&u.showZoom===void 0)return!1;const{legend:e}=T(m.customStyle);return e.show?{position:"bottomleft",customContent:(o,i)=>{const s=(i==null?void 0:i.length)>30?i.slice(0,30):i;if(s!=null&&s.length){const r=Ye($i).getElementsByClassName(Ri)[0];return s.forEach(a=>{let n="-";if(a.value!=="")if(Array.isArray(a.value))a.value.forEach((d,h)=>{a.value[h]=Number.isNaN(d)||d==="NaN"?"NaN":parseFloat(d).toFixed(0)}),n=a.value.join("-");else{const d=a.value;n=Number.isNaN(d)||d==="NaN"?"NaN":parseFloat(d).toFixed(0)}const c={...a,value:n},f=Uo(Hi,c),p=Ye(f);p.style.setProperty("--bgColor",a.color),r.appendChild(p)}),r}return""},domStyles:{"l7plot-legend__category-value":{fontSize:e.fontSize+"px",color:e.color},"l7plot-legend__category-marker":{...ln[e.icon]}}}:!1}const rn='<svg t="1717484429999" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9332" width="14px" height="14px"><path d="M47.653 439.326c-24.501 0-44.368 19.881-44.368 44.4v56.548c0 24.492 19.862 44.4 44.368 44.4h928.694c24.501 0 44.368-19.881 44.368-44.4v-56.548c0-24.497-19.862-44.4-44.368-44.4H47.653z" p-id="9333"></path><path d="M586.326 47.653c0-24.501-19.881-44.368-44.4-44.368h-56.548c-24.492 0-44.4 19.862-44.4 44.368v928.694c0 24.501 19.881 44.368 44.4 44.368h56.548c24.497 0 44.4-19.862 44.4-44.368V47.653z" p-id="9334"></path></svg>',an='<svg t="1717487786436" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18361" width="14px" height="14px"><path d="M127.594667 503.274667a383.573333 383.573333 0 0 1 112.426666-263.04 380.864 380.864 0 0 1 122.24-82.474667 382.421333 382.421333 0 0 1 149.632-30.165333c51.946667 0 102.250667 10.176 149.504 30.165333a381.610667 381.610667 0 0 1 122.133334 82.474667 385.152 385.152 0 0 1 31.082666 35.093333l-67.285333 52.501333a8.96 8.96 0 0 0 3.349333 15.765334l196.352 48.042666a8.96 8.96 0 0 0 11.050667-8.597333l0.896-202.154667c0-7.466667-8.597333-11.733333-14.421333-7.04l-63.018667 49.28C795.605333 113.173333 661.973333 42.666667 511.786667 42.666667 255.786667 42.666667 47.488 247.829333 42.666667 502.826667a8.96 8.96 0 0 0 8.96 9.173333h67.029333c4.906667 0 8.832-3.925333 8.96-8.725333z m844.8 8.725333h-67.050667a8.917333 8.917333 0 0 0-8.96 8.704 381.76 381.76 0 0 1-30.037333 140.8 382.336 382.336 0 0 1-82.346667 122.24 382.656 382.656 0 0 1-271.893333 112.64 382.421333 382.421333 0 0 1-271.765334-112.64 385.152 385.152 0 0 1-31.061333-35.072l67.264-52.522667a8.96 8.96 0 0 0-3.349333-15.765333l-196.330667-48.042667a8.96 8.96 0 0 0-11.050667 8.597334l-0.789333 202.261333c0 7.488 8.597333 11.733333 14.421333 7.04l63.018667-49.28C228.394667 910.826667 362.026667 981.333333 512.213333 981.333333 768.341333 981.333333 976.512 776.042667 981.333333 521.173333a8.96 8.96 0 0 0-8.96-9.173333z" p-id="18362"></path></svg>',cn='<svg t="1717486240292" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="13641" width="14px" height="14px"><path d="M935 423.3H89C40.2 423.3 0.3 463.2 0.3 512c0 48.8 39.9 88.7 88.7 88.7h846c48.8 0 88.7-39.9 88.7-88.7 0-48.8-39.9-88.7-88.7-88.7z" p-id="13642"></path></svg>';class We extends xl{resetButtonGroup(u){bl(u),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",u,this.zoomIn),this.zoomResetButton=this.createButton(this.controlOption.resetText,"Reset","l7-button-control",u,()=>{var i;((i=this.mapsService.map)==null?void 0:i.deMapProvider)=="qq"?this.mapsService.map.deMapAutoFit?this.mapsService.setZoomAndCenter(this.mapsService.map.deMapAutoZoom,[this.mapsService.map.deMapAutoLng,this.mapsService.map.deMapAutoLat]):this.mapsService.setZoomAndCenter(this.controlOption.initZoom,this.controlOption.center):this.controlOption.bounds?this.mapsService.fitBounds(this.controlOption.bounds,{animate:!0}):this.mapsService.setZoomAndCenter(this.controlOption.initZoom,this.controlOption.center)}),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",u)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",u,this.zoomOut);const{buttonBackground:e}=this.controlOption,o=[this.zoomResetButton,this.zoomInButton,this.zoomOutButton];e&&xi(o,"background",e),xi(o,"border-bottom","none"),this.updateDisabled()}getDefault(u){const{buttonColor:e}=u;let o=rn,i=cn,s=an;return e&&(o=o.replace("${fill}",e),i=i.replace("${fill}",e),s=s.replace("${fill}",e)),{...u,position:Sl.BOTTOMRIGHT,name:"zoom",zoomInText:o,zoomInTitle:"Zoom in",zoomOutText:i,zoomOutTitle:"Zoom out",resetText:s,showZoom:!1}}}function un(m,u,e){var s,l,r,a,n,c;const{basicStyle:o}=T(m.customAttr),i=u==null?void 0:u.getControlByName("zoom");if(i&&u.removeControl(i),!ss(o)&&!(u!=null&&u.getControlByName("zoom")))if(!u.map)u.once("loaded",()=>{switch(e==null?void 0:e.mapType){case"tianditu":{const f=o.autoFit===!1?o.zoomLevel:u.getZoom(),p=o.autoFit===!1?[o.mapCenter.longitude,o.mapCenter.latitude]:[u.map.getCenter().getLng(),u.map.getCenter().getLat()],d={initZoom:f,center:p,buttonColor:o.zoomButtonColor,buttonBackground:o.zoomBackground};u.addControl(new We(d))}break;case"qq":{const f=o.autoFit===!1?o.zoomLevel:u.getZoom(),p=o.autoFit===!1?[o.mapCenter.longitude,o.mapCenter.latitude]:[u.map.getCenter().lng,u.map.getCenter().lat],d={initZoom:f,center:p,buttonColor:o.zoomButtonColor,buttonBackground:o.zoomBackground};u.addControl(new We(d))}break;default:u.map.on("complete",()=>{const f=o.autoFit===!1?o.zoomLevel:u.getZoom(),p=o.autoFit===!1?[o.mapCenter.longitude,o.mapCenter.latitude]:[u.map.getCenter().lng,u.map.getCenter().lat],d={initZoom:f,center:p,buttonColor:o.zoomButtonColor,buttonBackground:o.zoomBackground};u.addControl(new We(d))})}});else{const f={buttonColor:o.zoomButtonColor,buttonBackground:o.zoomBackground};if(o.autoFit===!1)f.initZoom=o.zoomLevel,f.center=[o.mapCenter.longitude,o.mapCenter.latitude];else{const p=[];if(m.type==="flow-map"){const d=m.xAxis,h=m.xAxisExt;(d==null?void 0:d.length)===2&&((l=(s=m.data)==null?void 0:s.tableRow)==null||l.forEach(g=>{p.push([g[d[0].dataeaseName],g[d[1].dataeaseName]])})),(h==null?void 0:h.length)===2&&((a=(r=m.data)==null?void 0:r.tableRow)==null||a.forEach(g=>{p.push([g[h[0].dataeaseName],g[h[1].dataeaseName]])}))}else{const d=m.xAxis;(d==null?void 0:d.length)===2&&((c=(n=m.data)==null?void 0:n.tableRow)==null||c.forEach(h=>{p.push([h[d[0].dataeaseName],h[d[1].dataeaseName]])}))}f.bounds=dn(p)}u.addControl(new We(f))}}function dn(m){if(!m||m.length===0)return{northEast:[180,90],southWest:[-180,-90]};let u=-180,e=180,o=-90,i=90;return m.forEach(([s,l])=>{u=Math.max(u,s),e=Math.min(e,s),o=Math.max(o,l),i=Math.min(i,l)}),[[u,o],[e,i]]}function fn(m,u){const{basicStyle:e}=T(m.customAttr);ss(e)||u.once("loaded",()=>{const o={initZoom:u.scene.getZoom(),center:u.scene.getCenter(),buttonColor:e.zoomButtonColor,buttonBackground:e.zoomBackground};u.scene.addControl(new We(o))})}function xi(m,u,e){m.forEach(o=>{o.style[u]=e})}function Zo(m){typeof m=="string"&&(m=document.getElementById(m)),m.classList.add("de-map-rendering")}function Qo(m){m!=null&&m.map&&m.map.deMapProvider==="qq"&&setTimeout(()=>{m.map&&(m.map.deMapAutoZoom=m.map.getZoom(),m.map.deMapAutoLng=m.map.getCenter().getLng(),m.map.deMapAutoLat=m.map.getCenter().getLat())},1e3)}function Ie(m){typeof m=="string"&&(m=document.getElementById(m)),m.classList.add("de-map-rendered")}function Ko(m){var e,o;let u;if(m.autoFit===!1){const i=((e=m==null?void 0:m.mapCenter)==null?void 0:e.longitude)??bt.mapCenter.longitude,s=((o=m==null?void 0:m.mapCenter)==null?void 0:o.latitude)??bt.mapCenter.latitude;u=[i,s]}else u=void 0;return u}function ti(m,u){let e;switch(m.mapType){case"tianditu":Rt(Vl,o=>o.value===u.mapStyle)?e=u.mapStyle:e="normal";break;case"qq":!Rt(Yl,o=>o.value===u.mapStyle)||u.mapStyle==="normal"?e="normal":e=u.mapStyleUrl;break;default:Rt(ql,o=>o.value===u.mapStyle)||(u.mapStyle="normal"),e=u.mapStyleUrl,u.mapStyle!=="custom"&&(e=`amap://styles/${u.mapStyle?u.mapStyle:"normal"}`);break}return e}async function ei(m,u,e,o,i,s,l,r){var a,n,c;if(!u)u=new pl({id:e,logoVisible:!1,map:mn(o,i,s,l,r)});else{if(o.mapType==="tianditu"&&((a=u.map)==null||a.checkResize()),(n=u.getLayers())!=null&&n.length){await u.removeAllLayer();try{u.setPitch(s.mapPitch)}catch{}o.mapType==="tianditu"&&l==="normal"?(c=u.map)==null||c.removeStyle():u.setMapStyle(l),u.map.showLabel=i.showLabel!==!1,o.mapType==="qq"&&u.map.setBaseMap({type:"vector",features:i.showLabel===!1?["base","building2d"]:void 0})}i.autoFit===!1&&(u.setZoomAndCenter(i.zoomLevel,r),o.mapType==="qq"&&(u.map.deMapAutoFit=!1,u.map.deMapZoom=i.zoomLevel,u.map.deMapCenter=r))}return Zo(e),u.once("loaded",()=>{var f;if(Ie(e),o.mapType==="qq"&&(u.map.setBaseMap({type:"vector",features:i.showLabel===!1?["base","building2d"]:void 0}),u.setMapStyle(l),u.map.deMapProvider="qq",u.map.deMapAutoFit=!!i.autoFit),o.mapType==="tianditu"){l==="normal"?(f=u.map)==null||f.removeStyle():u.setMapStyle(l);const p=document.querySelector(`#component${m.id} .tdt-control-zoom.tdt-bar.tdt-control`);p&&(p.style.display="none");const d=document.querySelectorAll(`#wrapper-outer-id-${m.id} .tdt-control-zoom.tdt-bar.tdt-control`);if(d&&d.length>0)for(let y=0;y<d.length;y++)d[y].style.display="none";const h=document.querySelector(`#component${m.id} .tdt-control-copyright.tdt-control`);h&&(h.style.display="none");const g=document.querySelectorAll(`#wrapper-outer-id-${m.id} .tdt-control-copyright.tdt-control`);if(g&&g.length>0)for(let y=0;y<g.length;y++)g[y].style.display="none"}}),u}function mn(m,u,e,o,i){switch(m.mapType){case"tianditu":return new yl({token:(m==null?void 0:m.key)??void 0,style:o,pitch:void 0,center:i,zoom:u.autoFit===!1?u.zoomLevel:void 0,showLabel:u.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}});case"qq":return new gl({token:(m==null?void 0:m.key)??void 0,style:o,pitch:e.mapPitch,center:i,zoom:u.autoFit===!1?u.zoomLevel:12,showLabel:u.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}});default:return new hl({token:(m==null?void 0:m.key)??void 0,style:o,pitch:e.mapPitch,center:i,zoom:u.autoFit===!1?u.zoomLevel:void 0,showLabel:u.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}}function ss(m){return m.suspension===!1&&m.showZoom===void 0||m.showZoom===!1}const qe="g2-tooltip-wrapper";function ft(m){let u=document.getElementById(qe);u||(u=document.createElement("div"),u.style.position="absolute",u.style.zIndex="9999",u.id=qe,document.body.appendChild(u));const e=document.getElementById(m);e&&e.remove();const o=document.createElement("div");o.setAttribute("id",m),o.classList.add("g2-tooltip"),o.style.maxHeight="50%",Pl()?o.style.maxWidth="50%":o.style.maxWidth="25%",o.style.overflowY="auto",o.style.display="none",o.style.position="fixed",o.style.left="0px",o.style.top="0px";const i=document.createElement("div");i.classList.add("g2-tooltip-title"),o.appendChild(i);const s=document.createElement("ul");s.classList.add("g2-tooltip-list"),o.appendChild(s);const l=document.getElementsByClassName("fullscreen");return l.length?l.item(0).appendChild(o):u.appendChild(o),o}function pn(m,u){$o(u.type)&&!document.getElementById("multiplexingDrawer")&&m.once("afterrender",()=>{var i,s;const o=(s=(i=u.customAttr)==null?void 0:i.tooltip)==null?void 0:s.carousel;Ro.manage(m,u,{xField:"field",duration:o.enable?(o==null?void 0:o.stayTime)*1e3:2e3,interval:o.enable?(o==null?void 0:o.intervalTime)*1e3:2e3})})}function hn(m,u,e,o,i){const s=()=>{const l=Number(o.getBoundingClientRect().top);return jl(m.type)?l+o.getBoundingClientRect().height/2:Xl(m.type)||Gl(m.type)?l+e.point.y:l+e.point.y+60};return u?{x:e.point.x+Number(o.getBoundingClientRect().left),y:s()}:{x:i.clientX,y:i.clientY}}function St(m,u){const{tooltip:e}=T(m.customAttr);if(!e.show){Ro.destroyByContainer(m.container);return}const o=document.getElementById("container-viewDialog-"+m.id+"-common")||document.getElementById("container-preview-"+m.id+"-common")||document.getElementById("enlarge-inner-content-"+m.id)||document.getElementById("shape-id-"+m.id),s=(o==null?void 0:o.id.includes("viewDialog"))?"9999":"1002";pn(u,m),u.options.tooltip.container.addEventListener("mouseenter",l=>{l.target.style.visibility="visible",l.target.style.display="block"}),u.options.tooltip.container.addEventListener("mouseleave",l=>{l.target.style.visibility="hidden",l.target.style.display="none"}),u.on("tooltip:show",()=>{var h,g,y,x;const l=u.chart.getController("tooltip");if(!l)return;const r=Ro.getInstanceByContainer(m.container);if(r&&r.hasParentWithSwitchHidden(u.chart.ele))return;const a=document.getElementById("view-track-bar-"+m.id),n=(g=(h=u.chart.interactions.tooltip)==null?void 0:h.context)==null?void 0:g.event,c=((x=(y=m.customAttr)==null?void 0:y.tooltip)==null?void 0:x.carousel)&&(!n||["plot:leave","plot:mouseleave"].includes(n==null?void 0:n.type)||["pie","pie-rose","pie-donut"].includes(m.type));u.options.tooltip.showMarkers=!!c;const f=document.getElementById(qe);if(f.style.zIndex=c&&f?s:"9999",l.tooltip){const b=l.tooltip.cfg.container;if((a==null?void 0:a.getAttribute("aria-expanded"))==="false"&&b.classList.toggle("hidden-tooltip",!1),b.style.display="block",!document.getElementById(b.id)){const C=document.getElementsByClassName("fullscreen");C.length?C.item(0).appendChild(b):document.getElementById(qe).appendChild(b)}}u.chart.getOptions().tooltip.follow=!1,l.title=Math.random().toString();const{x:p,y:d}=hn(m,c,l,o,n);u.chart.getTheme().components.tooltip.x=p,u.chart.getTheme().components.tooltip.y=d}),u.on("plot:leave",()=>{var a,n;const l=u.chart.getController("tooltip");if(!l)return;u.chart.getOptions().tooltip.follow=!0;const r=(n=(a=l.tooltip)==null?void 0:a.cfg)==null?void 0:n.container;r&&(r.style.display="none"),l.hideTooltip()}),u.on("plot:touchstart",()=>{var r;const l=document.getElementById(qe);if(l){const a=u.chart.getController("tooltip");if(!a)return;const n=(r=a.tooltip)==null?void 0:r.cfg.container;for(const c of l.children)(!n||n.id!==c.id)&&(c.style.display="none")}}),u.on("tooltip:hidden",()=>{var a;const l=u.chart.getController("tooltip");if(!l)return;const r=(a=l.tooltip)==null?void 0:a.cfg.container;r&&(r.style.display="none")})}const mt='<li class="g2-tooltip-list-item" data-index={index}><span class="g2-tooltip-marker" style="background:{color}"></span><span class="g2-tooltip-name">{name}</span>:<span class="g2-tooltip-value">{value}</span></li>';function gn(m){const{threshold:u}=T(m.senior),e=[];if(!u.enable||m.type==="area-stack"||m.type==="symbolic-map")return e;const o=u.lineThreshold??[],i=m.yAxis.map(s=>s.id);for(const s of o)if(i.includes(s.fieldId))for(const l of s.conditions){const r={type:"regionFilter",start:["start","median"],end:["end","min"],color:l.color},a={type:"line",start:["start",l.value],end:["end",l.value],style:{stroke:l.color,lineDash:[2,2]}};l.term==="between"?(r.start=["start",parseFloat(l.min)],r.end=["end",parseFloat(l.max)],a.start=["start",parseFloat(l.min)],a.end=["end",parseFloat(l.min)],e.push(JSON.parse(JSON.stringify(a))),a.start=["start",parseFloat(l.max)],a.end=["end",parseFloat(l.max)],e.push(a)):["lt","le"].includes(l.term)?(r.start=["start",l.value],r.end=["end","min"],e.push(a)):["gt","ge"].includes(l.term)&&(r.start=["start",l.value],r.end=["end","max"],e.push(a)),e.push(r)}return e}const to={transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:"rgb(255, 255, 255)",boxShadow:"rgb(174, 174, 174) 0px 0px 10px",borderRadius:"3px",padding:"8px 12px",opacity:"0.95",position:"absolute",visibility:"visible"},yn='<div class="g2-axis-label-tooltip"><div class="g2-tooltip-title">{title}</div></div>';function ce(m,u,e){const o=e||"axis-label",i=o==="axis-title",{customStyle:s,customAttr:l}=T(m),{lengthLimit:r,fontSize:a,color:n,show:c}=s.yAxis.axisLabel,{tooltip:f}=l;!i&&(!r||!c||!s.yAxis.show||m.type==="bidirectional-bar")||(u.on(o+":mouseenter",p=>{var I;const d=p.target.cfg.delegateObject.component.cfg.field,h=p.target.cfg.delegateObject.component.cfg.position;if(d!=="field"&&d!=="title"&&!(h==="left"||h==="right"))return;const y=p.target.attrs.text;if(!i&&(y.length<r||y.slice(-3)!=="..."))return;const{x,y:b}=p,S=p.event.target.parentNode;let C=S.getElementsByClassName("g2-axis-label-tooltip")[0];const v=((I=p.target.cfg.delegateObject.item)==null?void 0:I.name)||p.target.cfg.delegateObject.axis.cfg.title.originalText;if(C)C.getElementsByClassName("g2-tooltip-title")[0].innerHTML=v,C.style.visibility="visible";else{const F=Uo(yn,{title:v});C=Ye(F),to.backgroundColor=f.backgroundColor,to.boxShadow=`${f.backgroundColor} 0px 0px 5px`,to.maxWidth="200px",pe.assign(C.style,to),S.appendChild(C)}const{height:A,width:w}=S.getBoundingClientRect(),{offsetHeight:z,offsetWidth:k}=C;if(z>A||k>w){C.style.left=C.style.top="0px";return}const N={left:x+10,top:b+15};N.left+k>w&&(N.left=w-k-10),N.top+z>A&&(N.top-=z+15),C.style.left=`${N.left}px`,C.style.top=`${N.top}px`,C.style.color=n,C.style.fontSize=`${a}px`}),u.on(o+":mouseleave",p=>{const d=p.target.cfg.delegateObject.component.cfg.field,h=p.target.cfg.delegateObject.component.cfg.position;if(d!=="field"&&d!=="title"&&!(h==="left"||h==="right"))return;const y=p.target.attrs.text;if(!i&&(y.length<r||y.slice(-3)!=="..."))return;const b=p.event.target.parentNode.getElementsByClassName("g2-axis-label-tooltip")[0];b&&(b.style.visibility="hidden")}))}function xn(m,u){u.on("beforerender",e=>{const{yAxis:o}=T(m.customStyle),i=.8*(e.view.canvas.cfg.height-(e.view.canvas.cfg.height<120?60:30)),s=Xs(m,o.name,{fontSize:o.fontSize,fontFamily:m.fontFamily},"height");let l="";for(let a=0;a<o.name.length&&(a+1)*s<=i;a++)l+=o.name[a];o.name.length>l.length&&(l=l.length>2?l.slice(0,l.length-2)+"...":l+"...");const{title:r}=e.view.options.axes.yAxisExt;r&&(r.originalText=o.name,r.text=l)})}const bn=(m,u)=>{const{threshold:e}=T(m.senior);return e.enable&&u.data.forEach(o=>{var s;o.conditionColor=[];const i=m.type==="bar-horizontal"?u.xField:u.yField;m.type==="bidirectional-bar"?i.forEach(l=>{var n;const r=l==="value"?m.yAxis:m.yAxisExt,a=Ho([(n=r[0])==null?void 0:n.id],o[l],m);a&&(o[o[u.xField]+"-"+l]=a)}):(s=o.quotaList)!=null&&s.length&&(o.quotaList.map(r=>r.id)??[]).forEach(r=>{let a=o[i];m.type==="progress-bar"&&(a=o.originalValue);const n=Ho([r],a,m);n?o.conditionColor.push(n):o.conditionColor=void 0})}),u},Ho=(m,u,e)=>{var r,a;const{threshold:o}=T(e.senior),{basicStyle:i}=T(e.customAttr),s=Array.isArray(u)?u[1]-u[0]:u;if(!s)return;const l=new Map;for(const n of o.lineThreshold??[])l.set(n.fieldId,n);for(const n of l.values())if(!(e.type==="progress-bar"&&((a=(r=e.yAxisExt)==null?void 0:r[0])==null?void 0:a.id)!==m[0])&&!(!m.includes(n.fieldId)&&e.type!=="waterfall")){for(const c of n.conditions)if(c.term==="between"&&s>=c.min&&s<=c.max||c.term==="lt"&&s<c.value||c.term==="le"&&s<=c.value||c.term==="gt"&&s>c.value||c.term==="ge"&&s>=c.value){let f=po(c.color,i.alpha);if(i.gradient){let p=["bar-horizontal","progress-bar"].includes(e.type)?0:270;if(e.type==="bidirectional-bar"){const d=e.yAxis.find(h=>h.id===n.fieldId);p=ns(i,d?0:1)}f=at(f,!0,p)}return f}}};function Sn(m,u){const{threshold:e}=T(m.senior);if(!e.enable)return u;const{basicStyle:o}=T(m.customAttr),i="conditionColor",s=u.rawFields||[];s.push(i);const l=n=>{var c;return{...(c=n[i])!=null&&c[0]?{fill:n[i][0]}:{}}};let r;return m.type==="bidirectional-bar"?(s.push(u.xField),r=vn(m,o,u)):m.type==="waterfall"&&(r=Cn(o,m)),{...u,rawFields:s,...re(m,"columnStyle",l),...re(m,"barStyle",l),tooltip:{...u.tooltip,...u.tooltip.customItems?{}:{customItems:n=>(n.forEach(c=>{var f;(f=c.data)!=null&&f[i]&&(c.color=c.data[i][0])}),n)}},...r?{color:r}:{}}}const Cn=(m,u)=>{const e=ls(u,m,270);return o=>{if(o.$$isTotal$$)return e[2];const i=o.$$yField$$;return Ho([],i,u)??(i[1]>i[0]?e[0]:e[1])}},vn=(m,u,e)=>{const o=ls(m,u,270);return i=>{const s=e.data.find(l=>l[i[e.xField]+"-"+i["series-field-key"]]);return s?s[i[e.xField]+"-"+i["series-field-key"]]:i["series-field-key"]==="value"?o[0]:o[1]}},ls=(m,u,e)=>{var i;const o=[];return(i=u.colors)==null||i.forEach((s,l)=>{m.type==="bidirectional-bar"?o.push(at(po(s,u.alpha),!0,ns(u,l))):o.push(at(po(s,u.alpha),!0,e))}),u.gradient?o:u.colors},ns=(m,u)=>{let e=180-u*180;return m.layout==="vertical"&&(e=u===0?280:90),e},oi=m=>{var e;let u=m.color;return(e=m.data)!=null&&e.conditionColor&&(u=m.data.conditionColor[0]),u},An=(m,u,e,o)=>{if((()=>{const s=document.getElementById(u+"_empty");s&&s.parentElement.removeChild(s)})(),!(m.length>0)&&!m.length){const s=document.createElement("div");s.id=u+"_empty",s.textContent=o||Jl("data_set.no_data"),s.setAttribute("style",`position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        color: darkgray;
        textAlign: center;`);const l=document.getElementById(u);l.insertBefore(s,l.firstChild),e==null||e.destroy()}},cc=m=>{if(m<=0||m>99||!Number.isInteger(m))throw new Error("请输入1-99之间的整数");const u=["","一","二","三","四","五","六","七","八","九"];if(m<10)return u[m];const e=Math.floor(m/10),o=m%10;return o===0?e===1?"十":u[e]+"十":e===1?"十"+u[o]:u[e]+"十"+u[o]},re=(m,u,e)=>{const{basicStyle:o}=T(m.customAttr);if(["roundAngle","topRoundAngle"].includes(o.radiusColumnBar)){const i=Array(2).fill(o.columnBarRightAngleRadius),s=[0,0,...i],l=[...i,0,0],r=[...i,...i];if(m.type.includes("-stack"))return{[u]:c=>c.value?{radius:r,...e?e(c):{}}:{radius:[],...e?e(c):{}}};const a=o.radiusColumnBar==="topRoundAngle";if(m.type==="bidirectional-bar"){const c=o.layout==="vertical"?"valueExt":"value";return{[u]:f=>({radius:f[c]&&a?s:a?i:r,...e?e(f):{}})}}if(m.type==="progress-bar")return{[u]:c=>({radius:a?l:r,...e?e(c):{}})};if(m.type==="bar-range")return{[u]:c=>({radius:(c==null?void 0:c.values[0])<(c==null?void 0:c.values[1])?a?l:r:a?s:r,...e?e(c):{}})};const n=c=>{if(a)return{radius:i,...e?e(c):{}};if(!a)return{radius:r,...e?e(c):{}}};return{[u]:n}}return{[u]:i=>({...e?e(i):{}})}},{t:Pt}=U();var _o=(m=>(m.ANT_V="antv",m.ECHARTS="echarts",m.CUSTOM="custom",m))(_o||{}),ue=(m=>(m.G2_PLOT="g2plot",m.L7_PLOT="l7plot",m.L7="l7",m.ECHARTS="echarts",m.S2="s2",m.RICH_TEXT="rich-text",m.PICTURE_GROUP="picture-group",m.INDICATOR="indicator",m))(ue||{});class wn{constructor(){_(this,"chartInstance")}}class Ze{constructor(u,e,o,i){_(this,"render");_(this,"library");_(this,"name");_(this,"title");_(this,"defaultData");this.render=u,this.library=e,this.name=o,this.defaultData=i}setupDefaultOptions(u){return u}}class Lo extends Ze{constructor(e,o,i){super("antv",e,o,i);_(this,"axisConfig",{xAxis:{name:`${Pt("chart.drag_block_type_axis")} / ${Pt("chart.dimension")}`,type:"d",allowEmpty:!0},xAxisExt:{name:`${Pt("chart.chart_group")} / ${Pt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},extStack:{name:`${Pt("chart.stack_item")} / ${Pt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${Pt("chart.drag_block_value_axis")} / ${Pt("chart.quota")}`,type:"q",limit:1,allowEmpty:!0}});_(this,"selectorSpec",{"misc-style-selector":{title:`${Pt("chart.size")}`},"dual-y-axis-selector":{title:`${Pt("chart.yAxis")}`},"x-axis-selector":{title:`${Pt("chart.xAxis")}`}})}}class lt extends Lo{configTheme(u,e){const o=Zl(u);return{...e,theme:o}}configLabel(u,e){const o=Je(u);return{...e,label:o}}configMultiSeriesTooltip(u,e){const o=Kl(u);return{...e,tooltip:o}}configTooltip(u,e){const o=Ql(u);return{...e,tooltip:o}}configLegend(u,e){const o=tn(u);return{...e,legend:o}}configXAxis(u,e){const o=Qi(u);return{...e,xAxis:o}}configYAxis(u,e){const o=Ao(u);return{...e,yAxis:o}}configSlider(u,e){const o=en(u);return{...e,slider:o}}configAnalyse(u,e){const o=ts(u);return{...e,annotations:[...o,...e.annotations||[]]}}configAnalyseHorizontal(u,e){const o=on(u);return{...e,annotations:o}}configEmptyDataStrategy(u,e){return Us(u,e)}configColor(u,e){const o=Js(u);return{...e,color:o}}configGroupColor(u,e){const o=Zs(u,e);return{...e,color:o}}configStackColor(u,e){const o=Qs(u,e);return{...e,color:o}}configSingleDimensionColor(u,e){const o=Ks(u,e);return{...e,color:o}}setupSeriesColor(u,e){return tl(u)}setupSubSeriesColor(u,e){}configConditions(u,e){const o=gn(u);return{...e,annotations:[...o,...e.annotations||[]]}}configBarConditions(u,e){return Sn(u,e)}addConditionsStyleColorToData(u,e){return bn(u,e)}configEmptyDataStyle(u,e,o,i){An(u,e,o,i)}constructor(u,e){super(ue.G2_PLOT,u,e)}}const Oe=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","function-cfg","assist-line","jump-set","linkage","threshold"],_n=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","function-cfg","jump-set","linkage","threshold"],yt={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","radiusColumnBar","columnWidthRatio"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter","show"],"x-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position"],"y-axis-selector":["name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","position"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["slider","emptyDataStrategy"],threshold:["lineThreshold"]},xe=["xAxis","yAxis","filter","drill","extLabel","extTooltip"],Qe=m=>{var e;const u=document.getElementById(Yt(m));u&&(u.remove(),(e=u.parentNode)==null||e.removeChild(u))},Ln=(m,u=128)=>{const e=rs(m);return j(e)?!1:e.r*.299+e.g*.587+e.b*.114>=u},rs=m=>{const u=/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/g;let e,o=null;for(;(e=u.exec(m))!==null;){const i=parseInt(e[1]),s=parseInt(e[2]),l=parseInt(e[3]),r=parseFloat(e[4]);o={r:i,g:s,b:l,a:r}}return o};function bi(m,u,e,o){var s;if(!u&&u!=0)return;const i=document.getElementById(Yt(o));if(i){const l=document.getElementById(m);l&&(l.remove(),(s=l.parentNode)==null||s.removeChild(l));const r=document.createElement("div");r.id=m,r.className="child",r.setAttribute("style",`width: auto;
        height: auto;
        border-radius: 2px;
        position: relative;
        padding: 4px 5px 4px 5px;
        display:none;
        transform: translateX(-50%);
        opacity: 1;
        transition: opacity 0.2s ease-in-out;
        white-space:nowrap;
        overflow:auto;`),r.textContent=D(u,e);const a=document.createElement("span");a.setAttribute("style",`width: 0px;
        height: 12px;
        border: 4px solid transparent;
        border-top-color: red;
        position: absolute;
        left: calc(50% - 4px);
        margin-top:4px;`),r.appendChild(a),i.appendChild(r)}}const as=m=>["area","bar"].includes(m.type),Tn=m=>["line","area","bar","bar-group"].includes(m.type),fo=m=>m.container+"_",Yt=m=>m.container+"_point_"+m.id+"_";function En(m,u){const e=document.getElementById(m);if(!e){console.error("Parent div not found");return}const o=e.getElementsByTagName("div");for(let i=o.length-1;i>=0;i--){const s=o[i];s.id&&s.id.startsWith(u)&&s.parentNode.removeChild(s)}}const To=(m,u,e,o)=>{if(u.container=o,Qe(u),!Tn(u))return;const{label:i}=T(u.customAttr),{yAxis:s}=T(u);m.once("beforerender",l=>{l.view.on("beforepaint",()=>{var r;(r=m.chart.geometries[0])==null||r.beforeMappingData.forEach(a=>{var p;a.forEach(d=>{delete d._origin.EXTREME});const{minItem:n,maxItem:c}=Fn(a.filter(d=>{var h,g;return((h=d==null?void 0:d._origin)==null?void 0:h.value)!==null&&((g=d==null?void 0:d._origin)==null?void 0:g.value)!==void 0}));if(!n||!c)return;let f=!1;if(as(u)||s.length>1){const d=i.seriesLabelFormatter.find(h=>(h.chartShowName?h.chartShowName:h.name===n._origin.category)||(h.chartShowName?h.chartShowName:h.name===c._origin.category));f=d==null?void 0:d.showExtremum}else["bar-group"].includes(u.type)?f=i.showExtremum:f=(p=i.seriesLabelFormatter[0])==null?void 0:p.showExtremum;f&&(n._origin.EXTREME=!0,c._origin.EXTREME=!0)})}),m.chart.geometries[0].on("afteranimate",()=>{zn(u,l)})}),m.on("legend-item:click",l=>{const r=l.view.getController("legend").components[0].component.cfg.items.filter(a=>a.unchecked);r.length>0&&r.forEach(a=>{const n=fo(u)+Yt(u)+a.id;En(Yt(u),n)})})},Fn=m=>m.reduce(({minItem:u,maxItem:e},o)=>((u===void 0||o._origin.value<u._origin.value)&&(u=o),(e===void 0||o._origin.value>e._origin.value)&&(e=o),u==null||delete u._origin.EXTREME,e==null||delete e._origin.EXTREME,{minItem:u,maxItem:e}),{minItem:void 0,maxItem:void 0}),zn=(m,u)=>{const{label:e,basicStyle:o}=T(m.customAttr),i=o.lineSymbolSize,{yAxis:s}=T(m);if(Qe(m),!document.getElementById(Yt(m))){const c=document.createElement("div");c.id=Yt(m),c.style.position="fixed",c.style.zIndex="1",c.style.opacity="0",c.style.transition="opacity 0.2s ease-in-out",c.style.overflow="visible";const f=document.getElementById(m.container);f.insertBefore(c,f.firstChild);let p=0;const d=()=>{if(p+=.19,p>=1){cancelAnimationFrame(h);return}c.style.opacity=p+"",h=requestAnimationFrame(d)};let h=requestAnimationFrame(d)}let r=[];const a=u.view.getGeometries().find(c=>c.type==="interval");a&&(r=a.dataArray);const n=u.view.getGeometries().find(c=>c.type==="point");n&&(r=n.dataArray),kn(r,c=>{var f;if(c&&c.length>0){const p=c[0],[d,h]=c.filter(C=>C._origin.EXTREME);let g,y=!1;if(as(m)||s.length>1){const C=e.seriesLabelFormatter.find(v=>v.chartShowName?v.chartShowName===p._origin.category:v.name===p._origin.category);y=C==null?void 0:C.showExtremum,g=C}else["bar-group"].includes(m.type)?y=e.showExtremum:(y=(f=e.seriesLabelFormatter[0])==null?void 0:f.showExtremum,g=e.seriesLabelFormatter[0]);const x=g?g.fontSize:e.fontSize;if(!d)return;const b=fo(m)+Yt(m)+p._origin.category+"_"+(h?h._origin.value:d._origin.value),S=fo(m)+Yt(m)+p._origin.category+"_"+d._origin.value;y&&e.show?(h&&bi(b,h._origin.value,g?g.formatterCfg:e.labelFormatter,m),bi(S,d._origin.value,g?g.formatterCfg:e.labelFormatter,m),c.forEach(C=>{const v=document.getElementById(fo(m)+Yt(m)+C._origin.category+"_"+C._origin.value);if(v&&C._origin.EXTREME){v.style.position="absolute";const A=(C.y[1]?C.y[1]:C.y)-(x+(i||0)+12);v.style.top=A+"px",v.style.left=C.x+"px",v.style.zIndex="10",v.style.fontSize=x+"px",v.style.lineHeight=x+"px";const w=C.color.startsWith("#")?po(C.color,o.alpha/100):rs(C.color),{r:z,b:k,g:N,a:I}=w;v.style.backgroundColor="rgba("+z+","+N+","+k+","+I+")",v.style.color=Ln(C.color)?"#000":"#fff",v.children[0].style.borderTopColor="rgba("+z+","+N+","+k+","+I+")",v.style.display="table";const F=v.childNodes[1],M=Math.ceil(C.y+Math.abs(Math.floor(A))+6);A<0&&Math.abs(A)/C.y*100>=50?(v.style.transform=`translateX(-50%) translateY(${M}px)`,F.style.marginTop="-16px",F.style.transform="rotate(180deg)"):F.style.display="block"}})):(Si(b),Si(S))}})};function Si(m){var e;const u=document.getElementById(m);u&&(u.remove(),(e=u.parentNode)==null||e.removeChild(u))}typeof window.requestIdleCallback!="function"&&(window.requestIdleCallback=function(m){return window.setTimeout(()=>{m({timeRemaining:()=>Math.max(0,50-Date.now()%50),didTimeout:!1})},16)},window.cancelIdleCallback=function(m){clearTimeout(m)});function kn(m,u){if(typeof m=="number"&&(m={length:m}),m.length===0)return;let e=0;function o(){e>=m.length||typeof window.requestIdleCallback=="function"&&requestIdleCallback(i=>{for(;i.timeRemaining()>0&&e<m.length;)u(m[e],e),e++;o()})}o()}const{t:Le}=U(),In=[];class cs extends lt{constructor(e="bar",o=In){super(e,o);_(this,"properties",Oe);_(this,"propertyInner",{...yt,"basic-style-selector":[...yt["basic-style-selector"],"seriesColor"],"label-selector":["vPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show","carousel"],"y-axis-selector":[...yt["y-axis-selector"],"axisLabelFormatter"]});_(this,"baseOptions",{xField:"field",yField:"value",seriesField:"category",isGroup:!0,data:[]});_(this,"axis",[...xe]);_(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Le("chart.drag_block_type_axis")} / ${Le("chart.dimension")}`,type:"d"},yAxis:{name:`${Le("chart.drag_block_value_axis")} / ${Le("chart.quota")}`,type:"q"}})}async drawChart(e){var f,p,d,h,g;const{chart:o,container:i,action:s}=e;if(o.container=i,!((p=(f=o==null?void 0:o.data)==null?void 0:f.data)!=null&&p.length)){Qe(o);return}this.name==="bar-group"&&((d=o.xAxisExt)==null?void 0:d.length)>0,["bar-stack","bar-group-stack"].includes(this.name)&&((h=o.extStack)==null?void 0:h.length)>0;const l=Q((g=e.chart.data)==null?void 0:g.data),r={...this.baseOptions,appendPadding:ct(o),data:l},a=this.setupOptions(o,r);let n=null;const{Column:c}=await it(()=>import("./@antv-0.0.0-dataease.js").then(y=>y.a2),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url);return n=new c(i,a),n.on("interval:click",s),this.name==="bar"&&a.tooltip&&n.on("plot:click",y=>{var b,S;if(((S=(b=y.target)==null?void 0:b.cfg)==null?void 0:S.renderer)!=="canvas")return;const x=y.view.backgroundGroup.cfg.children.find(C=>C.cfg.name==="active-region");if(x!=null&&x.cfg.visible){const C=Wi(y.view,{x:y.x,y:y.y},y.view.getController("tooltip").getTooltipCfg());if(C!=null&&C.length){const v=C[0].data;v&&v.field&&s({x:y.x,y:y.y,data:{data:v}})}}}),To(n,o,a,i),St(o,n),n}configLabel(e,o){var a;const i=super.configLabel(e,o);if(!i.label)return{...i,label:!1};const{label:s}=T(e.customAttr),l=(a=s.seriesLabelFormatter)==null?void 0:a.reduce((n,c)=>(n[c.id]=c,n),{});i.label.style.fill=ye.color;const r={fields:[],...i.label,formatter:n=>{var d;if(n.EXTREME)return"";if(!((d=s.seriesLabelFormatter)!=null&&d.length))return n.value;const c=l==null?void 0:l[n.quotaList[0].id];if(!c)return n.value;if(!c.show)return;const f=D(n.value,c.formatterCfg),p=new Ht({});return p.addShape({type:"text",attrs:{x:0,y:0,text:f,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fontFamily:e.fontFamily,fill:c.color}}),p},position:n=>{var c,f,p;if(n.value<0){if(((c=i.label)==null?void 0:c.position)==="top")return"bottom";if(((f=i.label)==null?void 0:f.position)==="bottom")return"top"}return(p=i.label)==null?void 0:p.position}};return{...i,label:r}}configTooltip(e,o){return super.configMultiSeriesTooltip(e,o)}configBasicStyle(e,o){const i=T(e.customAttr).basicStyle;if(i.gradient){let r=i.colors;r=r.map(a=>{const n=q(a,i.alpha);return at(n,!0,270)}),o={...o,color:r}}o={...o,...re(e,"columnStyle")};let s;const l=i.columnWidthRatio??bt.columnWidthRatio;return l>=1&&l<=100?s=l/100:l<1?s=1/100:l>100&&(s=1),s&&(o.columnWidthRatio=s),o}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;const s=T(e.customStyle).yAxis,l=s.axisValue;if(i.yAxis.label&&(i.yAxis.label.formatter=r=>D(r,s.axisLabelFormatter)),!(l!=null&&l.auto)){const r={yAxis:{...i.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}},{data:a}=o,n=a.filter(c=>c.value>=l.min);return{...i,data:n,...r}}return i}setupOptions(e,o){return K(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configBarConditions)(e,o,{},this)}setupDefaultOptions(e){return e.senior.functionCfg.emptyDataStrategy="ignoreData",e}}class ii extends cs{constructor(e="bar-stack"){super(e);_(this,"properties",Oe.filter(e=>e!=="threshold"));_(this,"propertyInner",{...this.propertyInner,"label-selector":[...yt["label-selector"],"vPosition","showTotal","totalColor","totalFontSize","totalFormatter","showStackQuota"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show","carousel"],"legend-selector":[...yt["legend-selector"],"legendSort"]});this.baseOptions={...this.baseOptions,isStack:!0,isGroup:!1,meta:{category:{type:"cat"}}},this.axis=[...this.axis,"extStack"]}configLabel(e,o){let i=Je(e);if(!i)return o;o={...o,label:i};const{label:s}=T(e.customAttr);if(s.showStackQuota||s.showStackQuota===void 0?(i.style.fill=s.color,i={...i,formatter:function(l){return D(l.value,s.labelFormatter)}}):i=!1,s.showTotal){const l=s.labelFormatter??bo;cl(ul(o.data,"field"),(r,a)=>{const n=r.reduce((f,p)=>f+p.value,0),c=D(n,l);o.annotations||(o={...o,annotations:[]}),o.annotations.push({type:"text",position:[a,n],content:`${c}`,style:{textAlign:"center",fontSize:s.fontSize,fill:s.color},offsetY:-(parseInt(s.fontSize)/2)})})}return{...o,label:i}}configTooltip(e,o){const i=T(e.customAttr).tooltip;if(!i.show)return{...o,tooltip:!1};const s={formatter:l=>{const a={name:j(l.category)?l.field:l.category,value:l.value},n=D(l.value,i.tooltipFormatter);return a.value=n??"",a},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:s}}configColor(e,o){return this.configStackColor(e,o)}configData(e,o){const{xAxis:i,extStack:s,yAxis:l}=e,r=i.some(d=>d.sort!=="none"),a=s.some(d=>d.sort!=="none");if(r||a||!((l==null?void 0:l[0].sort)!=="none")||!s.length||!l.length)return o;const{data:c}=o,f=c.reduce((d,h)=>(d[h.field]=d[h.field]?d[h.field]+h.value:h.value||0,d),{}),p=l[0].sort;return c.sort((d,h)=>p==="asc"?f[d.field]-f[h.field]:f[h.field]-f[d.field]),o}configSortedLegend(e,o){var f,p,d,h,g;const i=super.configLegend(e,o);if(!i.legend)return i;const s=e.extStack[0];if(((f=s==null?void 0:s.customSort)==null?void 0:f.length)>0){const y=s.customSort??[];if(y!=null&&y.length){const x=i.data,b=(x==null?void 0:x.reduce((C,v)=>{const A=v.category;return A&&!C.includes(A)&&C.push(A),C},[]))||[],S=y.reduce((C,v)=>{if(b.includes(v)){const A=b.indexOf(v);A!==-1&&b.splice(A,1),C.push(v)}return C},[]);b.length>0&&S.push(...b),i.meta={...i.meta,category:{type:"cat",values:S}}}}const l=T(e.customStyle);let r;l&&l.legend?r=ae(JSON.parse(JSON.stringify(l.legend)),At).size:r=At.size,i.legend.marker.style=y=>({r,fill:y.fill});const{sort:a,customSort:n,icon:c}=l.legend;if(a&&a!=="none"&&e.extStack.length){const y=T(e.customAttr),{basicStyle:x}=y,b=((p=x.seriesColor)==null?void 0:p.reduce((A,w)=>(A[w.id]=w,A),{}))||{},S=new Set,C=i.color??i.theme.styleSheet.paletteQualitative10,v=(d=i.data)==null?void 0:d.reduce((A,w)=>{var z;if(!S.has(w.category)){const k=((z=b[w.category])==null?void 0:z.color)??C[S.size%C.length];S.add(w.category),A.push({name:w.category,value:w.category,marker:{symbol:c,style:{r,fill:Lt(k)?k:Go(k,x.alpha)}}})}return A},[]);if(a!=="custom")v.sort((A,w)=>a!=="desc"?A.name.localeCompare(w.name):w.name.localeCompare(A.name));else{const A=[];(n||[]).forEach(w=>{const z=v.findIndex(k=>k.name===w);z!==-1&&(A.push(v[z]),v.splice(z,1))}),v.unshift(...A)}i.legend.items=v,((h=s==null?void 0:s.customSort)==null?void 0:h.length)>0&&((g=i.meta)==null||delete g.category.values)}return i}setupSeriesColor(e,o){return Xo(e,o)}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configData,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configSortedLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(e,o,{},this)}}class On extends ii{constructor(e="bar-group"){super(e);_(this,"properties",Oe);_(this,"propertyInner",{...this.propertyInner,"label-selector":[...yt["label-selector"],"vPosition","showExtremum"],"legend-selector":yt["legend-selector"]});_(this,"axisConfig",{...this.axisConfig,yAxis:{name:`${Le("chart.drag_block_value_axis")} / ${Le("chart.quota")}`,type:"q",limit:1}});this.baseOptions={...this.baseOptions,marginRatio:0,isGroup:!0,isStack:!1,meta:{category:{type:"cat"}}},this.axis=[...xe,"xAxisExt"]}async drawChart(e){const o=await super.drawChart(e);if(!o)return o;const{chart:i}=e,{xAxis:s,xAxisExt:l,yAxis:r}=i;let a=!!(s.length&&l.length&&r.length);if(a&&r[0].sort==="none"&&(a=!1),a&&l[0].sort!=="none"){const n=i.sortPriority??[],c=n==null?void 0:n.findIndex(p=>p.id===r[0].id);(n==null?void 0:n.findIndex(p=>p.id===l[0].id))<=c&&(a=!1)}return a&&o.chart.once("beforepaint",()=>{const n=o.chart.geometries[0],c=n.beforeMapping.bind(n);n.beforeMapping=f=>{const p=n.getXScale().values,d=p.reduce((h,g)=>(h!=null&&h[g]||(h[g]={fieldArr:[],indexArr:[],dataArr:[]}),f.forEach((y,x)=>{y.forEach((b,S)=>{b._origin.field===g&&(h[g].fieldArr.push(b.field),h[g].indexArr.push([x,S]),h[g].dataArr.push(b))})}),h),{});return p.forEach(h=>{const g=d[h];g.dataArr.sort((y,x)=>r[0].sort==="asc"?y.value-x.value:r[0].sort==="desc"?x.value-y.value:0),g.indexArr.forEach((y,x)=>{g.dataArr[x].field=g.fieldArr[x],f[y[0]][y[1]]=g.dataArr[x]})}),c(f)}}),o}configLabel(e,o){const i=Je(e);if(!i)return o;const s={...o,label:i},{label:l}=T(e.customAttr);s.label.style.fill=l.color;const r={...s.label,formatter:function(a){if(a.EXTREME)return"";const n=D(a.value,l.labelFormatter);return l.childrenShow?n:null}};return{...s,label:r}}configColor(e,o){return this.configGroupColor(e,o)}setupSeriesColor(e,o){return Fi(e,o)}setupOptions(e,o){return K(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configBarConditions)(e,o,{},this)}}class us extends ii{constructor(e="bar-group-stack"){super(e);_(this,"propertyInner",{...this.propertyInner,"label-selector":[...yt["label-selector"],"vPosition"],"legend-selector":yt["legend-selector"]});this.baseOptions={...this.baseOptions,isGroup:!0,groupField:"group"},this.axis=[...this.axis,"xAxisExt","extStack"]}configTheme(e,o){const l={...super.configTheme(e,o).theme,innerLabels:{offset:0}};return{...o,theme:l}}configLabel(e,o){const i=Je(e);if(!i)return o;const s={...o,label:i},{label:l}=T(e.customAttr);s.label.style.fill=l.color;const r={...s.label,formatter:function(a){return D(a.value,l.labelFormatter)}};return{...s,label:r}}configTooltip(e,o){const i=T(e.customAttr).tooltip;if(!i.show)return{...o,tooltip:!1};const s={fields:[],formatter:l=>{const r={name:`${l.category} - ${l.group}`,value:l.value};return r.value=D(l.value,i.tooltipFormatter),r},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:s}}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(e,o,{},this)}}class Nn extends us{constructor(){super("percentage-bar-stack");_(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","vPosition","reserveDecimalCount"],"tooltip-selector":["color","fontSize","backgroundColor","show","carousel"]});this.baseOptions={...this.baseOptions,isStack:!0,isPercent:!0,isGroup:!1,groupField:void 0,meta:{category:{type:"cat"}}},this.axis=[...xe,"extStack"]}configLabel(e,o){const i=super.configLabel(e,o);if(!i.label)return i;const{customAttr:s}=e,l=T(s).label,r={...i.label,formatter:function(a){return a.value?(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%":"0%"}};return{...i,label:r}}configTooltip(e,o){if(!T(e.customAttr).tooltip.show)return{...o,tooltip:{showContent:!1}};const{customAttr:s}=e,l=T(s).label,r={formatter:a=>{const n={name:a.category,value:a.value};return n.value=(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%",n},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:r}}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(e,o,{},this)}}const Bn=Object.freeze(Object.defineProperty({__proto__:null,Bar:cs,GroupBar:On,GroupStackBar:us,PercentageStackBar:Nn,StackBar:ii},Symbol.toStringTag,{value:"Module"})),{t:Jt}=U();class Mn extends lt{constructor(){super("bidirectional-bar",[]);_(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Jt("chart.drag_block_type_axis")} / ${Jt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Jt("chart.drag_block_value_axis")} / ${Jt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Jt("chart.drag_block_value_axis_ext")} / ${Jt("chart.quota")}`,type:"q",limit:1}});_(this,"axis",["xAxis","yAxis","yAxisExt","filter","drill","extLabel","extTooltip"]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","dual-y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","function-cfg","jump-set","linkage","threshold"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","layout","radiusColumnBar"],"x-axis-selector":["position","axisLabel","axisLine","splitLine"],"dual-y-axis-selector":["name","position","color","fontSize","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["emptyDataStrategy"],"label-selector":["hPosition","vPosition","seriesLabelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],threshold:["lineThreshold"]});_(this,"selectorSpec",{...this.selectorSpec,"dual-y-axis-selector":{title:`${Jt("chart.xAxis")}`},"x-axis-selector":{title:`${Jt("chart.yAxis")}`}})}async drawChart(e){var g,y,x,b;const{chart:o,container:i,action:s}=e;if(!((y=(g=o.data)==null?void 0:g.data)!=null&&y.length))return;const l=Q(o.data.data),r=Ot((x=l[0])==null?void 0:x.data,[]),a=Ve(Ot((b=l[1])==null?void 0:b.data,[]),S=>{var C;return{...S,category:S.field,value:(C=r.find(v=>v.field===S.field))==null?void 0:C.value,valueExt:S.value}}),n={xField:"field",data:a,xAxis:{label:{style:{}},position:"bottom"},yField:["value","valueExt"],appendPadding:ct(o),meta:{field:{type:"cat"}}},f={...this.setupOptions(o,n)},p=o.xAxis;if((p==null?void 0:p.length)===1&&p[0].deType===1){const S=a.map(C=>C.field);f.meta={field:{type:"cat",values:S.reverse()}}}const{BidirectionalBar:d}=await it(()=>import("./@antv-0.0.0-dataease.js").then(S=>S.a9),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),h=new d(i,f);return h.on("interval:click",s),h.on("element:click",S=>{const C=h.options.data.filter(v=>v.field===S.data.data.field&&v[S.data.data["series-field-key"]]===S.data.data[S.data.data["series-field-key"]]);S.data.data={...S.data.data,...C[0]}}),St(o,h),ce(o,h),h}configBasicStyle(e,o){var s;const i=T(e.customAttr).basicStyle;if(i.gradient){const l=(s=i.colors)==null?void 0:s.map((r,a)=>{const n=q(r,i.alpha);let c=180-a*180;return i.layout==="vertical"&&(a===0&&(c=280),a===1&&(c=90)),at(n,!0,c)});o={...o,color:l}}return o={...o,layout:i.layout},o={...o,...re(e,"barStyle")},o}configXAxis(e,o){const i=super.configXAxis(e,o);return i.xAxis&&i.xAxis.label&&delete i.xAxis.label.style.textAlign,i}configTooltip(e,o){var p;const s=T(e.customAttr).tooltip;if(!s.show)return{...o,tooltip:!1};const l=Q(e.yAxis),r=Q(e.yAxisExt),a=(p=s.seriesTooltipFormatter)==null?void 0:p.filter(d=>d.show).reduce((d,h)=>(d[h.seriesId]=h,d),{}),n=Q(o.data),c=d=>{const h=d.data;let g=l[0],y="yAxis";return h["series-field-key"]==="valueExt"&&(g=r[0],y="yAxisExt"),{id:g.id,name:g.name,axisType:y,value:h[h["series-field-key"]]}},f={shared:!0,showTitle:!0,customItems(d){var y,x;if(!((y=s.seriesTooltipFormatter)!=null&&y.length))return d;const h=[];d.filter(b=>{const S=c(b);return a[S.id+"-"+S.axisType]}).forEach(b=>{const S=c(b),C=a[S.id+"-"+S.axisType],v=D(parseFloat(b.value),C.formatterCfg),A=j(C.chartShowName)?C.name:C.chartShowName,w=oi(b);h.push({...b,name:A,value:v,color:w})});const g=(x=n.find(b=>b.field===d[0].title))==null?void 0:x.dynamicTooltipValue;return g.length>0&&g.forEach(b=>{const S=s.seriesTooltipFormatter.filter(C=>C.id===b.fieldId);if(S&&S.length>0){const C=D(parseFloat(b.value),S[0].formatterCfg),v=j(S[0].chartShowName)?S[0].name:S[0].chartShowName;h.push({color:"grey",name:v,value:C})}}),h},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:f}}configLegend(e,o){const i=super.configLegend(e,o);return i.legend&&(i.legend.itemName.formatter=(s,l,r)=>{const a=e.yAxis[0],n=e.yAxisExt[0];return r===0?a.chartShowName?a.chartShowName:a.name:n.chartShowName?n.chartShowName:n.name}),i}configYAxis(e,o){const i=Ao(e);let s=Ki(e);const l={...o};i?l.yAxis={value:void 0,valueExt:void 0}:(s=!1,l.yAxis={value:!1,valueExt:!1});const r=o.layout==="horizontal";i&&i.title&&r&&(i.title.autoRotate=!1);const a=T(e.customStyle).yAxis;i.label&&(i.label.formatter=p=>D(p,a.axisLabelFormatter));const n=a.axisValue;n!=null&&n.auto?l.yAxis.value=i:l.yAxis.value={...i,min:n.min,max:n.max,minLimit:n.min,maxLimit:n.max,tickCount:n.splitCount};const c=T(e.customStyle).yAxisExt;s.label&&(s.label.formatter=p=>D(p,c.axisLabelFormatter));const f=c.axisValue;return f!=null&&f.auto?l.yAxis.valueExt=s:l.yAxis.valueExt={...s,min:f.min,max:f.max,minLimit:f.min,maxLimit:f.max,tickCount:f.splitCount},l}setupDefaultOptions(e){return e.customStyle.yAxis={...e.customStyle.yAxis,position:"left"},e.customStyle.yAxisExt={...e.customStyle.yAxisExt,position:"left",splitLine:e.customStyle.yAxis.splitLine},e.customAttr.label={...e.customAttr.label,position:"right"},e.customAttr.basicStyle.layout="horizontal",e}configLabel(e,o){var f;let i;const s=e.yAxis,l=e.yAxisExt,r=T(e.customAttr).label,a=(f=r.seriesLabelFormatter)==null?void 0:f.reduce((p,d)=>(p[d.id]=d,p),{});let n;const c=o.layout==="horizontal";if(e.customAttr&&(n=T(e.customAttr),n.label)){const p=n.label;if(p.show){const d=[];if(!r.fullDisplay){const h=super.configLabel(e,o);d.push(...h.label.layout)}i={position:p.position,layout:d,style:{fill:p.color,fontSize:p.fontSize,fontFamily:e.fontFamily},formatter:h=>{let g=s[0],y=h.value;h["series-field-key"]==="valueExt"&&(g=l[0]);const x=h[h["series-field-key"]],b=a==null?void 0:a[g.id];if(g.formatterCfg&&(y=D(x,g.formatterCfg)),!b)return y;if(!b.show)return;b?y=D(x,b.formatterCfg):y=D(x,p.labelFormatter);const S=new Ht({}),C=h["series-field-key"]==="value",v=C&&c?"end":"start",A=i.position==="middle";return S.addShape({type:"text",attrs:{x:C&&c&&!A?-6:!C&&c&&!A?6:0,y:C&&!c&&!A?-8:!C&&!c&&!A?8:0,text:y,textAlign:i.position==="middle"?"start":v,textBaseline:"top",fontSize:b.fontSize,fontFamily:e.fontFamily,fill:b.color}}),S}}}else i=!1}return c||(i.position==="left"&&(i.position="bottom"),i.position==="right"&&(i.position="top")),{...o,label:i}}configEmptyDataStrategy(e,o){const{data:i}=o;if(!(i!=null&&i.length))return o;const s=T(e.senior).functionCfg.emptyDataStrategy;if(s==="ignoreData"){const r=i.filter(a=>a.value===null||a.valueExt===null).map(a=>a.field);return{...o,data:i.filter(a=>!r.includes(a.field))}}return(s==="breakLine"||s==="setZero")&&((r,a)=>{a.forEach(n=>{n.value===null&&(n.value=r==="breakLine"?null:0),n.valueExt===null&&(n.valueExt=r==="breakLine"?null:0)})})(s,i),o}setupOptions(e,o){return K(this.addConditionsStyleColorToData,this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configEmptyDataStrategy,this.configBarConditions)(e,o)}}const Dn=Object.freeze(Object.defineProperty({__proto__:null,BidirectionalHorizontalBar:Mn},Symbol.toStringTag,{value:"Module"})),{t:Zt}=U();class Pn extends lt{constructor(){super("bullet-graph",[]);_(this,"axis",[...xe,"yAxisExt","extBubble"]);_(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Zt("chart.form_type")} / ${Zt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Zt("chart.progress_current")} / ${Zt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Zt("chart.progress_target")} / ${Zt("chart.quota")}`,type:"q",limit:1},extBubble:{name:`${Zt("chart.range_bg")} / ${Zt("chart.quota")}`,type:"q",allowEmpty:!0,limit:1}});_(this,"properties",[...Oe.filter(e=>!["function-cfg","assist-line","threshold"].includes(e)),"bullet-graph-selector"]);_(this,"propertyInner",{"basic-style-selector":["radiusColumnBar","layout"],"label-selector":["hPosition","fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":[...yt["x-axis-selector"].filter(e=>e!="position"),"showLengthLimit"],"y-axis-selector":[...yt["y-axis-selector"].filter(e=>e!=="axisValue"&&e!=="position"),"axisLabelFormatter"],"legend-selector":["showRange","orient","fontSize","color","hPosition","vPosition"]})}async drawChart(e){var p,d,h;const{chart:o,container:i,action:s}=e;if(!((d=(p=o.data)==null?void 0:p.data)!=null&&d.length))return;const l=$n(o),{bullet:r}=T(o.customAttr).misc;if(r.bar.ranges.showType==="fixed"){const g=((h=r.bar.ranges.fixedRange)==null?void 0:h.map(y=>y.fixedRangeValue))||[0];l.forEach(y=>y.ranges=g)}else l.forEach(g=>g.ranges=g.originalRanges);if(r.bar.target.showType==="fixed"){const g=r.bar.target.value||0;l.forEach(y=>y.target=g)}else l.forEach(g=>g.target=g.originalTarget);const a={appendPadding:ct(o),data:l.reverse(),measureField:"measures",rangeField:"ranges",targetField:"target",xField:"title",meta:{title:{type:"cat"}},interactions:[{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]},n=this.setupOptions(o,a);let c=null;const{Bullet:f}=await it(()=>import("./@antv-0.0.0-dataease.js").then(g=>g.aa),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url);return c=new f(i,n),c.on("element:click",g=>{var S,C;const y=(S=g==null?void 0:g.data)==null?void 0:S.data,x=(C=n.data.find(v=>v.title===y.title))==null?void 0:C.dimensionList,b={x:g.x,y:g.y,data:{data:{...y,dimensionList:x}}};s(b)}),St(o,c),ce(o,c,null),c}configBasicStyle(e,o){var p,d;const i=T(e.customAttr).basicStyle,{radiusColumnBar:s,columnBarRightAngleRadius:l,layout:r}=i;let a=0,n=1;(s==="roundAngle"||s==="topRoundAngle")&&(a=l,n=(d=(p=o.data[0])==null?void 0:p.ranges)==null?void 0:d.length);const c={radius:Array(2).fill(a)},f=[...c.radius,...c.radius];return o={...o,bulletStyle:{range:h=>{if(!h.rKey)return{fill:"rgba(0, 0, 0, 0)"};if(n===1)return{radius:s==="topRoundAngle"?[...c.radius,0,0]:f};if(n>1&&h.rKey==="ranges_0")return{radius:s==="topRoundAngle"?[]:[0,0,...c.radius]};if(n>1&&h.rKey==="ranges_"+(n-1))return{radius:[...c.radius,0,0]}},measure:h=>{if(h.measures)return{radius:s==="topRoundAngle"?[...c.radius,0,0]:f}},target:h=>h.tKey==="target"?{lineWidth:2}:void 0}},r==="vertical"&&(o={...o,layout:"vertical"}),o}configMisc(e,o){var r;const{bullet:i}=T(e.customAttr).misc,l=i.bar.ranges.showType==="dynamic"?i.bar.ranges.fill:((r=i.bar.ranges.fixedRange)==null?void 0:r.sort((a,n)=>(a.fixedRangeValue??0)-(n.fixedRangeValue??0)).map(a=>a.fill))||[];return{...o,color:{measure:[].concat(i.bar.measures.fill),range:[].concat(l),target:[].concat(i.bar.target.fill)},size:{measure:i.bar.measures.size,range:i.bar.ranges.size,target:i.bar.target.size}}}configXAxis(e,o){const i=super.configXAxis(e,o);if(!i.xAxis||!i.xAxis.label)return i;const{layout:s,xAxis:l}=i,r=l.position,a={...l.label.style};return s==="vertical"?(a.textAlign="center",a.textBaseline=r==="bottom"?"top":"bottom"):(a.textAlign=r==="bottom"?"end":"start",a.textBaseline="middle"),l.label.style=a,i}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis||!i.yAxis.label)return i;const s=T(e.customStyle).yAxis;i.yAxis.label.formatter=c=>D(c,s.axisLabelFormatter);const{layout:l,yAxis:r}=i,a=r.position,n={...r.label.style};return l==="vertical"?(n.textAlign=a==="left"?"end":"start",n.textBaseline="middle"):(n.textAlign="center",n.textBaseline=a==="left"?"top":"bottom"),r.label.style=n,i}configLabel(e,o){const i=super.configLabel(e,o);if(!i.label)return i;const s=T(e.customAttr).label,l={...i.label,formatter:r=>r.mKey==="measures"?D(r.measures,s.labelFormatter):void 0};return{...i,label:{measure:l}}}configLegend(e,o){var f,p,d,h,g,y,x;const i=super.configLegend(e,o).legend;if(!i)return o;const{bullet:s}=T(e.customAttr).misc,l=T(e.customStyle).legend,r=[],a=(b,S,C,v,A=4)=>({value:b,name:S,marker:{symbol:C,style:{fill:v,stroke:b==="measure"?"":v,r:A}}});if(l.showRange)if(s.bar.ranges.showType==="dynamic"){if(e.extBubble.length){const b=((f=e.extBubble[0])==null?void 0:f.chartShowName)||s.bar.ranges.name;r.push(a("dynamic",b||((p=e.extBubble[0])==null?void 0:p.name),s.bar.ranges.symbol,[].concat(s.bar.ranges.fill)[0],s.bar.ranges.symbolSize))}}else(d=s.bar.ranges.fixedRange)==null||d.forEach(b=>{r.push(a(b.name,b.name,s.bar.ranges.symbol,b.fill,s.bar.ranges.symbolSize))});const n=((h=e.yAxisExt[0])==null?void 0:h.chartShowName)||s.bar.target.name;r.push(a("target",n||((g=e.yAxisExt[0])==null?void 0:g.name),"line",[].concat(s.bar.target.fill)[0],s.bar.ranges.symbolSize));const c=((y=e.yAxis[0])==null?void 0:y.chartShowName)||s.bar.measures.name;return r.push(a("measure",c||((x=e.yAxis[0])==null?void 0:x.name),"square",[].concat(s.bar.measures.fill)[0],s.bar.ranges.symbolSize)),{...o,legend:{custom:!0,position:i.position,layout:i.layout,items:r}}}configTooltip(e,o){var n;const s=T(e.customAttr).tooltip,{bullet:l}=T(e.customAttr).misc;if(!s.show)return{...o,tooltip:!1};const r=(n=s.seriesTooltipFormatter)==null?void 0:n.filter(c=>c.show).reduce((c,f,p)=>{switch(f.axisType){case"yAxis":return c.measures=f,c;case"yAxisExt":return c.target=f,c;case"extBubble":return c.ranges=f,c;default:return c}},{}),a={shared:!0,showMarkers:!0,customItems(c){var x,b;if(!((x=s.seriesTooltipFormatter)!=null&&x.length))return c;const f=l.bar.ranges.showType==="dynamic",p=e.extBubble[0],d=[],h=o.data.find(S=>S.title===c[0].title);Object.keys(r).forEach((S,C)=>{var A;if(S==="记录数*")return;const v=r[S];if(v){let w=j(v.chartShowName)?v.name:v.chartShowName,z=D(parseFloat(h[S]),v.formatterCfg),k=((A=l.bar[S])==null?void 0:A.fill)??"grey";if(S==="ranges")if(!f&&p)w=j(p.chartShowName)?p.name:p.chartShowName,z=D(parseFloat(h.minRanges[0]),p.formatterCfg),k="grey";else return;d.push({color:k,name:w,value:z})}}),h.ranges.forEach((S,C)=>{const v=f?D(parseFloat(h.minRanges[0]),p.formatterCfg):S;let A="",w;if(l.bar.ranges.showType==="dynamic")A=j(p.chartShowName)?p.name:p.chartShowName,w=l.bar.ranges.fill;else{const z=l.bar.ranges.fixedRange[C].name;A=z||(j(p.chartShowName)?p.name:p.chartShowName),w=l.bar.ranges.fixedRange[C].fill}d.push({...c[0],color:w,name:A,value:v})});const y=(b=e.data.data.find(S=>S.field===c[0].title))==null?void 0:b.dynamicTooltipValue;return y.length>0&&y.forEach(S=>{const C=s.seriesTooltipFormatter.filter(v=>v.id===S.fieldId);if(C&&C.length>0){const v=D(parseFloat(S.value),C[0].formatterCfg),A=j(C[0].chartShowName)?C[0].name:C[0].chartShowName;d.push({color:"grey",name:A,value:v})}}),d.sort((S,C)=>S.color==="grey"?1:C.color==="grey"?-1:0),d},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:a}}setupDefaultOptions(e){return e.customAttr.label.position="middle",e.customStyle.yAxis.splitLine.show=!1,super.setupDefaultOptions(e)}setupOptions(e,o){return K(this.configTheme,this.configBasicStyle,this.configMisc,this.configXAxis,this.configYAxis,this.configLabel,this.configLegend,this.configTooltip)(e,o,{},this)}}function $n(m){const u=m.data.data.reduce((o,i)=>{const s=i.field;return o[s]||(o[s]=[]),o[s].push(i),o},{}),e=[];return Object.keys(u).forEach(o=>{var c,f,p,d;const i=u[o],s={title:o,ranges:[],measures:[],target:[],dimensionList:i[0].dimensionList,quotaList:[]};i.forEach(h=>{var x,b,S,C;const g=(x=h.quotaList[0])==null?void 0:x.id,y=h.value||0;g===((b=m.yAxis[0])==null?void 0:b.id)&&s.measures.push(y),g===((S=m.yAxisExt[0])==null?void 0:S.id)&&s.target.push(y),g===((C=m.extBubble[0])==null?void 0:C.id)&&s.ranges.push(y),s.quotaList.push(h.quotaList[0])});const l=(c=m.extBubble[0])!=null&&c.id?[].concat((f=s.ranges)==null?void 0:f.reduce((h,g)=>h+g,0)):[],r=[].concat((p=s.target)==null?void 0:p.reduce((h,g)=>h+g,0)),a=[].concat((d=s.measures)==null?void 0:d.reduce((h,g)=>h+g,0)),n={...s,measures:a,target:r,ranges:l,quotaList:[...s.quotaList],minRanges:l,originalRanges:l,originalTarget:r};e.push(n)}),e}const Rn=Object.freeze(Object.defineProperty({__proto__:null,BulletGraph:Pn},Symbol.toStringTag,{value:"Module"})),{t:Te}=U(),Hn=[];class ds extends lt{constructor(e="bar-horizontal"){super(e,Hn);_(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Te("chart.drag_block_type_axis")} / ${Te("chart.dimension")}`,type:"d"},yAxis:{name:`${Te("chart.drag_block_value_axis")} / ${Te("chart.quota")}`,type:"q"}});_(this,"properties",Oe);_(this,"propertyInner",{...yt,"basic-style-selector":[...yt["basic-style-selector"],"seriesColor"],"label-selector":["hPosition","seriesLabelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":[...yt["x-axis-selector"],"axisLabelFormatter","axisValue"],"y-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position","showLengthLimit"]});_(this,"axis",[...xe]);_(this,"baseOptions",{data:[],xField:"value",yField:"field",seriesField:"category",isGroup:!0})}async drawChart(e){var f,p;const{chart:o,container:i,action:s}=e;if(!((p=(f=o.data)==null?void 0:f.data)!=null&&p.length))return;const l=Q(o.data.data),r={...this.baseOptions,appendPadding:ct(o),data:l},a=this.setupOptions(o,r),{Bar:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(d=>d.a1),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("interval:click",s),a.label&&c.on("label:click",d=>{s({x:d.x,y:d.y,data:{data:d.target.attrs.data}})}),this.name==="bar-horizontal"&&a.tooltip&&c.on("plot:click",d=>{var g,y;if(((y=(g=d.target)==null?void 0:g.cfg)==null?void 0:y.renderer)!=="canvas")return;const h=d.view.backgroundGroup.cfg.children.find(x=>x.cfg.name==="active-region");if(h!=null&&h.cfg.visible){const x=Wi(d.view,{x:d.x,y:d.y},d.view.getController("tooltip").getTooltipCfg());if(x!=null&&x.length){const b=x[0].data;b&&b.field&&s({x:d.x,y:d.y,data:{data:b}})}}}),St(o,c),ce(o,c),c}configXAxis(e,o){const i=super.configXAxis(e,o);if(!i.xAxis)return i;const s=T(e.customStyle).xAxis,l=s.axisValue;if(i.xAxis.label&&(i.xAxis.label.formatter=r=>D(r,s.axisLabelFormatter)),i.xAxis.position==="top"&&(i.xAxis.position="left"),i.xAxis.position==="bottom"&&(i.xAxis.position="right"),!(l!=null&&l.auto)){const r={xAxis:{...i.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}},{data:a}=o,n=a.filter(c=>c.value>=l.min);return{...i,data:n,...r}}return i}configTooltip(e,o){return super.configMultiSeriesTooltip(e,o)}configBasicStyle(e,o){const i=T(e.customAttr).basicStyle;if(i.gradient){let r=i.colors;r=r.map(a=>{const n=q(a,i.alpha);return at(n,!0)}),o={...o,color:r}}o={...o,...re(e,"barStyle")};let s;const l=i.columnWidthRatio??bt.columnWidthRatio;return l>=1&&l<=100?s=l/100:l<1?s=1/100:l>100&&(s=1),s&&(o.barWidthRatio=s),o}setupDefaultOptions(e){const{customAttr:o,senior:i}=e,{label:s}=o;return["left","middle","right"].includes(s.position)||(s.position="middle"),i.functionCfg.emptyDataStrategy="ignoreData",e}configLabel(e,o){var a;const i=super.configLabel(e,o);if(!i.label)return{...i,label:!1};const s=T(e.customAttr).label,l=(a=s.seriesLabelFormatter)==null?void 0:a.reduce((n,c)=>(n[c.id]=c,n),{});i.label.style.fill=ye.color;const r={fields:[],...i.label,formatter:n=>{var d;if(!((d=s.seriesLabelFormatter)!=null&&d.length))return n.value;const c=l==null?void 0:l[n.quotaList[0].id];if(!c)return n.value;if(!c.show)return;const f=D(n.value,c.formatterCfg),p=new Ht({});return p.addShape({type:"text",attrs:{x:0,y:0,data:n,text:f,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fontFamily:e.fontFamily,fill:c.color}}),p}};return{...i,label:r}}configYAxis(e,o){const i=super.configYAxis(e,o);return i.yAxis&&(i.yAxis.position==="left"&&(i.yAxis.position="bottom"),i.yAxis.position==="right"&&(i.yAxis.position="top")),i}setupOptions(e,o){return K(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal,this.configBarConditions)(e,o,{},this)}}class fs extends ds{constructor(e="bar-stack-horizontal"){super(e);_(this,"properties",Oe.filter(e=>e!=="threshold"));_(this,"axisConfig",{...this.axisConfig,extStack:{name:`${Te("chart.stack_item")} / ${Te("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}});_(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","hPosition","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"],"legend-selector":[...yt["legend-selector"],"legendSort"]});this.baseOptions={...this.baseOptions,isGroup:!1,isStack:!0,meta:{category:{type:"cat"}}},this.axis=[...this.axis,"extStack"]}configLabel(e,o){const i=super.configLabel(e,o);if(!i.label)return i;const{label:s}=T(e.customAttr);i.label.style.fill=s.color;const l={...i.label,formatter:function(r){const a=D(r.value,s.labelFormatter),n=new Ht({});return n.addShape({type:"text",attrs:{x:0,y:0,data:r,text:a,textAlign:"start",textBaseline:"top",fontSize:s.fontSize,fontFamily:e.fontFamily,fill:s.color}}),n}};return{...i,label:l}}configTooltip(e,o){const i=T(e.customAttr).tooltip;if(!i.show)return{...o,tooltip:!1};const s={formatter:l=>{const r={name:l.category,value:l.value},a=D(l.value,i.tooltipFormatter);return r.value=a??"",r},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:s}}configColor(e,o){return this.configStackColor(e,o)}setupSeriesColor(e,o){return Xo(e,o)}configData(e,o){var d;const{xAxis:i,extStack:s,yAxis:l}=e,r=i.some(h=>h.sort!=="none"),a=s.some(h=>h.sort!=="none");if(r||a||!(((d=l==null?void 0:l[0])==null?void 0:d.sort)!=="none")||!s.length||!l.length)return o;const{data:c}=o,f=c.reduce((h,g)=>(h[g.field]=h[g.field]?h[g.field]+g.value:g.value||0,h),{}),p=l[0].sort;return c.sort((h,g)=>p==="asc"?f[h.field]-f[g.field]:f[g.field]-f[h.field]),o}configLegend(e,o){var f,p,d,h,g;const i=super.configLegend(e,o);if(!i.legend)return i;const s=e.extStack[0];if(((f=s==null?void 0:s.customSort)==null?void 0:f.length)>0){const y=s.customSort??[];if(y!=null&&y.length){const x=i.data,b=(x==null?void 0:x.reduce((C,v)=>{const A=v.category;return A&&!C.includes(A)&&C.push(A),C},[]))||[],S=y.reduce((C,v)=>{if(b.includes(v)){const A=b.indexOf(v);A!==-1&&b.splice(A,1),C.push(v)}return C},[]);b.length>0&&S.push(...b),i.meta={...i.meta,category:{type:"cat",values:S}}}}const l=T(e.customStyle);let r;l&&l.legend?r=ae(JSON.parse(JSON.stringify(l.legend)),At).size:r=At.size,i.legend.marker.style=y=>({r,fill:y.fill});const{sort:a,customSort:n,icon:c}=l.legend;if(a&&a!=="none"&&e.extStack.length){const y=T(e.customAttr),{basicStyle:x}=y,b=((p=x.seriesColor)==null?void 0:p.reduce((A,w)=>(A[w.id]=w,A),{}))||{},S=new Set,C=i.color??i.theme.styleSheet.paletteQualitative10,v=(d=i.data)==null?void 0:d.reduce((A,w)=>{var z;if(!S.has(w.category)){const k=((z=b[w.category])==null?void 0:z.color)??C[S.size%C.length];S.add(w.category),A.push({name:w.category,value:w.category,marker:{symbol:c,style:{r,fill:Lt(k)?k:Go(k,x.alpha)}}})}return A},[]);if(a!=="custom")v.sort((A,w)=>a!=="desc"?A.name.localeCompare(w.name):w.name.localeCompare(A.name));else{const A=[];(n||[]).forEach(w=>{const z=v.findIndex(k=>k.name===w);z!==-1&&(A.push(v[z]),v.splice(z,1))}),v.unshift(...A)}i.legend.items=v,((h=s==null?void 0:s.customSort)==null?void 0:h.length)>0&&((g=i.meta)==null||delete g.category.values)}return i}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configData,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal)(e,o,{},this)}}class Wn extends fs{constructor(){super("percentage-bar-stack-horizontal");_(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","hPosition","reserveDecimalCount"],"tooltip-selector":["color","fontSize","backgroundColor","show"]});this.baseOptions={...this.baseOptions,isPercent:!0}}configLabel(e,o){const i=super.configLabel(e,o);if(!i.label)return i;const{customAttr:s}=e,l=T(s).label,r={...i.label,formatter:function(a){let n=a.value;n?n=(Math.round(n*1e4)/100).toFixed(l.reserveDecimalCount)+"%":n="0%";const c=new Ht({});return c.addShape({type:"text",attrs:{x:0,y:0,data:a,text:n,textAlign:"start",textBaseline:"top",fontSize:l.fontSize,fontFamily:e.fontFamily,fill:l.color}}),c}};return{...i,label:r}}configTooltip(e,o){if(!T(e.customAttr).tooltip.show)return{...o,tooltip:{showContent:!1}};const{customAttr:s}=e,l=T(s).label,r={formatter:a=>{const n={name:a.category,value:a.value};return n.value=(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%",n},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:r}}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal)(e,o,{},this)}}const qn=Object.freeze(Object.defineProperty({__proto__:null,HorizontalBar:ds,HorizontalPercentageStackBar:Wn,HorizontalStackBar:fs},Symbol.toStringTag,{value:"Module"})),{t:be}=U();class Vn extends lt{constructor(){super("progress-bar",[]);_(this,"axisConfig",{xAxis:{name:`${be("chart.form_type")} / ${be("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${be("chart.progress_target")} / ${be("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${be("chart.progress_current")} / ${be("chart.quota")}`,type:"q",limit:1}});_(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","y-axis-selector","title-selector","function-cfg","jump-set","linkage","threshold"]);_(this,"propertyInner",{...yt,"legend-selector":null,"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","radiusColumnBar","columnWidthRatio"],"label-selector":["hPosition","color","fontSize","showQuota","showProportion"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"],"y-axis-selector":["name","color","fontSize","axisForm","axisLabel","showLengthLimit"],"function-cfg":["emptyDataStrategy"],threshold:["lineThreshold"]});_(this,"axis",[...xe,"yAxisExt"]);_(this,"baseOptions",{data:[],xField:"progress",yField:"title",seriesField:"type",isGroup:!1,isPercent:!0,isStack:!0,xAxis:!1,appendPadding:[0,0,10,0]})}async drawChart(e){var y,x,b,S;const{chart:o,container:i,action:s}=e;if(!((x=(y=o.data)==null?void 0:y.data)!=null&&x.length))return;const l=(C,v)=>{if(C===0)return 100;if(C>0&&v<0)return 0;if(C<0&&v>0||C<0&&v===0)return(2-v/C)*100;if(C>0&&v>0)return v/C*100;if(C<0&&v<0){const A=(2-v/C)*100;return Number(Math.max(A,0).toFixed(2))}return 0},r=Q(o.data.data),a=Ot((b=r[0])==null?void 0:b.data,[]),c=Ot((S=r[1])==null?void 0:S.data,[]).map(C=>{var A;const v=l((A=a.find(w=>w.field===C.field))==null?void 0:A.value,C.value);return{...C,type:"current",title:C.field,id:C.quotaList[0].id,originalValue:C.value,originalProgress:v,progress:v>=100?100:v}}),f=a.map(C=>{var A;const v=100-((A=c.find(w=>w.title===C.field))==null?void 0:A.progress);return{...C,type:"target",title:C.field,id:C.quotaList[0].id,originalValue:C.value,progress:v}}),p={...this.baseOptions,data:c.concat(f).flat()},d=this.setupOptions(o,p),{Bar:h}=await it(()=>import("./@antv-0.0.0-dataease.js").then(C=>C.a1),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),g=new h(i,d);return g.on("interval:click",s),St(o,g),ce(o,g),g}configBasicStyle(e,o){var a;const i=T(e.customAttr).basicStyle;let s=(a=i.colors)==null?void 0:a.map((n,c)=>c===1?q(n,i.alpha>10?10:i.alpha):q(n,i.alpha));i.gradient&&(s=s.map((n,c)=>at(n,!0,0))),o={...o,color:n=>n.type==="target"?"rgba(0, 0, 0, 0)":s[0],barBackground:{style:{fill:s[1]}}},o={...o,...re(e,"barStyle")};let l;const r=i.columnWidthRatio??bt.columnWidthRatio;return r>=1&&r<=100?l=r/100:r<1?l=1/100:r>100&&(l=1),l&&(o.barWidthRatio=l),o}configTooltip(e,o){const i=T(e.customAttr).tooltip;if(!i.show)return{...o,tooltip:{showContent:!1}};const s=Q(e.yAxis)[0],l=Q(e.yAxisExt)[0];return{...o,tooltip:{showContent:!0,domStyles:{"g2-tooltip-marker":null},customItems(r){const a=[];return r.forEach(n=>{if(n.data){const c=D(n.data.value,i.tooltipFormatter);n.data.id===s.id&&a.push({...n,marker:!1,name:s.chartShowName?s.chartShowName:s.name,value:c}),n.data.id===l.id&&a.push({...n,marker:!1,name:l.chartShowName?l.chartShowName:l.name,value:c})}}),a.length==0?r:a},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0}}}configLabel(e,o){var r;const i=super.configLabel(e,o);if(!i.label)return i;(r=i.label.layout)!=null&&r[0]||(i.label.layout=[{type:"limit-in-canvas"}]);const{label:s}=T(e.customAttr);i.label.style.fill=s.color;const l={...i.label,content:a=>{if(a.type==="target")return"";let n="";if(s.showQuota&&(n+=D(a.value,s.quotaLabelFormatter)),s.showProportion){let c=a.originalProgress.toFixed(s.reserveDecimalCount)+"%";s.showQuota&&(c=` (${c}) `),n+=c}return n}};return l.position==="top"&&(l.position="right"),{...i,label:l}}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;i.yAxis.position="bottom";const s=T(e.customStyle).yAxis;if(s.axisLabel.show){const l=s.axisLabel.rotate;let r="end",a="middle";Math.abs(l)>75&&(r="center"),l>75&&(a="top"),l<-75&&(a="bottom"),i.yAxis.label.style.textBaseline=a,i.yAxis.label.style.textAlign=r}return i}setupDefaultOptions(e){return e.customStyle.yAxis={...e.customStyle.yAxis,position:"left",axisLine:{show:!1,lineStyle:e.customStyle.yAxis.axisLine.lineStyle},splitLine:{show:!1,lineStyle:e.customStyle.yAxis.axisLine.lineStyle}},e.customStyle.legend.show=!1,e.customAttr.label.show=!0,e.customAttr.label.position="right",e.customAttr.label.showQuota=!1,e.customAttr.label.showProportion=!0,e}configLegend(e,o){return{...super.configLegend(e,o),legend:!1}}configEmptyDataStrategy(e,o){const{data:i}=o;if(!(i!=null&&i.length))return o;const s=T(e.senior).functionCfg.emptyDataStrategy;if(s==="ignoreData"){const l=i.filter(r=>r.value===null).map(r=>r.field);return{...o,data:i.filter(r=>!l.includes(r.field))}}return s==="breakLine"&&i.forEach(l=>{l.value===null&&(l.value=null)}),s==="setZero"&&i.forEach(l=>{l.value===null&&(l.value=0)}),o}setupOptions(e,o){return K(this.addConditionsStyleColorToData,this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configYAxis,this.configEmptyDataStrategy,this.configBarConditions)(e,o)}}const Yn=Object.freeze(Object.defineProperty({__proto__:null,ProgressBar:Vn},Symbol.toStringTag,{value:"Module"})),{t:Se}=U(),jn=[];class Gn extends lt{constructor(e="bar-range"){super(e,jn);_(this,"axisConfig",{xAxis:{name:`${Se("chart.drag_block_type_axis")} / ${Se("chart.dimension")}`,type:"d"},yAxis:{name:`${Se("chart.drag_block_value_start")} / ${Se("chart.time_dimension_or_quota")}`,limit:1,type:"q"},yAxisExt:{name:`${Se("chart.drag_block_value_end")} / ${Se("chart.time_dimension_or_quota")}`,limit:1,type:"q"}});_(this,"properties",_n.filter(e=>e!=="threshold"));_(this,"propertyInner",{...yt,"label-selector":["hPosition","color","fontSize","labelFormatter","showGap"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","showGap","show"],"x-axis-selector":[...yt["x-axis-selector"],"axisLabelFormatter"],"y-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position","showLengthLimit"]});_(this,"axis",[...xe,"yAxisExt"]);_(this,"baseOptions",{data:[],xField:"values",yField:"field",colorField:"category",isGroup:!0})}async drawChart(e){var C,v,A,w;const{chart:o,container:i,action:s}=e;if(!((v=(C=o.data)==null?void 0:C.data)!=null&&v.length))return;const l=Q(o.data.data);l.forEach(z=>{z.tempId=(Math.random()*1e7).toString()});const r=!!o.aggregate,a=!!o.data.isDate,n=o.yAxis??o.yAxisExt??[];let c;const f=((A=n[0])==null?void 0:A.datePattern)==="date_split"?"/":"-";switch((w=n[0])==null?void 0:w.dateStyle){case"y":c="YYYY";break;case"y_M":c="YYYY"+f+"MM";break;case"y_M_d":c="YYYY"+f+"MM"+f+"DD";break;case"y_M_d_H":c="YYYY"+f+"MM"+f+"DD HH";break;case"y_M_d_H_m":c="YYYY"+f+"MM"+f+"DD HH:mm";break;case"y_M_d_H_m_s":c="YYYY"+f+"MM"+f+"DD HH:mm:ss";break;default:c="YYYY-MM-dd HH:mm:ss"}const p=o.data.minTime,d=o.data.maxTime,h=o.data.min,g=o.data.max,y={...this.baseOptions,appendPadding:ct(o),data:l,seriesField:a?r?"category":void 0:"category",isGroup:a?!r:!1,isStack:a?!r:!1,meta:a?{values:{type:"time",min:p,max:d,mask:c},tempId:{key:!0}}:{values:{min:h,max:g,mask:c},tempId:{key:!0}}},x=this.setupOptions(o,y),{Bar:b}=await it(()=>import("./@antv-0.0.0-dataease.js").then(z=>z.a1),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),S=new b(i,x);return S.on("interval:click",s),x.label&&S.on("label:click",z=>{s({x:z.x,y:z.y,data:{data:z.target.attrs.data}})}),St(o,S),ce(o,S),S}configXAxis(e,o){const i=super.configXAxis(e,o);if(!i.xAxis)return i;const s=T(e.customStyle).xAxis,l=s.axisValue,r=!!e.data.isDate;if(i.xAxis.label&&(i.xAxis.label.formatter=a=>r?a:D(a,s.axisLabelFormatter)),i.xAxis.position==="top"&&(i.xAxis.position="left"),i.xAxis.position==="bottom"&&(i.xAxis.position="right"),!(l!=null&&l.auto)){const a={xAxis:{...i.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...a}}return i}configTooltip(e,o){const i=!!e.data.isDate;let s,l;if(e.customAttr&&(l=T(e.customAttr),l.tooltip)){const r=JSON.parse(JSON.stringify(l.tooltip));r.show?s={fields:["values","field","gap"],formatter:function(a){let n;return i?(n=a.values[0]+" ~ "+a.values[1],r.showGap&&(n=n+" ("+a.gap+")")):(n=D(a.values[0],r.tooltipFormatter)+" ~ "+D(a.values[1],r.tooltipFormatter),r.showGap&&(n=n+" ("+D(a.gap,r.tooltipFormatter)+")")),{value:n,values:a.values,name:a.field}},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0}:s=!1}return{...o,tooltip:s}}configBasicStyle(e,o){const i=!!e.data.isDate,s=!!e.aggregate,l=T(e.customAttr).basicStyle;if(i&&!s){const n=[],c=[];for(let p=0;p<e.data.data.length;p++){const d=e.data.data[p].field;c.indexOf(d)<0&&c.push(d)}for(let p=0;p<c.length;p++){const d=c[p];n.push({name:d,color:l.colors[p%l.colors.length],isCustom:!1})}o={...o,color:p=>{const d=Rt(n,g=>g.name===p.field);if(d===void 0)return;const h=q(d.color,l.alpha);return l.gradient?at(h,!0):h}}}else if(l.gradient){let n=l.colors;n=n.map(c=>{const f=q(c,l.alpha);return at(f,!0)}),o={...o,color:n}}o={...o,...re(e,"barStyle")};let r;const a=l.columnWidthRatio??bt.columnWidthRatio;return a>=1&&a<=100?r=a/100:a<1?r=1/100:a>100&&(r=1),r&&(o.barWidthRatio=r),o}setupDefaultOptions(e){const{customAttr:o,senior:i}=e,{label:s}=o;return["left","middle","right"].includes(s.position)||(s.position="middle"),i.functionCfg.emptyDataStrategy="ignoreData",e}configLabel(e,o){const i=!!e.data.isDate,s=!!e.aggregate,l=super.configLabel(e,o);if(!l.label)return{...l,label:!1};const r=T(e.customAttr).label;i&&!s&&(l.label.layout||(l.label.layout=[]),l.label.layout.push({type:"interval-hide-overlap"}),l.label.layout.push({type:"limit-in-plot",cfg:{action:"hide"}}));const a={fields:[],...l.label,formatter:n=>{let c;i?r.showGap?c=n.gap:c=n.values[0]+" ~ "+n.values[1]:r.showGap?c=D(n.gap,r.labelFormatter):c=D(n.values[0],r.labelFormatter)+" ~ "+D(n.values[1],r.labelFormatter);const f=new Ht({});return f.addShape({type:"text",attrs:{x:0,y:0,data:n,text:c,textAlign:"start",textBaseline:"top",fontSize:r.fontSize,fontFamily:e.fontFamily,fill:r.color}}),f}};return{...l,label:a}}configYAxis(e,o){const i=super.configYAxis(e,o);return i.yAxis&&(i.yAxis.position==="left"&&(i.yAxis.position="bottom"),i.yAxis.position==="right"&&(i.yAxis.position="top")),i}setupOptions(e,o){return K(this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configEmptyDataStrategy)(e,o)}}const Xn=Object.freeze(Object.defineProperty({__proto__:null,RangeBar:Gn},Symbol.toStringTag,{value:"Module"})),{t:Qt}=U();class Un extends lt{constructor(){super("waterfall",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","x-axis-selector","y-axis-selector","threshold"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","columnWidthRatio"],"label-selector":["fontSize","color","vPosition","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"x-axis-selector":["position","name","color","fontSize","axisLine","splitLine","axisForm","axisLabel"],"y-axis-selector":["position","name","color","fontSize","axisValue","splitLine","axisForm","axisLabel","axisLabelFormatter","showLengthLimit","axisLine"],threshold:["lineThreshold"]});_(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${Qt("chart.drag_block_type_axis")} / ${Qt("chart.dimension")}`,type:"d"},yAxis:{name:`${Qt("chart.drag_block_value_axis")} / ${Qt("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var f;const{chart:o,container:i,action:s}=e;if(!((f=o.data)!=null&&f.data))return;const r={data:o.data.data,xField:"field",yField:"value",seriesField:"category",appendPadding:ct(o)},a=this.setupOptions(o,r),{Waterfall:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.aj),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("interval:click",s),St(o,c),ce(o,c),c}configMeta(e,o){const i=e.yAxis,s={field:{type:"cat"}};if(!(i!=null&&i.length))return{...o,meta:s};const l=i[0],r=T(e.customStyle).yAxis;return s.value={alias:l.name,formatter:a=>D(a,r.axisLabelFormatter)},{...o,meta:s}}configBasicStyle(e,o){const i=T(e.customAttr),{colors:s,gradient:l,alpha:r}=i.basicStyle,[a,n,c]=s;let f;const p=i.basicStyle.columnWidthRatio??bt.columnWidthRatio;return p>=1&&p<=100?f=p/100:p<1?f=1/100:p>100&&(f=1),f&&(o.columnWidthRatio=f),{...o,total:{label:Qt("chart.waterfall_total"),style:{fill:at(q(c,r),l,270)}},risingFill:at(q(a,r),l,270),fallingFill:at(q(n,r),l,270)}}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;const l=T(e.customStyle).yAxis.axisValue;if(!(l!=null&&l.auto)){const r={yAxis:{...i.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...r}}return i}configTooltip(e,o){var c;const s=T(e.customAttr).tooltip,l=e.yAxis;if(!s.show)return{...o,tooltip:!1};const r=(c=s.seriesTooltipFormatter)==null?void 0:c.filter(f=>f.show).reduce((f,p)=>(f[p.id]=p,f),{}),a=wo(o.data),n={showTitle:!0,customItems(f){var h,g;if(!((h=s.seriesTooltipFormatter)!=null&&h.length))return f;const p=[],d=f[0];return d.data.quotaList?(f.filter(y=>r[y.data.quotaList[0].id]).forEach(y=>{const x=r[y.data.quotaList[0].id],b=(y.value+"").replace(/,/g,"");x.formatterCfg.type="value";const S=D(parseFloat(b),x.formatterCfg),C=j(x.chartShowName)?x.name:x.chartShowName;p.push({...y,name:C,value:S})}),(g=d.data.dynamicTooltipValue)==null||g.forEach(y=>{const x=r[y.fieldId];if(x){const b=(y.value+"").replace(/,/g,""),S=D(parseFloat(b),x.formatterCfg),C=j(x.chartShowName)?x.name:x.chartShowName;p.push({color:"grey",name:C,value:S})}}),p.forEach(y=>{const x=oi(y);y.color=x}),p):(Object.keys(r).forEach(y=>{const x=r[y];let b=a[y],S="grey";y===l[0].id&&(b=d.data.value,S=d.color);const C=D(b,x.formatterCfg),v=j(x.chartShowName)?x.name:x.chartShowName;if(y===l[0].id){p.unshift({color:S,name:v,value:C});return}p.push({color:S,name:v,value:C})}),p)},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:n}}configLegend(e,o){const i=super.configLegend(e,o);if(!i.legend)return i;const s=T(e.customAttr),{colors:l,gradient:r,alpha:a}=s.basicStyle,[n,c,f]=l;return{...i,legend:{...i.legend,items:[{name:Qt("chart.increase"),value:"",marker:{style:{fill:at(q(n,a),r,270)}}},{name:Qt("chart.decrease"),value:"",marker:{style:{fill:at(q(c,a),r,270)}}},{name:Qt("chart.waterfall_total"),value:"",marker:{style:{fill:at(q(f,a),r,270)}}}]}}}setupOptions(e,o){return K(this.addConditionsStyleColorToData,this.configTheme,this.configLegend,this.configBasicStyle,this.configLabel,this.configTooltip,this.configXAxis,this.configYAxis,this.configMeta,this.configBarConditions)(e,o)}}const Jn=Object.freeze(Object.defineProperty({__proto__:null,Waterfall:Un},Symbol.toStringTag,{value:"Module"})),ms=["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","assist-line","function-cfg","jump-set","linkage","threshold"],ie={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"basic-style-selector":["colors","alpha","lineWidth","lineSymbol","lineSymbolSize","lineSmooth"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["slider","emptyDataStrategy"],threshold:["lineThreshold"]},ps=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],{t:Ee}=U(),Zn=[];class hs extends lt{constructor(e="area"){super(e,Zn);_(this,"properties",ms);_(this,"propertyInner",{...ie,"basic-style-selector":[...ie["basic-style-selector"],"gradient","seriesColor"],"label-selector":["seriesLabelVPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":[...ie["tooltip-selector"],"seriesTooltipFormatter","carousel"]});_(this,"axis",[...ps]);_(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Ee("chart.drag_block_type_axis")} / ${Ee("chart.dimension")}`,type:"d"},yAxis:{name:`${Ee("chart.drag_block_value_axis")} / ${Ee("chart.quota")}`,type:"q"}});_(this,"baseOptions",{data:[],xField:"field",yField:"value",seriesField:"category",isStack:!1,interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]})}async drawChart(e){var f,p;const{chart:o,container:i,action:s}=e;if(o.container=i,!((p=(f=o.data)==null?void 0:f.data)!=null&&p.length)){Qe(o);return}const l=Q(o.data.data),r={...this.baseOptions,data:l,appendPadding:ct(o)},a=this.setupOptions(o,r),{Area:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(d=>d.a0),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("point:click",s),To(c,o,a,i),St(o,c),zi(o,c),c}configLabel(e,o){var c;const i=super.configLabel(e,o);if(!i.label)return{...i,label:!1};const{label:s,basicStyle:l}=T(e.customAttr),r=ki(e),a=(c=s.seriesLabelFormatter)==null?void 0:c.reduce((f,p)=>(f[p.id]=p,f),{});i.label.style.fill=ye.color;const n={fields:[],...i.label,layout:s.fullDisplay?[{type:"limit-in-plot"}]:i.label.layout,formatter:f=>{var x;if(f.EXTREME)return"";if(!((x=s.seriesLabelFormatter)!=null&&x.length))return f.value;const p=a==null?void 0:a[f.quotaList[0].id];if(!p)return f.value;if(!p.show)return;const d=p.position==="top"?-2-l.lineSymbolSize:10+l.lineSymbolSize,h=D(f.value,p.formatterCfg),g=Ii(r,f.value,f.quotaList[0].id)||p.color,y=new Ht({});return y.addShape({type:"text",attrs:{x:0,y:d,text:h,textAlign:"start",textBaseline:"top",fontSize:p.fontSize,fontFamily:e.fontFamily,fill:g}}),y}};return{...i,label:n}}configBasicStyle(e,o){const i=T(e.customAttr),s=JSON.parse(JSON.stringify(i.basicStyle)),l=s.lineSmooth,r={size:s.lineSymbolSize,shape:s.lineSymbol},a={style:{lineWidth:s.lineWidth}},{colors:n,alpha:c}=i.basicStyle,f=[...n,...n];let p;if(i.basicStyle.gradient){const d=new Map,g=T(e.customStyle).yAxis.axisValue,y=!(g!=null&&g.auto)&&g.min&&g.max?g.min/g.max:0;p=x=>{let b;const S=`${x.field}-${x.category}`;return d.has(S)?b=d.get(S):(b=f.shift(),d.set(S,b)),b?{fill:at(q(b,c),!0,270,y)}:{fill:"rgba(255,255,255,0)"}}}return{...o,smooth:l,line:a,point:r,areaStyle:p}}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;const s=T(e.customStyle).yAxis;i.yAxis.label&&(i.yAxis.label.formatter=r=>D(r,s.axisLabelFormatter));const l=s.axisValue;if(!(l!=null&&l.auto)){const r={yAxis:{...i.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...r}}return l!=null&&l.auto?Oi(e,o,i):i}configTooltip(e,o){return super.configMultiSeriesTooltip(e,o)}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configLabel,this.configTooltip,this.configBasicStyle,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configConditions)(e,o,{},this)}}class Qn extends hs{constructor(){super("area-stack");_(this,"propertyInner",{...this.propertyInner,"label-selector":["vPosition","fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter","show","carousel"]});_(this,"axisConfig",{...this.axisConfig,extStack:{name:`${Ee("chart.stack_item")} / ${Ee("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}});this.baseOptions={...this.baseOptions,isStack:!0},delete this.propertyInner.threshold,this.properties=this.properties.filter(e=>e!=="threshold"),this.axis.push("extStack")}configLabel(e,o){const{label:i,basicStyle:s}=T(e.customAttr);if(!(i!=null&&i.show))return{...o,label:!1};const l=[];if(i.fullDisplay)l.push({type:"limit-in-plot"});else{const n=super.configLabel(e,o);l.push(...n.label.layout)}const r=i.position==="top"?-2-s.lineSymbolSize:8+s.lineSymbolSize,a={position:i.position,offsetY:r,layout:l,style:{fill:i.color,fontSize:i.fontSize},formatter:function(n){return D(n.value,i.labelFormatter)}};return{...o,label:a}}setupDefaultOptions(e){return e.senior.functionCfg.emptyDataStrategy="ignoreData",e}configColor(e,o){return this.configStackColor(e,o)}setupSeriesColor(e,o){return Xo(e,o)}configTooltip(e,o){const s=T(e.customAttr).tooltip;if(!s.show)return{...o,tooltip:!1};const l={formatter:function(r){return{name:r.category,value:D(r.value,s.tooltipFormatter)}},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:l}}}const Kn=Object.freeze(Object.defineProperty({__proto__:null,Area:hs,StackArea:Qn},Symbol.toStringTag,{value:"Module"})),{t:Ce}=U(),tr=[];class er extends lt{constructor(e="line"){super(e,tr);_(this,"properties",ms);_(this,"propertyInner",{...ie,"basic-style-selector":[...ie["basic-style-selector"],"seriesColor"],"label-selector":["seriesLabelVPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":[...ie["tooltip-selector"],"seriesTooltipFormatter","carousel"],"legend-selector":[...ie["legend-selector"],"legendSort"]});_(this,"axis",[...ps,"xAxisExt"]);_(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Ce("chart.drag_block_type_axis")} / ${Ce("chart.dimension")}`,type:"d"},xAxisExt:{name:`${Ce("chart.chart_group")} / ${Ce("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${Ce("chart.drag_block_value_axis")} / ${Ce("chart.quota")}`,type:"q"}})}async drawChart(e){var d,h;const{chart:o,action:i,container:s}=e;if(o.container=s,!((h=(d=o.data)==null?void 0:d.data)!=null&&h.length)){Qe(o);return}const l=Q(o.data.data),a=T(o.customAttr).basicStyle.colors,n={data:l,xField:"field",yField:"value",seriesField:"category",appendPadding:ct(o),color:a,interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]},c=this.setupOptions(o,n),{Line:f}=await it(()=>import("./@antv-0.0.0-dataease.js").then(g=>g.a5),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),p=new f(s,c);return p.on("point:click",i),To(p,o,c,s),St(o,p),zi(o,p),p}configLabel(e,o){var c;const i=super.configLabel(e,o);if(!i.label)return{...i,label:!1};const{label:s,basicStyle:l}=T(e.customAttr),r=ki(e),a=(c=s.seriesLabelFormatter)==null?void 0:c.reduce((f,p)=>(f[p.id]=p,f),{});i.label.style.fill=ye.color;const n={fields:[],...i.label,layout:s.fullDisplay?[{type:"limit-in-plot"}]:i.label.layout,formatter:f=>{var x;if(f.EXTREME)return"";if(!((x=s.seriesLabelFormatter)!=null&&x.length))return f.value;const p=a==null?void 0:a[f.quotaList[0].id];if(!p)return f.value;if(!p.show)return;const d=p.position==="top"?-2-l.lineSymbolSize:10+l.lineSymbolSize,h=D(f.value,p.formatterCfg),g=Ii(r,f.value,f.quotaList[0].id)||p.color,y=new Ht({});return y.addShape({type:"text",attrs:{x:0,y:d,text:h,textAlign:"start",textBaseline:"top",fontSize:p.fontSize,fontFamily:e.fontFamily,fill:g}}),y}};return{...i,label:n}}configBasicStyle(e,o){const i=T(e.customAttr),s=JSON.parse(JSON.stringify(i.basicStyle)),l=s.lineSmooth,r={size:s.lineSymbolSize,shape:s.lineSymbol},a={lineWidth:s.lineWidth};return{...o,smooth:l,point:r,lineStyle:a}}configCustomColors(e,o){const i=T(e.customAttr).basicStyle,s=i.colors.map(l=>q(l,i.alpha));return{...o,color:s}}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;const s=T(e.customStyle).yAxis;i.yAxis.label&&(i.yAxis.label.formatter=r=>D(r,s.axisLabelFormatter));const l=s.axisValue;if(!(l!=null&&l.auto)){const r={yAxis:{...i.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...r}}return l!=null&&l.auto?Oi(e,o,i):i}configTooltip(e,o){var n;const s=T(e.customAttr).tooltip;if(!s.show)return{...o,tooltip:!1};const l=e.xAxisExt,r=(n=s.seriesTooltipFormatter)==null?void 0:n.filter(c=>c.show).reduce((c,f)=>(c[f.id]=f,c),{}),a={showTitle:!0,customItems(c){var d,h;if(!((d=s.seriesTooltipFormatter)!=null&&d.length))return c;const f=c[0];if(!f.data.quotaList)return c;const p=[];return c.filter(g=>r[g.data.quotaList[0].id]).forEach(g=>{const y=r[g.data.quotaList[0].id],x=D(parseFloat(g.value),y.formatterCfg);let b=j(y.chartShowName)?y.name:y.chartShowName;(l==null?void 0:l.length)>0&&(b=g.data.category),p.push({...g,name:b,value:x})}),(h=f.data.dynamicTooltipValue)==null||h.forEach(g=>{const y=r[g.fieldId];if(y){const x=D(parseFloat(g.value),y.formatterCfg),b=j(y.chartShowName)?y.name:y.chartShowName;p.push({color:"grey",name:b,value:x})}}),p},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:a}}setupSeriesColor(e,o){return Fi(e,o)}configLegend(e,o){var f,p,d,h,g;const i=super.configLegend(e,o);if(!i.legend)return i;const s=e.xAxisExt[0];if(((f=s==null?void 0:s.customSort)==null?void 0:f.length)>0){const y=s.customSort??[];if(y!=null&&y.length){const x=i.data,b=(x==null?void 0:x.reduce((C,v)=>{const A=v.category;return A&&!C.includes(A)&&C.push(A),C},[]))||[],S=y.reduce((C,v)=>{if(b.includes(v)){const A=b.indexOf(v);A!==-1&&b.splice(A,1),C.push(v)}return C},[]);b.length>0&&S.push(...b),i.meta={...i.meta,category:{type:"cat",values:S}}}}const l=T(e.customStyle);let r;l&&l.legend?r=ae(JSON.parse(JSON.stringify(l.legend)),At).size:r=At.size,i.legend.marker.style=y=>({r,fill:y.stroke});const{sort:a,customSort:n,icon:c}=l.legend;if(a&&a!=="none"&&e.xAxisExt.length){const y=T(e.customAttr),{basicStyle:x}=y,b=((p=x.seriesColor)==null?void 0:p.reduce((v,A)=>(v[A.id]=A,v),{}))||{},S=new Set,C=(d=i.data)==null?void 0:d.reduce((v,A)=>{var w;if(!S.has(A.category)){const z=((w=b[A.category])==null?void 0:w.color)??i.color[S.size%i.color.length];S.add(A.category),v.push({name:A.category,value:A.category,marker:{symbol:c,style:{r,fill:Lt(z)?z:Go(z,x.alpha)}}})}return v},[]);if(a!=="custom")C.sort((v,A)=>a!=="desc"?v.name.localeCompare(A.name):A.name.localeCompare(v.name));else{const v=[];(n||[]).forEach(A=>{const w=C.findIndex(z=>z.name===A);w!==-1&&(v.push(C[w]),C.splice(w,1))}),C.unshift(...v)}i.legend.items=C,((h=s==null?void 0:s.customSort)==null?void 0:h.length)>0&&((g=i.meta)==null||delete g.category.values)}return i}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configGroupColor,this.configLabel,this.configTooltip,this.configBasicStyle,this.configCustomColors,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configConditions)(e,o)}}const or=Object.freeze(Object.defineProperty({__proto__:null,Line:er},Symbol.toStringTag,{value:"Module"})),{t:eo}=U(),ir=[];class sr extends lt{constructor(e="stock-line"){super(e,ir);_(this,"properties",["background-overall-component","border-style","basic-style-selector","legend-selector","x-axis-selector","y-axis-selector","title-selector","tooltip-selector","function-cfg","jump-set","linkage"]);_(this,"propertyInner",{...ie,"function-cfg":["emptyDataStrategy"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine","axisLabelFormatter"],"legend-selector":["fontSize","color","show"]});_(this,"axis",["xAxis","yAxis","filter","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${eo("common.component.date")} / ${eo("chart.dimension")}`,limit:1,type:"d"},yAxis:{name:`${eo("chart.k_line_yaxis_tip")} / ${eo("chart.quota")}`,limit:4,type:"q"}});_(this,"calculateMovingAverage",(e,o,i)=>{const s=i.xAxis,l=i.yAxis,r=s[0].dataeaseName,a=l[1].dataeaseName,n=[];for(let c=0;c<e.length;c++)if(c<o)n.push({[r]:e[c][r],value:null});else{const f=e.slice(c-o+1,c+1).reduce((p,d)=>p+d[a],0);n.push({[r]:e[c][r],value:parseFloat((f/o).toFixed(3))})}return n});_(this,"calculateMinMax",e=>e.reduce((o,i)=>{const l=Object.values(i).filter(r=>typeof r=="number");if(l.length>0){const r=Math.max(...l),a=Math.min(...l);o.maxValue=Math.max(o.maxValue,r),o.minValue=Math.min(o.minValue,a)}return o},{maxValue:Number.NEGATIVE_INFINITY,minValue:Number.POSITIVE_INFINITY}));_(this,"registerEvent",(e,o,i)=>{let s=!0;o.on("legend-item:click",l=>{const{value:r}=l.target.get("delegateObject").item;if(r==="k")s=!s,o.chart.geometries.forEach(a=>{a.type==="schema"&&a.changeVisible(s)});else{const a=o.chart.geometries.filter(f=>f.type==="line"),n=o.chart.geometries.filter(f=>f.type==="point");let c=0;for(const f of i.keys())c++,f===r&&(a[c-1].changeVisible(!a[c-1].visible),n[c-1].changeVisible(!n[c-1].visible))}}),o.on("afterrender",l=>{var a,n;let r=!1;if(o.chart.options.slider.start===.5&&o.chart.options.slider.end===1&&(r=!0),(n=(a=l.view)==null?void 0:a.options)!=null&&n.scales){const c=Math.floor(.5*e.length),f=Math.ceil(1*e.length),p=e.slice(c,f),{maxValue:d,minValue:h}=this.calculateMinMax(r?p:l.view.filteredData),g=l.view.options.scales;Object.keys(g).forEach(y=>{g[y].max&&(g[y].max=d),g[y].min&&(g[y].min=h)})}}),o.on("legend-item-group:click",l=>{var r,a;if((a=(r=l.view)==null?void 0:r.options)!=null&&a.scales){const{maxValue:n,minValue:c}=this.calculateMinMax(l.view.filteredData),f=l.view.options.scales;Object.keys(f).forEach(p=>{f[p].max&&(f[p].max=n),f[p].min&&(f[p].min=c)})}}),o.on("slider:valuechanged",l=>{const r=l.gEvent.currentTarget.cfg.component.cfg.start,a=l.gEvent.currentTarget.cfg.component.cfg.end;o.chart.options.slider.start=r,o.chart.options.slider.end=a;const n=Math.floor(r*e.length),c=Math.ceil(a*e.length),f=e.slice(n,c),{maxValue:p,minValue:d}=this.calculateMinMax(f),h=l.view.options.scales;Object.keys(h).forEach(g=>{h[g].max&&(h[g].max=p),h[g].min&&(h[g].min=d)})})})}async drawChart(e){var L,O,B,$,R;const{chart:o,action:i,container:s}=e;if(!((O=(L=o.data)==null?void 0:L.data)!=null&&O.length))return;const l=o.xAxis,r=o.yAxis;if(r.length!=4)return;const a=T(o.customAttr).basicStyle,n=[],c=a.alpha;a.colors.forEach(H=>{n.push(q(H,c))});const f=T((B=o.data)==null?void 0:B.tableRow),p=l[0].dataeaseName,d=[5,10,20,60,120,180],h=[{name:"日K",value:"k",marker:{symbol:(H,W,Y)=>{const V=Y*1,G=Y;return[["M",H-V-1/2,W-G/2],["L",H+V+1/2,W-G/2],["L",H+V+1/2,W+G/2],["L",H-V-1/2,W+G/2],["Z"],["M",H,W+10/2],["L",H,W-10/2]]},style:{fill:"red",stroke:"red",lineWidth:2}}}],g=new Map;d.forEach(H=>{g.set("ma"+H,this.calculateMovingAverage(f,H,o))}),f.forEach(H=>{var Y;const W=H[p];for(const[V,G]of g)H[V]=(Y=G.find(Nt=>Nt[p]===W))==null?void 0:Y.value});const y=[];let x=0;const b=.5,S=1,C=Math.floor(b*f.length),v=Math.ceil(S*f.length),A=f.slice(C,v),{maxValue:w,minValue:z}=this.calculateMinMax(A);for(const H of g.keys())x++,y.push({type:"line",top:!0,options:{smooth:!1,xField:p,yField:H,color:n[x-1],xAxis:null,yAxis:{label:!1,min:z,max:w,grid:null,line:null},lineStyle:{lineWidth:2}}}),h.push({name:H.toUpperCase(),value:H,marker:{symbol:"hyphen",style:{stroke:n[x-1],lineWidth:2}}});const k=o.xAxis??[];let N;const I=(($=k[0])==null?void 0:$.datePattern)==="date_split"?"/":"-";switch((R=k[0])==null?void 0:R.dateStyle){case"y":N="YYYY";break;case"y_M":N="YYYY"+I+"MM";break;case"y_M_d":N="YYYY"+I+"MM"+I+"DD";break;case"y_M_d_H":N="YYYY"+I+"MM"+I+"DD HH";break;case"y_M_d_H_m":N="YYYY"+I+"MM"+I+"DD HH:mm";break;case"y_M_d_H_m_s":N="YYYY"+I+"MM"+I+"DD HH:mm:ss";break;default:N="YYYY-MM-dd HH:mm:ss"}const F=this.setupOptions(o,{data:f,slider:{start:.5,end:1,textStyle:{fontFamily:o.fontFamily}},plots:[{type:"stock",top:!0,options:{meta:{[p]:{mask:N}},stockStyle:{stroke:"black",lineWidth:.5},yAxis:{label:{},position:"left",min:z,max:w},xField:p,yField:[r[0].dataeaseName,r[1].dataeaseName,r[2].dataeaseName,r[3].dataeaseName],legend:{position:"top",custom:!0,items:h}}},...y]}),{Mix:M}=await it(()=>import("./@antv-0.0.0-dataease.js").then(H=>H.a8),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),E=new M(s,F);return this.registerEvent(f,E,g),E.on("schema:click",H=>{var Nt;const W=H.data.data[p],V=T((Nt=o.data)==null?void 0:Nt.data).filter(nt=>nt.field===W),G=[];if(V.forEach(nt=>{G.push({...nt.quotaList[0],value:nt.value})}),V.length){const nt={x:H.x,y:H.y,data:{data:{...H.data.data,value:G[0].value,name:W,dimensionList:V[0].dimensionList,quotaList:G}}};i(nt)}}),E}configBasicStyle(e,o){const i=T(e.customAttr),s=JSON.parse(JSON.stringify(i.basicStyle)),l=s.lineSmooth,r={size:s.lineSymbolSize,shape:s.lineSymbol},a={lineWidth:s.lineWidth},n=[];return o.plots.forEach(c=>{c.type==="stock"&&n.push({...c}),c.type==="line"&&n.push({...c,options:{...c.options,smooth:l,point:r,lineStyle:a}})}),{...o,plots:n}}configTooltip(e,o){const i=T(e.customAttr).tooltip,s=[];o.plots.filter(d=>d.type==="line").forEach(d=>{s.push(d)});const r=o.plots.filter(d=>d.type==="stock")[0];if(!i.show){const d={...r.options,tooltip:{showContent:!1}};return s.push({...r,options:d}),{...o,plots:s}}const a=e.data.fields,n=d=>{var x;const h=d.map(b=>{const S=a.find(w=>w.dataeaseName===b.name),C=(S==null?void 0:S.chartShowName)||(S==null?void 0:S.name)||b.name,v=C.startsWith("ma")?C.toUpperCase():C;i.tooltipFormatter.decimalCount=3;const A=D(b.value,i.tooltipFormatter);return{...b,name:v,value:A,color:b.color}}),g=h.some(b=>!b.name.startsWith("MA")),y=h.filter(b=>!b.name.startsWith("MA"));return g?[{name:"日K",value:"",marker:!0,color:(x=y[0])==null?void 0:x.color},...y,...h.filter(b=>b.name.startsWith("MA"))]:h},c=d=>{const h=d.name.startsWith("MA")||!d.value?10:5,g=d.name.startsWith("MA")||!d.value?5:9,y=d.name.startsWith("MA")||!d.value?0:2;return`
        <li style="display: flex; align-items: center; margin-bottom: 10px;">
          <div>
            <span
              style="
                background-color: ${d.color};
                width: ${h}px;
                height: ${h}px;
                border-radius: 50%;
                display: inline-block;
                margin-right: ${g}px;
                margin-left: ${y}px;
              "></span>
          </div>
          <div style="display: flex; justify-content: space-between; width: 100%;">
            <span style="margin-right: 15px;">${d.name}</span>
            <span>${d.name.startsWith("MA")&&d.value==="0"?"-":d.value}</span>
          </div>
        </li>
      `},f=(d,h)=>`
        <div style="padding: 10px 0;">
          <div style="margin-bottom: 10px;">${d}</div>
          <ul style="list-style: none; padding: 0;">
            ${h.map(c).join("")}
          </ul>
        </div>
      `,p={...r.options,tooltip:{showMarkers:!0,showCrosshairs:!0,showNil:!0,crosshairs:{follow:!0,text:(d,h,g)=>d==="y"?{content:h&&h.toFixed(0)}:{content:g[0].title,position:"end"}},showContent:!0,customItems:n,customContent:f}};return s.push({...r,options:p}),{...o,plots:s}}configXAxis(e,o){const i=super.configXAxis(e,o);if(!i)return o;const s=[],l=o.plots.filter(n=>n.type==="line"),r=o.plots.filter(n=>n.type==="stock")[0],a={...r,options:{...r.options,xAxis:i.xAxis?{...r.options.xAxis,...i.xAxis}:{label:!1,line:null}}};return s.push(a),l.forEach(n=>{s.push(n)}),{...o,plots:s}}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i)return o;const s=T(e.customStyle).yAxis,l=[],r=o.plots.filter(f=>f.type==="line"),a=o.plots.filter(f=>f.type==="stock")[0];let n=!1;i.yAxis.label&&(n={...i.yAxis.label,formatter:f=>D(f,s.axisLabelFormatter)});const c={...a,options:{...a.options,yAxis:n?{...a.options.yAxis,...i.yAxis,label:n}:{...i.yAxis,label:n,grid:null,line:null}}};return l.push(c),r.forEach(f=>{l.push(f)}),{...o,plots:l}}customConfigEmptyDataStrategy(e,o){const{data:i}=o;if(!(i!=null&&i.length))return o;const s=T(e.senior).functionCfg.emptyDataStrategy;if(s==="ignoreData")for(let r=i.length-1;r>=0;r--){const a=i[r];Object.keys(a).forEach(n=>{n.startsWith("f_")&&a[n]===null&&i.splice(r,1)})}return(s==="breakLine"||s==="setZero")&&((r,a)=>{a.forEach(n=>{Object.keys(n).forEach(c=>{c.startsWith("f_")&&n[c]===null&&(n[c]=r==="breakLine"?null:0)})})})(s,i),o}configLegend(e,o){let i={},s;const l=o.plots.filter(c=>c.type==="stock")[0];if(e.customStyle&&(s=T(e.customStyle),s.legend)){const c=JSON.parse(JSON.stringify(s.legend));c.show?i={...l.options.legend,itemName:{style:{fill:c.color,fontSize:c.fontSize}}}:i=!1}const r=[],a={...l.options,legend:i};return o.plots.filter(c=>c.type==="line").forEach(c=>{r.push(c)}),r.push({...l,options:a}),{...o,plots:r}}setupOptions(e,o){return K(this.configTheme,this.configBasicStyle,this.configXAxis,this.configYAxis,this.configTooltip,this.configLegend,this.customConfigEmptyDataStrategy)(e,o)}}const lr=Object.freeze(Object.defineProperty({__proto__:null,StockLine:sr},Symbol.toStringTag,{value:"Module"})),{t:Ci}=U(),nr=[];class rr extends lt{constructor(){super("liquid",nr);_(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","misc-selector","title-selector","threshold"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha"],"label-selector":["fontSize","color","labelFormatter"],"misc-selector":["liquidShape","liquidSize","liquidMaxType","liquidMaxField"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],threshold:["liquidThreshold"]});_(this,"axis",["yAxis","filter"]);_(this,"axisConfig",{yAxis:{name:`${Ci("chart.drag_block_progress")} / ${Ci("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var f,p;const{chart:o,container:i,action:s}=e;if(!((f=o.data)!=null&&f.series)||!o.yAxis.length)return;const l={percent:0},r=this.setupOptions(o,l),{Liquid:a}=await it(()=>import("./@antv-0.0.0-dataease.js").then(d=>d.ae),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),n=new a(i,r);n.on("afterrender",()=>{var d,h;s({from:"liquid",data:{type:"liquid",max:(h=(d=o.data)==null?void 0:d.series[0])==null?void 0:h.data[0]}})});const c=(p=o.data)==null?void 0:p.series.some(d=>{var h,g;return((h=d.data)==null?void 0:h[0])===void 0||((g=d.data)==null?void 0:g[0])===null});if(this.configEmptyDataStyle(c?[]:[1],i,n),!c)return n}configTheme(e,o){const i=T(e.customAttr),s=[];if(i.basicStyle){const n=i.basicStyle;n.colors.forEach(c=>{s.push(q(c,n.alpha))})}const l=T(e.customStyle);let r;l.background&&(r=q(l.background.color,l.background.alpha));const a={styleSheet:{brandColor:s[0],paletteQualitative10:s,paletteQualitative20:s,backgroundColor:r}};return{...o,theme:a}}configMisc(e,o){var c,f,p;const i=T(e.customAttr);let s=0;e.data.series.length>0&&(s=e.data.series[0].data[0]);let l,r,a;if(i.misc){const d=i.misc,h=(p=(f=e.data)==null?void 0:f.series[((c=e.data)==null?void 0:c.series.length)-1])==null?void 0:p.data[0];d.liquidMaxType==="dynamic"?l=h:l=d.liquidMax?d.liquidMax:h,r=(d.liquidSize?d.liquidSize:he.liquidSize)/100,a=d.liquidShape??he.liquidShape}const n={percent:s/l,radius:r,shape:a};return{...o,...n}}configLabel(e,o){var a;const i=T(e.customAttr),s=o.percent;if(s>1&&(o={...o,percent:1}),!((a=i.label)!=null&&a.show))return{...o,statistic:{content:!1}};const l=i.label,r=l.labelFormatter;return{...o,statistic:{content:{style:{fontSize:l.fontSize.toString()+"px",color:l.color},formatter:()=>D(s,r)}}}}configThreshold(e,o){var s;const i=T(e.senior);if((s=i==null?void 0:i.threshold)!=null&&s.enable){const{liquidThreshold:l}=i==null?void 0:i.threshold;if(l){const{paletteQualitative10:r}=o.theme.styleSheet;return{...o,liquidStyle:()=>{const n=l.split(",");let c=0;return n.forEach((f,p)=>{o.percent>parseFloat(f)/100&&(c=p+1)}),{fill:r[c%r.length],stroke:r[c%r.length]}}}}}return o}setupDefaultOptions(e){return e.customAttr.label={...e.customAttr.label,fontSize:12,show:!0,labelFormatter:{type:"percent",thousandSeparator:!0,decimalCount:2}},e}setupOptions(e,o){return K(this.configTheme,this.configMisc,this.configLabel,this.configThreshold)(e,o)}}const ar=Object.freeze(Object.defineProperty({__proto__:null,Liquid:rr},Symbol.toStringTag,{value:"Module"}));class gs extends Lo{configLabel(u,e){const o=es(u);return jt(e.label,o),e}configStyle(u,e){const o=sn(u);return jt(e.style,o),e}configTooltip(u,e){const o=os(u);return jt(e.tooltip,o),e}configLegend(u,e){const o=nn(u);return jt(e,{legend:o}),e}configEmptyDataStrategy(u,e){var l,r;const{functionCfg:o}=T(u.senior),i=o.emptyDataStrategy;if(!i||i==="breakLine")return e;const s=Q(e.source.data);if(i==="setZero"&&s.forEach(a=>{var n;a.value===null&&(a.value=0),((n=a.dynamicTooltipValue)==null?void 0:n.length)>0&&a.dynamicTooltipValue.forEach(c=>{c.value===null&&(c.value=0)})}),i==="ignoreData")for(let a=s.length-1;a>=0;a--){s[a].value===null&&s.splice(a,1);for(let n=((r=(l=s[a])==null?void 0:l.dynamicTooltipValue)==null?void 0:r.length)-1;n>=0;n--)s[a].dynamicTooltipValue[n].value===null&&s[a].dynamicTooltipValue.splice(n,1)}return e.source.data=s,e}configZoomButton(u,e){fn(u,e)}constructor(u,e){super(ue.L7_PLOT,u),this.defaultData=e}}const Eo=(m,u,e,o,i,s)=>{var l;["bubble-map","map"].includes(m.type)&&(e=(l=u.source.data.dataArray)==null?void 0:l.filter(r=>{var a;return((a=r.dimensionList)==null?void 0:a.length)>0}).reduce((r,a)=>(r.find(c=>{var f;return(f=s==null?void 0:s.areaId)!=null&&f.startsWith("custom_")?c.areaName===a.areaName:c.name===a.name||c.adcode&&c.adcode===a.adcode})||r.push(a),r),[])),ze[m.container]?ze[m.container].update(o,m,u,e,i,s):new ys(o,m,u,e,i,s)},ze={};class ys{constructor(u,e,o,i,s,l){_(this,"popupTimeoutId",null);_(this,"popupIntervalId",null);_(this,"isPaused",!1);_(this,"currentIndex",0);_(this,"scene");_(this,"chart");_(this,"view");_(this,"data");_(this,"stayTime");_(this,"intervalTime");_(this,"popup");_(this,"customSubArea");_(this,"drawOption");_(this,"onMouseEnterHandler");_(this,"onMouseLeaveHandler");_(this,"onVisibilityChangeHandler");_(this,"handleVisibilityChange",()=>{document.hidden?this.clearPreviousInstance(this.chart.container):this.startCarouselPopups()});_(this,"pauseCarouselPopups",()=>{var u;this.popup&&((u=this.popup)==null||u.remove()),this.removeStyle(),this.isPaused=!0,this.clearExistingTimers()});_(this,"resumeCarouselPopups",()=>{this.isPaused&&(this.isPaused=!1,this.startCarouselPopups())});_(this,"clearExistingTimers",()=>{this.popupTimeoutId!==null&&(clearTimeout(this.popupTimeoutId),this.popupTimeoutId=0),this.popupIntervalId!==null&&(clearInterval(this.popupIntervalId),this.popupIntervalId=0)});this.onMouseEnterHandler=this.pauseCarouselPopups.bind(this),this.onMouseLeaveHandler=this.resumeCarouselPopups.bind(this),this.onVisibilityChangeHandler=this.handleVisibilityChange.bind(this),this.clearExistingTimers=this.clearExistingTimers.bind(this),this.init(u,e,o,i,s,l)}update(u,e,o,i,s,l){this.init(u,e,o,i,s,l)}init(u,e,o,i,s,l){var r,a,n,c,f,p,d,h,g,y;if(this.view=o,this.chart=e,this.scene=u,this.data=i,this.popup=null,this.currentIndex=0,this.customSubArea=s,this.drawOption=l,this.clearPreviousInstance(this.chart.container),(a=(r=this.chart.customAttr)==null?void 0:r.tooltip)!=null&&a.show&&((f=(c=(n=this.chart.customAttr)==null?void 0:n.tooltip)==null?void 0:c.carousel)!=null&&f.enable)&&this.data.length>0){this.popup=new qi({closeButton:!1,maxWidth:600});const x=(d=(p=this.chart.customAttr)==null?void 0:p.tooltip)==null?void 0:d.carousel;this.stayTime=x.stayTime*1e3,this.intervalTime=x.intervalTime*1e3,this.startCarouselPopups();const b=document.getElementById(this.chart.container);b.addEventListener("mouseenter",this.pauseCarouselPopups),b.addEventListener("mouseleave",this.resumeCarouselPopups),this.chart.type==="symbolic-map"&&((g=(h=u==null?void 0:u.getLayers())==null?void 0:h[0])==null||g.addListener("touchend",()=>{this.pauseCarouselPopups()}),(y=u==null?void 0:u.getMapCanvasContainer())==null||y.addEventListener("touchend",()=>{this.resumeCarouselPopups()})),document.addEventListener("visibilitychange",this.handleVisibilityChange),ze[this.chart.container]=this}}clearPreviousInstance(u){var e;if(ze[u]){const o=ze[u];this.clearExistingTimers(),(e=o.popup)==null||e.remove(),o.removeStyle()}}startCarouselPopups(){this.clearExistingTimers(),this.carouselPopups()}carouselPopups(){const u=e=>{this.removeStyle();const o=document.getElementById(this.chart.container);if(o){if(this.chart.type==="symbolic-map"){const i=o.getElementsByClassName("l7-popup-"+this.chart.container);for(const s of Array.from(i))s.classList.add("l7-popup-hide");this.createSymbolicMapPopup(e)}else{if(this.chart.type==="map"){const i=o.getElementsByClassName("l7plot-tooltip-container");for(const s of Array.from(i)){const l=s;l.style.display="none"}}this.createPopup(e)}this.clearExistingTimers(),this.popupTimeoutId=window.setTimeout(()=>{var i;this.currentIndex++,(i=this.popup)==null||i.remove(),this.cancelHighlightLayer(e),this.currentIndex>=this.data.length&&(this.currentIndex=0),this.popupIntervalId=window.setTimeout(()=>{u(this.currentIndex)},this.intervalTime)},this.stayTime)}else this.clearExistingTimers()};u(this.currentIndex)}removeStyle(){var e;const u=document.getElementById("style-"+this.chart.container);u&&(u.remove(),(e=u.parentNode)==null||e.removeChild(u))}createPopup(u){var r,a,n,c,f,p;const e=this.view.tooltip.options.domStyles,o=e["l7plot-tooltip"]["background-color"],i=e["l7plot-tooltip"]["font-size"],s=document.createElement("style");s.id="style-"+this.chart.container,s.innerHTML=`
            #${this.chart.container} .l7-popup-content {
                background-color: ${o} !important;
                font-size: ${i};
                padding: 10px 10px 6px;
                line-height: 1.6;
            }
            #${this.chart.container} .l7-popup-tip {
                border-top-color: ${o} !important;
            }
        `,document.head.appendChild(s);const l=this.getPopupData(u);if(l.data){let d="";this.getTooltipItems(l.data).forEach(g=>{d+=`
                    <li style="list-style-type: none; margin-bottom: 4px; white-space: nowrap; display: flex; justify-content: space-between;">
                        <span style="${this.objectToSemicolonSeparated(e["l7plot-tooltip__name"])}">${g.name}</span>
                        <span style="${this.objectToSemicolonSeparated(e["l7plot-tooltip__value"])}">${g.value}</span>
                    </li>`});const h=`
                <div>
                <div style="${this.objectToSemicolonSeparated(e["l7plot-tooltip__title"])}">${l.data.name}</div>
                    <ul style="${this.objectToSemicolonSeparated(e["l7plot-tooltip__list"])}">
                        ${d}
                    </ul>
                </div>
            `;if(this.popup.setLngLat({lng:l.centroid[0],lat:l.centroid[1]}),this.popup.setHTML(h),this.popup.closeButton=!1,this.view.addLayer(this.popup),(a=(r=this.view.scene.getLayers())==null?void 0:r.find(g=>g.name==="highlightLayer"))==null||a.setData(this.getActiveData(u)),this.chart.type==="bubble-map"){const{_id:g}=(c=(n=this.view.scene.getLayers())==null?void 0:n.find(y=>y.name==="bubbleLayer"))==null?void 0:c.layerSource.data.dataArray.find(y=>y.name===this.data[u].name);(p=(f=this.view.scene.getLayers())==null?void 0:f.find(y=>y.name==="bubbleLayer"&&y.coordCenter))==null||p.setActive(g,{color:"rgba(30,90,255,1)"})}}}getActiveData(u){var e,o,i;if((o=(e=this.drawOption)==null?void 0:e.areaId)!=null&&o.startsWith("custom_")){const s={type:"FeatureCollection",features:[]},l=this.customSubArea.find(a=>a.name===this.data[u].areaName),r=this.view.currentDistrictData.features.reduce((a,n)=>(a["156"+n.properties.adcode]=n,a),{});return(i=l==null?void 0:l.scopeArr)==null||i.forEach(a=>{r[a]&&s.features.push(r[a])}),s}return{type:"FeatureCollection",features:[this.view.currentDistrictData.features.find(s=>s.properties.name===this.data[u].name)]}}getPopupData(u){var e,o,i,s;if((o=(e=this.drawOption)==null?void 0:e.areaId)!=null&&o.startsWith("custom_")){const l=this.data[u],r=(i=this.customSubArea)==null?void 0:i.find(a=>a.name===l.areaName);return l.name=l.areaName,{data:l,centroid:r.centroid}}else return{data:this.data[u],centroid:(s=this.view.currentDistrictData.features.find(l=>l.properties.name===this.data[u].name))==null?void 0:s.properties.centroid}}objectToSemicolonSeparated(u){let e="";for(const o in u)u.hasOwnProperty(o)&&(e+=`${this.convertToSnakeCase(o)}:${u[o]};`);return e}cancelHighlightLayer(u){var e,o,i,s,l,r,a,n,c,f,p,d,h;if((i=(o=(e=this.view.scene)==null?void 0:e.getLayers())==null?void 0:o.find(g=>g.name==="highlightLayer"))==null||i.setData({type:"FeatureCollection",features:[]}),this.chart.type==="bubble-map"){const{_id:g}=(r=(l=(s=this.view.scene)==null?void 0:s.getLayers())==null?void 0:l.find(y=>y.name==="bubbleLayer"))==null?void 0:r.layerSource.data.dataArray.find(y=>y.name===this.data[u].name);(n=(a=this.view.scene.getLayers())==null?void 0:a.find(y=>y.name==="bubbleLayer"&&y.coordCenter))==null||n.setActive(g,{color:this.view.scene.getLayers().find(y=>y.name==="bubbleLayer").styleAttributeService.getLayerStyleAttribute("color").scale.field})}if(this.chart.type==="symbolic-map"){const g=this.chart.xAxis[0].dataeaseName,y=this.chart.xAxis[1].dataeaseName,{_id:x}=(p=(f=(c=this.scene)==null?void 0:c.getLayers())==null?void 0:f.find(b=>b.type==="PointLayer"))==null?void 0:p.layerSource.data.dataArray.find(b=>{const S=this.data[u][g],C=this.data[u][y];return b[g]===S&&b[y]===C});(h=(d=this.scene.getLayers())==null?void 0:d.find(b=>b.type==="PointLayer"&&b.coordCenter))==null||h.setActive(x,{color:this.scene.getLayers().find(b=>b.type==="PointLayer").styleAttributeService.getLayerStyleAttribute("color").scale.field})}}convertToSnakeCase(u){return u.replace(/([A-Z])/g,e=>"-"+e.toLowerCase())}getTooltipItems(u){var a,n,c,f;const e=[],s=(a=T(this.chart.customAttr).tooltip.seriesTooltipFormatter)==null?void 0:a.filter(p=>p.show).reduce((p,d)=>(p[d.id]=d,p),{});if(j(s))return e;const l=u,r=s[(c=(n=l.quotaList)==null?void 0:n[0])==null?void 0:c.id];if(!j(r)){const p=parseFloat(l.value),d=D(p,r.formatterCfg),h=j(r.chartShowName)?r.name:r.chartShowName;e.push({...l,name:h,value:`${d??""}`})}return(f=l.dynamicTooltipValue)==null||f.forEach(p=>{const d=s[p.fieldId];if(d){const h=D(parseFloat(p.value),d.formatterCfg),g=j(d.chartShowName)?d.name:d.chartShowName;e.push({color:"grey",name:g,value:`${h??""}`})}}),e}createSymbolicMapPopup(u){const e=()=>{var l,r,a,n,c,f;const s=this.chart.customAttr?T(this.chart.customAttr):null;if((l=s==null?void 0:s.tooltip)!=null&&l.show){if(!this.popup)return;const{tooltip:p}=st(s);let d=p.showFields||[];(!p.showFields||p.showFields.length===0)&&(d=[...this.chart.xAxisExt.map(C=>`${C.dataeaseName}@${C.name}`),...this.chart.xAxis.map(C=>`${C.dataeaseName}@${C.name}`)]);const h=document.createElement("style");h.id="style-"+this.chart.container,h.innerHTML=`
          #${this.chart.container} .l7-popup-content {
            background-color: ${p.backgroundColor} !important;
            padding: 6px 10px 6px;
            line-height: 1.6;
          }
          #${this.chart.container} .l7-popup-tip {
           border-top-color: ${p.backgroundColor} !important;
          }
        `,document.head.appendChild(h);const g=this.chart.xAxis[0].dataeaseName,y=this.chart.xAxis[1].dataeaseName,x=`<div style='font-size:${p.fontSize}px;color:${p.color};'>`,b="</div>",S=this.view.sourceOption.data[u];if(S&&((r=S.details)!=null&&r.length)){const C={...S,...Object.fromEntries(i(S.details))},v=o(p,C,d),A=`${x}${v}${b}`;this.popup.setLngLat({lng:S[g],lat:S[y]}),this.popup.setHTML(A),this.popup.closeButton=!1,this.scene.addPopup(this.popup),this.popup.addTo(this.scene);const{_id:w}=(n=(a=this.scene.getLayers())==null?void 0:a.find(z=>z.type==="PointLayer"))==null?void 0:n.layerSource.data.dataArray.find(z=>{const k=this.data[u][g],N=this.data[u][y];return z[g]===k&&z[y]===N});(f=(c=this.scene.getLayers())==null?void 0:c.find(z=>z.type==="PointLayer"&&z.coordCenter))==null||f.setActive(w,{color:"rgba(30,90,255,1)"})}}},o=(s,l,r)=>{let a="";return s.customContent?(a=s.customContent,r.forEach(n=>{a=a.replace(`\${${n.split("@")[1]}}`,l[n.split("@")[0]])})):r.forEach(n=>{a+=`<span style="margin-bottom: 4px">${n.split("@")[1]}: ${l[n.split("@")[0]]}</span><br>`}),a.replace(/\n/g,"<br>")},i=s=>{const l=new Map;return s.forEach(r=>{Object.entries(r).forEach(([a,n])=>{if(l.has(a)){const c=l.get(a);c!==n&&l.set(a,`${c}, ${n}`)}else l.set(a,n)})}),l};e()}}const cr=Object.freeze(Object.defineProperty({__proto__:null,CarouselManager:ys,carouselManagerInstances:ze,configCarouselTooltip:Eo},Symbol.toStringTag,{value:"Module"})),{t:oo}=U();class ur extends gs{constructor(){super("bubble-map");_(this,"properties",[...Ji,"bubble-animate"]);_(this,"propertyInner",{...le,"tooltip-selector":[...le["tooltip-selector"],"carousel"],"basic-style-selector":[...le["basic-style-selector"],"areaBaseColor"]});_(this,"axis",Zi);_(this,"axisConfig",{xAxis:{name:`${oo("chart.area")} / ${oo("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${oo("chart.bubble_size")} / ${oo("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var x;const{chart:o,level:i,areaId:s,container:l,action:r,scope:a}=e;if(!s)return;o.container=l;let n={},c=[],f=(x=o.data)==null?void 0:x.data;if(s.startsWith("custom_")){c=(await Ni(s)).data||[],c.forEach(A=>{var w;return A.scopeArr=((w=A.scope)==null?void 0:w.split(","))||[]}),n=Q(await Fe("156"));const b=n.features.reduce((A,w)=>(A["156"+w.properties.adcode]=w.properties.name,A),{}),{areaMapping:S}=T(o.senior),C=c.reduce((A,w)=>{var k,N;const z=(k=S==null?void 0:S[s])==null?void 0:k[w.name];return z&&(w.name=z),A[w.name]=w,w.scopeArr=((N=w.scope)==null?void 0:N.split(","))||[],A},{}),v=[];f==null||f.forEach(A=>{const w=C[A.name];w&&w.scopeArr.forEach(z=>{v.push({...A,name:b[z],field:b[z],scope:w.scopeArr,areaName:A.name})})}),f=v}else a?(n=Q(await Fe("156")),n.features=n.features.filter(b=>a.includes("156"+b.properties.adcode))):n=Q(await Fe(s));let p={preserveDrawingBuffer:!0,map:{type:"mapbox",style:"blank"},geoArea:{type:"geojson"},source:{data:f||[],joinBy:{sourceField:"name",geoField:"name",geoData:n}},viewLevel:{level:i,adcode:"all"},autoFit:!0,chinaBorder:!1,color:{field:"value"},style:{opacity:1,lineWidth:.6,lineOpacity:1},label:{field:"_DE_LABEL_",style:{textAnchor:"center"}},tooltip:{},legend:!1,customFetchGeoData:()=>null};const d={drawOption:e,geoJson:n,customSubArea:c};p=this.setupOptions(o,p,d);const h=st(p.tooltip);p={...p,tooltip:{...h,showComponent:!1}};const g=new Cl(l,p),y=this.getDotLayer(o,n,e,c);return s.startsWith("custom_")||(y.options={...y.options,tooltip:h}),this.configZoomButton(o,g),Zo(l),g.once("loaded",()=>{g.scene.map._canvasContainer.lastElementChild.style.cursor="default";const{layers:b}=d;b&&b.forEach(S=>{g.addLayer(S)}),y.addToScene(g.scene),y.once("add",()=>{Ie(l)}),g.scene.map.keyboard.disable(),y.on("dotLayer:click",S=>{var w;const C=S.feature.properties;let v,A;if(s.startsWith("custom_")){v="156";const z=c.find(k=>k.name===C.name);A=z==null?void 0:z.scopeArr}else v=(w=g.currentDistrictData.features.find(z=>z.properties.name===S.feature.properties.name))==null?void 0:w.properties.adcode;r({x:S.x,y:S.y,data:{data:C,extra:{adcode:v,scope:A}}})}),y.once("loaded",()=>{o.container=l,Eo(o,g,f||[],null,c,e)})}),g}getDotLayer(e,o,i,s){var h,g,y,x,b;const{areaId:l}=i,{basicStyle:r,tooltip:a}=T(e.customAttr),{bubbleCfg:n}=T(e.senior),{offsetHeight:c,offsetWidth:f}=document.getElementById(i.container),p=[],d={source:{data:p,parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:{field:"size",value:[5,Math.min(c,f)/20]},visible:!0,zIndex:.05,color:q(r.colors[0],r.alpha),name:"bubbleLayer",style:{opacity:1},state:{active:{color:"rgba(30,90,255,1)"}},tooltip:{showComponent:a.show}};if(l.startsWith("custom_")){const S=o.features.reduce((A,w)=>(w.properties.adcode&&(A["156"+w.properties.adcode]=w),A),{}),{areaMapping:C}=T(e.senior),v=s.reduce((A,w)=>{var k;const z=(k=C==null?void 0:C[l])==null?void 0:k[w.name];return z&&(w.name=z),A[w.name]=w,A},{});if((g=(h=e.data)==null?void 0:h.data)==null||g.forEach(A=>{var z;const w=v[A.name];if(w){const k=[];if((z=w.scopeArr)==null||z.forEach(N=>{const I=S[N];I&&k.push(I)}),k.length){const I=yo({type:"FeatureCollection",features:k});w.centroid=[I.geometry.coordinates[0],I.geometry.coordinates[1]],p.push({name:w.name,size:A.value,properties:A,x:I.geometry.coordinates[0],y:I.geometry.coordinates[1]})}}}),d.tooltip&&d.tooltip.showComponent){d.tooltip.items=["name","adcode","value"],d.tooltip.customTitle=({name:w})=>w;const A=(y=a.seriesTooltipFormatter)==null?void 0:y.filter(w=>w.show).reduce((w,z)=>(w[z.id]=z,w),{});d.tooltip.customItems=w=>{var I,F,M;const z=[];if(j(A))return z;const k=w.properties,N=A[(F=(I=k.quotaList)==null?void 0:I[0])==null?void 0:F.id];if(!j(N)){const E=parseFloat(k.value),L=D(E,N.formatterCfg),O=j(N.chartShowName)?N.name:N.chartShowName;z.push({...k,name:O,value:`${L??""}`})}return(M=k.dynamicTooltipValue)==null||M.forEach(E=>{const L=A[E.fieldId];if(L){const O=D(parseFloat(E.value),L.formatterCfg),B=j(L.chartShowName)?L.name:L.chartShowName;z.push({color:"grey",name:B,value:`${O??""}`})}}),z},d.tooltip.domStyles={"l7plot-tooltip":{"background-color":a.backgroundColor,"font-size":`${a.fontSize}px`,"line-height":1.6},"l7plot-tooltip__name":{color:a.color},"l7plot-tooltip__value":{color:a.color},"l7plot-tooltip__title":{color:a.color}}}}else{const S=(b=(x=e.data)==null?void 0:x.data)==null?void 0:b.reduce((C,v)=>(C[v.field]={value:v.value,data:v},C),{});o.features.forEach(C=>{var A;const v=C.properties.name;(A=S==null?void 0:S[v])!=null&&A.value&&p.push({x:C.properties.centroid[0],y:C.properties.centroid[1],size:S[v].value,properties:S[v].data,name:v})})}return n&&n.enable?new gi({...d,size:{field:"size",value:[10,Math.min(c,f)/10]},animate:{enable:!0,speed:n.speed,rings:n.rings}}):new gi(d)}configBasicStyle(e,o,i){var d,h,g,y;const{areaId:s}=i.drawOption,l=i.geoJson,{basicStyle:r,label:a}=T(e.customAttr),c=(d=T(e.senior).areaMapping)==null?void 0:d[s];if(is(l,c),o.color=r.areaBaseColor,!((g=(h=e.data)==null?void 0:h.data)!=null&&g.length)||!((y=l==null?void 0:l.features)!=null&&y.length))return o.label&&(o.label.field="name"),o;const p=e.data.data.reduce((x,b)=>(x[b.field]=b.value,x),{});return l.features.forEach(x=>{const b=x.properties.name;if(a.show){const S=[];a.showDimension&&S.push(b),a.showQuota&&(p[b]||p[b]===0)&&S.push(D(p[b],a.quotaLabelFormatter)),x.properties._DE_LABEL_=S.join(`

`)}}),o}configCustomArea(e,o,i){var p;const{drawOption:s,customSubArea:l,geoJson:r}=i;if(!s.areaId.startsWith("custom_"))return o;const a=T(e.customAttr),{label:n}=a,c=(p=e.data)==null?void 0:p.data,f=c==null?void 0:c.reduce((d,h)=>(d[h.field]=h,d),{});if(o.label={visible:!1},n.show){const d=r.features.reduce((x,b)=>(b.properties.adcode&&(x["156"+b.properties.adcode]=b),x),{}),{areaMapping:h}=T(e.senior),g=[];l.forEach(x=>{var S,C;const b=[];if((S=x.scopeArr)==null||S.forEach(v=>{const A=d[v];A&&b.push(A)}),b.length){const v={type:"FeatureCollection",features:b},A=[];if(n.showDimension){const z=(C=h==null?void 0:h[s.areaId])==null?void 0:C[x.name];z&&(x.name=z),A.push(x.name)}n.showQuota&&f[x.name]&&A.push(D(f[x.name].value,n.quotaLabelFormatter));const w=yo(v);g.push({name:A.join(`

`),x:w.geometry.coordinates[0],y:w.geometry.coordinates[1]})}});const y=new Vi({name:"areaLabelLayer",source:{data:g,parser:{type:"json",x:"x",y:"y"}},field:"name",zIndex:.06,style:{fill:n.color,fontSize:n.fontSize,opacity:1,fontWeight:"bold",textAnchor:"center",textAllowOverlap:n.fullDisplay,padding:n.fullDisplay?void 0:[2,2]}});i.layers=[y]}return o}setupOptions(e,o,i){return K(this.configEmptyDataStrategy,this.configLabel,this.configStyle,this.configTooltip,this.configBasicStyle,this.configCustomArea)(e,o,i,this)}}const dr=Object.freeze(Object.defineProperty({__proto__:null,BubbleMap:ur},Symbol.toStringTag,{value:"Module"})),Me=el();class Gt extends wn{constructor(e,o){super();_(this,"config");_(this,"scene",null);_(this,"destroy",()=>{var e;this.chartInstance&&((e=this.chartInstance)==null||e.destroy())});_(this,"render",()=>{var e;this.scene&&this.config&&(this.scene.loaded?Array.isArray(this.config)?(e=this.config)==null||e.forEach(o=>{this.handleConfig(o)}):this.handleConfig(this.config):this.scene.on("loaded",()=>{var o;Array.isArray(this.config)?(o=this.config)==null||o.forEach(i=>{this.handleConfig(i)}):this.handleConfig(this.config)}))});_(this,"handleConfig",e=>{var o;e&&(e.handleConfig?(o=e.handleConfig)==null||o.call(e,this.scene):this.scene.addLayer(e))});this.chartInstance=e,this.config=o,this.scene=e}getScene(){return this.scene}}class si extends Lo{constructor(e,o){super(ue.L7,e,o);_(this,"getMapKey",async()=>(Me.mapKey.key||await $l().then(e=>Me.setKey(e.data)),Me.mapKey.securityCode&&(window._AMapSecurityConfig={securityJsCode:Me.mapKey.securityCode}),Me.mapKey))}configEmptyDataStrategy(e,o){const{functionCfg:i}=T(e.senior),s=i.emptyDataStrategy;if(!s||s==="breakLine")return o;const l=Q(o.sourceOption.data);if(s==="setZero"&&l.forEach(r=>{r.value===null&&(r.value=0)}),s==="ignoreData")for(let r=l.length-1;r>=0;r--)l[r].value===null&&l.splice(r,1);return o.sourceOption.data=l,o}configZoomButton(e,o,i){un(e,o,i)}configLabel(e,o){const i=es(e);return jt(o.label,i),o}configTooltip(e,o){const i=os(e);return jt(o.tooltip,i),o}}const{t:$t}=U();class fr extends si{constructor(){super("flow-map",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector","flow-map-line-selector","flow-map-point-selector","bubble-animate"]);_(this,"propertyInner",{...le,"basic-style-selector":["mapBaseStyle","mapLineStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"]});_(this,"axis",["xAxis","xAxisExt","filter","flowMapStartName","flowMapEndName","yAxis"]);_(this,"axisConfig",{xAxis:{name:`${$t("chart.start_coordinates")} / ${$t("chart.dimension")}`,type:"d",limit:2},xAxisExt:{name:`${$t("chart.end_coordinates")} / ${$t("chart.dimension")}`,type:"d",limit:2},flowMapStartName:{name:`${$t("chart.start_name")} / ${$t("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},flowMapEndName:{name:`${$t("chart.end_name")} / ${$t("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${$t("chart.flow_map_line_width")} / ${$t("chart.quota")}`,type:"q",limit:1,tooltip:$t("chart.flow_map_line_width_tip"),allowEmpty:!0}});_(this,"lineConfig",(e,o,i,s,l)=>{var y;const r={type:l.flowMapConfig.lineConfig.mapLineType,size:l.flowMapConfig.lineConfig.mapLineType==="line"?l.flowMapConfig.lineConfig.mapLineWidth/2:l.flowMapConfig.lineConfig.mapLineWidth,animate:l.flowMapConfig.lineConfig.mapLineAnimate,animateDuration:l.flowMapConfig.lineConfig.mapLineAnimateDuration,gradient:l.flowMapConfig.lineConfig.mapLineGradient,sourceColor:l.flowMapConfig.lineConfig.mapLineSourceColor,targetColor:l.flowMapConfig.lineConfig.mapLineTargetColor,alpha:l.flowMapConfig.lineConfig.alpha},a=s.colors.map(x=>q(x,l.flowMapConfig.lineConfig.alpha));r.sourceColor=a[0],r.targetColor=a[1];let n=null;const c=st(e.yAxis);c.length>0&&(n=c[0].dataeaseName);let f=null;const p=st(e.yAxisExt);p.length>0&&(f=p[0].dataeaseName);const d="*",h=[];(y=e.data)==null||y.tableRow.forEach(x=>{const b="f_record",S=Object.keys(x).reduce((C,v)=>(v===d?C[b]=x[v]:C[v]=x[v],C),{});h.push(S)});const g=new vl({name:"line",blend:"normal",autoFit:s.autoFit!==!1}).source(h,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName,x1:i[0].dataeaseName,y1:i[1].dataeaseName}}).size(r.size).shape(r.type).animate({enable:r.animate,duration:r.animateDuration,interval:1,trailLength:1});return n&&g.size(n===d?"f_record":n,[1,10]),f?(g.style({opacity:r.alpha/100}),g.color(f)):r.gradient?g.style({sourceColor:r.sourceColor,targetColor:r.targetColor,opacity:r.alpha/100}):g.style({opacity:r.alpha/100}).color(r.sourceColor),g});_(this,"startAndEndNameConfig",(e,o,i,s,l)=>{var p,d;const r=st(e.flowMapStartName),a=st(e.flowMapEndName),n=s.flowMapConfig.pointConfig.text.color,c=s.flowMapConfig.pointConfig.text.fontSize,f=new Map;if((r==null?void 0:r.length)>0){const h=new _e().source((p=e.data)==null?void 0:p.tableRow,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape(r[0].dataeaseName,g=>f.has("from-"+g)?"":(f.set("from-"+g,g),g)).size(c).color(n).style({textAnchor:"top",textOffset:[0,0],spacing:2,padding:[1,1],textAllowOverlap:!0,fontFamily:e.fontFamily?e.fontFamily:void 0});l.push(h)}if((a==null?void 0:a.length)>0){const h=new _e().source((d=e.data)==null?void 0:d.tableRow,{parser:{type:"json",x:i[0].dataeaseName,y:i[1].dataeaseName}}).shape(a[0].dataeaseName,g=>f.has("from-"+g)||f.has("to-"+g)?"":(f.set("to-"+g,g),g)).size(c).color(n).style({textAnchor:"top",textOffset:[0,0],spacing:2,padding:[1,1],textAllowOverlap:!0,fontFamily:e.fontFamily?e.fontFamily:void 0});l.push(h)}});_(this,"pointConfig",(e,o,i,s,l)=>{var p,d;const r=s.flowMapConfig.pointConfig.point.color,a=s.flowMapConfig.pointConfig.point.size,{bubbleCfg:n}=T(e.senior),c=new _e({zIndex:-1}).source((p=e.data)==null?void 0:p.tableRow,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape("circle").size(a).color(r).style({blur:.6}),f=new _e({zIndex:-1}).source((d=e.data)==null?void 0:d.tableRow,{parser:{type:"json",x:i[0].dataeaseName,y:i[1].dataeaseName}}).shape("circle").size(a).color(r).style({blur:.6});if(n&&n.enable){const h={enable:!0,speed:n.speed,rings:n.rings};c.size(a*2),c.animate(h),f.size(a*2),f.animate(h)}l.push(c),l.push(f)})}async drawChart(e){var x;const{chart:o,container:i}=e,s=document.getElementById(i),l=s==null?void 0:s.getBoundingClientRect();if((l==null?void 0:l.height)<=0)return new Gt((x=e.chartObj)==null?void 0:x.getScene(),[]);const r=st(o.xAxis),a=st(o.xAxisExt),{basicStyle:n,misc:c}=st(T(o.customAttr)),f=await this.getMapKey(),p=ti(f,n),d=e.chartObj;let h=d==null?void 0:d.getScene();const g=Ko(n);if(h=await ei(o,h,i,f,n,c,p,g),this.configZoomButton(o,h,f),(r==null?void 0:r.length)<2||(a==null?void 0:a.length)<2)return new Gt(h,void 0);const y=[];y.push(this.lineConfig(o,r,a,n,c)),this.startAndEndNameConfig(o,r,a,c,y),this.pointConfig(o,r,a,c,y),y[0].once("inited",()=>{Ie(i)});for(let b=0;b<y.length;b++)y[b].on("inited",()=>{Qo(h)});return new Gt(h,y)}setupDefaultOptions(e){return e.customAttr.misc.flowMapConfig.lineConfig.mapLineAnimate=!0,e}}const mr=Object.freeze(Object.defineProperty({__proto__:null,FlowMap:fr},Symbol.toStringTag,{value:"Module"})),{t:io}=U();class pr extends si{constructor(){super("heat-map",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector"]);_(this,"propertyInner",{...le,"basic-style-selector":["colors","heatMapStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"]});_(this,"axis",["xAxis","yAxis","filter"]);_(this,"axisConfig",{xAxis:{name:`${io("chart.longitude_and_latitude")} / ${io("chart.dimension")}`,type:"d",limit:2},yAxis:{name:`${io("chart.chart_data")} / ${io("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var x,b;const{chart:o,container:i}=e,s=document.getElementById(i),l=s==null?void 0:s.getBoundingClientRect();if((l==null?void 0:l.height)<=0)return new Gt((x=e.chartObj)==null?void 0:x.getScene(),[]);const r=st(o.xAxis),a=st(o.yAxis);let n,c;o.customAttr&&(n=T(o.customAttr).basicStyle,c=T(o.customAttr).misc);const f=await this.getMapKey(),p=ti(f,n),d=e.chartObj;let h=d==null?void 0:d.getScene();const g=Ko(n);if(h=await ei(o,h,i,f,n,c,p,g),this.configZoomButton(o,h,f),(r==null?void 0:r.length)<2||(a==null?void 0:a.length)<1)return new Gt(h,void 0);const y=new Al({name:"line",blend:"normal",autoFit:n.autoFit!==!1,zIndex:10}).source((b=o.data)==null?void 0:b.data,{parser:{type:"json",x:"x",y:"y"}}).size("value",[0,1]).shape(n.heatMapType??bt.heatMapType);return y.style({intensity:n.heatMapIntensity??bt.heatMapIntensity,radius:n.heatMapRadius??bt.heatMapRadius,rampColors:{colors:n.colors.reverse(),positions:[0,.11,.22,.33,.44,.55,.66,.77,.88,1]}}),y.once("inited",()=>{Ie(i)}),y.on("inited",()=>{Qo(h)}),new Gt(h,y)}setupOptions(e,o){return K(this.configEmptyDataStrategy)(e,o)}}const hr=Object.freeze(Object.defineProperty({__proto__:null,HeatMap:pr},Symbol.toStringTag,{value:"Module"})),{t:so}=U();let gr=class extends gs{constructor(){super("map",[]);_(this,"properties",[...Ji,"legend-selector"]);_(this,"propertyInner",{...le,"basic-style-selector":["colors","alpha","areaBorderColor","areaBaseColor","zoom","gradient-color"],"legend-selector":["icon","fontSize","color"],"tooltip-selector":[...le["tooltip-selector"],"carousel"]});_(this,"axis",Zi);_(this,"axisConfig",{xAxis:{name:`${so("chart.area")} / ${so("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${so("chart.chart_data")} / ${so("chart.quota")}`,type:"q",limit:1}});_(this,"createLegendCustomContent",e=>{const i=Ye($i).getElementsByClassName(Ri)[0];return e.forEach(s=>{let l="-";if(s.value!=="")if(Array.isArray(s.value))s.value.forEach((c,f)=>{s.value[f]=Number.isNaN(c)||c==="NaN"?"NaN":parseFloat(c).toFixed(0)}),l=s.value.join("-");else{const c=s.value;l=Number.isNaN(c)||c==="NaN"?"NaN":parseFloat(c).toFixed(0)}const r={...s,value:l},a=Uo(Hi,r),n=Ye(a);n.style.setProperty("--bgColor",s.color),i.appendChild(n)}),i})}async drawChart(e){var S;const{chart:o,level:i,container:s,action:l,scope:r}=e,{areaId:a}=e;if(!a)return;o.container=s;let n=JSON.parse(JSON.stringify(((S=o.data)==null?void 0:S.data)||[]));const{misc:c}=T(o.customAttr),{legend:f}=T(o.customStyle);let p={},d=[];if(a.startsWith("custom_")){d=(await Ni(a)).data||[],p=Q(await Fe("156"));const C=p.features.reduce((z,k)=>(z["156"+k.properties.adcode]=k.properties.name,z),{}),{areaMapping:v}=T(o.senior),A=d.reduce((z,k)=>{var I,F;const N=(I=v==null?void 0:v[a])==null?void 0:I[k.name];return N&&(k.name=N),z[k.name]=k,k.scopeArr=((F=k.scope)==null?void 0:F.split(","))||[],z},{}),w=[];n.forEach(z=>{const k=A[z.name];k&&k.scopeArr.forEach(N=>{w.push({...z,name:C[N],field:C[N],scope:k.scopeArr,areaName:z.name})})}),n=w}else r?(p=Q(await Fe("156")),p.features=p.features.filter(C=>r.includes("156"+C.properties.adcode))):p=Q(await Fe(a));let h=[];if(!c.mapAutoLegend&&f.show){let C=c.mapLegendMin,v=c.mapLegendMax,A=9;c.mapLegendRangeType==="custom"&&(v=0,C=0,A=c.mapLegendNumber),Re(n,"value",v,C,(w,z)=>{v=w,C=z,l({from:"map",data:{max:v,min:C??fi(n,"value"),legendNumber:A}})}),h=uo(n,v,C),o.drill&&Re(n,"value",0,0,(w,z)=>{h=uo(n,w,z)})}else h=n;let g={preserveDrawingBuffer:!0,map:{type:"mapbox",style:"blank"},geoArea:{type:"geojson"},source:{data:h,joinBy:{sourceField:"name",geoField:"name",geoData:p}},viewLevel:{level:i,adcode:"all"},autoFit:!0,chinaBorder:!1,color:{field:"value"},style:{opacity:1,lineWidth:.6,lineOpacity:1},label:{field:"_DE_LABEL_",style:{textAnchor:"center"}},state:{active:{stroke:"green",lineWidth:1}},tooltip:{},customFetchGeoData:()=>null};const y={drawOption:e,geoJson:p,customSubArea:d};g=this.setupOptions(o,g,y);const{Choropleth:x}=await it(()=>import("./@antv-0.0.0-dataease.js").then(C=>C.al),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),b=new x(s,g);return this.configZoomButton(o,b),Zo(s),b.once("loaded",()=>{Ie(s);const{layers:C}=y;C&&C.forEach(v=>{b.addLayer(v)}),b.scene.map.keyboard.disable(),b.on("fillAreaLayer:click",v=>{const A=v.feature.properties;a.startsWith("custom_")&&(A.name=A.areaName,A.adcode="156"),l({x:v.x,y:v.y,data:{data:A,extra:{adcode:A.adcode,scope:A.scope}}})}),o.container=s,Eo(o,b,h,null,d,e)}),b}configBasicStyle(e,o,i){var v,A,w,z;const{areaId:s}=i.drawOption,l=i.geoJson,{basicStyle:r,label:a,misc:n}=T(e.customAttr),f=(v=T(e.senior).areaMapping)==null?void 0:v[s];if(is(l,f),o.color={field:"value",value:[r.colors[0]],scale:{type:"quantize",unknown:r.areaBaseColor}},!((w=(A=e.data)==null?void 0:A.data)!=null&&w.length)||!((z=l==null?void 0:l.features)!=null&&z.length))return o.label&&(o.label.field="name"),o;const p=o.source.data,d=r.colors.map(k=>q(k,r.alpha)),{legend:h}=T(e.customStyle);let g=p,y=[],x=n.mapLegendMin,b=n.mapLegendMax,S=n.mapLegendNumber;h.show?(Re(p,"value",b,x,(k,N)=>{b=k,x=N,S=9}),n.mapAutoLegend?S=9:g=uo(p,b,x),y=ol(x,b,S,d)):y=d;const C=g.reduce((k,N)=>(k[N.field]=N.value,k),{});return l.features.forEach(k=>{const N=k.properties.name;if(a.show){const I=[];a.showDimension&&I.push(N),a.showQuota&&(C[N]||C[N]===0)&&I.push(D(C[N],a.quotaLabelFormatter)),k.properties._DE_LABEL_=I.join(`

`)}}),y.length&&(o.color.value=y.map(k=>k.color?new vi(k.color):new vi(k)),y[0].value&&!n.mapAutoLegend&&(o.color.scale.domain=[x??fi(p,"value"),b])),o}customConfigLegend(e,o){const{basicStyle:i,misc:s}=T(e.customAttr),l=i.colors.map(c=>q(c,i.alpha));if(i.suspension===!1&&i.showZoom===void 0)return o;const{legend:r}=T(e.customStyle);if(!r.show)return o;const a={circle:{borderRadius:"50%"},square:{},triangle:{border:"unset",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"10px solid var(--bgColor)",background:"unset"},diamond:{transform:"rotate(45deg)"}},n={position:"bottomleft",domStyles:{"l7plot-legend__category-value":{fontSize:r.fontSize+"px",color:r.color,"font-family":e.fontFamily?e.fontFamily:void 0},"l7plot-legend__category-marker":{...a[r.icon],width:r.size+"px",height:r.size+"px",...r.icon==="triangle"?{...a[r.icon].triangle,borderLeft:`${r.size/2}px solid transparent`,borderRight:`${r.size/2}px solid transparent`,borderBottom:`${r.size}px solid var(--bgColor)`}:{border:"0.01px solid #f4f4f4"},...r.icon==="diamond"?{transform:"rotate(45deg)",marginBottom:`${r.size/4}px`}:{}}}};if(!s.mapAutoLegend&&s.mapLegendRangeType==="custom"&&!e.drill){const c=[],f=s.mapLegendCustomRange.slice(0,-1).map((p,d)=>[p,s.mapLegendCustomRange[d+1]]);f.forEach((p,d)=>{const h=[p[0],p[1]],g=d%l.length,y=p[0]<f[0][0]&&p[1]<f[0][0];let x=l[g];y&&(x=i.areaBaseColor),c.push({value:h,color:x})}),n.customContent=()=>c!=null&&c.length?this.createLegendCustomContent(c):"",o.color.value=({value:p})=>{const d=c.find(h=>p>=h.value[0]&&p<=h.value[1]);return d?d.color:i.areaBaseColor},o.color.scale.domain=[f[0][0],f[f.length-1][1]]}else n.customContent=(c,f)=>{const p=(f==null?void 0:f.length)>30?f.slice(0,30):f;return p!=null&&p.length?(p.length===1&&(p[0].value=o.color.scale.domain.slice(0,2)),this.createLegendCustomContent(p)):""};return e.drill&&Re(o.source.data,"value",0,0,(c,f)=>{o.color.scale.domain=[f,c]}),jt(o,{legend:n}),o}configCustomArea(e,o,i){var h;const{drawOption:s,customSubArea:l,geoJson:r}=i;if(!s.areaId.startsWith("custom_"))return o;const a=T(e.customAttr),{label:n}=a,c=e.data.data,f=c==null?void 0:c.reduce((g,y)=>(g[y.field]=y,g),{}),p=r.features.reduce((g,y)=>(y.properties.adcode&&(g["156"+y.properties.adcode]=y),g),{});if(l.forEach(g=>{var x;const y=[];if((x=g.scopeArr)==null||x.forEach(b=>{const S=p[b];S&&y.push(S)}),y.length){const S=yo({type:"FeatureCollection",features:y});g.centroid=[S.geometry.coordinates[0],S.geometry.coordinates[1]]}}),o.label={visible:!1},n.show){const g=[];l.forEach(x=>{if(x.centroid){const b=[];n.showDimension&&b.push(x.name),n.showQuota&&(f[x.name]||f[x.name]===0)&&b.push(D(f[x.name].value,n.quotaLabelFormatter)),g.push({name:b.join(`

`),x:x.centroid[0],y:x.centroid[1]})}});const y=new Vi({name:"areaLabelLayer",source:{data:g,parser:{type:"json",x:"x",y:"y"}},field:"name",style:{fill:n.color,fontSize:n.fontSize,opacity:1,fontWeight:"bold",textAnchor:"center",textAllowOverlap:n.fullDisplay,padding:n.fullDisplay?void 0:[2,2]}});i.layers=[y]}const d=l.reduce((g,y)=>(y.scopeArr.forEach(x=>{g[x]=y.name}),g),{});if(o.tooltip&&o.tooltip.showComponent){o.tooltip.items=["name","adcode","value"],o.tooltip.customTitle=({name:x,adcode:b})=>(b="156"+b,d[b]??x);const y=(h=a.tooltip.seriesTooltipFormatter)==null?void 0:h.filter(x=>x.show).reduce((x,b)=>(x[b.id]=b,x),{});o.tooltip.customItems=x=>{var z,k,N;const b=[];if(j(y))return b;const S=x.properties;if(!S)return b;const{adcode:C}=S,v=d["156"+C],A=f[v];if(!A)return b;const w=y[(k=(z=A.quotaList)==null?void 0:z[0])==null?void 0:k.id];if(!j(w)){const I=parseFloat(A.value),F=D(I,w.formatterCfg),M=j(w.chartShowName)?w.name:w.chartShowName;b.push({...A,name:M,value:`${F??""}`})}return(N=A.dynamicTooltipValue)==null||N.forEach(I=>{const F=y[I.fieldId];if(F){const M=D(parseFloat(I.value),F.formatterCfg),E=j(F.chartShowName)?F.name:F.chartShowName;b.push({color:"grey",name:E,value:`${M??""}`})}}),b}}return o}setupDefaultOptions(e){return e.customAttr.basicStyle.areaBaseColor="#f4f4f4",e}setupOptions(e,o,i){return K(this.configEmptyDataStrategy,this.configLabel,this.configStyle,this.configTooltip,this.configBasicStyle,this.customConfigLegend,this.configCustomArea)(e,o,i,this)}};class vi{constructor(u){_(this,"color");this.color=u}toString(){return this.color}}const yr=Object.freeze(Object.defineProperty({__proto__:null,Map:gr},Symbol.toStringTag,{value:"Module"})),{t:fe}=U();class xr extends si{constructor(){super("symbolic-map",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","symbolic-style-selector","title-selector","label-selector","tooltip-selector","threshold","bubble-animate"]);_(this,"propertyInner",{...le,"basic-style-selector":["colors","alpha","mapBaseStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"],"symbolic-style-selector":["symbolicMapStyle"],"label-selector":["color","fontSize","showFields","customContent"],"tooltip-selector":["color","fontSize","showFields","customContent","show","backgroundColor","carousel"],threshold:["lineThreshold"]});_(this,"axis",["xAxis","xAxisExt","extBubble","filter","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${fe("chart.symbolic_map_coordinates")} / ${fe("chart.dimension")}`,type:"d",limit:2},xAxisExt:{name:`${fe("chart.color")} / ${fe("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},extBubble:{name:`${fe("chart.bubble_size")} / ${fe("chart.quota")}`,type:"q",limit:1,tooltip:fe("chart.symbolic_map_bubble_size_tip"),allowEmpty:!0}});_(this,"buildSymbolicLayer",async(e,o)=>{var F,M;const{basicStyle:i}=T(e.customAttr),s=st(e.xAxis),l=st(e.xAxisExt),r=st(e.extBubble),{mapSymbolOpacity:a,mapSymbolSize:n,mapSymbol:c,mapSymbolStrokeWidth:f,colors:p,alpha:d,mapSymbolSizeMin:h,mapSymbolSizeMax:g}=st(i),y=p.map(E=>q(E,d));let x=0;const b=new Map,S=r.length>0?r[0].dataeaseName:"",{threshold:C,bubbleCfg:v}=T(e.senior);let A=[];C.enable&&(A=C.lineThreshold??[]);const w=e.extBubble.map(E=>E.id);A=ge(A,E=>w.includes(E.fieldId));const z=y[0],k=[],N=(F=e.data)!=null&&F.tableRow?e.data.tableRow.map((E,L)=>{var $;E._index="_index"+L;const O=E[($=l[0])==null?void 0:$.dataeaseName];let B=b.get(O);if(B||(B=y[x++%y.length],b.set(O,B)),k[L]=B,A.length>0)for(let R=0;R<A.length;R++){const H=A[R],W=E[H.field.dataeaseName];for(const Y of H.conditions){const V=Y.value,G=il(Y.color);if(Y.term==="between"){const Nt=parseFloat(Y.min),nt=parseFloat(Y.max);Nt<=W&&W<=nt&&(B=q(G,d),k[L]=B)}else Y.term==="lt"?W<V&&(B=q(G,d),k[L]=B):Y.term==="le"?W<=V&&(B=q(G,d),k[L]=B):Y.term==="gt"?W>V&&(B=q(G,d),k[L]=B):Y.term==="ge"?W>=V&&(B=q(G,d),k[L]=B):Y.term==="eq"?W===V&&(B=q(G,d),k[L]=B):Y.term==="not_eq"&&W!==V&&(B=q(G,d),k[L]=B)}}return{...E,color:B,size:parseInt(E[S])??n,name:O}}):[],I=new _e({autoFit:i.autoFit!==!1}).source(N,{parser:{type:"json",x:s[0].dataeaseName,y:s[1].dataeaseName}}).active(!0);if((M=l[0])!=null&&M.dataeaseName)if(i.mapSymbol==="custom"&&i.customIcon)if(i.customIcon.startsWith("data"))o.removeImage("customIcon"),await o.addImage("customIcon",i.customIcon),I.shape("customIcon");else{const E=new DOMParser;for(let L=0;L<Math.min(k.length,x+1);L++){const O=k[L],B=/(fill="[^"]*")/g,$=i.customIcon.replace(B,""),H=E.parseFromString($,"image/svg+xml").documentElement;H.setAttribute("fill",O),o.removeImage(`icon-${O}`),await o.addImage(`icon-${O}`,mi(H.outerHTML))}I.shape("color",L=>`icon-${L}`)}else I.shape(c).color("_index",k),I.style({stroke:{field:"color"},strokeWidth:f,opacity:a/10});else if(i.mapSymbol==="custom"&&i.customIcon)if(o.removeImage("customIcon"),i.customIcon.startsWith("data"))await o.addImage("customIcon",i.customIcon),I.shape("customIcon");else{const E=new DOMParser,L=z,O=/(fill="[^"]*")/g,B=i.customIcon.replace(O,""),R=E.parseFromString(B,"image/svg+xml").documentElement;R.setAttribute("fill",L),await o.addImage("customIcon",mi(R.outerHTML)),I.shape("customIcon")}else I.shape(c).color("_index",k).style({stroke:{field:"color"},strokeWidth:f,opacity:a/10});return S?I.size("size",[h,g]):I.size(n),v&&v.enable?(I.animate({enable:!0,speed:v.speed,rings:v.rings}),I.style({...I.style,opacity:a/2})):I.animate(!1),I});_(this,"mergeDetailsToMap",e=>{const o=new Map;return e.forEach(i=>{Object.entries(i).forEach(([s,l])=>{if(o.has(s)){const r=o.get(s);r!==l&&o.set(s,`${r}, ${l}`)}else o.set(s,l)})}),o});_(this,"clearPopup",e=>{const o=document.getElementById(e);o==null||o.querySelectorAll(".l7-popup").forEach(i=>i.remove())});_(this,"buildTooltip",(e,o,i,s)=>{var r,a;const l=e.customAttr?T(e.customAttr):null;if(this.clearPopup(o),(r=l==null?void 0:l.tooltip)!=null&&r.show){const{tooltip:n}=st(l);let c=n.showFields||[];(!n.showFields||n.showFields.length===0)&&(c=[...e.xAxisExt.map(x=>`${x.dataeaseName}@${x.name}`),...e.xAxis.map(x=>`${x.dataeaseName}@${x.name}`)]);const f="tooltip-"+o,p=document.getElementById(f);p&&(p.remove(),(a=p.parentNode)==null||a.removeChild(p));const d=document.createElement("style");d.id=f,d.innerHTML=`
          #${o} .l7-popup-content {
            background-color: ${n.backgroundColor} !important;
            padding: 6px 10px 6px;
            line-height: 1.6;
            border-top-left-radius: 3px;
          }
          #${o} .l7-popup-tip {
           border-top-color: ${n.backgroundColor} !important;
          }
        `,document.head.appendChild(d);const h=`<div style='font-size:${n.fontSize}px;color:${n.color};font-family: ${e.fontFamily}'>`,g="</div>",y=document.getElementById(o);return y&&y.addEventListener("mousemove",x=>{const b=y.getBoundingClientRect(),S=x.clientX-b.left,C=x.clientY-b.top,v=y.getElementsByClassName("l7-popup");for(let A=0;A<(v==null?void 0:v.length);A++){const w=v[A];w.firstElementChild.style.display="none",w.style.transform="translate(15px, 12px)";const z=y.clientWidth-S<=w.clientWidth+10,k=y.clientHeight-C<=w.clientHeight;let N="";z&&(N+="translateX(-120%) translateY(15%) "),k&&(N+="translateX(15%) translateY(-80%) "),N&&(w.style.transform=N.trim())}}),i.on("touchend",x=>{if(x.lngLat){const b={...x.feature,...Object.fromEntries(this.mergeDetailsToMap(x.feature.details??[]))},S=this.buildTooltipContent(n,b,c),C=new qi({lngLat:x.lngLat,title:"",closeButton:!1,closeOnClick:!0,html:`${h}${S}${g}`});s.addPopup(C)}}),new wl({anchor:"top-left",className:"l7-popup-"+o,items:[{layer:i,customContent:x=>{const b={...x,...Object.fromEntries(this.mergeDetailsToMap(x.details))},S=this.buildTooltipContent(n,b,c);return`${h}${S}${g}`}}],trigger:"hover"})}});_(this,"buildTooltipContent",(e,o,i)=>{let s="";return e.customContent?(s=e.customContent,i.forEach(l=>{s=s.replace(`\${${l.split("@")[1]}}`,o[l.split("@")[0]])})):i.forEach(l=>{s+=`<span style="margin-bottom: 4px">${l.split("@")[1]}: ${o[l.split("@")[0]]}</span><br>`}),s.replace(/\n/g,"<br>")});_(this,"buildLabel",(e,o)=>{var l,r;const i=st(e.xAxis),s=e.customAttr?T(e.customAttr):null;if((l=s==null?void 0:s.label)!=null&&l.show){const{label:a}=s,n=((r=e.data)==null?void 0:r.tableRow)||[];let c=a.showFields||[];(!a.showFields||a.showFields.length===0)&&(c=[...e.xAxisExt.map(f=>`${f.dataeaseName}@${f.name}`),...e.xAxis.map(f=>`${f.dataeaseName}@${f.name}`)]),n.forEach(f=>{const p={...f,...Object.fromEntries(this.mergeDetailsToMap(f.details))};let d=a.customContent||"";d?c.forEach(h=>{const[g,y]=h.split("@");d=d.replace(`\${${y}}`,p[g])}):d=c.map(h=>p[h.split("@")[0]]).join(","),d=d.replace(/\n/g,""),f.textLayerContent=d}),o.push(new _e().source(n,{parser:{type:"json",x:i[0].dataeaseName,y:i[1].dataeaseName}}).shape("textLayerContent","text").color(a.color).size(a.fontSize).style({textAllowOverlap:a.fullDisplay,textAnchor:"center",textOffset:[0,0],fontFamily:e.fontFamily?e.fontFamily:void 0}))}})}async drawChart(e){var S,C,v,A,w,z,k,N;const{chart:o,container:i,action:s}=e,l=document.getElementById(i),r=l==null?void 0:l.getBoundingClientRect();if((r==null?void 0:r.height)<=0)return new Gt((S=e.chartObj)==null?void 0:S.getScene(),[]);const a=st(o.xAxis);let n,c;o.customAttr&&(n=T(o.customAttr).basicStyle,c=T(o.customAttr).misc);const f=await this.getMapKey(),p=ti(f,n);let d=Ko(n);if((v=(C=o.chartExtRequest)==null?void 0:C.linkageFilters)!=null&&v.length&&(a==null?void 0:a.length)===2&&((A=o.data)!=null&&A.tableRow.length)){const I=(z=(w=o.data)==null?void 0:w.tableRow)==null?void 0:z[0][o.xAxis[0].dataeaseName],F=(N=(k=o.data)==null?void 0:k.tableRow)==null?void 0:N[0][o.xAxis[1].dataeaseName];d=[I,F]}const h=e.chartObj;let g=h==null?void 0:h.getScene();if(g=await ei(o,g,i,f,n,c,p,d),this.configZoomButton(o,g,f),(a==null?void 0:a.length)<2)return new Gt(g,void 0);const y=[],x=await this.buildSymbolicLayer(o,g);y.push(x);const b=this.buildTooltip(o,i,x,g);return b&&g.addPopup(b),this.buildLabel(o,y),x.once("inited",()=>{Ie(i)}),x.on("inited",()=>{o.container=i,Eo(o,x,x.sourceOption.data,g),Qo(g)}),x.on("click",I=>{const F=I.feature,M=[],E=[];o.data.fields.forEach((L,O)=>{Object.keys(F).forEach(B=>{B.startsWith("f_")&&L.dataeaseName===B&&(O===0?M.push({id:L.id,dataeaseName:L.dataeaseName,value:F[B]}):E.push({id:L.id,dataeaseName:L.dataeaseName,value:F[B]}))})}),s({x:I.x,y:I.y,data:{data:{...F,value:E[0].value,name:M[0].id,dimensionList:M,quotaList:E}}})}),new Gt(g,y)}setupDefaultOptions(e){return e.customAttr.label={...e.customAttr.label,show:!1},e.customAttr.basicStyle={...e.customAttr.basicStyle,mapSymbolOpacity:5,mapStyle:"normal"},e}}const br=Object.freeze(Object.defineProperty({__proto__:null,SymbolicMap:xr},Symbol.toStringTag,{value:"Module"})),xs=["background-overall-component","border-style","dual-basic-style-selector","x-axis-selector","dual-y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","assist-line","function-cfg","jump-set","linkage"],Xt={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"dual-basic-style-selector":["colors","alpha","gradient","lineWidth","lineSymbol","lineSymbolSize","lineSmooth","radiusColumnBar","subSeriesColor","seriesColor","columnWidthRatio"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine"],"dual-y-axis-selector":["name","color","fontSize","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["emptyDataStrategy"]},bs=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],mo={...bt,subAlpha:100,subColorScheme:"fast",subSeriesColor:[],subColors:["#fae800","#00c039","#0482dc","#bb9581","#ff7701","#9c5ec3","#00ccdf","#00c039","#ff7701"],leftLineWidth:2,leftLineSymbol:"circle",leftLineSymbolSize:4,leftLineSmooth:!0},Sr=Object.freeze(Object.defineProperty({__proto__:null,CHART_MIX_AXIS_TYPE:bs,CHART_MIX_DEFAULT_BASIC_STYLE:mo,CHART_MIX_EDITOR_PROPERTY:xs,CHART_MIX_EDITOR_PROPERTY_INNER:Xt},Symbol.toStringTag,{value:"Module"})),{t:_t}=U(),Cr=[];class Fo extends lt{constructor(e="chart-mix"){super(e,Cr);_(this,"properties",xs);_(this,"propertyInner",{...Xt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...Xt["tooltip-selector"],"seriesTooltipFormatter","carousel"]});_(this,"axis",[...bs,"xAxisExtRight","yAxisExt"]);_(this,"axisConfig",{xAxis:{name:`${_t("chart.drag_block_type_axis")} / ${_t("chart.dimension")}`,type:"d"},yAxis:{name:`${_t("chart.drag_block_value_axis_left")} / ${_t("chart.column_quota")}`,limit:1,type:"q"},extBubble:{name:`${_t("chart.drag_block_type_axis_right")} / ${_t("chart.dimension")}`,limit:1,type:"d",allowEmpty:!0},yAxisExt:{name:`${_t("chart.drag_block_value_axis_right")} / ${_t("chart.line_quota")}`,limit:1,type:"q",allowEmpty:!0}})}getLeftType(){return"column"}getRightType(){return"line"}async drawChart(e){var C,v,A,w,z,k,N,I,F,M,E,L,O,B;const{chart:o,action:i,container:s}=e;if(o.container=s,!((A=(v=(C=o.data)==null?void 0:C.left)==null?void 0:v.data)!=null&&A.length)&&!((k=(z=(w=o.data)==null?void 0:w.right)==null?void 0:z.data)!=null&&k.length))return;const l=Q((I=(N=o.data)==null?void 0:N.left)==null?void 0:I.data),r=Q((M=(F=o.data)==null?void 0:F.right)==null?void 0:M.data),a=this.getLeftType(),n=this.getRightType(),c=this.name==="chart-mix-group"&&((E=o.xAxisExt)==null?void 0:E.length)>0,f=this.name==="chart-mix-stack"&&((L=o.extStack)==null?void 0:L.length)>0,p="category",d="category",h=Ot((O=l[0])==null?void 0:O.data,[]),g=Ve(Ot((B=r[0])==null?void 0:B.data,[]),$=>({...$,valueExt:$.value})),y={data:[h,g],xField:"field",yField:["value","valueExt"],appendPadding:ct(o),geometryOptions:[{geometry:a,marginRatio:0,color:[],isGroup:c,isStack:f,seriesField:p},{geometry:n,color:[],seriesField:d}],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region"}]},x=this.setupOptions(o,y),{DualAxes:b}=await it(()=>import("./@antv-0.0.0-dataease.js").then($=>$.ac),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),S=new b(s,x);return S.on("point:click",i),S.on("interval:click",i),To(S,o,x,s),St(o,S),S}configLabel(e,o){var n;const i=Je(e),s={...o};if(!i)return s.geometryOptions&&(s.geometryOptions[0].label=!1,s.geometryOptions[1].label=!1),s;const l=T(e.customAttr).label,r={};return(n=l.seriesLabelFormatter)==null||n.forEach(c=>{r[c.axisType]||(r[c.axisType]=[]),r[c.axisType].push(c)}),["yAxis","yAxisExt"].forEach(c=>{var d;const f=(d=r[c])==null?void 0:d.reduce((h,g)=>(h[g.id]=g,h),{});i.style.fill=ye.color;const p={fields:[],...i,offsetY:-8,formatter:h=>{var b;if(!((b=l.seriesLabelFormatter)!=null&&b.length))return h.value;const g=f==null?void 0:f[h.quotaList[0].id];if(!g)return h.value;if(!g.show)return;const y=D(h.value,g.formatterCfg),x=new Ht({});return x.addShape({type:"text",attrs:{x:0,y:0,text:y,textAlign:"start",textBaseline:"top",fontSize:g.fontSize,fontFamily:e.fontFamily,fill:g.color}}),x}};s.geometryOptions&&(c==="yAxis"?s.geometryOptions[0].label=p:c==="yAxisExt"&&(s.geometryOptions[1].label=p))}),s}configBasicStyle(e,o){const i=T(e.customAttr),s=jt(JSON.parse(JSON.stringify(i.basicStyle)),mo),l=s.lineSmooth,r={size:s.lineSymbolSize,shape:s.lineSymbol,style:{stroke:q("#FFFFFF",s.subAlpha)}},a={lineWidth:s.lineWidth},n=s.leftLineSmooth,c={size:s.leftLineSymbolSize,shape:s.leftLineSymbol,style:{stroke:q("#FFFFFF",s.alpha)}},f={lineWidth:s.leftLineWidth},p={...o,smooth:l,point:r,lineStyle:a};p.geometryOptions&&(p.geometryOptions[0].smooth=n,p.geometryOptions[0].point=c,p.geometryOptions[0].lineStyle=f,p.geometryOptions[1].smooth=l,p.geometryOptions[1].point=r,p.geometryOptions[1].lineStyle=a,p.geometryOptions[0]={...p.geometryOptions[0],...re(e,"columnStyle")});let d;const h=s.columnWidthRatio??bt.columnWidthRatio;return h>=1&&h<=100?d=h/100:h<1?d=1/100:h>100&&(d=1),d&&(p.geometryOptions[0].columnWidthRatio=d),super.name!=="chart-mix-dual-line"&&(p.geometryOptions[0].appendPadding=ct(e)),p}setupDefaultOptions(e){const{senior:o}=e;return(o.functionCfg.emptyDataStrategy==null||o.functionCfg.emptyDataStrategy==="ignoreData")&&(o.functionCfg.emptyDataStrategy="breakLine"),e}configCustomColors(e,o){const i={...o},s=T(e.customAttr).basicStyle,{seriesColor:l}=s;if(l!=null&&l.length){const a=l.reduce((c,f)=>(c[f.id]=f,c),{}),{yAxis:n}=e;n==null||n.forEach((c,f)=>{const p=a[c.id];p&&(f+1>s.colors.length?s.colors.push(p.color):s.colors[f]=p.color)})}const r=s.colors.map(a=>{const n=q(a,s.alpha);return s.gradient?at(n,!0,270):n});return i.geometryOptions[0].color=r,i}configSubCustomColors(e,o){var a;const i={...o},s=jt(T(e.customAttr).basicStyle,Q(mo)),{subSeriesColor:l}=s;if(l!=null&&l.length){const{yAxisExt:n,extBubble:c}=e,f=l.reduce((d,h)=>(d[h.id]=h,d),{}),{data:p}=o;if(c!=null&&c.length){const d=new Set;(a=p[1])==null||a.forEach(g=>g.category!==null&&d.add(g.category)),[...d].forEach((g,y)=>{const x=f[g];x&&(y+1>s.subColors.length?s.subColors.push(x.color):s.subColors[y]=x.color)})}else n==null||n.forEach((d,h)=>{const g=f[d.id];g&&(h+1>s.subColors.length?s.subColors.push(g.color):s.subColors[h]=g.color)})}const r=s.subColors.map(n=>q(n,s.subAlpha));return i.geometryOptions[1].color=r,i}setupSubSeriesColor(e,o){const i=[],s=new Set,l=e.customAttr.basicStyle.subColors??mo.subColors,{yAxisExt:r,extBubble:a}=e;return a!=null&&a.length?o==null||o.forEach(n=>{n.value===null||n.category===null||s.has(n.category)||(s.add(n.category),i.push({id:n.category,name:n.category,color:l[(s.size-1)%l.length]}))}):r==null||r.forEach(n=>{s.has(n.id)||(s.add(n.id),i.push({id:n.id,name:n.chartShowName??n.name,color:l[(s.size-1)%l.length]}))}),i}configYAxis(e,o){const i=Ao(e),s=Ki(e),l={...o};if(l.yAxis={},!i)l.yAxis.value=!1;else{l.yAxis.value=void 0,i.position="left";const r=T(e.customStyle).yAxis;i.label&&(i.label.style.textAlign="end",i.label.formatter=n=>D(n,r.axisLabelFormatter));const a=r.axisValue;a!=null&&a.auto?l.yAxis.value=i:l.yAxis.value={...i,min:a.min,max:a.max,minLimit:a.min,maxLimit:a.max,tickCount:a.splitCount}}if(!s)l.yAxis.valueExt=!1;else{l.yAxis.valueExt=void 0,s.position="right";const r=T(e.customStyle).yAxisExt;s.label&&(s.label.style.textAlign="start",s.label.formatter=n=>D(n,r.axisLabelFormatter));const a=r.axisValue;a!=null&&a.auto?l.yAxis.valueExt=s:l.yAxis.valueExt={...s,min:a.min,max:a.max,minLimit:a.min,maxLimit:a.max,tickCount:a.splitCount}}return l}configTooltip(e,o){var a;const s=T(e.customAttr).tooltip;if(!s.show)return{...o,tooltip:!1};const l=(a=s.seriesTooltipFormatter)==null?void 0:a.filter(n=>n.show).reduce((n,c)=>(n[c.id]=c,n),{}),r={shared:!0,showTitle:!0,customItems(n){var p,d;if(!((p=s.seriesTooltipFormatter)!=null&&p.length))return n;const c=n[0];if(!c.data.quotaList)return n;const f=[];return n.filter(h=>l[h.data.quotaList[0].id]).forEach(h=>{const g=l[h.data.quotaList[0].id],y=D(parseFloat(h.value),g.formatterCfg),x=h.data.category;f.push({...h,name:x,value:y})}),(d=c.data.dynamicTooltipValue)==null||d.forEach(h=>{const g=l[h.fieldId];if(g){const y=D(parseFloat(h.value),g.formatterCfg),x=j(g.chartShowName)?g.name:g.chartShowName;f.push({color:"grey",name:x,value:y})}}),f},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:r}}configLegend(e,o){var s,l,r,a;const i=super.configLegend(e,o);if(i.legend){const n=Q((l=(s=e.data)==null?void 0:s.left)==null?void 0:l.data),c=Q((a=(r=e.data)==null?void 0:r.right)==null?void 0:a.data);i.legend.itemName.formatter=(d,h,g)=>{var x,b;let y;return h.viewId==="left-axes-view"&&d==="value"?y=(x=n[0])==null?void 0:x.categories[0]:h.viewId==="right-axes-view"&&d==="valueExt"&&(y=(b=c[0])==null?void 0:b.categories[0]),h.id=h.id+"__"+g,y===void 0?d:y};const f=T(e.customStyle);let p;f&&f.legend?p=ae(JSON.parse(JSON.stringify(f.legend)),At).size:p=At.size,i.legend.marker.style=d=>{const h=d.fill??d.stroke;return{r:p,fill:h}}}return i}configAnalyse(e,o){var l,r,a,n;e.data.dynamicAssistLines=dl(Ot((r=(l=e.data)==null?void 0:l.left)==null?void 0:r.dynamicAssistLines,[]),Ot((n=(a=e.data)==null?void 0:a.right)==null?void 0:n.dynamicAssistLines,[]));const i=ts(e),s={value:ge(i,c=>c.yAxisType==="left"),valueExt:ge(i,c=>c.yAxisType==="right")};return{...o,annotations:s}}setupOptions(e,o){return K(this.configTheme,this.configLabel,this.configTooltip,this.configBasicStyle,this.configCustomColors,this.configSubCustomColors,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configEmptyDataStrategy)(e,o)}}class vr extends Fo{constructor(e="chart-mix-group"){super(e);_(this,"axis",[...this.axis,"xAxisExt"]);_(this,"propertyInner",{...Xt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...Xt["tooltip-selector"],"seriesTooltipFormatter","carousel"]});_(this,"axisConfig",{...this.axisConfig,xAxisExt:{name:`${_t("chart.chart_group")} / ${_t("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}configCustomColors(e,o){var a;const i={...o},s=T(e.customAttr).basicStyle,{seriesColor:l}=s;if(l!=null&&l.length){const n=l.reduce((d,h)=>(d[h.id]=h,d),{}),{yAxis:c,xAxisExt:f}=e,{data:p}=o;if(f!=null&&f.length){const d=new Set;(a=p[0])==null||a.forEach(g=>g.category!==null&&d.add(g.category)),[...d].forEach((g,y)=>{const x=n[g];x&&(y+1>s.colors.length?s.colors.push(x.color):s.colors[y]=x.color)})}else c==null||c.forEach((d,h)=>{const g=n[d.id];g&&(h+1>s.colors.length?s.colors.push(g.color):s.colors[h]=g.color)})}const r=s.colors.map(n=>{const c=q(n,s.alpha);return s.gradient?at(c,!0,270):c});return i.geometryOptions[0].color=r,i}setupSeriesColor(e,o){const i=[],s=new Set,l=e.customAttr.basicStyle.colors,{yAxis:r,xAxisExt:a}=e;return a!=null&&a.length?o==null||o.forEach(n=>{n.value===null||n.category===null||s.has(n.category)||(s.add(n.category),i.push({id:n.category,name:n.category,color:l[(s.size-1)%l.length]}))}):r==null||r.forEach(n=>{s.has(n.id)||(s.add(n.id),i.push({id:n.id,name:n.chartShowName??n.name,color:l[(s.size-1)%l.length]}))}),i}}class Ar extends Fo{constructor(e="chart-mix-stack"){super(e);_(this,"axis",[...this.axis,"extStack"]);_(this,"propertyInner",{...Xt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...Xt["tooltip-selector"],"seriesTooltipFormatter","carousel"]});_(this,"axisConfig",{...this.axisConfig,extStack:{name:`${_t("chart.stack_item")} / ${_t("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}configCustomColors(e,o){var a;const i={...o},s=T(e.customAttr).basicStyle,{seriesColor:l}=s;if(l!=null&&l.length){const n=l.reduce((d,h)=>(d[h.id]=h,d),{}),{yAxis:c,extStack:f}=e,{data:p}=o;if(f!=null&&f.length){const d=new Set;(a=p[0])==null||a.forEach(g=>g.category!==null&&d.add(g.category)),[...d].forEach((g,y)=>{const x=n[g];x&&(y+1>s.colors.length?s.colors.push(x.color):s.colors[y]=x.color)})}else c==null||c.forEach((d,h)=>{const g=n[d.id];g&&(h+1>s.colors.length?s.colors.push(g.color):s.colors[h]=g.color)})}const r=s.colors.map(n=>{const c=q(n,s.alpha);return s.gradient?at(c,!0,270):c});return i.geometryOptions[0].color=r,i}setupSeriesColor(e,o){const i=[],s=new Set,l=e.customAttr.basicStyle.colors,{yAxis:r,extStack:a}=e;return a!=null&&a.length?o==null||o.forEach(n=>{n.value===null||n.category===null||s.has(n.category)||(s.add(n.category),i.push({id:n.category,name:n.category,color:l[(s.size-1)%l.length]}))}):r==null||r.forEach(n=>{s.has(n.id)||(s.add(n.id),i.push({id:n.id,name:n.chartShowName??n.name,color:l[(s.size-1)%l.length]}))}),i}}class wr extends Fo{constructor(e="chart-mix-dual-line"){super(e);_(this,"axis",[...this.axis,"xAxisExt"]);_(this,"propertyInner",{...Xt,"label-selector":["seriesLabelFormatter"],"tooltip-selector":[...Xt["tooltip-selector"],"seriesTooltipFormatter","carousel"]});_(this,"axisConfig",{...this.axisConfig,xAxisExt:{name:`${_t("chart.drag_block_type_axis_left")} / ${_t("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}getLeftType(){return"line"}configCustomColors(e,o){var a;const i={...o},s=T(e.customAttr).basicStyle,{seriesColor:l}=s;if(l!=null&&l.length){const n=l.reduce((d,h)=>(d[h.id]=h,d),{}),{yAxis:c,xAxisExt:f}=e,{data:p}=o;if(f!=null&&f.length){const d=new Set;(a=p[0])==null||a.forEach(g=>g.category!==null&&d.add(g.category)),[...d].forEach((g,y)=>{const x=n[g];x&&(y+1>s.colors.length?s.colors.push(x.color):s.colors[y]=x.color)})}else c==null||c.forEach((d,h)=>{const g=n[d.id];g&&(h+1>s.colors.length?s.colors.push(g.color):s.colors[h]=g.color)})}const r=s.colors.map(n=>{const c=q(n,s.alpha);return s.gradient?at(c,!0,270):c});return i.geometryOptions[0].color=r,i}setupSeriesColor(e,o){const i=[],s=new Set,l=e.customAttr.basicStyle.colors,{yAxis:r,xAxisExt:a}=e;return a!=null&&a.length?o==null||o.forEach(n=>{n.value===null||n.category===null||s.has(n.category)||(s.add(n.category),i.push({id:n.category,name:n.category,color:l[(s.size-1)%l.length]}))}):r==null||r.forEach(n=>{s.has(n.id)||(s.add(n.id),i.push({id:n.id,name:n.chartShowName??n.name,color:l[(s.size-1)%l.length]}))}),i}}const _r=Object.freeze(Object.defineProperty({__proto__:null,ColumnLineMix:Fo,DualLineMix:wr,GroupColumnLineMix:vr,StackColumnLineMix:Ar},Symbol.toStringTag,{value:"Module"})),{t:ve}=U(),Lr=[];class Tr extends lt{constructor(){super("circle-packing",Lr);_(this,"properties",["basic-style-selector","background-overall-component","border-style","label-selector","legend-selector","title-selector","tooltip-selector","jump-set","linkage"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","circleBorderStyle"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"function-cfg":["emptyDataStrategy"],"label-selector":["color","fontSize"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"tooltip-selector":["color","fontSize","backgroundColor","tooltipFormatter","show"]});_(this,"axis",["xAxis","yAxis","filter","drill"]);_(this,"axisConfig",{xAxis:{name:`${ve("chart.circle_packing_name")} / ${ve("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${ve("chart.circle_packing_value")} / ${ve("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var l,r,a;const{chart:o,container:i,action:s}=e;if((r=(l=o==null?void 0:o.data)==null?void 0:l.data)!=null&&r.length){const n=o.data.data,{yAxis:c}=o,f=((a=c[0])==null?void 0:a.sort)??"none",p={sort:(b,S)=>f==="asc"?b.value-S.value:f==="desc"?S.value-b.value:0},h={data:(()=>{const b=[{name:ve("commons.all"),children:[]}],S=(C,v)=>{const A={...v,name:v.name,children:[]};C.push(A)};return n.forEach(C=>S(b[0].children,C)),b[0]})(),appendPadding:ct(o),hierarchyConfig:{...f==="none"?{}:p},interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}}]},g=this.setupOptions(o,h),{CirclePacking:y}=await it(()=>import("./@antv-0.0.0-dataease.js").then(b=>b.ab),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),x=new y(i,g);return x.on("element:click",b=>{var v;const S=(v=b==null?void 0:b.data)==null?void 0:v.data;if((S==null?void 0:S.name)===ve("commons.all"))return;const C={x:b.x,y:b.y,data:{data:{...S}}};s(C)}),x}}configBasicStyle(e,o){const i=T(e.customAttr),s=JSON.parse(JSON.stringify(i.basicStyle)),l={stroke:s.circleBorderColor,lineWidth:s.circleBorderWidth??0},r=s.circlePadding;return{...o,hierarchyConfig:{...o.hierarchyConfig,padding:r/100},pointStyle:l}}configLabel(e,o){const i=super.configLabel(e,o);if(!i.label)return{...i,label:!1};const{label:s}=T(e.customAttr),l={...i.label,textAlign:"center",offsetY:5,layout:s.fullDisplay?[{type:"limit-in-plot"}]:i.label.layout,formatter:r=>r.children.length===0?r.name:""};return{...i,label:l}}configTooltip(e,o){const i=super.configTooltip(e,o);if(!i.tooltip)return i;const s=T(e.customAttr).tooltip;return{...i,tooltip:{...i,fields:["name","value"],formatter:l=>{let r=l.value;return s.tooltipFormatter&&(r=D(r,s.tooltipFormatter)),{name:l.name,value:r}}}}}configEmptyDataStrategy(e,o){const{functionCfg:i}=T(e.senior),s=i.emptyDataStrategy,l=a=>{var n,c,f,p,d;if(s==="ignoreData")for(let h=a.length-1;h>=0;h--){let g=[];(n=a[h].children)!=null&&n.length&&(g=a[h].children.filter(y=>y.value!==null)),(c=a[h].children)!=null&&c.length&&g.length&&l(a[h].children),(f=a[h])!=null&&f.hasOwnProperty("value")&&a[h].value===null&&a.splice(h,1),!((p=a[h])!=null&&p.hasOwnProperty("value"))&&g.length===0&&a.splice(h,1)}else for(let h=a.length-1;h>=0;h--){let g=[];if((d=a[h].children)!=null&&d.length&&(g=a[h].children.filter(y=>y.value!==null),!g.length)){a[h].children=[];continue}l(a[h].children)}},r=Q(o.data.children);return l(r),o.data.children=r,o}setupDefaultOptions(e){const{customAttr:o,customStyle:i,senior:s}=e,{label:l,basicStyle:r}=o,{legend:a}=i;return s.functionCfg.emptyDataStrategy="ignoreData",o.label={...l,show:!0},a.show=!1,r.circleBorderWidth=0,r.circleBorderColor="#fff",r.circlePadding=0,e}setupOptions(e,o){return K(this.configTheme,this.configEmptyDataStrategy,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend)(e,o)}}const Er=Object.freeze(Object.defineProperty({__proto__:null,CirclePacking:Tr},Symbol.toStringTag,{value:"Module"})),{t:De}=U();class Fr extends lt{constructor(){super("funnel",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","jump-set","linkage"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","seriesColor"],"label-selector":["fontSize","color","hPosition","showQuota","conversionTag"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["show","title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});_(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${De("chart.drag_block_funnel_split")} / ${De("chart.dimension")}`,type:"d"},yAxis:{name:`${De("chart.drag_block_funnel_width")} / ${De("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var f;const{chart:o,container:i,action:s}=e;if(!((f=o.data)!=null&&f.data))return;const r={data:o.data.data,xField:"field",yField:"value",appendPadding:ct(o),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}}],meta:{field:{type:"cat"}}},a=this.setupOptions(o,r),{Funnel:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.a3),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("interval:click",s),St(o,c),c}configLabel(e,o){var r;let i,s,l;if(e.customAttr){l=T(e.customAttr);const a=l.label.showQuota,n=l.label;if((r=l.label)!=null&&r.show){if(a){const f=[];n.fullDisplay||f.push({type:"hide-overlap"},{type:"limit-in-plot"}),i={position:n.position,layout:f,style:{fill:n.color,fontSize:n.fontSize},formatter:function(d){return D(d.value,n.quotaLabelFormatter)}},i.position==="right"&&(i.offsetX=-40)}const c=T(e.customAttr).label.conversionTag;c&&c.show&&(s={style:{fill:n.color,fontSize:n.fontSize},formatter:f=>{if(!f.$$conversion$$[0])return`${c.text??""} -`;const p=(f.$$conversion$$[1]/f.$$conversion$$[0]*100).toFixed(c.precision);return`${c.text??""} ${p}%`}})}return{...o,label:i,conversionTag:s,maxSize:s?.8:1}}return o}setupSeriesColor(e,o){return Xe(e,o)}setupOptions(e,o){return K(this.configTheme,this.configSingleDimensionColor,this.configLabel,this.configMultiSeriesTooltip,this.configLegend)(e,o)}setupDefaultOptions(e){const{customAttr:o,customStyle:i}=e,{label:s}=o;["left","middle","right"].includes(s.position)||(s.position="middle"),o.label={...s,show:!0,showQuota:!0,conversionTag:{show:!1,precision:2,text:De("chart.conversion_rate")}};const{legend:l}=i;return l.show=!1,e}}const zr=Object.freeze(Object.defineProperty({__proto__:null,Funnel:Fr},Symbol.toStringTag,{value:"Module"})),{t:Bo}=U(),kr=[];class Ir extends lt{constructor(){super("gauge",kr);_(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","misc-selector","title-selector","threshold"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","gaugeAxisLine","gaugePercentLabel"],"label-selector":["fontSize","color","labelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"misc-selector":["gaugeMinType","gaugeMinField","gaugeMin","gaugeMaxType","gaugeMaxField","gaugeMax","gaugeStartAngle","gaugeEndAngle"],threshold:["gaugeThreshold"]});_(this,"axis",["yAxis","filter"]);_(this,"axisConfig",{yAxis:{name:`${Bo("chart.drag_block_gauge_angel")} / ${Bo("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var p,d;const{chart:o,container:i,scale:s,action:l}=e;if(!((p=o.data)!=null&&p.series)||!o.yAxis.length)return;const r={percent:0,appendPadding:[0,10,15,10],axis:{tickInterval:.2,label:{style:{fontSize:de(12,s)}},tickLine:{length:de(12,s)*-1,style:{lineWidth:de(1,s)}},subTickLine:{count:4,length:de(6,s)*-1,style:{lineWidth:de(1,s)}}}},a=this.setupOptions(o,r,{scale:s}),{Gauge:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(h=>h.a4),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);c.on("afterrender",()=>{var h,g;l({from:"gauge",data:{type:"gauge",max:(g=(h=o.data)==null?void 0:h.series[0])==null?void 0:g.data[0]}})});const f=(d=o.data)==null?void 0:d.series.some(h=>{var g,y;return((g=h.data)==null?void 0:g[0])===void 0||((y=h.data)==null?void 0:y[0])===null});if(this.configEmptyDataStyle(f?[]:[1],i,c),!f)return c}configMisc(e,o,i){var d,h,g,y,x,b,S,C,v,A,w,z,k,N,I;const s=T(e.customAttr),l=e.data.series[0].data[0];let r,a,n,c;if(s.misc){const F=s.misc;F.gaugeMinType==="dynamic"&&F.gaugeMaxType==="dynamic"?(r=(g=(h=e.data)==null?void 0:h.series[((d=e.data)==null?void 0:d.series.length)-2])==null?void 0:g.data[0],a=(b=(x=e.data)==null?void 0:x.series[((y=e.data)==null?void 0:y.series.length)-1])==null?void 0:b.data[0]):F.gaugeMinType!=="dynamic"&&F.gaugeMaxType==="dynamic"?(r=F.gaugeMin||F.gaugeMin===0?F.gaugeMin:he.gaugeMin,a=(v=(C=e.data)==null?void 0:C.series[((S=e.data)==null?void 0:S.series.length)-1])==null?void 0:v.data[0]):F.gaugeMinType==="dynamic"&&F.gaugeMaxType!=="dynamic"?(r=(z=(w=e.data)==null?void 0:w.series[((A=e.data)==null?void 0:A.series.length)-1])==null?void 0:z.data[0],a=F.gaugeMax?F.gaugeMax:he.gaugeMax):(r=F.gaugeMin||F.gaugeMin===0?F.gaugeMin:he.gaugeMin,a=F.gaugeMax?F.gaugeMax:(I=(N=e.data)==null?void 0:N.series[((k=e.data)==null?void 0:k.series.length)-1])==null?void 0:I.data[0]),n=F.gaugeStartAngle*Math.PI/180,c=F.gaugeEndAngle*Math.PI/180,i.min=r,i.max=a}const p={percent:(parseFloat(l)-parseFloat(r))/(parseFloat(a)-parseFloat(r)),startAngle:n,endAngle:c};return{...o,...p}}configRange(e,o,i){var d;const{scale:s}=i,l=[0];let r=0,a=!1,n=!1;const c=o.theme;if(e.senior){const g=T(e.senior).threshold??sl;if(g.enable&&g.gaugeThreshold){n=!0;const y=g.gaugeThreshold.split(",");for(let x=0;x<y.length;x++){const b=y[x],S=parseFloat(b)/100;l.push(S),!a&&o.percent<=S&&(a=!0,r=x)}a||(r=y.length)}}l.push(1);let f;if(n?f={range:{color:c.styleSheet.paletteQualitative10,ticks:l},indicator:{pointer:{style:{stroke:c.styleSheet.paletteQualitative10[r%c.styleSheet.paletteQualitative10.length]}},pin:{style:{stroke:c.styleSheet.paletteQualitative10[r%c.styleSheet.paletteQualitative10.length],r:de(10,s)}}}}:f={indicator:{pin:{style:{r:de(10,s)}}}},T(e.customAttr).basicStyle.gradient){const h=(((d=c.styleSheet)==null?void 0:d.paletteQualitative10)||[]).map(g=>at(g,!0));f.range?f.range.color=h:f.range={color:h}}return{...o,...f}}configLabel(e,o,i){const s=T(e.customAttr),l=e.data.series[0].data[0];let r=!1,a=!1;const n=s.label,c=n.labelFormatter??ye.labelFormatter;n.show&&n.childrenShow&&(r={style:{fontSize:`${n.fontSize}px`,color:n.color},formatter:function(){let x;return c.type==="percent"?x=o.percent:x=l,D(x,c)}});const{min:f,max:p}=i;if(n.show&&n.proportionSeriesFormatter.show){const x=n.proportionSeriesFormatter;a={offsetY:x.fontSize+n.fontSize,style:{fontSize:`${x.fontSize}px`,color:x.color},formatter:function(){const b=(parseFloat(l)-f)/(p-f)*100;return Bo("chart.proportion")+"： "+b.toFixed(x.formatterCfg.decimalCount)+"%"}}}const d={title:r,content:a},{gaugeAxisLine:h,gaugePercentLabel:g}=s.basicStyle;return o=kt(o,{axis:{label:{formatter:x=>{if(h===!1)return"";if(g===!1){const b=x==="0"?f:x==="1"?p:f+(p-f)*x;return c.type==="value"?D(b,c):b}return x==="0"?x:x*100+"%"}}}}),{...o,statistic:d}}setupDefaultOptions(e){return e.customAttr.label={...e.customAttr.label,show:!0,labelFormatter:{type:"value",thousandSeparator:!0,decimalCount:0,unit:1}},e}setupOptions(e,o,i){return K(this.configTheme,this.configMisc,this.configLabel,this.configRange)(e,o,i)}}const Or=Object.freeze(Object.defineProperty({__proto__:null,Gauge:Ir},Symbol.toStringTag,{value:"Module"})),{t:Nr}=U();class Br extends Ze{constructor(){super(_o.CUSTOM,ue.INDICATOR,"indicator");_(this,"selectorSpec");_(this,"properties",["background-overall-component","border-style","title-selector","indicator-value-selector","indicator-name-selector","threshold","function-cfg","linkage"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"indicator-value-selector":["fontSize","color","hPosition","isItalic","isBolder","fontFamily","letterSpace","fontShadow"],"indicator-name-selector":["title","fontSize","color","hPosition","isItalic","isBolder","fontFamily","letterSpace","fontShadow"],"function-cfg":["emptyDataStrategy"]});_(this,"axis",["yAxis","filter"]);_(this,"axisConfig",{yAxis:{name:`${Nr("chart.quota")}`,limit:1}})}setupDefaultOptions(e){const o=ll[0].colors;return e.customAttr.basicStyle.colors=o,e.customAttr.indicator.color=o[0],e.customAttr.indicatorName.color=o[1],e}}const Mr=Object.freeze(Object.defineProperty({__proto__:null,IndicatorChartView:Br},Symbol.toStringTag,{value:"Module"})),{t:Ai}=U();class Dr extends Ze{constructor(){super(_o.CUSTOM,ue.PICTURE_GROUP,"picture-group");_(this,"properties",["background-overall-component","border-style","threshold"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],threshold:["tableThreshold"]});_(this,"axis",["xAxis","yAxis","filter"]);_(this,"axisConfig",{xAxis:{name:`${Ai("chart.dimension")}`,type:"d"},yAxis:{name:`${Ai("chart.quota")}`,type:"q"}})}}const Pr=Object.freeze(Object.defineProperty({__proto__:null,PictureGroupView:Dr},Symbol.toStringTag,{value:"Module"})),{t:Kt}=U();class $r extends lt{constructor(){super("quadrant",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","label-selector","tooltip-selector","legend-selector","jump-set","linkage","quadrant-selector"]);_(this,"propertyInner",{"basic-style-selector":["colors","alpha","scatterSymbol","scatterSymbolSize","seriesColor"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":["position","name","color","fontSize","axisLine","axisValue","splitLine","axisForm","axisLabel","axisLabelFormatter"],"y-axis-selector":["position","name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"],"quadrant-selector":["regionStyle","label","lineStyle"]});_(this,"axis",["xAxis","yAxis","yAxisExt","extBubble","filter","drill","extLabel","extTooltip"]);_(this,"axisConfig",{extBubble:{name:`${Kt("chart.bubble_size")} / ${Kt("chart.quota")}`,type:"q",limit:1,allowEmpty:!0},xAxis:{name:`${Kt("chart.form_type")} / ${Kt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Kt("chart.x_axis")} / ${Kt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Kt("chart.y_axis")} / ${Kt("chart.quota")}`,type:"q",limit:1}})}getFieldObject(e){var r,a,n,c,f,p,d,h;const o={id:(r=e.xAxis[0])==null?void 0:r.id,name:(a=e.xAxis[0])==null?void 0:a.originName},i={id:(n=e.extBubble[0])==null?void 0:n.id,name:(c=e.extBubble[0])==null?void 0:c.originName},s={id:(f=e.yAxis[0])==null?void 0:f.id,name:(p=e.yAxis[0])==null?void 0:p.originName},l={id:(d=e.yAxisExt[0])==null?void 0:d.id,name:(h=e.yAxisExt[0])==null?void 0:h.originName};return{colorFieldObj:o,sizeFieldObj:i,xFieldObj:s,yFieldObj:l}}getUniqueObjects(e){return[...new Set(e.map(JSON.stringify))].map(JSON.parse)}async drawChart(e){var N,I,F,M;const{chart:o,container:i,action:s,quadrantDefaultBaseline:l}=e;if(!((N=o.data)!=null&&N.data))return;const r=Q(o.data.data),a=Ot((I=r[0])==null?void 0:I.data,[]),n=Ot((F=r[1])==null?void 0:F.data,[]),c=Ot((M=r[2])==null?void 0:M.data,[]),f=a.map(E=>{var L;return{...E,id:(L=E.quotaList[0])==null?void 0:L.id,field:E.field,value:E.value}}),p=n.map(E=>{var L;return{...E,id:(L=E.quotaList[0])==null?void 0:L.id,field:E.field,value:E.value}}),d=c.map(E=>{var L;return{...E,id:(L=E.quotaList[0])==null?void 0:L.id,field:E.field,value:E.value}}),h=f.map(E=>E.value),g=((Math.max(...h)+Math.min(...h))/2).toFixed(),y=p.map(E=>E.value),x=((Math.max(...y)+Math.min(...y))/2).toFixed(),b={...o.customAttr.quadrant};b.xBaseline===void 0&&(b.xBaseline=g,b.yBaseline=x);const S=E=>{var B,$;const L=(B=d.find(R=>R.field===E.field))==null?void 0:B.quotaList,O=($=p.find(R=>R.field===E.field))==null?void 0:$.quotaList;return JSON.stringify(L)===JSON.stringify(O)?O:[...L||[],...O||[]]},C=Ve(Ot(f,[]),E=>{var L,O;return{...E,yAxis:E.value,quotaList:S(E),yAxisExt:(L=p.find(B=>B.field===E.field))==null?void 0:L.value,extBubble:(O=d.find(B=>B.field===E.field))==null?void 0:O.value}}),v={colorField:"field",meta:{field:{type:"cat"}},quadrant:{...b},data:C,xField:"yAxis",yField:"yAxisExt",appendPadding:ct(o),pointStyle:{fillOpacity:.8,stroke:"#bbb"}};o.container=i;const A=this.setupOptions(o,v),{Scatter:w}=await it(()=>import("./@antv-0.0.0-dataease.js").then(E=>E.a7),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),z=new w(i,A);z.on("point:click",s),z.on("click",()=>l(b)),z.on("afterrender",()=>l(b));const k=T(o.customStyle).yAxis;return k!=null&&k.name&&(xn(o,z),ce(o,z,"axis-title")),St(o,z),z}configBasicStyle(e,o){var l;const s=T(e.customAttr).basicStyle;return(l=e.extBubble)!=null&&l.length?{...o,size:[4,30],sizeField:"extBubble",shape:s.scatterSymbol}:{...o,size:s.scatterSymbolSize,shape:s.scatterSymbol}}configXAxis(e,o){const i=super.configXAxis(e,o);if(!i.xAxis)return i;const s=T(e.customStyle).xAxis;i.xAxis.label&&(i.xAxis.label.formatter=r=>D(r,s.axisLabelFormatter));const l=s.axisValue;if(!(l!=null&&l.auto)){const r={xAxis:{...i.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...r}}return i}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;const s=T(e.customStyle).yAxis;i.yAxis.label&&(i.yAxis.label.formatter=r=>D(r,s.axisLabelFormatter));const l=s.axisValue;if(!(l!=null&&l.auto)){const r={yAxis:{...i.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...r}}return i}configLabel(e,o){let i,s;if(e.customAttr&&(s=T(e.customAttr),s.label)){const l=s.label;if(l.show){const r=[];l.fullDisplay||(r.push({type:"hide-overlap"}),r.push({type:"limit-in-shape"})),i={offset:0,style:{fill:l.color,fontSize:l.fontSize},content:a=>a.name,layout:r}}else i=!1}return{...o,label:i}}configTooltip(e,o){var p;const s=T(e.customAttr).tooltip,l=e.xAxis[0],r=e.yAxis[0],a=e.yAxisExt[0];if(!s.show||!l&&!r&&!a)return{...o,tooltip:!1};const n=(p=s.seriesTooltipFormatter)==null?void 0:p.filter(d=>d.show).reduce((d,h)=>(d[h.seriesId]=h,d),{}),c=Q(o.data),f={showTitle:!0,title:(d,h)=>h==null?void 0:h.name,customItems(d){var y,x;if(!((y=s.seriesTooltipFormatter)!=null&&y.length))return d;const h=[];d.forEach(b=>{Object.keys(n).forEach(S=>{if(S.endsWith(b.name)){const C=n[S];if(C){const v=C.groupType==="q"?D(parseFloat(b.value),C.formatterCfg):b.value,A=j(C.chartShowName)?C.name:C.chartShowName;h.push({color:b.color,name:A,value:v})}}})});const g=(x=c.find(b=>b.field===d[0].title))==null?void 0:x.dynamicTooltipValue;return g.length>0&&g.forEach(b=>{const S=s.seriesTooltipFormatter.filter(C=>C.id===b.fieldId);if(S&&S.length>0){const C=D(parseFloat(b.value),S[0].formatterCfg),v=j(S[0].chartShowName)?S[0].name:S[0].chartShowName;h.push({color:"grey",name:v,value:C})}}),h},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:f}}setupDefaultOptions(e){return e.customStyle.yAxis.splitLine={...e.customStyle.yAxis.splitLine,show:!1},e.customStyle.yAxisExt.splitLine={...e.customStyle.yAxisExt.splitLine,show:!1},e.customStyle.yAxis.axisLine={...e.customStyle.yAxis.axisLine,show:!0},e.customStyle.yAxisExt.axisLine={...e.customStyle.yAxisExt.axisLine,show:!0},e}configColor(e,o){const{xAxis:i,yAxis:s,yAxisExt:l}=e;return i!=null&&i.length&&(s!=null&&s.length)&&(l!=null&&l.length)?this.configSingleDimensionColor(e,o):o}setupSeriesColor(e,o){var a;const{xAxis:i,yAxis:s,yAxisExt:l}=e;if(!(i!=null&&i.length&&(s!=null&&s.length)&&(l!=null&&l.length)))return[];const r=(a=o==null?void 0:o[0])==null?void 0:a.data;return Xe(e,r)}configLegend(e,o){const i=super.configLegend(e,o);if(!i.legend)return i;const s=T(e.customStyle);let l;return s&&s.legend?l=ae(JSON.parse(JSON.stringify(s.legend)),At).size:l=At.size,i.legend.marker.style=r=>({r:l,fill:r.fill}),i}setupOptions(e,o){return K(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configBasicStyle)(e,o,{},this)}}const Rr=Object.freeze(Object.defineProperty({__proto__:null,Quadrant:$r},Symbol.toStringTag,{value:"Module"})),{t:Pe}=U();class Hr extends lt{constructor(){super("radar",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","misc-style-selector","jump-set","linkage"]);_(this,"propertyInner",{"basic-style-selector":["colors","alpha","radarShape","seriesColor","radarShowPoint","radarPointSize","radarAreaColor"],"label-selector":["seriesLabelFormatter"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"misc-style-selector":["showName","color","fontSize","axisColor","axisValue"],"title-selector":["show","title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});_(this,"selectorSpec",{...this.selectorSpec,"misc-style-selector":{title:`${Pe("chart.tooltip_axis")}`}});_(this,"axis",["xAxis","yAxis","drill","filter","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${Pe("chart.drag_block_radar_label")} / ${Pe("chart.dimension")}`,type:"d"},yAxis:{name:`${Pe("chart.drag_block_radar_length")} / ${Pe("chart.quota")}`,type:"q"}})}async drawChart(e){var f;const{chart:o,container:i,action:s}=e;if(!((f=o.data)!=null&&f.data))return;const r={data:o.data.data,xField:"field",yField:"value",seriesField:"category",appendPadding:[10,10,10,10],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"point:mousemove",action:"active-region:show"}],end:[{trigger:"point:mouseleave",action:"active-region:hide"}]}}]},a=this.setupOptions(o,r),{Radar:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.af),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("point:click",s),a.label&&c.on("label:click",p=>{s({x:p.x,y:p.y,data:{data:p.target.attrs.data}})}),St(o,c),c}configBasicStyle(e,o){const{radarShowPoint:i,radarPointSize:s,radarAreaColor:l}=T(e.customAttr).basicStyle,r={};return i&&(r.point={shape:"circle",size:s,style:{fill:null}}),l&&(r.area={}),{...o,...r}}configLabel(e,o){var a;const i=super.configLabel(e,o);if(!i.label)return{...i,label:!1};const s=T(e.customAttr).label,l=(a=s.seriesLabelFormatter)==null?void 0:a.reduce((n,c)=>(n[c.id]=c,n),{});i.label.style.fill=ye.color;const r={fields:[],...i.label,autoRotate:!1,autoHide:!0,formatter:n=>{var d;if(!((d=s.seriesLabelFormatter)!=null&&d.length))return n.value;const c=l==null?void 0:l[n.quotaList[0].id];if(!c)return n.value;if(!c.show)return;const f=D(n.value,c.formatterCfg),p=new Ht({});return p.addShape({type:"text",attrs:{data:n,x:0,y:0,text:f,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fill:c.color}}),p}};return{...i,label:r}}configAxis(e,o){const i=T(e.customAttr),s=T(e.customStyle),l=i.basicStyle,r=s.misc;let a={style:{fill:r.color,fontSize:r.fontSize}};r.showName||(a=!1);const n={line:null,tickLine:null,label:a,grid:{line:{style:{stroke:r.axisColor}}}},c={label:null,line:null,tickLine:null,grid:{line:{type:l.radarShape,style:{stroke:r.axisColor}}}},f=r.axisValue;if(!(f!=null&&f.auto)){const p={...c,min:f.min,max:f.max,minLimit:f.min,maxLimit:f.max,tickCount:f.splitCount};return{...o,xAxis:n,yAxis:p}}return{...o,xAxis:n,yAxis:c}}configLegend(e,o){const i=super.configLegend(e,o);if(!i.legend)return i;const s=T(e.customStyle);let l;return s&&s.legend?l=ae(JSON.parse(JSON.stringify(s.legend)),At).size:l=At.size,i.legend.marker.style=r=>({r:l,fill:r.stroke}),i}setupOptions(e,o){return K(this.configTheme,this.configColor,this.configLabel,this.configLegend,this.configMultiSeriesTooltip,this.configAxis,this.configBasicStyle)(e,o)}}const Wr=Object.freeze(Object.defineProperty({__proto__:null,Radar:Hr},Symbol.toStringTag,{value:"Module"})),{t:wi}=U();class qr extends Ze{constructor(){super(_o.CUSTOM,ue.RICH_TEXT,"rich-text");_(this,"properties",["background-overall-component","border-style","threshold","function-cfg"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],threshold:["tableThreshold"],"function-cfg":["emptyDataStrategy"]});_(this,"axis",["xAxis","yAxis","filter"]);_(this,"axisConfig",{xAxis:{name:`${wi("chart.dimension")}`,type:"d",allowEmpty:!0},yAxis:{name:`${wi("chart.quota")}`,type:"q",allowEmpty:!0}})}}const Vr=Object.freeze(Object.defineProperty({__proto__:null,RichTextChartView:qr},Symbol.toStringTag,{value:"Module"})),Ss=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","jump-set","linkage"],Cs={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"function-cfg":["slider","emptyDataStrategy"]},vs=["xAxis","xAxisExt","yAxis","filter","extLabel","extTooltip"],Yr=Object.freeze(Object.defineProperty({__proto__:null,SANKEY_AXIS_TYPE:vs,SANKEY_EDITOR_PROPERTY:Ss,SANKEY_EDITOR_PROPERTY_INNER:Cs},Symbol.toStringTag,{value:"Module"})),{t:Ae}=U(),jr=[];class Gr extends lt{constructor(e="sankey"){super(e,jr);_(this,"axisConfig",{xAxis:{name:`${Ae("chart.drag_block_type_axis_start")} / ${Ae("chart.dimension")}`,limit:1,type:"d"},xAxisExt:{name:`${Ae("chart.drag_block_type_axis_end")} / ${Ae("chart.dimension")}`,limit:1,type:"d",allowEmpty:!0},yAxis:{name:`${Ae("chart.chart_data")} / ${Ae("chart.quota")}`,limit:1,type:"q"}});_(this,"properties",Ss);_(this,"propertyInner",{...Cs,"label-selector":["color","fontSize"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});_(this,"axis",[...vs]);_(this,"baseOptions",{data:[],sourceField:"source",targetField:"target",weightField:"value",rawFields:["dimensionList","quotaList"],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}},{type:"active-region",cfg:{start:[{trigger:"interval:mousemove",action:"active-region:show"}],end:[{trigger:"interval:mouseleave",action:"active-region:hide"}]}}]})}async drawChart(e){var f,p;const{chart:o,container:i,action:s}=e;if(!((p=(f=o.data)==null?void 0:f.data)!=null&&p.length))return;const l=Q(o.data.data);l.forEach(d=>{d.dimensionList&&(d.dimensionList[0]&&(d.source=d.dimensionList[0].value),d.dimensionList[1]&&(d.target=d.dimensionList[1].value))});const r={...this.baseOptions,appendPadding:ct(o),data:l,nodeSort:(d,h)=>{if(o.yAxis&&o.yAxis[0]){if(o.yAxis[0].sort==="asc")return d.value-h.value;if(o.yAxis[0].sort==="desc")return h.value-d.value}if(o.xAxis&&o.xAxis[0]&&d.sourceLinks.length>0){if(o.xAxis[0].sort==="custom_sort"&&o.xAxis[0].customSort)return o.xAxis[0].customSort.indexOf(d.name)-o.xAxis[0].customSort.indexOf(h.name);if(o.xAxis[0].sort==="asc")return d.name.localeCompare(h.name);if(o.xAxis[0].sort==="desc")return h.name.localeCompare(d.name)}if(o.xAxisExt&&o.xAxisExt[0]&&d.targetLinks.length>0){if(o.xAxisExt[0].sort==="custom_sort"&&o.xAxisExt[0].customSort)return o.xAxisExt[0].customSort.indexOf(d.name)-o.xAxisExt[0].customSort.indexOf(h.name);if(o.xAxisExt[0].sort==="asc")return d.name.localeCompare(h.name);if(o.xAxisExt[0].sort==="desc")return h.name.localeCompare(d.name)}return h.value-d.value}},a=this.setupOptions(o,r),{Sankey:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(d=>d.ah),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("edge:click",s),c}configTooltip(e,o){var l;let i,s;if(e.customAttr&&(s=T(e.customAttr),s.tooltip)){const r=JSON.parse(JSON.stringify(s.tooltip));if(r.show){const a={};Array.isArray(o.data)&&((l=o.data)==null||l.forEach(n=>{a[n.source]=(a[n.source]||0)+n.value})),i={showTitle:!1,showMarkers:!1,shared:!1,showContent:n=>!gt(n,[0,"data","isNode"]),formatter:n=>{const{source:c,target:f,value:p}=n;if(r.tooltipFormatter.showTotalPercent){const{decimalCount:d=2}=r.tooltipFormatter,h=(p/a[c]*100).toFixed(d)+"%";return{name:`${c} -> ${f}`,value:D(p,r.tooltipFormatter)+` (${h})`}}return{name:c+" -> "+f,value:D(p,r.tooltipFormatter)}}}}else i=!1}return{...o,tooltip:i}}configBasicStyle(e,o){const i=T(e.customAttr).basicStyle;let s=i.colors;return s=s.map(l=>{const r=q(l,i.alpha);return i.gradient?at(r,!0):r}),o={...o,color:s},o}setupDefaultOptions(e){const{customAttr:o,senior:i}=e,{label:s}=o;return["left","middle","right"].includes(s.position)||(s.position="middle"),i.functionCfg.emptyDataStrategy="ignoreData",e}configLabel(e,o){const i=T(e.customAttr).label;if(i.show){const s=[];return i.fullDisplay||s.push({type:"hide-overlap"},{type:"limit-in-canvas"}),{...o,label:{formatter:({name:r})=>r,callback:r=>{const a=r[1]===1;return{style:{fill:i.color,fontSize:i.fontSize,textAlign:a?"end":"start",fontFamily:e.fontFamily},offsetX:a?-8:8}},layout:s}}}else return{...o,label:!1}}setupOptions(e,o){return K(this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configSlider,this.configAnalyseHorizontal,this.configEmptyDataStrategy)(e,o)}}const Xr=Object.freeze(Object.defineProperty({__proto__:null,SankeyBar:Gr},Symbol.toStringTag,{value:"Module"})),{t:lo}=U();class Ur extends lt{constructor(){super("scatter",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","label-selector","tooltip-selector","legend-selector","jump-set","linkage"]);_(this,"propertyInner",{"basic-style-selector":["colors","alpha","scatterSymbol","scatterSymbolSize","seriesColor"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":["position","name","color","fontSize","axisLine","splitLine","axisForm","axisLabel"],"y-axis-selector":["position","name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});_(this,"axis",["xAxis","yAxis","extBubble","filter","drill","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${lo("chart.drag_block_type_axis")} / ${lo("chart.dimension")}`,type:"d"},yAxis:{...this.axisConfig.yAxis,limit:void 0,allowEmpty:!1},extBubble:{name:`${lo("chart.bubble_size")} / ${lo("chart.quota")}`,type:"q",limit:1,allowEmpty:!0}})}async drawChart(e){var f;const{chart:o,container:i,action:s}=e;if(!((f=o.data)!=null&&f.data))return;const r={data:o.data.data,xField:"field",yField:"value",colorField:"category",meta:{field:{type:"cat"}},appendPadding:ct(o),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}}]},a=this.setupOptions(o,r),{Scatter:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.a7),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("point:click",s),a.label&&c.on("label:click",p=>{s({x:p.x,y:p.y,data:{data:p.target.attrs.data}})}),St(o,c),c}configBasicStyle(e,o){var l;const s=T(e.customAttr).basicStyle;return(l=e.extBubble)!=null&&l.length?{...o,size:[5,30],sizeField:"popSize",shape:s.scatterSymbol}:{...o,size:s.scatterSymbolSize,shape:s.scatterSymbol}}configYAxis(e,o){const i=super.configYAxis(e,o);if(!i.yAxis)return i;const s=T(e.customStyle).yAxis;i.yAxis.label&&(i.yAxis.label.formatter=r=>D(r,s.axisLabelFormatter));const l=s.axisValue;if(!(l!=null&&l.auto)){const r={yAxis:{...i.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...i,...r}}return i}configTooltip(e,o){var n;const s=T(e.customAttr).tooltip;if(!s.show)return{...o,tooltip:!1};const l=(n=s.seriesTooltipFormatter)==null?void 0:n.filter(c=>c.show).reduce((c,f)=>(c[f.seriesId]=f,c),{}),r=["value","popSize"],a={showTitle:!0,customItems(c){var d,h;if(!((d=s.seriesTooltipFormatter)!=null&&d.length))return c;const f=c[0];if(!f.data.quotaList)return c;const p=[];return c.filter(g=>r.includes(g.name)).forEach(g=>{let y=l[`${g.data.quotaList[0].id}-yAxis`];if(g.name==="popSize"&&(y=l[`${g.data.quotaList[1].id}-extBubble`]),!y)return;const x=D(parseFloat(g.value),y.formatterCfg),b=j(y.chartShowName)?y.name:y.chartShowName;p.push({...g,name:b,value:x})}),(h=f.data.dynamicTooltipValue)==null||h.forEach(g=>{const y=l[g.fieldId];if(y){const x=D(parseFloat(g.value),y.formatterCfg),b=j(y.chartShowName)?y.name:y.chartShowName;p.push({color:"grey",name:b,value:x})}}),p},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:a}}configLegend(e,o){const i=super.configLegend(e,o);if(!i.legend)return i;const s=T(e.customStyle);let l;return s&&s.legend?l=ae(JSON.parse(JSON.stringify(s.legend)),At).size:l=At.size,i.legend.marker.style=r=>({r:l,fill:r.fill}),i}configLabel(e,o){const i=super.configLabel(e,o);if(!i.label)return o;const{label:s}=T(e.customAttr);i.label.style.fill=s.color;const l={...i.label,formatter:function(r){const a=D(r.value,s.labelFormatter),n=new Ht({});return n.addShape({type:"text",attrs:{x:0,y:0,data:r,text:a,textAlign:"start",textBaseline:"top",fontSize:s.fontSize,fontFamily:e.fontFamily,fill:s.color}}),n}};return{...i,label:l}}setupOptions(e,o){return K(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configBasicStyle)(e,o)}}const Jr=Object.freeze(Object.defineProperty({__proto__:null,Scatter:Ur},Symbol.toStringTag,{value:"Module"})),{t:no}=U();class Zr extends lt{constructor(){super("treemap",[]);_(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector","legend-selector","label-selector","tooltip-selector","jump-set","linkage"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","seriesColor"],"label-selector":["fontSize","color","showDimension","showQuota","showProportion"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"]});_(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);_(this,"axisConfig",{xAxis:{name:`${no("chart.drag_block_treemap_label")} / ${no("chart.dimension")}`,type:"d"},yAxis:{name:`${no("chart.drag_block_treemap_size")} / ${no("chart.quota")}`,limit:1}})}async drawChart(e){var f,p;const{chart:o,container:i,action:s}=e;if(!((p=(f=o.data)==null?void 0:f.data)!=null&&p.length))return;const r={data:{name:"root",children:o.data.data},colorField:"name",appendPadding:ct(o),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"element:mousemove",action:"tooltip:show"}],end:[{trigger:"element:mouseleave",action:"tooltip:hide"}]}}]},a=this.setupOptions(o,r),{Treemap:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(d=>d.ai),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("polygon:click",s),c}configTooltip(e,o){var f;const{tooltip:i,label:s}=T(e.customAttr),{yAxis:l}=e;if(!i.show)return{...o,tooltip:!1};const r=s.reserveDecimalCount,a=wo(o.data.children),n=(f=i.seriesTooltipFormatter)==null?void 0:f.filter(p=>p.show).reduce((p,d)=>(p[d.id]=d,p),{});return{...o,tooltip:{showTitle:!0,title:()=>{},customItems(p){var y,x;let d=p;(y=i.seriesTooltipFormatter)!=null&&y.length&&(d=p.filter(b=>n[b.data.quotaList[0].id]));const h=[],g=p[0];return d.forEach(b=>{const S=n[b.data.quotaList[0].id]??l[0],C=D(parseFloat(b.value),S.formatterCfg),v=(Math.round(b.data.value/b.data.path[1].value*1e4)/100).toFixed(r),A=j(S.chartShowName)?S.name:S.chartShowName;h.push({...b,name:A,value:`${C??""} (${v}%)`})}),(x=g.data.dynamicTooltipValue)==null||x.forEach(b=>{const S=n[b.fieldId];if(S){const C=a[b.fieldId],v=(Math.round(b.value/C*1e4)/100).toFixed(r),A=D(parseFloat(b.value),S.formatterCfg),w=j(S.chartShowName)?S.name:S.chartShowName;h.push({color:"grey",name:w,value:`${A??""} (${v}%)`})}}),h}}}}configLabel(e,o){const s=T(e.customAttr).label;if(!s.show)return{...o,label:!1};const l={style:{fill:s.color,fontSize:s.fontSize},formatter:function(r){let a=r.value;const n=[];if(s.showDimension&&n.push(r.field),s.showQuota&&n.push(D(r.value,s.quotaLabelFormatter)),s.showProportion){const c=`${(r.value/r.parent.value*1e4/100).toFixed(s.reserveDecimalCount)}%`;n.push(c)}return a=n.join(`
`),a}};return s.fullDisplay&&(l.layout=[{type:"limit-in-plot"}]),{...o,label:l}}setupDefaultOptions(e){const{customAttr:o,customStyle:i}=e,{label:s}=o;o.label={...s,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=i;return l.show=!1,e}setupSeriesColor(e,o){return o==null||o.sort((i,s)=>s.value-i.value),Xe(e,o)}configColor(e,o){const i=o.data.children;i.sort((l,r)=>r.value-l.value);const s=this.configSingleDimensionColor(e,{...o,data:i});return{...o,color:s.color}}setupOptions(e,o){return K(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend)(e,o,{},this)}}const Qr=Object.freeze(Object.defineProperty({__proto__:null,Treemap:Zr},Symbol.toStringTag,{value:"Module"})),{t:ro}=U(),Kr=[];class ta extends lt{constructor(){super("word-cloud",Kr);_(this,"properties",["basic-style-selector","background-overall-component","border-style","title-selector","tooltip-selector","misc-selector","jump-set","linkage"]);_(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"misc-selector":["wordSizeRange","wordSpacing","wordCloudAxisValueRange"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"]});_(this,"axis",["xAxis","yAxis","filter"]);_(this,"axisConfig",{xAxis:{name:`${ro("chart.drag_block_word_cloud_label")} / ${ro("chart.dimension_or_quota")}`,type:"d",limit:1},yAxis:{name:`${ro("chart.drag_block_word_cloud_size")} / ${ro("chart.quota")}`,type:"q",limit:1}});_(this,"setDataRange",(e,o,i)=>{e({from:"word-cloud",data:{max:o,min:i}})})}async drawChart(e){var l,r;const{chart:o,container:i,action:s}=e;if(o!=null&&o.data){let a=o.data.data;const{misc:n}=T(o.customAttr);let c=0,f=0;!((l=n.wordCloudAxisValueRange)!=null&&l.auto)&&((r=n.wordCloudAxisValueRange)==null?void 0:r.fieldId)===o.yAxis[0].id&&(c=n.wordCloudAxisValueRange.min,f=n.wordCloudAxisValueRange.max),Re(a??[],"value",f,c,(y,x)=>{f=y,c=x}),a=uo(a??[],f,c);const p={data:a,wordField:"field",weightField:"value",colorField:"field",wordStyle:{fontFamily:o.fontFamily?o.fontFamily:"Verdana",fontSize:n.wordSizeRange??he.wordSizeRange,rotation:[0,0],padding:n.wordSpacing??he.wordSpacing},random:()=>.5,appendPadding:ct(o),legend:!1,interactions:[]},d=this.setupOptions(o,p),{WordCloud:h}=await it(()=>import("./@antv-0.0.0-dataease.js").then(y=>y.ak),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),g=new h(i,d);return g.on("click",()=>{this.setDataRange(s,f,c)}),g.on("afterrender",()=>{this.setDataRange(s,f,c)}),g.on("point:click",y=>{s({x:y.x,y:y.y,data:{data:y.data.data.datum}})}),g}}configTooltip(e,o){var n;const s=T(e.customAttr).tooltip,l=e.yAxis;if(!s.show)return{...o,tooltip:!1};const r=(n=s.seriesTooltipFormatter)==null?void 0:n.filter(c=>c.show).reduce((c,f)=>(c[f.id]=f,c),{});return{...o,tooltip:{showTitle:!0,title:()=>{},customItems(c){var h,g;let f=c;(h=s.seriesTooltipFormatter)!=null&&h.length&&(f=c.filter(y=>r[y.data.datum.quotaList[0].id]));const p=[],d=c[0];return f.forEach(y=>{const x=r[y.data.datum.quotaList[0].id]??l[0],b=D(y.value,x.formatterCfg),S=j(x.chartShowName)?x.name:x.chartShowName;p.push({...y,name:S,value:b})}),(g=d.data.datum.dynamicTooltipValue)==null||g.forEach(y=>{const x=r[y.fieldId];if(x){const b=D(parseFloat(y.value),x.formatterCfg),S=j(x.chartShowName)?x.name:x.chartShowName;p.push({color:"grey",name:S,value:b})}}),p}}}}setupOptions(e,o){return K(this.configTheme,this.configTooltip)(e,o)}}const ea=Object.freeze(Object.defineProperty({__proto__:null,WordCloud:ta},Symbol.toStringTag,{value:"Module"})),{t:ao}=U(),As=["background-overall-component","border-style","basic-style-selector","title-selector","legend-selector","label-selector","tooltip-selector","jump-set","linkage"],ke={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color","rPosition","showDimension","showQuota","showProportion"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"basic-style-selector":["colors","alpha","radius","seriesColor"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"]},ws=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],_s={xAxis:{name:`${ao("chart.drag_block_pie_label")} / ${ao("chart.dimension")}`,type:"d"},yAxis:{name:`${ao("chart.drag_block_pie_angle")} / ${ao("chart.quota")}`,type:"q",limit:1}},{t:oa}=U(),ia=[];class Ls extends lt{constructor(e="pie"){super(e,ia);_(this,"axis",ws);_(this,"properties",As);_(this,"propertyInner",{...ke,"basic-style-selector":["colors","alpha","radius","topN","seriesColor"],"tooltip-selector":[...ke["tooltip-selector"],"carousel"]});_(this,"axisConfig",_s)}async drawChart(e){var d,h,g;const{chart:o,container:i,action:s}=e;if(this.configEmptyDataStyle((d=o.data)==null?void 0:d.data,i,null,oa("chart.no_data_or_not_positive")),o.container=i,!((g=(h=o.data)==null?void 0:h.data)!=null&&g.length))return;const l=o.data.data,r=T(o.customAttr),a=r.basicStyle.colors.map(y=>q(y,r.basicStyle.alpha)),n={data:l,angleField:"value",colorField:"field",appendPadding:ct(o),color:a,animation:!1,pieStyle:{lineWidth:0},statistic:{title:!1,content:{style:{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},content:""}},interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}},{type:"active-region",cfg:{start:[{trigger:"interval:mousemove",action:"active-region:show"}],end:[{trigger:"interval:mouseleave",action:"active-region:hide"}]}}],meta:{field:{type:"cat"}},state:{active:{style:{lineWidth:2,fillOpacity:.5}}}},c=this.setupOptions(o,n),{Pie:f}=await it(()=>import("./@antv-0.0.0-dataease.js").then(y=>y.a6),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),p=new f(i,c);return p.on("interval:click",y=>{var x,b;((b=(x=y.data)==null?void 0:x.data)==null?void 0:b.field)!==r.basicStyle.topNLabel&&s(y)}),St(o,p),p}configLabel(e,o){const{label:i}=T(e.customAttr);if(!(i!=null&&i.show))return{...o,label:!1};const s=[];let l;i.position==="inner"?(l="center",i.fullDisplay?s.push({type:"limit-in-plot"}):(s.push({type:"limit-in-canvas"}),s.push({type:"hide-overlap"}))):i.fullDisplay||s.push({type:"limit-in-plot"});let r=i.position==="outer"?"spider":i.position;s.length===0&&(r="no");const a={type:r,textAlign:l,layout:s,autoRotate:!1,style:{fill:i.color,fontSize:i.fontSize},formatter:n=>{let c=n.value;const f=[];if(i.showDimension&&f.push(n.field),i.showQuota&&f.push(D(n.value,i.quotaLabelFormatter)),i.showProportion){const p=`${(Math.round(n.percent*1e4)/100).toFixed(i.reserveDecimalCount)}%`;i.showDimension&&i.showQuota?f.push(`(${p})`):f.push(p)}return c=f.join(" "),c}};return{...o,label:a}}configTooltip(e,o){var p,d;const{tooltip:i,label:s}=T(e.customAttr),{yAxis:l}=e;if(!i.show)return{...o,tooltip:!1};const r=s.reserveDecimalCount,a=wo(o.data),n=(p=o.data)==null?void 0:p.reduce((h,g)=>xo(h,g.value??0),0),c=(d=i.seriesTooltipFormatter)==null?void 0:d.filter(h=>h.show).reduce((h,g)=>(h[g.id]=g,h),{}),f={showTitle:!0,title:()=>{},customItems(h){var b,S;let g=h;(b=i.seriesTooltipFormatter)!=null&&b.length&&(g=h.filter(C=>c[C.data.quotaList[0].id]));const y=[],x=h[0];return g.forEach(C=>{const v=c[C.data.quotaList[0].id]??l[0],A=parseFloat(C.value),w=D(A,v.formatterCfg),z=(Math.round(A/n*1e4)/100).toFixed(r),k=j(v.chartShowName)?v.name:v.chartShowName;y.push({...C,name:k,value:`${w??""} (${z}%)`})}),(S=x.data.dynamicTooltipValue)==null||S.forEach(C=>{const v=c[C.fieldId];if(v){const A=a[C.fieldId],w=(Math.round(C.value/A*1e4)/100).toFixed(r),z=D(parseFloat(C.value),v.formatterCfg),k=j(v.chartShowName)?v.name:v.chartShowName;y.push({color:"grey",name:k,value:`${z??""} (${w}%)`})}}),y},container:ft(`tooltip-${e.id}`),itemTpl:mt,shared:!0,enterable:!0};return{...o,tooltip:f}}configBasicStyle(e,o){const i=T(e.customAttr),{basicStyle:s}=i,{data:l}=o;if(l!=null&&l.length&&s.calcTopN&&l.length>s.topN){l.sort((c,f)=>f.value-c.value);const r=l.splice(s.topN),a={...l[0],dynamicTooltipValue:[],field:s.topNLabel,name:s.topNLabel,value:0},n={};r.reduce((c,f)=>{var p;return c.value+=f.value??0,(p=f.dynamicTooltipValue)==null||p.forEach(d=>{n[d.fieldId]=(n[d.fieldId]||0)+d.value}),c},a);for(const c in n)a.dynamicTooltipValue.push({fieldId:c,value:n[c]});l.push(a)}return{...o,radius:s.radius/100}}setupDefaultOptions(e){const{customAttr:o,customStyle:i}=e,{label:s}=o;["inner","outer"].includes(s.position)||(s.position="outer"),o.label={...s,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=i;return l.show=!1,e}setupSeriesColor(e,o){o=Q(o);const{calcTopN:i,topN:s,topNLabel:l}=e.customAttr.basicStyle;return o!=null&&o.length&&i&&o.length>s&&(o.sort((r,a)=>a.value-r.value),o.splice(s),o.push({field:l,value:0})),Xe(e,o)}setupOptions(e,o){return K(this.configTheme,this.configBasicStyle,this.configSingleDimensionColor,this.configLabel,this.configTooltip,this.configLegend)(e,o,{},this)}}class sa extends Ls{constructor(){super("pie-donut");_(this,"propertyInner",{...ke,"basic-style-selector":["colors","alpha","radius","innerRadius","topN","seriesColor"],"tooltip-selector":[...ke["tooltip-selector"],"carousel"]})}configBasicStyle(e,o){const i=super.configBasicStyle(e,o),{basicStyle:s}=T(e.customAttr);return{...i,radius:s.radius/100,innerRadius:s.innerRadius/100}}}const la=Object.freeze(Object.defineProperty({__proto__:null,Pie:Ls,PieDonut:sa},Symbol.toStringTag,{value:"Module"})),{t:Mo}=U();class Ts extends lt{constructor(e="pie-rose"){super(e,[]);_(this,"axis",ws);_(this,"properties",As);_(this,"propertyInner",ke);_(this,"axisConfig",{..._s,yAxis:{name:`${Mo("chart.drag_block_pie_radius")} / ${Mo("chart.quota")}`,type:"q",limit:1}})}async drawChart(e){var f,p,d;const{chart:o,container:i,action:s}=e;if(this.configEmptyDataStyle((f=o.data)==null?void 0:f.data,i,null,Mo("chart.no_data_or_not_positive")),!((d=(p=o==null?void 0:o.data)==null?void 0:p.data)!=null&&d.length))return;const r={data:o.data.data,xField:"field",yField:"value",seriesField:"field",appendPadding:ct(o),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}}],meta:{field:{type:"cat"}}},a=this.setupOptions(o,r),{Rose:n}=await it(()=>import("./@antv-0.0.0-dataease.js").then(h=>h.ag),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),c=new n(i,a);return c.on("interval:click",s),St(o,c),c}configBasicStyle(e,o){const{basicStyle:i}=T(e.customAttr);return{...o,radius:i.radius/100}}configLabel(e,o){var a;const{label:i}=T(e.customAttr);if(!i.show)return{...o,label:!1};const s=(a=o.data)==null?void 0:a.reduce((n,c)=>xo(n,c.value??0),0),l=[];if(!i.fullDisplay){const n=super.configLabel(e,o);l.push(...n.label.layout)}const r={autoRotate:!0,layout:l,style:{fill:i.color,fontSize:i.fontSize},formatter:n=>{let c=n.value;const f=[];if(i.showDimension&&f.push(n.field),i.showQuota&&f.push(D(n.value,i.quotaLabelFormatter)),i.showProportion){const p=`${(Math.round(n.value/s*1e4)/100).toFixed(i.reserveDecimalCount)}%`;i.showDimension&&i.showQuota?f.push(`(${p})`):f.push(p)}return c=f.join(`
`),c}};return i.position==="inner"&&(r.offset=-10),{...o,label:r}}configTooltip(e,o){var p,d;const{tooltip:i,label:s}=T(e.customAttr),{yAxis:l}=e;if(!i.show)return{...o,tooltip:!1};const r=s.reserveDecimalCount,a=wo(o.data),n=(p=o.data)==null?void 0:p.reduce((h,g)=>xo(h,g.value??0),0),c=(d=i.seriesTooltipFormatter)==null?void 0:d.filter(h=>h.show).reduce((h,g)=>(h[g.id]=g,h),{}),f={showTitle:!0,title:()=>{},customItems(h){var b,S;let g=h;(b=i.seriesTooltipFormatter)!=null&&b.length&&(g=h.filter(C=>c[C.data.quotaList[0].id]));const y=[],x=h[0];return g.forEach(C=>{const v=c[C.data.quotaList[0].id]??l[0],A=parseFloat(C.value),w=D(A,v.formatterCfg),z=(Math.round(A/n*1e4)/100).toFixed(r),k=j(v.chartShowName)?v.name:v.chartShowName;y.push({...C,name:k,value:`${w??""} (${z}%)`})}),(S=x.data.dynamicTooltipValue)==null||S.forEach(C=>{const v=c[C.fieldId];if(v){const A=a[C.fieldId],w=(Math.round(C.value/A*1e4)/100).toFixed(r),z=D(parseFloat(C.value),v.formatterCfg),k=j(v.chartShowName)?v.name:v.chartShowName;y.push({color:"grey",name:k,value:`${z??""} (${w}%)`})}}),y},container:ft(`tooltip-${e.id}`),itemTpl:mt,enterable:!0};return{...o,tooltip:f}}setupDefaultOptions(e){const{customAttr:o,customStyle:i}=e,{label:s}=o;["inner","outer"].includes(s.position)||(s.position="outer"),o.label={...s,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=i;return l.show=!1,e}setupSeriesColor(e,o){return Xe(e,o)}setupOptions(e,o){return K(this.configBasicStyle,this.configSingleDimensionColor,this.configTheme,this.configLabel,this.configLegend,this.configTooltip)(e,o)}}class na extends Ts{constructor(){super("pie-donut-rose");_(this,"propertyInner",{...ke,"basic-style-selector":["colors","alpha","radius","innerRadius","seriesColor"]})}configBasicStyle(e,o){const i=T(e.customAttr);return{...o,radius:i.basicStyle.radius/100,innerRadius:i.basicStyle.innerRadius/100}}}const ra=Object.freeze(Object.defineProperty({__proto__:null,Rose:Ts,RoseDonut:na},Symbol.toStringTag,{value:"Module"})),{t:we}=U(),aa=[];class ca extends lt{constructor(){super("t-heatmap",aa);_(this,"properties",["basic-style-selector","background-overall-component","label-selector","legend-selector","x-axis-selector","y-axis-selector","title-selector","tooltip-selector","jump-set","linkage","border-style"]);_(this,"propertyInner",{"background-overall-component":["all"],"basic-style-selector":["colors"],"label-selector":["fontSize","color"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","showLengthLimit"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["orient","color","fontSize","hPosition","vPosition"],"tooltip-selector":["show","color","fontSize","backgroundColor"],"border-style":["all"]});_(this,"axis",["xAxis","xAxisExt","extColor","filter"]);_(this,"axisConfig",{xAxis:{name:`${we("chart.x_axis")} / ${we("chart.dimension")}`,type:"d",limit:1},xAxisExt:{name:`${we("chart.y_axis")} / ${we("chart.dimension")}`,type:"d",limit:1},extColor:{name:`${we("chart.color")} / ${we("chart.dimension_or_quota")}`,limit:1}});_(this,"getDefaultLength",(e,o)=>{const i=document.getElementById(e.container),s=(i==null?void 0:i.clientHeight)||100,l=(i==null?void 0:i.clientWidth)||100;let r=s-s*.5;return o.orient!=="vertical"&&(r=l-l*.5),r});_(this,"sortData",(e,o)=>{const{deType:i,sort:s,customSort:l}=e;return s==="desc"?i===0?o.sort().reverse():o.sort((r,a)=>a-r):s==="asc"?i===0?o.sort():o.sort((r,a)=>r-a):l&&l.length>0?l:o})}async drawChart(e){const{chart:o,container:i,action:s}=e,l=st(o.xAxis),r=st(o.xAxisExt),a=st(o.extColor);if(!(l!=null&&l.length)||!(r!=null&&r.length)||!(a!=null&&a.length))return;const n=l[0].dataeaseName,c=r[0].dataeaseName,f=a[0].dataeaseName,d=Q(o.data.tableRow).filter(b=>b[n]&&b[c]&&b[f]);d.forEach(b=>{Object.keys(b).forEach(S=>{S==="*"&&(b["@"]=b[S])})});const h={data:d,xField:n,yField:c,colorField:f==="*"?"@":f,appendPadding:ct(o),meta:{[n]:{type:"cat",values:this.sortData(l[0],[...new Set(d.map(b=>b[[n]]))])},[c]:{type:"cat",values:this.sortData(r[0],[...new Set(d.map(b=>b[[c]]))]).reverse()}},legend:{layout:"vertical",position:"right",slidable:!0,label:{align:"left",spacing:10}}};o.container=i;const g=this.setupOptions(o,h),{Heatmap:y}=await it(()=>import("./@antv-0.0.0-dataease.js").then(b=>b.ad),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","../css/@antv-0.0.0-dataease.css"],import.meta.url),x=new y(i,g);return x.on("plot:click",b=>{var v;if(!((v=b.data)!=null&&v.data))return;const S=b.data.data,C=[];o.data.fields.forEach(A=>{Object.keys(S).forEach(w=>{w.startsWith("f_")&&A.dataeaseName===w&&C.push({id:A.id,dataeaseName:A.dataeaseName,value:S[w]})})}),s({x:b.data.x,y:b.data.y,data:{data:{...b.data.data,value:C[1].value,name:C[1].id,dimensionList:C,quotaList:[C[1]]}}})}),x.on("afterrender",b=>{var C;const S=JSON.parse(JSON.stringify(T(o.customStyle).legend));if(S.show){const v=(C=b.view.getController("legend").option[a[0].dataeaseName])==null?void 0:C.rail;v&&(v.defaultLength=this.getDefaultLength(o,S))}}),ce(o,x),x}configTheme(e,o){const i=super.configTheme(e,o);return i.theme.innerLabels.offset=0,i}configBasicStyle(e,o){var l;const i=T(e.customAttr).basicStyle,s=(l=i.colors)==null?void 0:l.map(r=>q(r,i.alpha));return{...o,color:s}}configTooltip(e,o){let i,s;if(e.customAttr&&(s=T(e.customAttr),s.tooltip)){const l=st(e.extColor),a=[st(e.xAxisExt),l];JSON.parse(JSON.stringify(s.tooltip)).show?i={showTitle:!0,customItems(c){const f=[],p=(d,h,g)=>{const y=d!=null&&d.chartShowName?d==null?void 0:d.chartShowName:d==null?void 0:d.name;let x=g[0].data[d.dataeaseName];isNaN(Number(x))||(x=D(x,d==null?void 0:d.formatterCfg)),h.push({...g[0],name:y,value:x})};return a.forEach(d=>{p(d[0],f,c)}),f}}:i=!1}return{...o,tooltip:i}}configXAxis(e,o){const i=Qi(e);return{...o,xAxis:i?{...i,grid:null}:!1}}configYAxis(e,o){const i=Ao(e);return{...o,yAxis:i?{...i,grid:null}:!1}}configLegend(e,o){const i=super.configLegend(e,o);if(i.legend){const s=JSON.parse(JSON.stringify(T(e.customStyle).legend));i.legend.slidable=!0,i.legend.minHeight=10,i.legend.minWidth=10,i.legend.maxHeight=600,i.legend.maxWidth=600;const l=document.getElementById(e.container),r=(l==null?void 0:l.clientHeight)||100,a=(l==null?void 0:l.clientWidth)||100;let n=r-r*.5;s.orient==="vertical"?i.legend.offsetY=-5:n=a-a*.5,i.legend.rail={defaultLength:n},i.legend.label={spacing:10,style:{fill:s.color,fontSize:s.fontSize}}}return i}setupDefaultOptions(e){return e.customStyle.legend.orient="vertical",e.customStyle.legend.vPosition="center",e.customStyle.legend.hPosition="right",e.customStyle.legend.rail={defaultLength:100},e}configLabel(e,o){const i=super.configLabel(e,o);if(i.label){const s=st(e.extColor),l=[];i.label.fullDisplay||l.push(...i.label.layout);const r={...i.label,position:"middle",layout:l,formatter:a=>{var c,f;const n=a[(c=s[0])==null?void 0:c.dataeaseName];return isNaN(Number(n))?n:D(n,(f=s[0])==null?void 0:f.formatterCfg)}};return{...i,label:r}}return i}setupOptions(e,o){return K(this.configTheme,this.configXAxis,this.configYAxis,this.configBasicStyle,this.configLegend,this.configTooltip,this.configLabel)(e,o)}}const ua=Object.freeze(Object.defineProperty({__proto__:null,TableHeatmap:ca},Symbol.toStringTag,{value:"Module"})),{t:Vt}=U();function da(m){const u=q(rt.tableHeaderBgColor,bt.alpha),e=rt.tableHeaderAlign,o=q(qt.tableItemBgColor,bt.alpha),i=qt.tableItemAlign,s=q(bt.tableBorderColor,bt.alpha),l=bt.tableScrollBarColor,r=pi(l,3),a=m.fontFamily&&m.fontFamily!=="inherit"?m.fontFamily:Yi,n={background:{color:"#00000000"},splitLine:{horizontalBorderColor:s,horizontalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderColor:s,verticalBorderColorOpacity:1,verticalBorderWidth:1,showShadow:!1},cornerCell:{cell:{backgroundColor:u,horizontalBorderColor:s,verticalBorderColor:s},text:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a},bolderText:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a},measureText:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a}},rowCell:{cell:{backgroundColor:u,horizontalBorderColor:s,verticalBorderColor:s},text:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,textBaseline:"middle",fontFamily:a},bolderText:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a},measureText:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a},seriesText:{fill:qt.tableItemBgColor,fontSize:qt.tableItemFontSize,textAlign:i,fontFamily:a}},colCell:{cell:{backgroundColor:u,horizontalBorderColor:s,verticalBorderColor:s},text:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a},bolderText:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a},measureText:{fill:rt.tableHeaderFontColor,fontSize:rt.tableTitleFontSize,textAlign:e,fontFamily:a}},dataCell:{cell:{backgroundColor:o,horizontalBorderColor:s,verticalBorderColor:s},text:{fill:qt.tableFontColor,fontSize:qt.tableItemFontSize,textAlign:i,fontFamily:a},bolderText:{fill:qt.tableFontColor,fontSize:qt.tableItemFontSize,textAlign:i,fontFamily:a},measureText:{fill:qt.tableFontColor,fontSize:qt.tableItemFontSize,textAlign:e,fontFamily:a}},scrollBar:{thumbColor:l,thumbHoverColor:r,size:8,hoverSize:12}};let c;if(m.customAttr){c=T(m.customAttr);const{basicStyle:f,tableHeader:p,tableCell:d}=c;if(f){const h=f.tableBorderColor,g=f.tableScrollBarColor,y={splitLine:{horizontalBorderColor:h,verticalBorderColor:h},cornerCell:{cell:{horizontalBorderColor:h,verticalBorderColor:h}},colCell:{cell:{horizontalBorderColor:h,verticalBorderColor:h}},dataCell:{cell:{horizontalBorderColor:h,verticalBorderColor:h,interactionState:{hoverFocus:{borderOpacity:f.showHoverStyle===!1?0:1}}}},scrollBar:{thumbColor:g,thumbHoverColor:pi(g,1.5)}};kt(n,y)}if(p){const h=q(p.tableHeaderFontColor,f.alpha);let g=p.tableHeaderBgColor;Lt(g)||(g=q(g,f.alpha));const y=p.isItalic?"italic":"normal",x=p.isBolder===!1?"normal":"bold",{tableHeaderAlign:b,tableTitleFontSize:S}=p;kt(n,{cornerCell:{cell:{backgroundColor:g},bolderText:{fill:h,fontSize:S,textAlign:b,fontStyle:y,fontWeight:x,fontFamily:a},text:{fill:h,fontSize:S,textAlign:b,fontStyle:y,fontWeight:x,fontFamily:a},measureText:{fill:h,fontSize:S,textAlign:b,fontStyle:y,fontWeight:x,fontFamily:a}},colCell:{cell:{backgroundColor:g},bolderText:{fill:h,fontSize:S,textAlign:b,fontStyle:y,fontWeight:x,fontFamily:a},text:{fill:h,fontSize:S,textAlign:b,fontStyle:y,fontWeight:x,fontFamily:a},measureText:{fill:h,fontSize:S,textAlign:b,fontStyle:y,fontWeight:x,fontFamily:a}}}),p.showHorizonBorder===!1&&p.showTableHeader!==!1&&kt(n,{splitLine:{horizontalBorderColor:g,horizontalBorderWidth:0,horizontalBorderColorOpacity:0},colCell:{cell:{horizontalBorderColor:g,horizontalBorderWidth:0}}}),p.showVerticalBorder===!1&&p.showTableHeader!==!1&&kt(n,{splitLine:{verticalBorderColor:g,verticalBorderWidth:0,verticalBorderColorOpacity:0},colCell:{cell:{verticalBorderColor:g,verticalBorderWidth:0}},cornerCell:{cell:{verticalBorderColor:g,verticalBorderWidth:0}}})}if(d){const h=q(d.tableFontColor,f.alpha);let g=d.tableItemBgColor;Lt(g)||(g=q(g,f.alpha));let y=d.tableItemSubBgColor;Lt(y)||(y=q(y,f.alpha));const x=d.isItalic?"italic":"normal",b=d.isBolder===!1?"normal":"bold",{tableItemAlign:S,tableItemFontSize:C,enableTableCrossBG:v}=d;kt(n,{rowCell:{cell:{backgroundColor:g,horizontalBorderColor:g,verticalBorderColor:g},bolderText:{fill:h,textAlign:S,fontSize:C,fontFamily:a},text:{fill:h,textAlign:S,fontSize:C,fontFamily:a},measureText:{fill:h,textAlign:S,fontSize:C,fontFamily:a},seriesText:{fill:h,textAlign:S,fontSize:C,fontFamily:a}},dataCell:{cell:{crossBackgroundColor:v?y:g,backgroundColor:g},bolderText:{fill:h,textAlign:S,fontSize:C,fontStyle:x,fontWeight:b,fontFamily:a},text:{fill:h,textAlign:S,fontSize:C,fontStyle:x,fontWeight:b,fontFamily:a},measureText:{fill:h,textAlign:S,fontSize:C,fontStyle:x,fontWeight:b,fontFamily:a},seriesText:{fill:h,textAlign:S,fontSize:C,fontStyle:x,fontWeight:b,fontFamily:a}}}),d.showHorizonBorder===!1&&kt(n,{dataCell:{cell:{horizontalBorderColor:g,horizontalBorderWidth:0}}}),d.showVerticalBorder===!1&&kt(n,{splitLine:{verticalBorderWidth:0,verticalBorderColorOpacity:0},dataCell:{cell:{verticalBorderColor:g,verticalBorderWidth:0}}})}}return n}function fa(m,u){var i,s,l;const e={};let o;if(m.customAttr){o=T(m.customAttr);const{basicStyle:r,tableHeader:a,tableCell:n}=o;switch(e.colCfg={height:a.tableTitleHeight},e.cellCfg={height:n.tableItemHeight},r.tableColumnMode){case"adapt":{e.layoutWidthType="compact";break}case"field":{delete e.layoutWidthType;const c=((i=r.tableFieldWidth)==null?void 0:i.reduce((h,g)=>(h[g.fieldId]=g,h),{}))||{};if(m.drill){const{xAxis:h}=T(m),g=m.drillFields[m.drillFilters.length],y=h.findIndex(b=>b.id===m.drillFilters[0].fieldId),x=h[y];c[g.dataeaseName]={width:(s=c[x.dataeaseName])==null?void 0:s.width}}const f=(l=u.meta)==null?void 0:l.reduce((h,g)=>{var y;return h+(((y=c[g.field])==null?void 0:y.width)??10)},0),p=parseInt(f.toFixed(0))===100,d=[];e.colCfg.width=h=>{var S;const g=h.spreadsheet.container.cfg.el.getBoundingClientRect().width;if(!((S=r.tableFieldWidth)!=null&&S.length)){const C=m.data.fields.length,v=a.showIndex?C+1:C;return g/v}const y=g/100,x=c[h.field]?c[h.field].width*y:y*10,b=parseInt(x.toFixed(0));if(p)if(d.length===u.meta.length-1){const C=d.reduce((A,w)=>A+w,0),v=g-C;if(d.splice(0),v<b)return v}else d.push(b);return b};break}case"custom":{e.colCfg.width=r.tableColumnWidth;break}default:delete e.layoutWidthType,e.colCfg.width=c=>{const f=c.spreadsheet.container.cfg.el.offsetWidth,p=c.spreadsheet.dataCfg.meta.length;if(!p)return 0;const d=a.showIndex?p+1:p,h=f/d;return Math.max(h,r.tableColumnWidth)}}}return e}function ma(m){const{threshold:u}=T(m.senior);if(!u.enable)return;const e={text:[],background:[]},o=u.tableThreshold??[],i=[...m.xAxis,...m.xAxisExt].map(s=>s.dataeaseName);if((o==null?void 0:o.length)>0){const{tableCell:s,basicStyle:l,tableHeader:r}=T(m.customAttr),a=m.type==="table-info"?s.enableTableCrossBG&&!s.mergeCells:s.enableTableCrossBG,n=Lt(s.tableFontColor)?s.tableFontColor:q(s.tableFontColor,l.alpha),c=a?null:Lt(s.tableItemBgColor)?s.tableItemBgColor:q(s.tableItemBgColor,l.alpha),f=r.tableHeaderFontColor,p=Lt(r.tableHeaderBgColor)?r.tableHeaderBgColor:q(r.tableHeaderBgColor,l.alpha),d=pa(m);for(let h=0;h<o.length;h++){const g=o[h];let y=n,x=c;m.type==="table-pivot"&&i.includes(g.field.dataeaseName)&&(y=f,x=p),e.text.push({field:g.field.dataeaseName,mapping(b,S){return S!=null&&S.isTotals||S!=null&&S.id&&(S==null?void 0:S.field)===S.id?null:{fill:_i(b,y,g,"color",d,S)}}}),e.background.push({field:g.field.dataeaseName,mapping(b,S){if(S!=null&&S.isTotals||S!=null&&S.id&&(S==null?void 0:S.field)===S.id)return null;const C=_i(b,x,g,"backgroundColor",d,S);return rl(C)?null:{fill:C}}})}}return e}function _i(m,u,e,o,i,s){let l=null;for(let r=0;r<e.conditions.length;r++){let a=!1;const n=e.conditions[r];let c,f,p;if(n.type==="dynamic"?n.term==="between"?(f=parseFloat(Do(n.dynamicMaxField,i,s)),p=parseFloat(Do(n.dynamicMinField,i,s))):c=Do(n.dynamicField,i,s):n.term==="between"?(p=parseFloat(n.min),f=parseFloat(n.max)):c=n.value,e.field.deType===2||e.field.deType===3||e.field.deType===4){if(c=parseFloat(c),n.term==="eq"?m===c&&(l=n[o],a=!0):n.term==="not_eq"?m!==c&&(l=n[o],a=!0):n.term==="lt"?m<c&&(l=n[o],a=!0):n.term==="gt"?m>c&&(l=n[o],a=!0):n.term==="le"?m<=c&&(l=n[o],a=!0):n.term==="ge"?m>=c&&(l=n[o],a=!0):n.term==="between"?p<=m&&m<=f&&(l=n[o],a=!0):n.term==="default"&&(l=n[o],a=!0),a)break;r===e.conditions.length-1&&(l=u)}else if(e.field.deType===0||e.field.deType===5){if(n.term==="eq"?m===c&&(l=n[o],a=!0):n.term==="not_eq"?m!==c&&(l=n[o],a=!0):n.term==="like"?m.includes(c)&&(l=n[o],a=!0):n.term==="not like"?m.includes(c)||(l=n[o],a=!0):n.term==="null"?(m==null||m==="")&&(l=n[o],a=!0):n.term==="not_null"?m!=null&&m!==""&&(l=n[o],a=!0):n.term==="default"&&(l=n[o],a=!0),a)break;r===e.conditions.length-1&&(l=u)}else{if(!c||!m)break;const d=e.conditions[r];c=new Date(c.replace(/-/g,"/")+" GMT+8").getTime();const h=new Date(m.replace(/-/g,"/")+" GMT+8").getTime();if(d.term==="eq"?h===c&&(l=d[o],a=!0):d.term==="not_eq"?h!==c&&(l=d[o],a=!0):d.term==="lt"?h<c&&(l=d[o],a=!0):d.term==="gt"?h>c&&(l=d[o],a=!0):d.term==="le"?h<=c&&(l=d[o],a=!0):d.term==="ge"?h>=c&&(l=d[o],a=!0):d.term==="default"&&(l=d[o],a=!0),a)break;r===e.conditions.length-1&&(l=u)}}return l}function pa(m){const u={};return m.data&&m.data.dynamicAssistLines&&m.data.dynamicAssistLines.length>0&&m.data.dynamicAssistLines.forEach(e=>{u[e.summary+"-"+e.fieldId]=e.value}),u}function Do(m,u,e){var o;return m.summary==="value"?e?e[(o=m.field)==null?void 0:o.dataeaseName]:void 0:u[m.summary+"-"+m.fieldId]}function ha(m){var l,r,a;let u=((l=m.data)==null?void 0:l.tableRow)||[],e=[];const o=T(m.senior);let i=(r=o==null?void 0:o.functionCfg)==null?void 0:r.emptyDataStrategy;i||(i="breakLine");const s=(a=o==null?void 0:o.functionCfg)==null?void 0:a.emptyDataFieldCtrl;if(i!=="breakLine"&&(s!=null&&s.length)&&(u!=null&&u.length)){const n=So(u[0]);e=fl(n,s)}if(e.length){u=Q(u);for(let n=u.length-1;n>=0;n--)for(let c=0,f=e.length;c<f;c++){const p=e[c];if(u[n][p]===null&&(i==="setZero"&&(u[n][p]=0),i==="ignoreData")){u=ge(u,(d,h)=>h!==n);break}}}return u}class Es extends _l{show(u){const{iconName:e}=u;if(e){this.showSortTooltip(u);return}super.show(u)}showSortTooltip(u){var h,g;const{position:e,options:o,meta:i,event:s}=u,{enterable:l}=Ll(o),{autoAdjustBoundary:r,adjustPosition:a}=this.spreadsheet.options.tooltip||{};this.visible=!0,this.options=u;const n=this.getContainer(),c=Rl(Wl,{table:this.spreadsheet,meta:i});this.spreadsheet.tooltip.container.innerHTML="";const f=document.createElement("div");this.spreadsheet.tooltip.container.appendChild(f),Hl(c,f);const{x:p,y:d}=Tl({spreadsheet:this.spreadsheet,position:e,tooltipContainer:n,autoAdjustBoundary:r});this.position=(a==null?void 0:a({position:{x:p,y:d},event:s}))??{x:p,y:d},ji(n,{style:{left:`${(h=this.position)==null?void 0:h.x}px`,top:`${(g=this.position)==null?void 0:g.y}px`,pointerEvents:l?"all":"none",zIndex:9999,position:"absolute",color:"black",background:"white",fontSize:"16px"},visible:!0})}}const ga='<svg t="1711681787276" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4355" width="200" height="200"><path d="M922.345786 372.183628l-39.393195 38.687114L676.138314 211.079416l0 683.909301-54.713113 0L621.425202 129.010259l53.320393 0L922.345786 372.183628zM349.254406 894.989741 101.654214 651.815349l39.393195-38.687114 206.814276 199.792349L347.861686 129.010259l54.713113 0 0 765.978459L349.254406 894.988718z" fill="{fill}" p-id="4356"></path></svg>',ya='<svg t="1711682928245" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11756" width="200" height="200"><path d="M960 704L512 256 64 704z" fill="{fill}" p-id="11757"></path></svg>',xa='<svg t="1711681879346" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4655" width="200" height="200"><path d="M64 320l448 448 448-448z" fill="{fill}" p-id="4656"></path></svg>';function Po(m){return`data:image/svg+xml;charset=utf-8;base64,${btoa(m)}`}function ba(m,u){const{tableHeaderFontColor:e,tableHeaderSort:o}=T(m.customAttr).tableHeader;if(!o)return;const i=e??"#666",s=Po(ga.replace("{fill}",i)),l=Po(ya.replace("{fill}",i)),r=Po(xa.replace("{fill}",i)),a=Math.random(),n={asc:`customSortUp${a}`,desc:`customSortDown${a}`};u.customSVGIcons=[{name:`customSortDefault${a}`,svg:s},{name:`customSortUp${a}`,svg:l},{name:`customSortDown${a}`,svg:r}],u.headerActionIcons=[{iconNames:[`customSortDefault${a}`,`customSortUp${a}`,`customSortDown${a}`],belongsCell:"colCell",displayCondition:(c,f)=>{if(c.field===Gi||c.colIndex===-1)return!1;const p=c.spreadsheet.store.get("sortMethodMap"),d=p==null?void 0:p[c.field];return d?f===n[d]:f===`customSortDefault${a}`},onClick:c=>{var h;const{meta:f,event:p}=c;f.spreadsheet.showTooltip({position:{x:p.clientX,y:p.clientY},event:p,...c});const d=document.getElementById(m.container);if((h=d==null?void 0:d.childNodes)!=null&&h.length){const g=Array.from(d.childNodes).filter(y=>y.nodeType===Node.ELEMENT_NODE).find(y=>y.classList.contains("antv-s2-tooltip-container"));if(g&&g.offsetLeft+g.clientWidth>d.offsetWidth){const x=d.offsetWidth-g.clientWidth-10;g.style.left=`${x}px`}}}}]}function Sa(m,u){const{tooltip:e}=T(m.customAttr),o=m.fontFamily?m.fontFamily:Yi;u.tooltip={...u.tooltip,style:{background:e.backgroundColor,fontSize:e.fontSize+"px",fontFamily:o,color:e.color,boxShadow:"rgba(0, 0, 0, 0.1) 0px 4px 8px 0px",borderRadius:"3px",padding:"4px 12px",opacity:.95,position:"absolute"},adjustPosition:({event:i})=>Ca(i)}}function li(m,u,e){var a;u.preventDefault();const o=m.getCell(u.target),i=o.getMeta().valueField,s=o.getMeta(),l=m.interaction.getState();let r="";if(l.stateName===El.SELECTED){const{cells:n}=l;if(!(n!=null&&n.length))return;if(n.length===1){const h=n[0];if(o.getMeta().id===h.id){const g=o.getMeta(),y=(a=g.data)==null?void 0:a[g.valueField],x=Rt(e,S=>S.field===g.valueField);let b=y==null?void 0:y.toString();x&&(b=x.formatter(y)),Io(b,!0)}m.interaction.clearState();return}const f=m.interaction.interactions.get(Fl.BRUSH_SELECTION).getScrollBrushRangeCells(n);f.sort((h,g)=>{const y=h.getMeta(),x=g.getMeta();return y.rowIndex!==x.rowIndex?y.rowIndex-x.rowIndex:y.colIndex-x.colIndex});let p=!1;const d=f.reduce((h,g)=>{g.getMeta().colIndex===s.colIndex&&g.getMeta().rowIndex===s.rowIndex&&(p=!0);const y=h[g.getMeta().rowIndex];return y?y.push(g):h[g.getMeta().rowIndex]=[g],h},{});p&&(So(d).forEach(h=>{const g=d[h];g.forEach((y,x)=>{var A;const b=y.getMeta(),S=(A=b.data)==null?void 0:A[b.valueField],C=Rt(e,w=>w.field===b.valueField);let v=S==null?void 0:S.toString();C&&(v=C.formatter(S)),v==null&&(v=""),x!==g.length-1&&(v+="	"),r+=v}),r=r+`
`}),r&&Io(r,!0)),m.interaction.clearState();return}if(s!=null&&s.data){const n=s.data[i],c=Rt(e,f=>f.field===i);r=n==null?void 0:n.toString(),c&&(r=c.formatter(n))}else{const n=e==null?void 0:e.reduce((c,f)=>(c[f.field]=f.name,c),{});r=s.value,n!=null&&n[r]&&(r=n[r])}r&&Io(r,!0)}function Ca(m){const u=m.s2Instance,{x:e,y:o}=m,i={x:e+15,y:o};if(!u)return i;const{height:s,width:l}=u.getCanvasElement().getBoundingClientRect(),{offsetHeight:r,offsetWidth:a}=u.tooltip.getContainer();return a>l&&(i.x=0),r>s&&(i.y=0),(i.x||i.y)&&(i.x&&i.x+a>l&&(i.x-=i.x+a-l),i.y&&(i.y>r?i.y-r>=15?i.y-=r+15:i.y=0:i.y+=15)),i}async function va(m,u){var N,I,F,M,E;const{layoutResult:e}=m.facet,{meta:o,fields:i}=m.dataCfg,s=((N=i==null?void 0:i.rows)==null?void 0:N.length)||0,l=((I=i==null?void 0:i.columns)==null?void 0:I.length)||0;if(e.colLeafNodes.length+s>16384){Ue.warning(Vt("chart.pivot_export_invalid_col_exceed"));return}const a=new Co.Workbook,n=a.addWorksheet(Vt("chart.chart_data")),c=o==null?void 0:o.reduce((L,O)=>(O.field&&(L[O.field]=O),L),{});(F=i.columns)==null||F.forEach((L,O)=>{var $;const B=n.getCell(O+1,1);B.value=(($=c[L])==null?void 0:$.name)??L,B.alignment={vertical:"middle",horizontal:"center"},s>=2&&n.mergeCells(O+1,1,O+1,s),B.border={right:{style:"thick",color:{argb:"00000000"}}}}),(M=i==null?void 0:i.rows)==null||M.forEach((L,O)=>{var $;const B=n.getCell(l+1,O+1);B.value=(($=c[L])==null?void 0:$.name)??L,B.alignment={vertical:"middle",horizontal:"center"},B.border={bottom:{style:"thick",color:{argb:"00000000"}}},O===i.rows.length-1&&(B.border.right={style:"thick",color:{argb:"00000000"}})});const{rowLeafNodes:f,rowsHierarchy:p,rowNodes:d}=e,h=p.maxLevel+1,g={};f.forEach(L=>{let O=L.parent;for(;O;){const W=g[O.id]??0;g[O.id]=W+1,O=O.parent}const{rowIndex:B}=L,$=B+1+l+1,R=L.level+1,H=n.getCell($,R);H.value=L.label,H.alignment={vertical:"middle",horizontal:"center"},R<h&&n.mergeCells($,R,$,h),H.border={right:{style:"thick",color:{argb:"00000000"}}}});const y=L=>{var O;return(O=L.children)!=null&&O.length?y(L.children[0]):L.rowIndex+1};d==null||d.forEach(L=>{if(L.isLeaf)return;const O=y(L),B=g[L.id],$=O+l+1,R=L.children[0].level-L.level,H=L.label,W=n.getCell($,L.level+1);W.value=H,W.alignment={vertical:"middle",horizontal:"center"},(R>1||B>1)&&n.mergeCells($,L.level+1,$+B-1,L.level+R)});const{colLeafNodes:x,colNodes:b,colsHierarchy:S}=e,C=S.maxLevel+1,v={};x.forEach(L=>{var Y;let O=L.parent;for(;O;){const V=v[O.id]??0;v[O.id]=V+1,O=O.parent}const{colIndex:B}=L,$=L.level+1,R=B+1+s,H=n.getCell($,R);let W=L.label;L.field==="$$extra$$"&&((Y=c[W])!=null&&Y.name)&&(W=c[W].name),H.value=W,H.alignment={vertical:"middle",horizontal:"center"},$<C&&n.mergeCells($,R,C,R),H.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const A=L=>{var O;return(O=L.children)!=null&&O.length?A(L.children[0]):L.colIndex+1};b.forEach(L=>{if(L.isLeaf)return;const O=A(L),B=v[L.id],$=L.level+1,R=L.children[0].level-L.level,H=L.label,W=O+s,Y=n.getCell($,W);Y.value=H,Y.alignment={vertical:"middle",horizontal:"center"},(R>1||B>1)&&n.mergeCells($,W,$+R-1,W+B-1)});const w=u.yAxis.reduce((L,O)=>(O.dataeaseName&&(L[O.dataeaseName]=O.formatterCfg),L),{});for(let L=0;L<f.length;L++)for(let O=0;O<x.length;O++){const B=e.getCellMeta(L,O),{fieldValue:$}=B;if($===0||$){const R=c[B.valueField],H=n.getCell(L+C+1,s+O+1);H.alignment={vertical:"middle",horizontal:"center"};const W=((E=R==null?void 0:R.formatter)==null?void 0:E.call(R,$))||$;if(typeof W=="number")H.value=W;else if(typeof W=="string"){const Y=w==null?void 0:w[B.valueField],V=zo(W,Y);typeof V=="string"?H.value=V:(H.value=V.value,H.numFmt=V.numFmt)}}}const z=await a.xlsx.writeBuffer(),k=new Blob([z],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});vo.saveAs(k,`${u.title??"透视表"}.xlsx`)}async function Aa(m,u){var N,I,F,M;const{layoutResult:e}=m.facet,{meta:o,fields:i}=m.dataCfg,s=((N=i==null?void 0:i.rows)==null?void 0:N.length)||0,l=((I=i==null?void 0:i.columns)==null?void 0:I.length)||0;if(e.colLeafNodes.length+s>16384){Ue.warning(Vt("chart.pivot_export_invalid_col_exceed"));return}const a=new Co.Workbook,n=a.addWorksheet(Vt("chart.chart_data")),c=o==null?void 0:o.reduce((E,L)=>(L.field&&(E[L.field]=L),E),{});l>1&&i.columns.forEach((E,L)=>{var B;if(L>=l-1)return;const O=n.getCell(L+1,1);O.value=((B=c[E])==null?void 0:B.name)??E,O.alignment={vertical:"middle",horizontal:"center"},O.border={right:{style:"thick",color:{argb:"00000000"}}},n.mergeCells(L+1,1,L+1,s+1)}),(F=i==null?void 0:i.rows)==null||F.forEach((E,L)=>{var B;const O=n.getCell(l===0?1:l,L+1);O.value=((B=c[E])==null?void 0:B.name)??E,O.alignment={vertical:"middle",horizontal:"center"},O.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const f=u.customAttr.basicStyle.quotaColLabel??t("dataset.value"),p=n.getCell(l===0?1:l,s+1);p.value=f,p.alignment={vertical:"middle",horizontal:"center"},p.border={bottom:{style:"thick",color:{argb:"00000000"}},right:{style:"thick",color:{argb:"00000000"}}};const{rowLeafNodes:d,rowNodes:h}=e,g={};d.forEach(E=>{var W;let L=E.parent;for(;L;){const Y=g[L.id]??0;g[L.id]=Y+1,L=L.parent}const{rowIndex:O}=E,B=O+2+(l===0?1:l-1),$=E.level+1,R=n.getCell(B,$);let H=E.label;E.field==="$$extra$$"&&((W=c[H])!=null&&W.name)&&(H=c[H].name),R.value=H,R.alignment={vertical:"middle",horizontal:"center"},R.border={right:{style:"thick",color:{argb:"00000000"}}}});const y=E=>{var L;return(L=E.children)!=null&&L.length?y(E.children[0]):E.rowIndex+1};h==null||h.forEach(E=>{if(E.isLeaf)return;const L=y(E),O=g[E.id],B=L+1+(l===0?1:l-1),$=E.children[0].level-E.level,R=n.getCell(B,E.level+1);R.value=E.label,R.alignment={vertical:"middle",horizontal:"center"},($>1||O>1)&&n.mergeCells(B,E.level+1,B+O-1,E.level+$)});const{colLeafNodes:x,colNodes:b,colsHierarchy:S}=e,C=S.maxLevel+1,v={};x.forEach(E=>{let L=E.parent;for(;L;){const W=v[L.id]??0;v[L.id]=W+1,L=L.parent}const{colIndex:O}=E,B=E.level+1,$=O+s+2,R=n.getCell(B,$),H=E.label;R.value=H,R.alignment={vertical:"middle",horizontal:"center"},B<C&&n.mergeCells(B,$,C,$),R.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const A=E=>{var L;return(L=E.children)!=null&&L.length?A(E.children[0]):E.colIndex+1};b.forEach(E=>{if(E.isLeaf)return;const L=A(E),O=v[E.id],B=E.level+1,$=E.label,R=L+s+1,H=n.getCell(B,R);H.value=$,H.alignment={vertical:"middle",horizontal:"center"},O>1&&n.mergeCells(B,R,B,R+O-1)});const w=u.yAxis.reduce((E,L)=>(L.dataeaseName&&(E[L.dataeaseName]=L.formatterCfg),E),{});for(let E=0;E<d.length;E++)for(let L=0;L<x.length;L++){const O=e.getCellMeta(E,L),{fieldValue:B}=O;if(B===0||B){const $=c[O.valueField],R=n.getCell(E+C+1,s+L+2),H=((M=$==null?void 0:$.formatter)==null?void 0:M.call($,B))||B;if(R.alignment={vertical:"middle",horizontal:"center"},typeof H=="number")R.value=H;else if(typeof H=="string"){const W=w==null?void 0:w[O.valueField],Y=zo(H,W);typeof Y=="string"?R.value=Y:(R.value=Y.value,R.numFmt=Y.numFmt)}}}const z=await a.xlsx.writeBuffer(),k=new Blob([z],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});vo.saveAs(k,`${u.title??"透视表"}.xlsx`)}async function wa(m,u){var C,v,A,w;const e=m.facet.layoutResult;if(e.colLeafNodes.length+1>16384){Ue.warning(Vt("chart.pivot_export_invalid_col_exceed"));return}const{meta:o,fields:i}=m.dataCfg,s=((C=i==null?void 0:i.columns)==null?void 0:C.length)||0,l=new Co.Workbook,r=l.addWorksheet(Vt("chart.chart_data")),a=o==null?void 0:o.reduce((z,k)=>(k.field&&(z[k.field]=k),z),{});(v=i.columns)==null||v.forEach((z,k)=>{var I;const N=r.getCell(k+1,1);N.value=((I=a[z])==null?void 0:I.name)??z,N.alignment={vertical:"middle",horizontal:"center"},N.border={right:{style:"thick",color:{argb:"00000000"}}}});const n=e.colsHierarchy.maxLevel+1,c=(A=i==null?void 0:i.rows)==null?void 0:A.map(z=>{var k;return((k=a[z])==null?void 0:k.name)??z}).join("/"),f=r.getCell(s+1,1);f.value=c,f.alignment={vertical:"middle",horizontal:"center"},f.border={right:{style:"thick",color:{argb:"00000000"}},bottom:{style:"thick",color:{argb:"00000000"}}};const{rowLeafNodes:p}=e;p.forEach((z,k)=>{const N=r.getCell(n+k+1,1);N.value=Bi("  ",z.level)+z.label,N.alignment={vertical:"middle",horizontal:"left"},N.border={right:{style:"thick",color:{argb:"00000000"}}}});const d={},{colLeafNodes:h}=e;h.forEach(z=>{var L;let k=z.parent;for(;k;){const O=d[k.id]??0;d[k.id]=O+1,k=k.parent}const{colIndex:N}=z,I=z.level+1,F=N+1+1,M=r.getCell(I,F);let E=z.label;z.field==="$$extra$$"&&((L=a[E])!=null&&L.name)&&(E=a[E].name),M.value=E,M.alignment={vertical:"middle",horizontal:"center"},I<n&&r.mergeCells(I,F,n,F),M.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const g=e.colNodes,y=z=>{var k;return(k=z.children)!=null&&k.length?y(z.children[0]):z.colIndex+1};g.forEach(z=>{if(z.isLeaf)return;const k=y(z),N=d[z.id],I=z.level+1,F=z.children[0].level-z.level,M=k+1,E=r.getCell(I,M);E.value=z.label,E.alignment={vertical:"middle",horizontal:"center"},(F>1||N>1)&&r.mergeCells(I,M,I+F-1,M+N-1)});const x=u.yAxis.reduce((z,k)=>(k.dataeaseName&&(z[k.dataeaseName]=k.formatterCfg),z),{});for(let z=0;z<p.length;z++)for(let k=0;k<h.length;k++){const N=e.getCellMeta(z,k),{fieldValue:I}=N;if(I===0||I){const F=a[N.valueField],M=r.getCell(z+n+1,k+1+1),E=((w=F==null?void 0:F.formatter)==null?void 0:w.call(F,I))||I;if(M.alignment={vertical:"middle",horizontal:"center"},typeof E=="number")M.value=E;else if(typeof E=="string"){const L=x==null?void 0:x[N.valueField],O=zo(E,L);typeof O=="string"?M.value=O:(M.value=O.value,M.numFmt=O.numFmt)}}}const b=await l.xlsx.writeBuffer(),S=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});vo.saveAs(S,`${u.title??"透视表"}.xlsx`)}async function _a(m,u){var v,A,w,z;const e=m.facet.layoutResult;if(e.colLeafNodes.length+1>16384){Ue.warning(Vt("chart.pivot_export_invalid_col_exceed"));return}const{meta:o,fields:i}=m.dataCfg,s=((v=i==null?void 0:i.columns)==null?void 0:v.length)||0,l=new Co.Workbook,r=l.addWorksheet(Vt("chart.chart_data")),a=o==null?void 0:o.reduce((k,N)=>(N.field&&(k[N.field]=N),k),{});(A=i.columns)==null||A.forEach((k,N)=>{var F;if(N>=i.columns.length-1)return;const I=r.getCell(N+1,1);I.value=((F=a[k])==null?void 0:F.name)??k,I.alignment={vertical:"middle",horizontal:"center"},I.border={right:{style:"thick",color:{argb:"00000000"}}}});const n=u.customAttr.basicStyle.quotaColLabel??t("dataset.value"),c=e.colsHierarchy.maxLevel+1,f=(w=i==null?void 0:i.rows)==null?void 0:w.map(k=>{var N;return((N=a[k])==null?void 0:N.name)??k}).concat(n).join("/"),p=r.getCell(s,1);p.value=f,p.alignment={vertical:"middle",horizontal:"center"},p.border={right:{style:"thick",color:{argb:"00000000"}},bottom:{style:"thick",color:{argb:"00000000"}}};const{rowLeafNodes:d}=e;d.forEach((k,N)=>{var M;const I=r.getCell(c+N+1,1);let F=k.label;k.field==="$$extra$$"&&((M=a[F])!=null&&M.name)&&(F=a[F].name),I.value=Bi("  ",k.level)+F,I.alignment={vertical:"middle",horizontal:"left"},I.border={right:{style:"thick",color:{argb:"00000000"}}}});const h={},{colLeafNodes:g}=e;g.forEach(k=>{let N=k.parent;for(;N;){const L=h[N.id]??0;h[N.id]=L+1,N=N.parent}const{colIndex:I}=k,F=k.level+1,M=I+2,E=r.getCell(F,M);E.value=k.label,E.alignment={vertical:"middle",horizontal:"center"},F<c&&r.mergeCells(F,M,c,M),E.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const y=e.colNodes,x=k=>{var N;return(N=k.children)!=null&&N.length?x(k.children[0]):k.colIndex+1};y.forEach(k=>{if(k.isLeaf)return;const N=x(k),I=h[k.id],F=k.level+1,M=N+1,E=r.getCell(F,M);E.value=k.label,E.alignment={vertical:"middle",horizontal:"center"},I>1&&r.mergeCells(F,M,F,M+I-1)});const b=u.yAxis.reduce((k,N)=>(N.dataeaseName&&(k[N.dataeaseName]=N.formatterCfg),k),{});for(let k=0;k<d.length;k++)for(let N=0;N<g.length;N++){const I=e.getCellMeta(k,N),{fieldValue:F}=I;if(F===0||F){const M=a[I.valueField],E=r.getCell(k+c+1,N+2),L=((z=M==null?void 0:M.formatter)==null?void 0:z.call(M,F))||F;if(E.alignment={vertical:"middle",horizontal:"center"},typeof L=="number")E.value=L;else if(typeof L=="string"){const O=b==null?void 0:b[I.valueField],B=zo(L,O);typeof B=="string"?E.value=B:(E.value=B.value,E.numFmt=B.numFmt)}}}const S=await l.xlsx.writeBuffer(),C=new Blob([S],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});vo.saveAs(C,`${u.title??"透视表"}.xlsx`)}function zo(m,u){let e=m;if(u.type==="percent"){if(e=e.slice(0,-1),u.thousandSeparator&&(e=e.replace(/,/g,"")),e.includes("e")){const c=e.match(/^[+-]?\d+(\.\d+)?(e[+-]?\d+)?/);if(!(c!=null&&c.length))return m;const f=c[0],p=parseFloat(f);let d="0.";const h=f.split("e")[0];return d+="0".repeat(h.slice(1).length),d+='E+0"%"',{value:p,numFmt:d}}const a=parseFloat(e);let n="#";return u.thousandSeparator&&(n+=",#"),Math.abs(a)<1&&(n="0"),u.decimalCount>0&&(n+=`.${"0".repeat(u.decimalCount)}`),n+='"%"',{value:a,numFmt:n}}if(u.suffix){const a=u.suffix;e.endsWith(a)&&(e=e.slice(0,-a.length))}if(u.thousandSeparator&&(e=e.replace(/,/g,"")),e.includes("e")){const a=e.match(/^[+-]?\d+(\.\d+)?(e[+-]?\d+)?/);if(!(a!=null&&a.length))return m;const n=a[0],c=parseFloat(n);let f="0.";const p=n.split("e")[0];f+="0".repeat(p.slice(1).length),f+="E+0";const d=m.slice(n.length);return d&&(f+=`"${d}"`),{value:c,numFmt:f}}const o=e.match(/^[+-]?\d+(\.\d+)?/);if(!(o!=null&&o.length))return m;const i=o[0],s=parseFloat(i),l=e.slice(i.length);let r="#";if(u.thousandSeparator&&(r+=",#"),Math.abs(s)<1&&(r="0"),u.type==="value")u.decimalCount>0&&(r+=`.${"0".repeat(u.decimalCount)}`);else if(i.indexOf(".")>-1){const a=i.split(".")[1].length;r+=`.${"0".repeat(a)}`}return l&&(r+=`"${l}"`),r+=`"${u.suffix}"`,{value:s,numFmt:r}}async function dc(m,u){var l,r;const{fields:e}=m.dataCfg,o=((l=e==null?void 0:e.rows)==null?void 0:l.length)||0,i=((r=e==null?void 0:e.values)==null?void 0:r.length)||0;if(!(o&&i)){Ue.warning(Vt("chart.pivot_export_invalid_field"));return}const{quotaPosition:s}=u.customAttr.basicStyle;u.customAttr.basicStyle.tableLayoutMode!=="tree"?s==="row"?Aa(m,u):va(m,u):s==="row"?_a(m,u):wa(m,u)}function La(m,u,e){var s;const{mergeCells:o}=T(m.customAttr).tableCell,{showIndex:i}=T(m.customAttr).tableHeader;if(o){u.frozenColCount=0,u.frozenRowCount=0;const r=(m.data.fields||[]).reduce((d,h)=>(d[h.dataeaseName]=h,d),{})||{},a=e.meta.findIndex(d=>{var h;return((h=r[d.field])==null?void 0:h.groupType)==="q"}),n=(s=m.data)==null?void 0:s.tableRow;if(a===0||!(n!=null&&n.length))return;const c=[[[0,n.length-1]]],f=[];e.meta.filter((d,h)=>h<a||a===-1).forEach((d,h)=>{const g=c[h],y=[];c.push(y),g.forEach(x=>{const[b,S]=x;let C=n[b][d.field],v=b;for(let A=b;A<=S;A++){const w=n[A][d.field];if(w!==C||A===S){const z=A-v;if(z>1||A===S&&z===1&&C===w){const k=[],N=z%2===1?(z-1)/2:z/2-1;for(let I=0;I<z;I++)k.push({colIndex:i?h+1:h,rowIndex:v+I,showText:I===N});A===S&&C===w&&k.push({colIndex:i?h+1:h,rowIndex:A,showText:!1}),f.push(k),y.push([v,A===S&&C===w?A:A-1])}C=w,v=A}}})}),i&&f.filter(h=>h[0].colIndex===1).forEach(h=>{const g=Q(h);g.forEach(y=>{y.colIndex=0}),f.unshift(g)}),u.mergedCellsInfo=f,u.mergedCell=(d,h,g)=>{var y;return i&&g.colIndex===0&&(g.fieldValue=Fs(f,g)),g.deFieldType=(y=r[g.valueField])==null?void 0:y.deType,new Ta(d,h,g)}}}function Fs(m,u){if(!(m!=null&&m.length))return u.rowIndex+1;let e=u.rowIndex;const o=m.reduce((i,s)=>{if(s[0].colIndex!==0)return i;const l=s[0].rowIndex,r=s[s.length-1].rowIndex,a=r-l;return u.rowIndex>=l&&u.rowIndex<=r&&(e=l),u.rowIndex>r?i+a:i},0);return e-o+1}class Ta extends Xi{drawBackgroundShape(){const u=Ol(this.cells),{backgroundColor:e}=this.getBackgroundColor(),o=this.theme.dataCell.cell;this.backgroundShape=Nl(this,{points:u,stroke:o.horizontalBorderColor,fill:e,lineHeight:o.horizontalBorderWidth})}drawTextShape(){this.meta.deFieldType===7?Bs.apply(this):super.drawTextShape()}}class Ke extends zl{hideInteractionShape(){this.stateShapes.forEach(u=>{Ne(u,Be.backgroundOpacity,0),Ne(u,Be.backgroundColor,"transparent"),Ne(u,Be.borderOpacity,0),Ne(u,Be.borderWidth,0),Ne(u,Be.borderColor,"transparent")})}drawTextShape(){this.meta.autoWrap?zs(this,!1):super.drawTextShape()}}class Ea extends Jo{drawTextShape(){this.meta.autoWrap?zs(this,!0):super.drawTextShape()}}const zs=(m,u)=>{const e=`
`,o="...",i=m.meta.maxLines??1,{options:{placeholder:s}}=m.spreadsheet,l=kl(void 0,s),{formattedValue:r}=m.getFormattedFieldValue(),a=m.getTextStyle();let n=Wo(r?r==null?void 0:r.toString():l,a,m.meta.width,m.spreadsheet);const c=n.split(e);let f=a.fontSize;if(u){const d=n.split(e);if(c.length>i){const h=d.slice(0,i),g=d[0].length;h[h.length-1]=h[h.length-1].slice(0,g-1)+o,n=h.join(e)}}else{const d=qo(n.replaceAll(e,""),a,m.spreadsheet,i),h=Math.floor(m.meta.height/d),g=c.slice(0,h);n=h<1?o:g.join(e)||o;const y=n.split(e);if(!n.endsWith(o)&&(c.length>i||c.length>h)){const x=y[0].length,b=y.slice(0,Math.min(i,h));b[b.length-1]=b[b.length-1].slice(0,x-1)+o,n=b.join(e)}n===o&&(f=12)}m.actualText=n,m.actualTextWidth=m.spreadsheet.measureTextWidth(n,a);const p=m.getTextPosition();m.textShape=Il(m,[m.textShape],p.x,p.y,n,a,{fontSize:f}),m.textShapes.push(m.textShape)},Li=(m,u,e,o,i)=>{if(e.showTableHeader===!1)return;const s=i||u.facet.layoutResult,l=o.maxLines??1,r={...u.theme.cornerCell.text},a=m.info.meta.value;let n=qo(Wo(a,r,m.info.resizedWidth,s.spreadsheet),r,s.spreadsheet,l);const c=s.colLeafNodes.filter(f=>f.colIndex!==m.info.meta.colIndex).reduce((f,p)=>{const d=qo(Wo(p.value,r,p.width,p.spreadsheet),r,p.spreadsheet,l);return d>f.height?{height:d,colIndex:p.colIndex}:f},{height:0});n=Math.max(n,c.height)+r.fontSize+10.5,i&&(o.tableColumnMode==="adapt"&&(n-=r.fontSize-2),s.colLeafNodes.forEach(f=>f.height=n),s.colsHierarchy.height=n),u.store.set("autoCalcHeight",n)},Wo=(m,u,e,o)=>{if(!m&&m!==0)return"";m=m.toString().trim();const i=a=>o.measureTextWidthRoughly(a,u);let s="",l="",r=0;for(let a=0;a<m.length;a++){const n=m[a],c=i(n);r+=c,l+=n;const f=n.charCodeAt(0)>=128?12:8;r>=e-u.fontSize-f&&(s+=l+(a!==m.length-1?`
`:""),l="",r=0)}return s+=l,s},qo=(m,u,e,o)=>{let i=0;for(const l of m){const r=u.fontSize/(l.charCodeAt(0)>=128?5:2.5);i=Math.max(i,e.measureTextHeight(l,u)+r)}const s=m.split(`
`).length;return Math.min(s,o)*i};function ks(m,u,e=[]){const o={SUMMARY:!0};for(let i=0;i<u.length;i++){const s=u[i].dataeaseName;let l=Rt(e,r=>r.field===s);if(l?(l.summary==null&&(l.summary="sum"),l.show==null&&(l.show=!0)):l={field:s,summary:"sum",show:!0},!!l.show)switch(l.summary){case"sum":o[s]=nl(m,s);break;case"avg":o[s]=Oo(m,s);break;case"max":o[s]=Di(ge(m,r=>parseFloat(r[s])!==void 0),r=>parseFloat(r[s]))[s];break;case"min":o[s]=Mi(ge(m,r=>parseFloat(r[s])!==void 0),r=>parseFloat(r[s]))[s];break;case"var_pop":if(m.length<2)continue;{const r=Oo(m,s),n=Ve(m,c=>{const p=new ee(c[s]??0).minus(r);return p.times(p)}).reduce((c,f)=>c.plus(f),new ee(0));o[s]=n.dividedBy(m.length-1).toNumber()}break;case"stddev_pop":if(m.length<2)continue;{const r=Oo(m,s),n=Ve(m,c=>{const p=new ee(c[s]??0).minus(r);return p.times(p)}).reduce((c,f)=>c.plus(f),new ee(0));o[s]=n.dividedBy(m.length-1).sqrt().toNumber()}break}}return o}class Is extends Ke{getTextStyle(){const u=Q(this.theme.colCell.bolderText);return u.textAlign=this.theme.dataCell.text.textAlign,u}getBackgroundColor(){const{backgroundColor:u,backgroundColorOpacity:e}=this.theme.colCell.cell;return{backgroundColor:u,backgroundColorOpacity:e}}}const Os=(m,u,e,o)=>{const i=()=>{const s=document.getElementById(o+"_empty");s&&s.parentElement.removeChild(s)};i(),!e.length&&m.on(Z.LAYOUT_AFTER_HEADER_LAYOUT,s=>{if(i(),!e.length){const l=document.createElement("div"),r=Math.min(m.options.width,s.colsHierarchy.width)/2-32;l.id=o+"_empty",l.textContent=Vt("data_set.no_data"),l.setAttribute("style",`position: absolute;
        left: ${r}px;
        top: 50%;`);const a=document.getElementById(o);a.insertBefore(l,a.firstChild)}})},Ns=m=>{const u=[],e=o=>{var i,s;if(!((i=o.children)!=null&&i.length)){u.push(o);return}for(let l=0;l<((s=o.children)==null?void 0:s.length);l++)e(o.children[l])};return m.forEach(o=>e(o)),u},ni=(m,u)=>{var o;const e=[];for(let i=0;i<u.length;i++)m.includes(u[i].key)&&e.push(u[i]),(o=u[i].children)!=null&&o.length&&e.push(...ni(m,u[i].children));return e};function Bs(){const m=new Image,{x:u,y:e,width:o,height:i,fieldValue:s}=this.meta;m.src=s,m.setAttribute("crossOrigin","anonymous"),m.onload=()=>{!this.cfg.children&&(this.cfg.children=[]);const{width:l,height:r}=m,a=Math.max(l/o,r/i),n=l/a*.8,c=r/a*.8;this.textShape=this.addShape("image",{attrs:{x:u+(n<o?(o-n)/2:0),y:e+(c<i?(i-c)/2:0),width:n,height:c,img:m}})}}function je(m){var u;return(u=m.children)!=null&&u.length?m.children.reduce((e,o)=>e+je(o),0):m.width}function Ge(m){var u;return(u=m.children)!=null&&u.length?Ge(m.children[0]):m.x}function Ms(m){return m!=null&&m.length?Math.max(...m.map(u=>{var e;return(e=u.children)!=null&&e.length?Ms(u.children)+1:1})):0}function Ds(m,u,e,o,i){if(!i||!u.length)return;const s=m.dataCfg.fields.columns,r=o.showTableHeader===!0?Ms(s)+1:1;m.on(Z.LAYOUT_BEFORE_RENDER,()=>{const a=o.tableTitleHeight*r+e.tableItemHeight*(u.length-1);a<m.container.cfg.height&&(m.options.height=a<m.container.cfg.height-8?a+8:a)})}class ri extends Lo{constructor(u,e){super(ue.S2,u,e)}configTheme(u){return da(u)}configStyle(u,e){return fa(u,e)}configEmptyDataStrategy(u){return ha(u)}configTooltip(u,e){Sa(u,e)}configHeaderInteraction(u,e){ba(u,e)}configConditions(u){return ma(u)}configMergeCells(u,e,o){La(u,e,o)}showTooltip(u,e,o){var n;const i=u.getCell(e.target),s=i.getMeta();let l="",r;switch(i.cellType){case"dataCell":case"mergedCell":if(s.valueField===Gi){l=s.fieldValue.toString();break}r=Rt(o,c=>c.field===s.valueField),s.fieldValue===0&&(l="0"),s.fieldValue&&(l=(n=r==null?void 0:r.formatter)==null?void 0:n.call(r,s.fieldValue));break;case"rowCell":case"colCell":l=s.label,r=Rt(o,c=>c.field===l),r&&(l=r.name);break}if(!l)return;e.s2Instance=u;const a=u.options.tooltip.style;ji(u.tooltip.container,{style:a}),u.showTooltip({position:{x:e.clientX,y:e.clientY},content:l,meta:s,event:e})}configTouchEvent(u,e,o){const{touchAction:i}=e;u.once(Z.LAYOUT_AFTER_RENDER,()=>{if(u.store.get("touchActionInit"))return;u.store.set("touchActionInit",!0);const l=u.getCanvasElement();let r=Date.now();l.addEventListener("touchstart",()=>{r=Date.now()}),l.addEventListener("touchend",a=>{var b;if(Date.now()-r>300)return;const c=l.getBoundingClientRect(),f=[a.changedTouches[0].pageX,a.changedTouches[0].pageY],p=[f[0]-c.x,f[1]-c.y],d=u.container.getShape(p[0],p[1]);if(((b=d.cfg)==null?void 0:b.type)==="image")return;const h=()=>{if(a.preventDefault(),a.stopPropagation(),d){const S={target:d,x:p[0],y:p[1],clientX:f[0],clientY:f[1],originEvent:a};this.showTooltip(u,S,o)}},g=u.getCell(d),y=g==null?void 0:g.getMeta();let x;if(y){const S=Rt(o,C=>C.field===y.valueField);x=S==null?void 0:S.id}i(h,x)})})}}const Ps=["background-overall-component","border-style","basic-style-selector","table-header-selector","table-cell-selector","title-selector","tooltip-selector","summary-selector","function-cfg","threshold","scroll-cfg","jump-set","linkage"],se={"border-style":["all"],"background-overall-component":["all"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha"],"table-header-selector":["tableHeaderBgColor","tableTitleFontSize","tableHeaderFontColor","tableTitleHeight","tableHeaderAlign","showIndex","indexLabel","showColTooltip","showHorizonBorder","showVerticalBorder"],"table-cell-selector":["tableItemBgColor","tableItemFontSize","tableFontColor","tableItemAlign","tableItemHeight","enableTableCrossBG","tableItemSubBgColor","showTooltip","showHorizonBorder","showVerticalBorder"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"function-cfg":["emptyDataStrategy"],threshold:["tableThreshold"]},{t:co}=U();class Fa extends Ke{drawTextShape(){Bs.apply(this)}}class za extends ri{constructor(){super("table-info",[]);_(this,"properties",Ps);_(this,"propertyInner",{...se,"table-header-selector":[...se["table-header-selector"],"tableHeaderSort","showTableHeader","headerGroup"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha","tablePageMode","showHoverStyle","autoWrap"],"table-cell-selector":[...se["table-cell-selector"],"tableFreeze","tableColumnFreezeHead","tableRowFreezeHead","mergeCells"],"summary-selector":["showSummary","summaryLabel"]});_(this,"axis",["xAxis","filter","drill"]);_(this,"axisConfig",{xAxis:{name:`${co("chart.drag_block_table_data_column")} / ${co("chart.dimension_or_quota")}`}})}drawChart(e){var N,I;const{container:o,chart:i,pageInfo:s,action:l,resizeAction:r}=e,a=document.getElementById(o);let n=((N=i.data)==null?void 0:N.fields)??[];const c=[],f=[],p=i.xAxis.reduce((F,M)=>(F[M.dataeaseName]=M,F),{}),d={};if(i.drill){const F=i.drillFilters.map(B=>B.fieldId),M=i.drillFields[0].id,E=i.xAxis.findIndex(B=>B.id===M),L=i.drillFields[F.length].id,O=n.find(B=>B.id===L);F.push(L),n=n.filter(B=>!F.includes(B.id)),d[O.dataeaseName]=i.drillFields[0].dataeaseName,n.splice(E,0,O)}n.forEach(F=>{const M=p[F.dataeaseName];(M==null?void 0:M.hide)!==!0&&(c.push(F.dataeaseName),f.push({field:F.dataeaseName,name:F.chartShowName??F.name,formatter:function(E){if(!M||E==null||![2,3,4].includes(M.deType)||!ho(E))return E;let L=M.formatterCfg;return L||(L=bo),D(E,L)},id:F.id}))});const{basicStyle:h,tableCell:g,tableHeader:y,tooltip:x}=T(i.customAttr),{headerGroup:b,showTableHeader:S}=y;if(b&&S!==!1){const{headerGroupConfig:F}=y;if((I=F==null?void 0:F.columns)!=null&&I.length){const M=c.map(O=>d[O]||O),L=Ns(F.columns).map(O=>O.key);if(Pi(L,M)){if(Object.keys(d).length){const O=Object.values(d)[0],B=Object.keys(d)[0],[$]=ni([O],F.columns);$.key=B}c.splice(0,c.length,...F.columns),f.push(...F.meta)}}}const C=this.configEmptyDataStrategy(i),v={fields:{columns:c},meta:f,data:C},A={width:a.getBoundingClientRect().width,height:a.offsetHeight,showSeriesNumber:y.showIndex,conditions:this.configConditions(i),tooltip:{getContainer:()=>a,renderTooltip:F=>new Es(F)},interaction:{hoverHighlight:h.showHoverStyle!==!1,scrollbarPosition:C.length?go.CONTENT:go.CANVAS}};if(A.style=this.configStyle(i,v),h.tableColumnMode==="adapt"){const F=n.filter(M=>{var E;return M.deType===7&&!((E=p[M.dataeaseName])!=null&&E.hide)});A.style.colCfg.widthByFieldValue=F==null?void 0:F.reduce((M,E)=>(M[E.chartShowName??E.name]=120,M),{})}g.tableFreeze&&!g.mergeCells&&(A.frozenColCount=g.tableColumnFreezeHead??0,A.frozenRowCount=g.tableRowFreezeHead??0),this.configTooltip(i,A),this.configMergeCells(i,A,v),y.showTableHeader===!1?(A.style.colCfg.height=1,g.showHorizonBorder===!1&&(A.style.colCfg.height=0),A.interaction.resize={colCellVertical:!1},A.colCell=(F,M,E)=>(F.label=" ",new Jo(F,M,E))):(i.container=o,this.configHeaderInteraction(i,A),A.colCell=(F,M,E)=>(F.autoWrap=g.mergeCells?!1:h.autoWrap,F.maxLines=h.maxLines,new Ea(F,M,E))),this.configSummaryRowAndIndex(i,s,A,v);const w=new Ui(a,v,A);Ds(w,C,g,y,h.showSummary),h.autoWrap&&!g.mergeCells&&(w.on(Z.LAYOUT_RESIZE_COL_WIDTH,F=>{Li(F,w,y,h,null)}),w.on(Z.LAYOUT_AFTER_HEADER_LAYOUT,F=>{var E;const M=w.store.get("autoCalcHeight");if(M)F.colLeafNodes.forEach(L=>L.height=M),F.colsHierarchy.height=M,w.store.set("autoCalcHeight",void 0);else if((E=F.colLeafNodes)!=null&&E.length){const{value:L,width:O}=F.colLeafNodes[0];Li({info:{meta:{value:L},resizedWidth:O}},w,y,h,F)}})),h.tableColumnMode==="adapt"&&(w.on(Z.LAYOUT_RESIZE_COL_WIDTH,()=>{w.store.set("lastLayoutResult",w.facet.layoutResult)}),w.on(Z.LAYOUT_AFTER_HEADER_LAYOUT,F=>{var W,Y;const M=w.store.get("lastLayoutResult");if(M){const V=(Y=(W=w.options.style)==null?void 0:W.colCfg)==null?void 0:Y.widthByFieldValue,G=(M==null?void 0:M.colLeafNodes.reduce((nt,zt)=>(nt[zt.value]=(V==null?void 0:V[zt.value])??zt.width,nt),{}))||{},Nt=F.colLeafNodes.reduce((nt,zt)=>(zt.width=G[zt.value]||zt.width,zt.x=nt,nt+zt.width),0);F.colNodes.forEach(nt=>{nt.colIndex===-1&&(nt.width=je(nt),nt.x=Ge(nt))}),F.colsHierarchy.width=Nt,w.store.set("lastLayoutResult",void 0);return}const E=n.filter(V=>{var G;return V.deType===7&&!((G=p[V.dataeaseName])!=null&&G.hide)}).map(V=>V.dataeaseName),L=F.colLeafNodes.reduce((V,G)=>V+(E.includes(G.field)?120:G.width),0),O=a.getBoundingClientRect().width;if(O<=L){F.colLeafNodes.reduce((V,G)=>(G.width=Math.round(G.width),G.x=V,V+G.width),0);return}const B=F.colLeafNodes.reduce((V,G)=>V+(E.includes(G.field)?0:G.width),0),R=(O-E.length*120)/B,H=F.colLeafNodes.reduce((V,G)=>(G.width=E.includes(G.field)?120:Math.round(G.width*R),G.x=V,V+G.width),0);F.colNodes.forEach(V=>{V.colIndex===-1&&(V.width=je(V),V.x=Ge(V))}),H>O&&(F.colLeafNodes[F.colLeafNodes.length-1].width-=H-O),F.colsHierarchy.width=O})),Os(w,h,C,o),w.on(Z.DATA_CELL_CLICK,F=>{const E=w.getCell(F.target).getMeta(),L=n.reduce((R,H)=>(R[H.dataeaseName]=H.id,R),{}),O=w.dataSet.getRowData(E),B=[];for(const R in O)L[R]&&B.push({id:L[R],value:O[R]});const $={x:F.x,y:F.y,data:{dimensionList:B,name:L[E.valueField],sourceType:"table-info",quotaList:[]}};l($)}),w.on(Z.MERGED_CELLS_CLICK,F=>w.emit(Z.DATA_CELL_CLICK,F));const{show:z}=x;z&&(w.on(Z.COL_CELL_HOVER,F=>this.showTooltip(w,F,f)),w.on(Z.DATA_CELL_HOVER,F=>this.showTooltip(w,F,f)),w.on(Z.MERGED_CELLS_HOVER,F=>this.showTooltip(w,F,f)),this.configTouchEvent(w,e,f)),w.on(Z.LAYOUT_RESIZE_COL_WIDTH,F=>r(F)),w.on(Z.GLOBAL_CONTEXT_MENU,F=>li(w,F,f));const k=this.configTheme(i);return w.setThemeCfg({theme:k}),w}configTheme(e){const o=super.configTheme(e),{basicStyle:i,tableCell:s}=T(e.customAttr);if(s.mergeCells){const l=q(s.tableFontColor,i.alpha);let r=s.tableItemBgColor;Lt(r)||(r=q(r,i.alpha));const{tableBorderColor:a}=i,{tableItemAlign:n,tableItemFontSize:c}=s,f=s.isItalic?"italic":"normal",p=s.isBolder===!1?"normal":"bold",d={dataCell:{cell:{crossBackgroundColor:r}},mergedCell:{cell:{backgroundColor:r,crossBackgroundColor:r,horizontalBorderColor:a,verticalBorderColor:a,horizontalBorderWidth:s.showHorizonBorder?1:0,verticalBorderWidth:s.showVerticalBorder?1:0},bolderText:{fill:l,textAlign:n,fontSize:c,fontStyle:f,fontWeight:p},text:{fill:l,textAlign:n,fontSize:c,fontStyle:f,fontWeight:p},measureText:{fill:l,textAlign:n,fontSize:c,fontStyle:f,fontWeight:p},seriesText:{fill:l,textAlign:n,fontSize:c,fontStyle:f,fontWeight:p}}};kt(o,d)}return o}configSummaryRowAndIndex(e,o,i,s){var h;const{tableHeader:l,basicStyle:r,tableCell:a}=T(e.customAttr),n=((h=e.data)==null?void 0:h.fields)??[];if(i.showSeriesNumber){let g=l.indexLabel;g||(g=""),i.layoutCoordinate=(y,x,b)=>{b.colIndex===0&&b.rowIndex===0&&(b.label=g,b.value=g)}}const{showSummary:c,summaryLabel:f}=r,p=s.data,d=e.xAxis;if(c&&(p!=null&&p.length)){const g={};g[p.length]=l.tableTitleHeight,i.style.rowCfg={heightByField:g},i.frozenTrailingRowCount=1;const y=ge(d,b=>[2,3,4].includes(b.deType)),x=ks(p,y,r.seriesSummary);p.push(x)}i.dataCell=g=>{var x;if(c&&g.rowIndex===p.length-1)return g.colIndex===0&&(l.showIndex?g.fieldValue=f??co("chart.total_show"):[2,3,4].includes((x=d==null?void 0:d[0])==null?void 0:x.deType)||(g.fieldValue=f??co("chart.total_show"))),new Is(g,g==null?void 0:g.spreadsheet);const y=n.find(b=>b.dataeaseName===g.valueField);return(y==null?void 0:y.deType)===7&&e.showPosition!=="dialog"?new Fa(g,g==null?void 0:g.spreadsheet):(g.colIndex===0&&i.showSeriesNumber&&(a.mergeCells?g.fieldValue=Fs(i.mergedCellsInfo,g):g.fieldValue=o.pageSize*(o.currentPage-1)+g.rowIndex+1),g.autoWrap=a.mergeCells?!1:r.autoWrap,g.maxLines=r.maxLines,new Ke(g,g==null?void 0:g.spreadsheet))}}}const ka=Object.freeze(Object.defineProperty({__proto__:null,TableInfo:za},Symbol.toStringTag,{value:"Module"})),{t:$e}=U();class Ia extends ri{constructor(){super("table-normal",[]);_(this,"properties",Ps);_(this,"propertyInner",{...se,"table-header-selector":[...se["table-header-selector"],"tableHeaderSort","showTableHeader","headerGroup"],"basic-style-selector":[...se["basic-style-selector"],"tablePageMode","showHoverStyle"],"table-cell-selector":[...se["table-cell-selector"],"tableFreeze","tableColumnFreezeHead","tableRowFreezeHead"],"summary-selector":["showSummary","summaryLabel"]});_(this,"axis",["xAxis","yAxis","drill","filter"]);_(this,"axisConfig",{xAxis:{name:`${$e("chart.drag_block_table_data_column")} / ${$e("chart.dimension")}`,type:"d"},yAxis:{name:`${$e("chart.drag_block_table_data_column")} / ${$e("chart.quota")}`,type:"q"}})}setupDefaultOptions(e){return e.xAxis=[],e}drawChart(e){var N;const{container:o,chart:i,action:s,pageInfo:l,resizeAction:r}=e,a=document.getElementById(o);if(!a)return;let n=i.data.fields;const c=[],f=[],p={};if(i.drill){const I=i.drillFilters.map(O=>O.fieldId),F=i.drillFields[0].id,M=i.xAxis.findIndex(O=>O.id===F),E=i.drillFields[I.length].id,L=n.find(O=>O.id===E);I.push(E),n=n.filter(O=>!I.includes(O.id)),p[L.dataeaseName]=i.drillFields[0].dataeaseName,n.splice(M,0,L)}const d=[...i.xAxis,...i.yAxis].reduce((I,F)=>(I[F.dataeaseName]=F,I),{});n.forEach(I=>{const F=d[I.dataeaseName];(F==null?void 0:F.hide)!==!0&&(c.push(I.dataeaseName),f.push({field:I.dataeaseName,name:I.chartShowName??I.name,formatter:function(M){if(!F||M==null||![2,3,4].includes(F.deType)||!ho(M))return M;let E=F.formatterCfg;return E||(E=bo),D(M,E)},id:I.id}))});const{basicStyle:h,tableCell:g,tableHeader:y,tooltip:x}=T(i.customAttr),{headerGroup:b,showTableHeader:S}=y;if(b&&S!==!1){const{headerGroupConfig:I}=y;if((N=I==null?void 0:I.columns)!=null&&N.length){const F=c.map(L=>p[L]||L),E=Ns(I.columns).map(L=>L.key);if(Pi(E,F)){if(Object.keys(p).length){const L=Object.values(p)[0],O=Object.keys(p)[0],[B]=ni([L],I.columns);B.key=O}c.splice(0,c.length,...I.columns),f.push(...I.meta)}}}const C=this.configEmptyDataStrategy(i),v={fields:{columns:c},meta:f,data:C},A={width:a.getBoundingClientRect().width,height:a.offsetHeight,showSeriesNumber:y.showIndex,conditions:this.configConditions(i),tooltip:{getContainer:()=>a,renderTooltip:I=>new Es(I)},interaction:{hoverHighlight:h.showHoverStyle!==!1,scrollbarPosition:C.length?go.CONTENT:go.CANVAS}};A.style=this.configStyle(i,v),g.tableFreeze&&(A.frozenColCount=g.tableColumnFreezeHead??0,A.frozenRowCount=g.tableRowFreezeHead??0),this.configTooltip(i,A),y.showTableHeader===!1?(A.style.colCfg.height=1,g.showHorizonBorder===!1&&(A.style.colCfg.height=0),A.interaction.resize={colCellVertical:!1},A.colCell=(I,F,M)=>(I.label=" ",new Jo(I,F,M))):(i.container=o,this.configHeaderInteraction(i,A)),this.configSummaryRowAndIndex(i,l,A,v);const w=new Ui(a,v,A);Ds(w,C,g,y,h.showSummary),h.tableColumnMode==="adapt"&&(w.on(Z.LAYOUT_RESIZE_COL_WIDTH,()=>{w.store.set("lastLayoutResult",w.facet.layoutResult)}),w.on(Z.LAYOUT_AFTER_HEADER_LAYOUT,I=>{var O,B;const F=w.store.get("lastLayoutResult");if(F){const $=(B=(O=w.options.style)==null?void 0:O.colCfg)==null?void 0:B.widthByFieldValue,R=(F==null?void 0:F.colLeafNodes.reduce((W,Y)=>(W[Y.value]=($==null?void 0:$[Y.value])??Y.width,W),{}))||{},H=I.colLeafNodes.reduce((W,Y)=>(Y.width=R[Y.value]||Y.width,Y.x=W,W+Y.width),0);I.colNodes.forEach(W=>{W.colIndex===-1&&(W.width=je(W),W.x=Ge(W))}),I.colsHierarchy.width=H,w.store.set("lastLayoutResult",void 0);return}const M=a.getBoundingClientRect().width,E=M/I.colsHierarchy.width;if(E<=1){I.colLeafNodes.reduce(($,R)=>(R.width=Math.round(R.width),R.x=$,$+R.width),0);return}const L=I.colLeafNodes.reduce(($,R)=>(R.width=Math.round(R.width*E),R.x=$,$+R.width),0);I.colNodes.forEach($=>{$.colIndex===-1&&($.width=je($),$.x=Ge($))}),L>M&&(I.colLeafNodes[I.colLeafNodes.length-1].width-=L-M),I.colsHierarchy.width=M})),Os(w,h,C,o),w.on(Z.DATA_CELL_CLICK,I=>{const M=w.getCell(I.target).getMeta(),E=n.reduce(($,R)=>($[R.dataeaseName]=R.id,$),{}),L=w.dataSet.getRowData(M),O=[];for(const $ in L)E[$]&&O.push({id:E[$],value:L[$]});const B={x:I.x,y:I.y,data:{dimensionList:O,name:E[M.valueField],sourceType:"table-normal",quotaList:[]}};s(B)});const{show:z}=x;z&&(w.on(Z.COL_CELL_HOVER,I=>this.showTooltip(w,I,f)),w.on(Z.DATA_CELL_HOVER,I=>this.showTooltip(w,I,f)),this.configTouchEvent(w,e,f)),w.on(Z.LAYOUT_RESIZE_COL_WIDTH,I=>r(I)),w.on(Z.GLOBAL_CONTEXT_MENU,I=>li(w,I,f));const k=this.configTheme(i);return w.setThemeCfg({theme:k}),w}configSummaryRowAndIndex(e,o,i,s){const{tableHeader:l,basicStyle:r}=T(e.customAttr);if(i.showSeriesNumber){let d=l.indexLabel;d||(d=""),i.layoutCoordinate=(h,g,y)=>{y.colIndex===0&&y.rowIndex===0&&(y.label=d,y.value=d)}}const{showSummary:a,summaryLabel:n}=r,c=s.data,{xAxis:f,yAxis:p}=e;if(a&&(c!=null&&c.length)){const d={};d[c.length]=l.tableTitleHeight,i.style.rowCfg={heightByField:d},i.frozenTrailingRowCount=1;const h=ks(c,p,r.seriesSummary);c.push(h)}i.dataCell=d=>a&&d.rowIndex===c.length-1?(d.colIndex===0&&(l.showIndex||f!=null&&f.length)&&(d.fieldValue=n??$e("chart.total_show")),new Is(d,d==null?void 0:d.spreadsheet)):(d.colIndex===0&&i.showSeriesNumber&&(d.fieldValue=o.pageSize*(o.currentPage-1)+d.rowIndex+1),new Ke(d,d==null?void 0:d.spreadsheet))}}const Oa=Object.freeze(Object.defineProperty({__proto__:null,TableNormal:Ia},Symbol.toStringTag,{value:"Module"})),{t:te}=U();class Na extends Ml{getTotalValue(u,e){const{options:o}=this.spreadsheet,s=ml(e)?e:this.getTotalStatus(u),{aggregation:l,calcFunc:r}=Ra(s,o==null?void 0:o.totals)||{},a=j(o==null?void 0:o.totals)&&!this.spreadsheet.isHierarchyTreeType()?He.SUM:"",n=Ha[l||a];if(n||r){const c=this.getMultiData(u,{queryType:Dl.DetailOnly});let f;return r?f=r(u,c,this.spreadsheet,s):n&&(f=n(c,yi)),{...u,[yi]:f,[u[vt]]:f}}}}class Ba extends ri{constructor(){super("table-pivot",[]);_(this,"properties",["border-style","background-overall-component","basic-style-selector","table-header-selector","table-cell-selector","table-total-selector","title-selector","tooltip-selector","function-cfg","threshold","linkage","jump-set"]);_(this,"propertyInner",{...se,"table-header-selector":["tableHeaderBgColor","tableTitleFontSize","tableHeaderFontColor","tableTitleHeight","tableHeaderAlign","showColTooltip","showRowTooltip","showHorizonBorder","showVerticalBorder","rowHeaderFreeze"],"table-total-selector":["row","col"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha","tableLayoutMode","showHoverStyle","quotaPosition","quotaColLabel"]});_(this,"axis",["xAxis","xAxisExt","yAxis","filter"]);_(this,"axisConfig",{xAxis:{name:`${te("chart.table_pivot_row")} / ${te("chart.dimension")}`,type:"d"},xAxisExt:{name:`${te("chart.drag_block_table_data_column")} / ${te("chart.dimension")}`,type:"d",allowEmpty:!0},yAxis:{name:`${te("chart.drag_block_table_data_column")} / ${te("chart.quota")}`,type:"q"}})}drawChart(e){var $,R,H,W,Y,V,G,Nt,nt,zt;const{container:o,chart:i,chartObj:s,action:l}=e,r=document.getElementById(o),{xAxisExt:a,xAxis:n,yAxis:c}=i,[f,p,d]=[a,n,c].map(P=>P.map(J=>J.dataeaseName)),{fields:h,customCalc:g}=i.data;if(!h||h.length===0){s&&s.destroy();return}const y=[],x=[],b=[...i.xAxis,...i.xAxisExt,...i.yAxis].reduce((P,J)=>(P[J.dataeaseName]=J,P),{});h.forEach(P=>{const J=b[P.dataeaseName];y.push(P.dataeaseName),x.push({field:P.dataeaseName,name:P.chartShowName??P.name,formatter:X=>!J||X==null||![2,3,4].includes(J.deType)||!ho(X)?X:J.formatterCfg?D(X,J.formatterCfg):D(X,bo),id:P.id})});const{basicStyle:S,tooltip:C,tableTotal:v,tableHeader:A}=T(i.customAttr);(!v.row.subTotalsDimensionsNew||v.row.subTotalsDimensions==null)&&(v.row.subTotalsDimensions=p),v.col.subTotalsDimensions=f;const w=[];let z=!1;v.row.totalSort&&v.row.totalSort!=="none"&&f.length>0&&v.row.showGrandTotals&&d.indexOf(v.row.totalSortField)>-1&&(f.forEach(P=>{const J={sortFieldId:P,sortMethod:v.row.totalSort.toUpperCase(),sortByMeasure:No,query:{[vt]:v.row.totalSortField}};w.push(J)}),z=!0);let k=!1;if(v.col.totalSort&&v.col.totalSort!=="none"&&p.length>0&&v.col.showGrandTotals&&d.indexOf(v.col.totalSortField)>-1&&(p.forEach(P=>{const J={sortFieldId:P,sortMethod:v.col.totalSort.toUpperCase(),sortByMeasure:No,query:{[vt]:v.col.totalSortField}};w.push(J)}),k=!0),!(a!=null&&a.length)){const P=c==null?void 0:c.find(J=>!["none","custom_sort"].includes(J.sort));if(P){const J={sortFieldId:p[0],sortMethod:P.sort.toUpperCase(),sortByMeasure:No,query:{[vt]:P.dataeaseName}};w.push(J)}}const N=[v.row.calcTotals,v.row.calcSubTotals,v.col.calcTotals,v.col.calcSubTotals],I={row:i.xAxis,col:i.xAxisExt,quota:i.yAxis};($=i.xAxisExt)!=null&&$.length||(S.tableLayoutMode==="tree"?(v.col.calcTotals=v.row.calcSubTotals,(R=v.col.calcTotals.cfg)!=null&&R.length||(v.col.calcTotals.cfg=i.yAxis.map(P=>({dataeaseName:P.dataeaseName,aggregation:"SUM"})))):v.col.calcTotals.calcFunc=()=>"-"),N.forEach(P=>{var J;if((J=P.cfg)!=null&&J.length){delete P.aggregation;const X=P.cfg.reduce((tt,ut)=>(tt[ut.dataeaseName]=ut,tt),{});P.calcFunc=(tt,ut,Bt,Mt)=>Ma(tt,ut,Mt,i,X,I,g)}});const F=this.configEmptyDataStrategy(i);z||f==null||f.forEach((P,J)=>{var ut,Bt,Mt,Ut;if(((ut=b[P])==null?void 0:ut.sort)==="none")return;const X={sortFieldId:P},tt=(Mt=(Bt=b[P])==null?void 0:Bt.sort)==null?void 0:Mt.toUpperCase();if(tt==="CUSTOM_SORT")X.sortBy=b[P].customSort;else if([2,3,4].includes((Ut=b[P])==null?void 0:Ut.deType)){const Wt=F.map(ot=>ot[P]),wt=[...new Set(Wt)];wt.sort((ot,pt)=>tt==="ASC"?ot-pt:pt-ot),X.sortBy=wt}else if(J===0)X.sortMethod=tt;else{const Wt=F.map(ot=>ot[P]),wt=[...new Set(Wt)];wt.sort((ot,pt)=>!ot&&!pt?0:ot?pt?tt==="ASC"?ot.localeCompare(pt):pt.localeCompare(ot):tt==="ASC"?1:-1:tt==="ASC"?-1:1),X.sortBy=wt}w.push(X)}),k||p==null||p.forEach((P,J)=>{var ut,Bt,Mt,Ut;if(((ut=b[P])==null?void 0:ut.sort)==="none")return;const X={sortFieldId:P},tt=(Mt=(Bt=b[P])==null?void 0:Bt.sort)==null?void 0:Mt.toUpperCase();if(tt==="CUSTOM_SORT")X.sortBy=b[P].customSort;else if([2,3,4].includes((Ut=b[P])==null?void 0:Ut.deType)){const Wt=F.map(ot=>ot[P]),wt=[...new Set(Wt)];wt.sort((ot,pt)=>tt==="ASC"?ot-pt:pt-ot),X.sortBy=wt}else if(J===0)X.sortMethod=tt;else{const Wt=F.map(ot=>ot[P]),wt=[...new Set(Wt)];wt.sort((ot,pt)=>!ot&&!pt?0:ot?pt?tt==="ASC"?ot.localeCompare(pt):pt.localeCompare(ot):tt==="ASC"?1:-1:tt==="ASC"?-1:1),X.sortBy=wt}w.push(X)});const M={fields:{rows:p,columns:f,values:d,valueInCols:S.quotaPosition!=="row"},meta:x,data:F,sortParams:w},E={width:r.offsetWidth,height:r.offsetHeight,totals:v,cornerExtraFieldText:S.quotaColLabel??te("dataset.value"),conditions:this.configConditions(i),tooltip:{getContainer:()=>r},hierarchyType:S.tableLayoutMode??"grid",dataSet:P=>new Na(P),interaction:{hoverHighlight:S.showHoverStyle!==!1},dataCell:P=>new Ke(P,P.spreadsheet),frozenRowHeader:A.rowHeaderFreeze!==!1};if(E.style=this.configStyle(i,M),S.tableLayoutMode==="tree"){const{defaultExpandLevel:P}=S;ho(P)&&(P>=i.xAxis.length?E.style.rowExpandDepth=P:E.style.rowExpandDepth=P-2),P==="all"&&(E.style.rowExpandDepth=i.xAxis.length),P||(E.style.hierarchyCollapse=!0)}if(!(S.quotaPosition==="row"&&S.tableLayoutMode==="tree")){if(S.quotaPosition!=="row"&&((H=i.xAxisExt)!=null&&H.length)&&((W=i.yAxis)==null?void 0:W.length)>1&&v.col.showGrandTotals&&((V=(Y=v.col.calcTotals)==null?void 0:Y.cfg)!=null&&V.length)){const P=v.col.calcTotals.cfg.reduce((J,X)=>(J[X.dataeaseName]=X,J),{});E.layoutCoordinate=(J,X,tt)=>{var ut;tt!=null&&tt.isGrandTotals&&(ut=P[tt.value])!=null&&ut.label&&(tt.label=P[tt.value].label)}}if(S.quotaPosition==="row"&&((G=i.xAxisExt)!=null&&G.length)&&((Nt=i.yAxis)==null?void 0:Nt.length)>1&&v.row.showGrandTotals&&((zt=(nt=v.row.calcTotals)==null?void 0:nt.cfg)!=null&&zt.length)){const P=v.row.calcTotals.cfg.reduce((J,X)=>(J[X.dataeaseName]=X,J),{});E.layoutCoordinate=(J,X,tt)=>{var ut;X!=null&&X.isGrandTotals&&(ut=P[X.value])!=null&&ut.label&&(X.label=P[X.value].label)}}}this.configTooltip(i,E);const L=new Bl(r,M,E);S.tableColumnMode==="adapt"&&(L.on(Z.LAYOUT_RESIZE_COL_WIDTH,()=>{L.store.set("lastLayoutResult",L.facet.layoutResult)}),L.on(Z.LAYOUT_RESIZE_ROW_WIDTH,()=>{L.store.set("lastLayoutResult",L.facet.layoutResult)}),L.on(Z.LAYOUT_RESIZE_TREE_WIDTH,()=>{L.store.set("lastLayoutResult",L.facet.layoutResult)}),L.on(Z.LAYOUT_AFTER_HEADER_LAYOUT,P=>{var Ut,Wt,wt,ot,pt;const J=L.store.get("lastLayoutResult");if(J){const dt=(Wt=(Ut=L.options.style)==null?void 0:Ut.colCfg)==null?void 0:Wt.widthByFieldValue,Tt=(ot=(wt=L.options.style)==null?void 0:wt.rowCfg)==null?void 0:ot.widthByField,ci=((pt=L.options.style)==null?void 0:pt.treeRowsWidth)||J.rowsHierarchy.width,Vs=J.colLeafNodes.reduce((Ct,Dt)=>(Ct[Dt.id]=(dt==null?void 0:dt[Dt.value])??Dt.width,Ct),{})||{},ui=P.colLeafNodes.reduce((Ct,Dt)=>(Dt.width=Vs[Dt.id]||Dt.width,Dt.x=Ct,Ct+Dt.width),0);if(P.colNodes.forEach(Ct=>{Ct.isLeaf||(Ct.width=this.getColWidth(Ct),Ct.x=this.getLeftChild(Ct).x)}),S.tableLayoutMode==="tree")P.rowNodes.forEach(Ct=>{Ct.width=ci}),P.rowsHierarchy.width=ci,P.colsHierarchy.width=ui;else{const Ct=J.rowNodes.reduce((xt,Et)=>(xt[Et.id]=(Tt==null?void 0:Tt[Et.field])??Et.width,xt),{})||{};P.rowNodes.forEach(xt=>{xt.x=0,xt.width=Ct[xt.id]||xt.width;let Et=xt;for(;Et.parent.id!=="root";)xt.x+=Et.parent.width,Et=Et.parent});const Dt=P.rowsHierarchy.sampleNodesForAllLevels.reduce((xt,Et)=>xt+Et.width,0),di=P.rowsHierarchy.maxLevel;P.rowNodes.forEach(xt=>{if(xt.isTotalRoot||xt.isSubTotals&&xt.level<di){let Et=0;for(let ko=xt.level;ko<=di;ko++)Et+=P.rowsHierarchy.sampleNodesForAllLevels[ko].width;xt.width=Et}}),P.rowsHierarchy.width=Dt,P.colsHierarchy.width=ui}L.store.set("lastLayoutResult",void 0);return}const X=r.getBoundingClientRect().width,tt=X/(P.colsHierarchy.width+P.rowsHierarchy.width);if(tt<=1)return;const ut=Math.round(P.rowsHierarchy.width*tt);P.rowNodes.forEach(dt=>{dt.width=Math.round(dt.width*tt)}),S.tableLayoutMode!=="tree"&&P.rowNodes.forEach(dt=>{dt.x=0;let Tt=dt;for(;Tt.parent.id!=="root";)dt.x+=Tt.parent.width,Tt=Tt.parent});let Bt=P.colLeafNodes.reduce((dt,Tt)=>(Tt.width=Math.round(Tt.width*tt),Tt.x=dt,dt+Tt.width),0);P.colNodes.forEach(dt=>{dt.isLeaf||(dt.width=this.getColWidth(dt),dt.x=this.getLeftChild(dt).x)});const Mt=Bt+ut;Mt>X&&(P.colLeafNodes[P.colLeafNodes.length-1].width-=Mt-X,Bt=Bt-(Mt-X)),P.colsHierarchy.width=Bt,P.rowsHierarchy.width=ut}));const{show:O}=C;O&&(L.on(Z.COL_CELL_HOVER,P=>this.showTooltip(L,P,x)),L.on(Z.ROW_CELL_HOVER,P=>this.showTooltip(L,P,x)),L.on(Z.DATA_CELL_HOVER,P=>this.showTooltip(L,P,x)),this.configTouchEvent(L,e,x)),qa(L,F),L.on(Z.DATA_CELL_CLICK,P=>this.dataCellClickAction(i,P,L,l)),L.on(Z.ROW_CELL_CLICK,P=>this.headerCellClickAction(i,P,L,l)),L.on(Z.COL_CELL_CLICK,P=>this.headerCellClickAction(i,P,L,l)),L.on(Z.GLOBAL_CONTEXT_MENU,P=>li(L,P,x));const B=this.configTheme(i);return L.setThemeCfg({theme:B}),L}getColWidth(e){var i;let o=0;return(i=e.children)!=null&&i.length?e.children.forEach(s=>{o+=this.getColWidth(s)}):o=e.width,o}getLeftChild(e){var o;return(o=e.children)!=null&&o.length?this.getLeftChild(e.children[0]):e}dataCellClickAction(e,o,i,s){const r=i.getCell(o.target).getMeta(),a=e.data.fields.reduce((p,d)=>(p[d.dataeaseName]=d.id,p),{}),n={...r.rowQuery,...r.colQuery};n[r.valueField]=r.fieldValue;const c=[];for(const p in n)a[p]&&c.push({id:a[p],value:n[p]});const f={x:o.x,y:o.y,data:{dimensionList:c,name:a[r.valueField],sourceType:"table-pivot",quotaList:[]}};s(f)}headerCellClickAction(e,o,i,s){const r=i.getCell(o.target).getMeta(),a=r.query,n=e.data.fields.reduce((p,d)=>(p[d.dataeaseName]=d.id,p),{}),c=[];for(const p in a)n[p]&&c.push({id:n[p],value:a[p]});const f={x:o.x,y:o.y,data:{dimensionList:c,name:n[r.valueField],sourceType:"table-pivot",quotaList:[]}};s(f)}configTheme(e){const o=super.configTheme(e),{basicStyle:i,tableHeader:s}=T(e.customAttr);let l=s.tableHeaderBgColor;Lt(l)||(l=q(l,i.alpha));let r=s.tableHeaderCornerBgColor??rt.tableHeaderCornerBgColor;Lt(r)||(r=q(r,i.alpha));let a=s.tableHeaderColBgColor??rt.tableHeaderColBgColor;Lt(a)||(a=q(a,i.alpha));let n=i.tableBorderColor;Lt(n)||(n=q(n,i.alpha));const c=q(s.tableHeaderColFontColor,i.alpha),f=q(s.tableHeaderCornerFontColor,i.alpha),p=s.isColItalic?"italic":"normal",d=s.isCornerItalic?"italic":"normal",h=s.isColBolder===!1?"normal":"bold",g=s.isCornerBolder===!1?"normal":"bold",y={rowCell:{cell:{backgroundColor:a,horizontalBorderColor:n,verticalBorderColor:n},text:{fill:c,fontSize:s.tableTitleColFontSize,textAlign:s.tableHeaderColAlign,textBaseline:"top",fontStyle:p,fontWeight:h},bolderText:{fill:c,fontSize:s.tableTitleColFontSize,textAlign:s.tableHeaderColAlign,fontStyle:p,fontWeight:h},measureText:{fill:c,fontSize:s.tableTitleColFontSize,textAlign:s.tableHeaderColAlign,fontStyle:p,fontWeight:h},seriesText:{fill:c,fontSize:s.tableTitleColFontSize,textAlign:s.tableHeaderColAlign,fontStyle:p,fontWeight:h}},cornerCell:{cell:{backgroundColor:r},text:{fill:f,fontSize:s.tableTitleCornerFontSize,textAlign:s.tableHeaderCornerAlign,fontStyle:d,fontWeight:g},bolderText:{fill:f,fontSize:s.tableTitleCornerFontSize,textAlign:s.tableHeaderCornerAlign,fontStyle:d,fontWeight:g},measureText:{fill:f,fontSize:s.tableTitleCornerFontSize,textAlign:s.tableHeaderCornerAlign,fontStyle:d,fontWeight:g}},dataCell:{bolderText:{fontWeight:"bold"}}};return kt(o,y),s.showHorizonBorder===!1&&kt(o,{cornerCell:{cell:{horizontalBorderColor:l,horizontalBorderWidth:0}},rowCell:{cell:{horizontalBorderColor:l,horizontalBorderWidth:0}}}),s.showVerticalBorder===!1&&kt(o,{cornerCell:{cell:{verticalBorderColor:l,verticalBorderWidth:0}},rowCell:{cell:{verticalBorderColor:l,verticalBorderWidth:0}}}),o}setupDefaultOptions(e){const{customAttr:o}=e;return o.basicStyle.tableColumnMode==="field"&&(o.basicStyle.tableColumnMode="custom"),e}}function Ma(m,u,e,o,i,s,l){var a;if(!(u!=null&&u.length)||!m[vt])return"-";switch(((a=i[m[vt]])==null?void 0:a.aggregation)||"SUM"){case"SUM":return u.reduce((n,c)=>n+parseFloat(c[m[vt]]??0),0);case"AVG":return u.reduce((c,f)=>c+parseFloat(f[m[vt]]??0),0)/u.length;case"MIN":{const n=Mi(u,c=>parseFloat(c[m[vt]]));return n==null?void 0:n[m[vt]]}case"MAX":{const n=Di(u,c=>parseFloat(c[m[vt]]));return n==null?void 0:n[m[vt]]}case"NONE":return"-";case"CUSTOM":{const n=$a(m,s,o,e,l||{});return n===""||n===void 0?"-":parseFloat(n)}default:return u.reduce((n,c)=>n+parseFloat(c[m[vt]]??0),0)}}function Da(m,u,e,o){var r,a,n,c,f,p,d,h,g;const i=m[vt],{row:s,col:l}=u;if(e.isRowTotal&&e.isColTotal)return(a=(r=o.rowColTotal)==null?void 0:r.data)==null?void 0:a[i];if(e.isColTotal&&!e.isRowSubTotal){const{colTotal:y,rowSubInColTotal:x}=o,b=ht(m,s);let S;if(b.length){const C=It(m,s);if(C+1===s.length&&y&&(b.push(i),S=gt(y.data,b)),C+1<s.length&&x){const v=(n=x==null?void 0:x[C])==null?void 0:n.data;b.push(i),S=gt(v,b)}}return S}if(e.isColSubTotal&&!e.isRowTotal&&!e.isRowSubTotal){const{colSubTotal:y}=o,x=It(m,l),b=It(m,s),S=ht(m,s),C=ht(m,l),v=[...S,...C];let A=(c=y==null?void 0:y[x])==null?void 0:c.data;if(S.length<s.length){const{rowSubInColSub:z}=o;A=(p=(f=z==null?void 0:z[b])==null?void 0:f[x])==null?void 0:p.data}let w;return v.length&&A&&(v.push(i),w=gt(A,v)),w}if(e.isRowTotal&&!e.isColSubTotal){const{rowTotal:y}=o,x=ht(m,l);let b;return y&&(x.length&&(x.push(i),b=gt(y.data,x)),!l.length&&s.length&&(b=gt(y.data,i))),b}if(e.isRowSubTotal&&(!e.isColTotal&&!e.isColSubTotal||!l.length&&e.isColTotal&&e.isRowSubTotal)){const{rowSubTotal:y}=o,x=It(m,s),b=ht(m,l),S=ht(m,s),C=[...b,...S],v=(d=y==null?void 0:y[x])==null?void 0:d.data;let A;return C.length&&y&&(C.push(i),A=gt(v,C)),A}if(e.isRowTotal&&e.isColSubTotal){const{colSubInRowTotal:y}=o,x=It(m,l),b=(h=y==null?void 0:y[x])==null?void 0:h.data,S=ht(m,l);let C;return S.length&&y&&(S.push(i),C=gt(b,S)),C}if(e.isColTotal&&e.isRowSubTotal){const{rowSubInColTotal:y}=o,x=It(m,s),b=(g=y==null?void 0:y[x])==null?void 0:g.data,S=ht(m,s);let C;return S.length&&y&&(S.push(i),C=gt(b,S)),C}return"-"}function Pa(m,u,e,o){var r,a,n,c,f,p,d,h;const i=m[vt],{row:s,col:l}=u;if(e.isRowTotal&&e.isColTotal)return(a=(r=o.rowColTotal)==null?void 0:r.data)==null?void 0:a[i];if(e.isColTotal&&!e.isRowSubTotal){const{colTotal:g}=o,y=ht(m,s);let x;return y.length&&g&&(y.push(i),x=gt(g.data,y)),x}if(e.isColSubTotal&&!e.isRowTotal&&!e.isRowSubTotal){const{colSubTotal:g}=o,y=It(m,l),x=ht(m,s),b=ht(m,l),S=[...x,...b],C=(n=g==null?void 0:g[y])==null?void 0:n.data;let v;return S.length&&C&&(S.push(i),v=gt(C,S)),v}if(e.isRowTotal&&!e.isColSubTotal){const{rowTotal:g}=o,y=ht(m,l);let x;return g&&(y.length&&(y.push(i),x=gt(g.data,y)),!l.length&&s.length&&(x=gt(g.data,i))),x}if(e.isRowSubTotal&&!e.isColTotal&&!e.isColSubTotal){const{rowSubTotal:g}=o,y=It(m,s),x=ht(m,l),b=ht(m,s),S=[...x,...b],C=(c=g==null?void 0:g[y])==null?void 0:c.data;let v;return S.length&&g&&(S.push(i),v=gt(C,S)),v}if(e.isRowTotal&&e.isColSubTotal){const{colSubInRowTotal:g}=o,y=It(m,l),x=(f=g==null?void 0:g[y])==null?void 0:f.data,b=ht(m,l);let S;return b.length&&g&&(b.push(i),S=gt(x,b)),S}if(e.isColTotal&&e.isRowSubTotal){const{rowSubInColTotal:g}=o,y=It(m,s),x=(p=g==null?void 0:g[y])==null?void 0:p.data,b=ht(m,s);let S;return b.length&&g&&(b.push(i),S=gt(x,b)),S}if(e.isColSubTotal&&e.isRowSubTotal){const{rowSubInColSub:g}=o,y=It(m,s),x=It(m,l),b=(h=(d=g==null?void 0:g[y])==null?void 0:d[x])==null?void 0:h.data,S=ht(m,s),C=ht(m,l),v=[...S,...C];let A;return v.length&&g&&(v.push(i),A=gt(b,v)),A}}function $a(m,u,e,o,i){const{tableLayoutMode:s}=e.customAttr.basicStyle;return s==="tree"?Da(m,u,o,i):Pa(m,u,o,i)}function It(m,u){const e=u.map(s=>s.dataeaseName);let o=-1;const i=So(m);for(let s=e.length-1;s>=0;s--){const l=e[s];i.findIndex(a=>a===l)!==-1&&o++}return o}function ht(m,u){const e=[],o=So(m);return u.forEach(i=>{o.findIndex(l=>l===i.dataeaseName)!==-1&&e.push(m[i.dataeaseName])}),e}function Ra(m,u){const{isRowTotal:e,isRowSubTotal:o,isColTotal:i,isColSubTotal:s}=m,{row:l,col:r}=u||{},{calcTotals:a={},calcSubTotals:n={}}=l||{},{calcTotals:c={},calcSubTotals:f={}}=r||{},p=(d,h)=>{if((d.aggregation||d.calcFunc)&&h)return{aggregation:d.aggregation,calcFunc:d.calcFunc}};return p(c,i)||p(f,s)||p(a,e)||p(n,o)}const $s=m=>typeof m=="number"?Number.isNaN(m):m&&typeof m=="string"?Number.isNaN(Number(m)):!0,ai=(m,u,e=!1)=>m!=null&&m.length?m.reduce((o,i)=>{const s=gt(i,u),l=$s(s);if(e&&l)return o;const r=l?0:s;return o.push(new ee(r)),o},[]):[],Rs=(m,u)=>{const e=ai(m,u);return e.length?ee.sum(...e).toNumber():0},Vo=(m,u,e)=>{const o=ai(u,e,!0);if(o!=null&&o.length)return ee[m](...o).toNumber()},Hs=(m,u)=>{const e=ai(m,u);return e!=null&&e.length?ee.sum(...e).dividedBy(e.length).toNumber():0},Ha={[He.SUM]:Rs,[He.MIN]:(m,u)=>Vo("min",m,u),[He.MAX]:(m,u)=>Vo("max",m,u),[He.AVG]:Hs};class Wa extends Xi{drawTextShape(){this.meta.fieldValue=" ",super.drawTextShape();const{rowHeader:u,columnHeader:e}=this.spreadsheet.facet,o=e.getConfig().viewportWidth/2,i=u.getConfig().viewportHeight/2,l={attrs:{...this.getTextStyle(),x:o,y:i,text:te("data_set.no_data"),opacity:1,textAlign:"center",textBaseline:"middle"}};this.addShape("text",l)}drawBackgroundShape(){const u=this.theme.dataCell.cell;u.backgroundColor=Ws(u.backgroundColor,1),super.drawBackgroundShape()}}function Ws(m,u){if(m.indexOf("rgba")!==-1){const e=m.split(",");return e[3]=`${u})`,e.join(",")}if(m.indexOf("rgb")!==-1)return`${m.replace("rgb","rgba").replace(")",`,${u})`)}`;if(m.indexOf("#")!==-1){if(m.length===7)return`${m}${Math.round(u*255).toString(16)}`;if(m.length===9)return m.slice(0,7)+Math.round(u*255).toString(16)}return m}function qa(m,u){u!=null&&u.length||m.on(Z.LAYOUT_AFTER_RENDER,()=>{var s;const{colLeafNodes:e,rowLeafNodes:o}=((s=m.facet)==null?void 0:s.layoutResult)||{};if(!(e!=null&&e.length)||!(o!=null&&o.length))return;const i=[];e.forEach((l,r)=>{o.forEach((a,n)=>{i.push({rowIndex:n,colIndex:r})})}),m.options.mergedCell=(l,r,a)=>new Wa(l,r,a),m.interaction.mergeCells(i)})}const Va=Object.freeze(Object.defineProperty({__proto__:null,TablePivot:Ba,getDataAvgByField:Hs,getDataExtremumByField:Vo,getDataSumByField:Rs,isNotNumber:$s,setColorOpacity:Ws},Symbol.toStringTag,{value:"Module"})),me=class me{registerChartView(u,e,o){me.CHART_VIEW_MAP.has(u)?me.CHART_VIEW_MAP.get(u).set(e,o):me.CHART_VIEW_MAP.set(u,new Map([[e,o]]))}getChartView(u,e){var o;return(o=me.CHART_VIEW_MAP.get(u))==null?void 0:o.get(e)}};_(me,"CHART_VIEW_MAP",new Map);let Yo=me;const qs=new Yo,Ti=Object.assign({"./charts/bar/bar.ts":Bn,"./charts/bar/bidirectional-bar.ts":Dn,"./charts/bar/bullet-graph.ts":Rn,"./charts/bar/horizontal-bar.ts":qn,"./charts/bar/progress-bar.ts":Yn,"./charts/bar/range-bar.ts":Xn,"./charts/bar/waterfall.ts":Jn,"./charts/line/area.ts":Kn,"./charts/line/line.ts":or,"./charts/line/stock-line.ts":lr,"./charts/liquid/liquid.ts":ar,"./charts/map/bubble-map.ts":dr,"./charts/map/flow-map.ts":mr,"./charts/map/heat-map.ts":hr,"./charts/map/map.ts":yr,"./charts/map/symbolic-map.ts":br,"./charts/map/tooltip-carousel.ts":cr,"./charts/others/chart-mix-common.ts":Sr,"./charts/others/chart-mix.ts":_r,"./charts/others/circle-packing.ts":Er,"./charts/others/funnel.ts":zr,"./charts/others/gauge.ts":Or,"./charts/others/indicator.ts":Mr,"./charts/others/picture-group.ts":Pr,"./charts/others/quadrant.ts":Rr,"./charts/others/radar.ts":Wr,"./charts/others/rich-text.ts":Vr,"./charts/others/sankey-common.ts":Yr,"./charts/others/sankey.ts":Xr,"./charts/others/scatter.ts":Jr,"./charts/others/treemap.ts":Qr,"./charts/others/word-cloud.ts":ea,"./charts/pie/pie.ts":la,"./charts/pie/rose.ts":ra,"./charts/table/t-heatmap.ts":ua,"./charts/table/table-info.ts":ka,"./charts/table/table-normal.ts":Oa,"./charts/table/table-pivot.ts":Va});for(const m in Ti){const u=Ti[m];Object.getOwnPropertyNames(u).forEach(e=>{if(al(u[e],Ze)){const o=new u[e];qs.registerChartView(o.render,o.name,o)}})}const fc=qs;export{Ro as C,Qe as a,ue as b,fc as c,mo as d,dc as e,Ns as f,ql as g,An as h,da as i,ni as j,_i as m,cc as n,Yl as q,Tn as s,Vl as t};
