import"./index-0.0.0-dataease.js";import{E as K}from"./el-dialog-0.0.0-dataease.js";import{j as S,o as U,D as h,n as G,y as P}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as Q}from"./el-row-0.0.0-dataease.js";import{E as R}from"./el-col-0.0.0-dataease.js";import{d as W,y as x,X,w as $,o as H,f as c,O as p,P as d,S as g,a4 as r,u as a,_ as y,j as l,i as n,W as Y,a6 as Z,g as L,a3 as N,a8 as F}from"./vue-0.0.0-dataease.js";import{i as ee}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as te}from"./icon_info_outlined-0.0.0-dataease.js";import se from"./AssistLineEdit-0.0.0-dataease.js";import{aC as ie}from"./chart-0.0.0-dataease.js";import{D as ae,w as k}from"./lodash-0.0.0-dataease.js";import{E as ne}from"./index-0.0.0-dataease4.js";import{_ as oe}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./el-color-picker-0.0.0-dataease.js";import"./index-0.0.0-dataease27.js";import"./index-0.0.0-dataease20.js";import"./index-0.0.0-dataease18.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./el-input-number-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./attr-0.0.0-dataease23.js";import"./field-list-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";const re={class:"inner-container"},le={class:"right-btns"},ce=["disabled"],de=["title"],ue=["title"],fe=["title"],pe=["title"],me=["title"],_e={key:1,style:{color:"red"}},he={class:"assist-line-cfg-header"},ge={class:"ed-dialog__title"},ye={class:"dialog-footer"},Le=W({__name:"AssistLine",props:{chart:{type:Object,required:!0},quotaData:{type:Array,required:!0},quotaExtData:{type:Array,required:!0},themes:{type:String,default:"dark"},propertyInner:{type:Array}},emits:["onAssistLineChange"],setup(v,{emit:I}){const{t:i}=U(),w=I,u=v,C=x(()=>u.quotaData.filter(s=>s.summary!==""&&s.id!=="-1")),E=x(()=>u.quotaExtData.filter(s=>s.summary!==""&&s.id!=="-1")),A=x(()=>u.chart.type.includes("chart-mix")),t=X({assistLineCfg:{enable:!1,assistLine:[]},editLineDialog:!1,lineArr:[],quotaFields:[]});$(()=>u.chart.senior.assistLineCfg,()=>{q()},{deep:!0});const O=()=>{const s=t.assistLineCfg.assistLine.findIndex(e=>e.field==="1")!==-1;w("onAssistLineChange",{data:t.assistLineCfg,requestData:s})},V=s=>{t.lineArr=s},J=()=>{t.editLineDialog=!0},D=()=>{t.editLineDialog=!1},B=()=>{for(let s=0;s<t.lineArr.length;s++){const e=t.lineArr[s];if(!e.name||e.name===""){h.error(i("chart.name_can_not_empty"));return}if(e.field==="0"){if(e.value===null||e.value===void 0||e.value===""){h.error(i("chart.value_can_not_empty"));return}if(parseFloat(e.value).toString()==="NaN"){h.error(i("chart.value_error"));return}}else{if(!e.fieldId||e.fieldId===""){h.error(i("chart.field_not_empty"));return}if(!e.summary||e.summary===""){h.error(i("chart.summary_not_empty"));return}}}t.assistLineCfg.assistLine=JSON.parse(JSON.stringify(t.lineArr)),O(),D()};function z(s){return A.value?!!k(C.value,e=>e.id===s.id)||!!k(E.value,e=>e.id===s.id):!!k(C.value,e=>e.id===s.id)}const q=()=>{var e;const s=JSON.parse(JSON.stringify(u.chart));if(s.senior){const m=s.senior;if((e=m.assistLineCfg)!=null&&e.assistLine){const f=m.assistLineCfg.assistLine;for(let _=0;_<f.length;_++)f[_].fontSize||(f[_].fontSize=10);t.assistLineCfg=ae(m.assistLineCfg,ie)}t.lineArr=JSON.parse(JSON.stringify(t.assistLineCfg.assistLine))}};return H(()=>{q()}),(s,e)=>{const m=G,f=R,_=Q,T=ne,b=P,j=K;return c(),p("div",{onKeydown:e[1]||(e[1]=F(()=>{},["stop"])),onKeyup:e[2]||(e[2]=F(()=>{},["stop"])),class:"assist-line-container"},[d("div",re,[d("span",{class:g(["label","label-"+u.themes])},r(a(i)("chart.assist_line_settings")),3),d("span",le,[t.assistLineCfg.assistLine.length>0?(c(),p("span",{key:0,class:g(["set-text-info",{"set-text-info-dark":v.themes==="dark"}])},r(a(i)("visualization.already_setting")),3)):y("",!0),d("button",{class:g(["label-"+u.themes,"circle-button_icon"]),style:{marginLeft:"6px"},disabled:!t.assistLineCfg.enable,onClick:J},[l(a(S),null,{default:n(()=>[l(m,null,{default:n(()=>[l(a(ee),{class:g([t.assistLineCfg.enable&&"primary-color","svg-icon"])},null,8,["class"])]),_:1})]),_:1})],10,ce)])]),(c(!0),p(Y,null,Z(t.assistLineCfg.assistLine,(o,M)=>(c(),L(_,{key:M,class:"line-style"},{default:n(()=>[l(f,{span:8,class:"line-style"},{default:n(()=>[d("span",{title:o.name},r(o.name),9,de)]),_:2},1024),l(f,{span:6,class:"line-style"},{default:n(()=>[o.field==="0"?(c(),p("span",{key:0,title:a(i)("chart.field_fixed")},r(a(i)("chart.field_fixed")),9,ue)):y("",!0),o.field==="1"?(c(),p("span",{key:1,title:a(i)("chart.field_dynamic")},r(a(i)("chart.field_dynamic")),9,fe)):y("",!0)]),_:2},1024),o.field==="0"?(c(),L(f,{key:0,span:10,class:"line-style"},{default:n(()=>[d("span",{title:o.value},r(o.value),9,pe)]),_:2},1024)):o.field==="1"?(c(),L(f,{key:1,span:10,class:"line-style"},{default:n(()=>[z(o.curField)?(c(),p("span",{key:0,title:o.curField.name+"("+a(i)("chart."+o.summary)+")"},r(o.curField.name+"("+a(i)("chart."+o.summary)+")"),9,me)):(c(),p("span",_e,r(a(i)("chart.invalid_field")),1))]),_:2},1024)):y("",!0)]),_:2},1024))),128)),t.editLineDialog?(c(),L(j,{key:0,modelValue:t.editLineDialog,"onUpdate:modelValue":e[0]||(e[0]=o=>t.editLineDialog=o),visible:t.editLineDialog,width:"1000px",class:"dialog-css"},{header:n(()=>[d("div",he,[d("span",ge,r(a(i)("chart.assist_line")),1),l(T,{class:"item",effect:"light",placement:"top"},{content:n(()=>[d("span",null,r(a(i)("chart.assist_line_tip")),1)]),default:n(()=>[l(a(S),{class:g(["hint-icon",{"hint-icon--dark":v.themes==="dark"}])},{default:n(()=>[l(m,{name:"icon_info_outlined"},{default:n(()=>[l(a(te),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1})])]),footer:n(()=>[d("div",ye,[l(b,{onClick:D},{default:n(()=>[N(r(a(i)("chart.cancel")),1)]),_:1}),l(b,{type:"primary",onClick:B},{default:n(()=>[N(r(a(i)("chart.confirm")),1)]),_:1})])]),default:n(()=>[l(se,{chart:u.chart,line:t.assistLineCfg.assistLine,"quota-fields":C.value,"quota-ext-fields":E.value,"use-quota-ext":A.value,onOnAssistLineChange:V},null,8,["chart","line","quota-fields","quota-ext-fields","use-quota-ext"])]),_:1},8,["modelValue","visible"])):y("",!0)],32)}}});const ct=oe(Le,[["__scopeId","data-v-d88107ea"]]);export{ct as default};
