import{e as S,E as h,f as K,i as R,M as j,C as G,p as Q}from"./element-plus-secondary-0.0.0-dataease.js";import{h as W,f as X}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as Y,k as x,l as $,w as H,b as P,o as c,c as u,a as d,z as g,Y as r,u as a,R as y,W as l,U as o,S as Z,a8 as tt,T as L,_ as N,X as F}from"./@vue-0.0.0-dataease.js";import{i as et}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as it}from"./icon_info_outlined-0.0.0-dataease.js";import st from"./AssistLineEdit-0.0.0-dataease.js";import{aC as at}from"./chart-0.0.0-dataease.js";import{E as ot,x as k}from"./lodash-es-0.0.0-dataease.js";import{_ as nt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./attr-0.0.0-dataease23.js";import"./field-list-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./login-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";const rt={class:"inner-container"},lt={class:"right-btns"},ct=["disabled"],dt=["title"],pt=["title"],mt=["title"],ut=["title"],ft=["title"],_t={key:1,style:{color:"red"}},ht={class:"assist-line-cfg-header"},gt={class:"ed-dialog__title"},yt={class:"dialog-footer"},Lt=Y({__name:"AssistLine",props:{chart:{type:Object,required:!0},quotaData:{type:Array,required:!0},quotaExtData:{type:Array,required:!0},themes:{type:String,default:"dark"},propertyInner:{type:Array}},emits:["onAssistLineChange"],setup(C,{emit:I}){const{t:s}=W(),w=I,p=C,v=x(()=>p.quotaData.filter(i=>i.summary!==""&&i.id!=="-1")),A=x(()=>p.quotaExtData.filter(i=>i.summary!==""&&i.id!=="-1")),E=x(()=>p.chart.type.includes("chart-mix")),e=$({assistLineCfg:{enable:!1,assistLine:[]},editLineDialog:!1,lineArr:[],quotaFields:[]});H(()=>p.chart.senior.assistLineCfg,()=>{b()},{deep:!0});const O=()=>{const i=e.assistLineCfg.assistLine.findIndex(t=>t.field==="1")!==-1;w("onAssistLineChange",{data:e.assistLineCfg,requestData:i})},V=i=>{e.lineArr=i},J=()=>{e.editLineDialog=!0},q=()=>{e.editLineDialog=!1},z=()=>{for(let i=0;i<e.lineArr.length;i++){const t=e.lineArr[i];if(!t.name||t.name===""){h.error(s("chart.name_can_not_empty"));return}if(t.field==="0"){if(t.value===null||t.value===void 0||t.value===""){h.error(s("chart.value_can_not_empty"));return}if(parseFloat(t.value).toString()==="NaN"){h.error(s("chart.value_error"));return}}else{if(!t.fieldId||t.fieldId===""){h.error(s("chart.field_not_empty"));return}if(!t.summary||t.summary===""){h.error(s("chart.summary_not_empty"));return}}}e.assistLineCfg.assistLine=JSON.parse(JSON.stringify(e.lineArr)),O(),q()};function B(i){return E.value?!!k(v.value,t=>t.id===i.id)||!!k(A.value,t=>t.id===i.id):!!k(v.value,t=>t.id===i.id)}const b=()=>{var t;const i=JSON.parse(JSON.stringify(p.chart));if(i.senior){const f=i.senior;if((t=f.assistLineCfg)!=null&&t.assistLine){const m=f.assistLineCfg.assistLine;for(let _=0;_<m.length;_++)m[_].fontSize||(m[_].fontSize=10);e.assistLineCfg=ot(f.assistLineCfg,at)}e.lineArr=JSON.parse(JSON.stringify(e.assistLineCfg.assistLine))}};return P(()=>{b()}),(i,t)=>{const f=X,m=G,_=Q,T=K,D=R,M=j;return c(),u("div",{onKeydown:t[1]||(t[1]=F(()=>{},["stop"])),onKeyup:t[2]||(t[2]=F(()=>{},["stop"])),class:"assist-line-container"},[d("div",rt,[d("span",{class:g(["label","label-"+p.themes])},r(a(s)("chart.assist_line_settings")),3),d("span",lt,[e.assistLineCfg.assistLine.length>0?(c(),u("span",{key:0,class:g(["set-text-info",{"set-text-info-dark":C.themes==="dark"}])},r(a(s)("visualization.already_setting")),3)):y("",!0),d("button",{class:g(["label-"+p.themes,"circle-button_icon"]),style:{marginLeft:"6px"},disabled:!e.assistLineCfg.enable,onClick:J},[l(a(S),null,{default:o(()=>[l(f,null,{default:o(()=>[l(a(et),{class:g([e.assistLineCfg.enable&&"primary-color","svg-icon"])},null,8,["class"])]),_:1})]),_:1})],10,ct)])]),(c(!0),u(Z,null,tt(e.assistLineCfg.assistLine,(n,U)=>(c(),L(_,{key:U,class:"line-style"},{default:o(()=>[l(m,{span:8,class:"line-style"},{default:o(()=>[d("span",{title:n.name},r(n.name),9,dt)]),_:2},1024),l(m,{span:6,class:"line-style"},{default:o(()=>[n.field==="0"?(c(),u("span",{key:0,title:a(s)("chart.field_fixed")},r(a(s)("chart.field_fixed")),9,pt)):y("",!0),n.field==="1"?(c(),u("span",{key:1,title:a(s)("chart.field_dynamic")},r(a(s)("chart.field_dynamic")),9,mt)):y("",!0)]),_:2},1024),n.field==="0"?(c(),L(m,{key:0,span:10,class:"line-style"},{default:o(()=>[d("span",{title:n.value},r(n.value),9,ut)]),_:2},1024)):n.field==="1"?(c(),L(m,{key:1,span:10,class:"line-style"},{default:o(()=>[B(n.curField)?(c(),u("span",{key:0,title:n.curField.name+"("+a(s)("chart."+n.summary)+")"},r(n.curField.name+"("+a(s)("chart."+n.summary)+")"),9,ft)):(c(),u("span",_t,r(a(s)("chart.invalid_field")),1))]),_:2},1024)):y("",!0)]),_:2},1024))),128)),e.editLineDialog?(c(),L(M,{key:0,modelValue:e.editLineDialog,"onUpdate:modelValue":t[0]||(t[0]=n=>e.editLineDialog=n),visible:e.editLineDialog,width:"1000px",class:"dialog-css"},{header:o(()=>[d("div",ht,[d("span",gt,r(a(s)("chart.assist_line")),1),l(T,{class:"item",effect:"light",placement:"top"},{content:o(()=>[d("span",null,r(a(s)("chart.assist_line_tip")),1)]),default:o(()=>[l(a(S),{class:g(["hint-icon",{"hint-icon--dark":C.themes==="dark"}])},{default:o(()=>[l(f,{name:"icon_info_outlined"},{default:o(()=>[l(a(it),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1})])]),footer:o(()=>[d("div",yt,[l(D,{onClick:q},{default:o(()=>[N(r(a(s)("chart.cancel")),1)]),_:1}),l(D,{type:"primary",onClick:z},{default:o(()=>[N(r(a(s)("chart.confirm")),1)]),_:1})])]),default:o(()=>[l(st,{chart:p.chart,line:e.assistLineCfg.assistLine,"quota-fields":v.value,"quota-ext-fields":A.value,"use-quota-ext":E.value,onOnAssistLineChange:V},null,8,["chart","line","quota-fields","quota-ext-fields","use-quota-ext"])]),_:1},8,["modelValue","visible"])):y("",!0)],32)}}});const Je=nt(Lt,[["__scopeId","data-v-d88107ea"]]);export{Je as default};
