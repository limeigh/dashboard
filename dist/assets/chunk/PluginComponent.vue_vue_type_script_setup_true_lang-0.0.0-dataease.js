import{b as C,a as M,z as j}from"./index-0.0.0-dataease.js";import{aC as b,aD as h,r as S,aE as A,x as F,aF as R,aG as I,aH as B,h as E,aI as r,aJ as J}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as K,r as p,ac as O,o as H,v as q,as as z,R as G,f as L,g as T,a2 as V,u as x,l as Q}from"./vue-0.0.0-dataease.js";import{a as U}from"./axios-0.0.0-dataease.js";const ae=K({__name:"PluginComponent",emits:["loadFail"],setup(W,{expose:_,emit:y}){const{wsCache:s}=C(),i=p(),n=p(!1),l=O(),f=()=>{i.value=B,n.value=!1},k=a=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(var o=0;o<a;o++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},w=a=>{E(Object.assign({}),`../../../../../../../extensions/${r(a[8])}/${r(a[9])}/${r(a[10])}/${r(a[11])}/${r(a[12])}.vue`).then(e=>{i.value=e.default}).catch(e=>{console.error(e),f()})},d=()=>window.atob(l.jsname.toString()).split("/")[0],P=()=>{const a=d();n.value=!0;const t=s.get(`de-plugin-proxy-${a}`);if(t){w(JSON.parse(t)),n.value=!1;return}const e=k(J()),o=window.btoa(a),u=`${e},${o}`;R(u).then(m=>{let $=m.data;const g=I($,e);D(g),w(g)}).catch(()=>{v("loadFail"),f()}).finally(()=>{n.value=!1})},D=a=>{const t=[];a.forEach(o=>{t.push([...o])});const e=d();s.set(`de-plugin-proxy-${e}`,JSON.stringify(t))},c=p(null),N=a=>{var t,e;c.value.invokeMethod?c.value.invokeMethod(a):(e=(t=c.value)[a.methodName])==null||e.call(t,...a.args)};H(async()=>{const a="xpack-model-distributed";let t=!1;if(s.get(a)===null){const e=await b();s.set("xpack-model-distributed",h(e.data)?"null":e.data),t=e.data}else t=s.get(a);if(h(t)){setTimeout(()=>{v("loadFail"),n.value=!1},1e3);return}if(t){const e=d();if(window[e]){const o=await window[e].mapping[l.jsname];i.value=o.default}else{window.VueDe=q,window.AxiosDe=U,window.PiniaDe=z,window.vueRouterDe=S,window.MittAllDe=M().emitter.all,window.I18nDe=A;const o=`/xpackComponent/pluginStaticInfo/${e}`;F.get({url:o}).then(async u=>{new Function(u.data||u)();const m=await window[e].mapping[l.jsname];i.value=m.default})}}else P()});const v=y;return _({invokeMethod:N}),(a,t)=>{const e=j;return G((L(),T(Q(i.value),V({key:x(l).jsname,ref_key:"pluginProxy",ref:c},x(l)),null,16)),[[e,n.value]])}}});export{ae as _};
