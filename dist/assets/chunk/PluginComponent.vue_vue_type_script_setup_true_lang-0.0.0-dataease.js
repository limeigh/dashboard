import{v as j}from"./element-plus-secondary-0.0.0-dataease.js";import{x as C,r as S,q as b,j as A,t as F,v as R,w as B,d as I,y as r,z as K}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{v as O}from"./vue-0.0.0-dataease.js";import{a as q,g as c,o as x,u as E}from"./index-0.0.0-dataease.js";import{a as J}from"./axios-0.0.0-dataease.js";import{P as T}from"./pinia-0.0.0-dataease.js";import{d as V,r as f,P as z,b as H,$ as L,o as G,T as Q,M as U,u as y,V as W}from"./@vue-0.0.0-dataease.js";const se=V({__name:"PluginComponent",emits:["loadFail"],setup(X,{expose:_,emit:k}){const{wsCache:s}=q(),i=f(),n=f(!1),l=z(),w=()=>{i.value=B,n.value=!1},P=t=>{const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(var a=0;a<t;a++)e+=o.charAt(Math.floor(Math.random()*o.length));return e},v=t=>{I(Object.assign({}),`../../../../../../../extensions/${r(t[8])}/${r(t[9])}/${r(t[10])}/${r(t[11])}/${r(t[12])}.vue`).then(e=>{i.value=e.default}).catch(e=>{console.error(e),w()})},d=()=>window.atob(l.jsname.toString()).split("/")[0],$=()=>{const t=d();n.value=!0;const o=s.get(c(`de-plugin-proxy-${t}`));if(o){v(JSON.parse(o)),n.value=!1;return}const e=P(K()),a=window.btoa(t),m=`${e},${a}`;F(m).then(p=>{let D=p.data;const h=R(D,e);M(h),v(h)}).catch(()=>{g("loadFail"),w()}).finally(()=>{n.value=!1})},M=t=>{const o=[];t.forEach(a=>{o.push([...a])});const e=d();s.set(c(`de-plugin-proxy-${e}`),JSON.stringify(o))},u=f(null),N=t=>{var o,e;u.value.invokeMethod?u.value.invokeMethod(t):(e=(o=u.value)[t.methodName])==null||e.call(o,...t.args)};H(async()=>{const t="xpack-model-distributed";let o=!1;if(s.get(c(t))===null){const e=await C();s.set(c("xpack-model-distributed"),x(e.data)?"null":e.data),o=e.data}else o=s.get(c(t));if(x(o)){setTimeout(()=>{g("loadFail"),n.value=!1},1e3);return}if(o){const e=d();if(window[e]){const a=await window[e].mapping[l.jsname];i.value=a.default}else{window.VueDe=O,window.AxiosDe=J,window.PiniaDe=T,window.vueRouterDe=S,window.MittAllDe=E().emitter.all,window.I18nDe=b;const a=`/xpackComponent/pluginStaticInfo/${e}`;A.get({url:a}).then(async m=>{new Function(m.data||m)();const p=await window[e].mapping[l.jsname];i.value=p.default})}}else $()});const g=k;return _({invokeMethod:N}),(t,o)=>{const e=j;return L((G(),Q(W(i.value),U({key:y(l).jsname,ref_key:"pluginProxy",ref:u},y(l)),null,16)),[[e,n.value]])}}});export{se as _};
