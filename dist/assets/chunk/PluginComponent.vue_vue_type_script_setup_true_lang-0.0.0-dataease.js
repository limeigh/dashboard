import{v as C}from"./element-plus-secondary-0.0.0-dataease.js";import{x as j,r as S,t as b,k as A,v as F,w as R,y as B,e as I,z as r,A as K}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{v as O}from"./vue-0.0.0-dataease.js";import{a as q,g as c,q as x,u as E}from"./index-0.0.0-dataease.js";import{a as J}from"./axios-0.0.0-dataease.js";import{P as T}from"./pinia-0.0.0-dataease.js";import{d as V,r as f,P as z,b as H,$ as L,o as G,T as Q,M as U,u as y,V as W}from"./@vue-0.0.0-dataease.js";const se=V({__name:"PluginComponent",emits:["loadFail"],setup(X,{expose:_,emit:k}){const{wsCache:s}=q(),i=f(),n=f(!1),l=z(),w=()=>{i.value=B,n.value=!1},P=t=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(var o=0;o<t;o++)e+=a.charAt(Math.floor(Math.random()*a.length));return e},v=t=>{I(Object.assign({}),`../../../../../../../extensions/${r(t[8])}/${r(t[9])}/${r(t[10])}/${r(t[11])}/${r(t[12])}.vue`).then(e=>{i.value=e.default}).catch(e=>{console.error(e),w()})},d=()=>window.atob(l.jsname.toString()).split("/")[0],$=()=>{const t=d();n.value=!0;const a=s.get(c(`de-plugin-proxy-${t}`));if(a){v(JSON.parse(a)),n.value=!1;return}const e=P(K()),o=window.btoa(t),m=`${e},${o}`;F(m).then(p=>{let D=p.data;const h=R(D,e);M(h),v(h)}).catch(()=>{g("loadFail"),w()}).finally(()=>{n.value=!1})},M=t=>{const a=[];t.forEach(o=>{a.push([...o])});const e=d();s.set(c(`de-plugin-proxy-${e}`),JSON.stringify(a))},u=f(null),N=t=>{var a,e;u.value.invokeMethod?u.value.invokeMethod(t):(e=(a=u.value)[t.methodName])==null||e.call(a,...t.args)};H(async()=>{const t="xpack-model-distributed";let a=!1;if(s.get(c(t))===null){const e=await j();s.set(c("xpack-model-distributed"),x(e.data)?"null":e.data),a=e.data}else a=s.get(c(t));if(x(a)){setTimeout(()=>{g("loadFail"),n.value=!1},1e3);return}if(a){const e=d();if(window[e]){const o=await window[e].mapping[l.jsname];i.value=o.default}else{window.VueDe=O,window.AxiosDe=J,window.PiniaDe=T,window.vueRouterDe=S,window.MittAllDe=E().emitter.all,window.I18nDe=b;const o=`/xpackComponent/pluginStaticInfo/${e}`;A.get({url:o}).then(async m=>{new Function(m.data||m)();const p=await window[e].mapping[l.jsname];i.value=p.default})}}else $()});const g=k;return _({invokeMethod:N}),(t,a)=>{const e=C;return L((G(),Q(W(i.value),U({key:y(l).jsname,ref_key:"pluginProxy",ref:u},y(l)),null,16)),[[e,n.value]])}}});export{se as _};
