import{_ as I}from"./InfoTemplate.vue_vue_type_style_index_0_scope_true_lang-0.0.0-dataease.js";import K from"./BasicEdit-0.0.0-dataease.js";import{f as Q,j as O}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as X}from"./ModelUtil-0.0.0-dataease.js";import{h as d}from"./lodash-es-0.0.0-dataease.js";import{d as Y,r as c,l as Z,k as x,o as B,c as ee,W as P,u as g,T,R as j,S as te,n as ie}from"./@vue-0.0.0-dataease.js";import{_ as ae}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./element-plus-secondary-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./vue-clipboard3-0.0.0-dataease.js";import"./clipboard-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const se=Y({__name:"BasicInfo",setup(le){const{t:i}=Q(),v=c(),f=c(),_=c(),b=c(),y=c(!1),U=X(),V=[{value:"0",label:i("commons.date.permanent")},{value:"1",label:i("commons.date.one_year")},{value:"2",label:i("commons.date.six_months")},{value:"3",label:i("commons.date.three_months")},{value:"4",label:i("commons.date.one_month")}],k=[{key:"setting_basic.defaultOpen",val:i("setting_basic.default_open_tips")},{key:"setting_basic.frontTimeOut",val:i("system.to_take_effect")},{key:"setting_basic.platformOid",val:i("system.and_platform_docking")},{key:"setting_basic.platformRid",val:i("system.and_platform_docking")},{key:"setting_basic.shareDisable",val:i("setting_basic.share_disable_tips")}],C=["setting_basic.dip","setting_basic.pvp","setting_basic.defaultLogin","setting_basic.loginLimit","setting_basic.loginLimitRate","setting_basic.loginLimitTime"],E=["setting_basic.autoCreateUser","setting_basic.platformOid","setting_basic.platformRid"],a=Z({templateList:[],orgOptions:[],roleOptions:[{value:"admin",label:i("role.org_admin"),children:null,disabled:!1},{value:"readonly",label:i("role.average_role"),children:null,disabled:!1}],loginOptions:[{value:"0",label:i("system.normal_login")},{value:"1",label:"LDAP"},{value:"2",label:"OIDC"},{value:"3",label:"CAS"},{value:"9",label:"OAuth2"}],sortOptions:[{value:"0",label:i("resource_sort.time_asc")},{value:"1",label:i("resource_sort.time_desc")},{value:"2",label:i("resource_sort.name_asc")},{value:"3",label:i("resource_sort.name_desc")}],openOptions:[{value:"0",label:i("open_opt.new_page")},{value:"1",label:i("open_opt.local_page")}]});let m=[];const L=c(""),q=c(""),w=c([]),h=c([]),$=c("0"),A=x(()=>a.templateList.filter(s=>!C.concat(E).includes(s.pkey)&&(!U||s.pkey!=="setting_basic.defaultOpen"))),S=x(()=>a.templateList.filter(s=>E.includes(s.pkey))),R=x(()=>a.templateList.filter(t=>C.includes(t.pkey))),W=s=>{const t="/sysParameter/basic/query";m=[],a.templateList=[];const o=[];O.get({url:t}).then(async n=>{m=d(n.data);const r=n.data;for(let p=0;p<r.length;p++){const e=r[p];if(e.pkey==="basic.autoCreateUser"||e.pkey==="basic.dip"||e.pkey==="basic.pwdStrategy"||e.pkey==="basic.shareDisable"||e.pkey==="basic.sharePeRequire"||e.pkey==="basic.loginLimit")e.pval=e.pval==="true"?i("chart.open"):i("system.not_enabled");else if(e.pkey==="basic.platformOid")L.value=e.pval,await z(),e.pval=q.value||i("system.default_organization");else if(e.pkey==="basic.platformRid"){const l=e.pval;if(l!=null&&l.length){const u=l.split(",");w.value=u,await F(),h.value.length?e.pval=h.value.join(","):e.pval=i("system.normal_role")}else w.value=[],e.pval=i("system.normal_role")}else if(e.pkey==="basic.pvp")$.value=e.pval||"0",e.pval=V.filter(l=>l.value===$.value)[0].label;else if(e.pkey==="basic.defaultLogin"){if(await H(),y.value)if(e.pval){const l=a.loginOptions.filter(u=>u.value===e.pval);l!=null&&l.length?e.pval=l[0].label:(e.pval=a.loginOptions[0].label,J())}else e.pval=a.loginOptions[0].label}else if(e.pkey==="basic.defaultSort")if(e.pval){const l=a.sortOptions.filter(u=>u.value===e.pval);l!=null&&l.length?e.pval=l[0].label:e.pval=a.sortOptions[1].label}else e.pval=a.sortOptions[1].label;else if(e.pkey==="basic.defaultOpen")if(e.pval){const l=a.openOptions.filter(u=>u.value===e.pval);l!=null&&l.length?e.pval=l[0].label:e.pval=a.openOptions[0].label}else e.pval=a.openOptions[0].label;else e.pval=e.pval;e.pkey="setting_"+e.pkey,(!e.pkey.includes("defaultLogin")||y.value)&&o.push(e)}a.templateList.splice(0,o.length,...o),s&&s()})},N=()=>{W(()=>{ie(()=>{var s,t,o;(s=f==null?void 0:f.value)==null||s.init(),(t=_==null?void 0:_.value)==null||t.init(),(o=b==null?void 0:b.value)==null||o.init()})})};N();const D=(s,t)=>{v==null||v.value.edit(d(m),d(a.orgOptions),d(a.roleOptions),d(a.loginOptions),d(a.sortOptions),d(a.openOptions),s,t)},z=async()=>{const t=(await O.post({url:"/org/mounted",data:{}})).data;M(t),a.orgOptions=t},F=async()=>{const t=(await O.get({url:`/role/queryWithOid/${L.value}`})).data,o=G(t);a.roleOptions[0].children=o.get(!1),a.roleOptions[1].children=o.get(!0)},M=s=>{var o;const t=[...s];for(;t.length;){const n=t.pop();n.id===L.value&&(q.value=n.name),n.value=n.id,n.label=n.name,n.disabled=n.readOnly,(o=n.children)!=null&&o.length&&n.children.forEach(r=>t.push(r))}},G=s=>{const t=new Map;return h.value=[],s.forEach(o=>{w.value.includes(o.id)&&h.value.push(o.name);const n=o.readonly;let r=t.get(n);r||(r=[]),r.push({value:o.id,label:o.name,disabled:!1}),t.set(n,r)}),t},H=async()=>{const s="/setting/authentication/status",n=(await O.get({url:s})).data.reduce((p,{name:e,enable:l})=>(p[e]=l,p),{});let r=a.loginOptions.length;for(;r--;){const p=a.loginOptions[r];p.value!=="0"&&!n[p.label.toLocaleLowerCase()]&&a.loginOptions.splice(r,1)}if(y.value=a.loginOptions.length>1,!y.value){let p=m.length;for(;p--;)m[p].pkey==="basic.defaultLogin"&&m.splice(p,1)}},J=()=>{let s=m.length;for(;s--;){const t=m[s];t.pkey==="basic.defaultLogin"&&(t.pval="0")}};return(s,t)=>{var o,n;return B(),ee(te,null,[P(I,{ref_key:"infoTemplate",ref:f,"label-tooltips":k,"setting-key":"basic","setting-title":g(i)("system.basic_settings"),"setting-data":A.value,onEdit:t[0]||(t[0]=r=>D(g(i)("system.basic_settings"),A.value.map(p=>p.pkey.split(".")[1])))},null,8,["setting-title","setting-data"]),(o=R.value)!=null&&o.length?(B(),T(I,{key:0,ref_key:"loginTemplate",ref:_,class:"login-setting-template","label-tooltips":k,"setting-key":"basic","setting-title":g(i)("system.login_settings"),"setting-data":R.value,onEdit:t[1]||(t[1]=r=>D(g(i)("system.login_settings"),R.value.map(p=>p.pkey.split(".")[1])))},null,8,["setting-title","setting-data"])):j("",!0),(n=S.value)!=null&&n.length?(B(),T(I,{key:1,ref_key:"thirdTemplate",ref:b,class:"login-setting-template","label-tooltips":k,"setting-key":"basic","setting-title":g(i)("setting_basic.third_platform_settings"),"setting-data":S.value,onEdit:t[2]||(t[2]=r=>D(g(i)("setting_basic.third_platform_settings"),S.value.map(p=>p.pkey.split(".")[1])))},null,8,["setting-title","setting-data"])):j("",!0),P(K,{ref_key:"editor",ref:v,"label-tooltips":k,onSaved:N},null,512)],64)}}});const vt=ae(se,[["__scopeId","data-v-cc377fd8"]]);export{vt as default};
