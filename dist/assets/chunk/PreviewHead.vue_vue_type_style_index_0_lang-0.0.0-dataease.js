import{e as K,f as e1,h as t1,g as o1,i as a1,G as s1,H as n1,I as i1}from"./element-plus-secondary-0.0.0-dataease.js";import{j as l1,h as r1,f as T}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{o as c,c as V,a as r,d as d1,r as P,k as b,w as c1,ae as u1,u as e,Y as l,$ as p1,a0 as m1,W as t,U as o,T as _,V as v1,Z as _1,R as C,_ as d,S as f1}from"./@vue-0.0.0-dataease.js";import{v as w1,i as C1}from"./visual-star-0.0.0-dataease.js";import{d as h1}from"./dv-info-0.0.0-dataease.js";import{i as g1}from"./icon_pc_outlined-0.0.0-dataease.js";import{i as b1}from"./icon_download_outlined-0.0.0-dataease.js";import{i as y1}from"./icon_replace_outlined-0.0.0-dataease.js";import{i as k1}from"./icon_edit_outlined-0.0.0-dataease.js";import{d as x1}from"./dvMain-0.0.0-dataease.js";import{s as V1}from"./pinia-0.0.0-dataease.js";import{useAppStoreWithOut as z1}from"./app-0.0.0-dataease.js";import S1 from"./DvDetailInfo-0.0.0-dataease.js";import{a as D1,f as H1,g as I1,m as A1,u as W}from"./index-0.0.0-dataease.js";import{f as E1,y as M1}from"./dataVisualization-0.0.0-dataease.js";import $1 from"./ShareVisualHead-0.0.0-dataease.js";import{u as B1}from"./share-0.0.0-dataease.js";import{i as T1}from"./ModelUtil-0.0.0-dataease.js";const P1={width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"};function W1(z,u){return c(),V("svg",P1,[...u[0]||(u[0]=[r("path",{d:"M11.25 14.9993V16.666C11.25 16.7207 11.2392 16.7749 11.2183 16.8255C11.1973 16.876 11.1667 16.922 11.128 16.9606C11.0893 16.9993 11.0433 17.03 10.9928 17.051C10.9422 17.0719 10.8881 17.0827 10.8333 17.0827H9.16667C9.11195 17.0827 9.05777 17.0719 9.00722 17.051C8.95666 17.03 8.91073 16.9993 8.87204 16.9606C8.83335 16.922 8.80266 16.876 8.78172 16.8255C8.76078 16.7749 8.75 16.7207 8.75 16.666V14.9993C8.75 14.8888 8.7939 14.7829 8.87204 14.7047C8.95018 14.6266 9.05616 14.5827 9.16667 14.5827H10.8333C10.8881 14.5827 10.9422 14.5935 10.9928 14.6144C11.0433 14.6353 11.0893 14.666 11.128 14.7047C11.1667 14.7434 11.1973 14.7893 11.2183 14.8399C11.2392 14.8904 11.25 14.9446 11.25 14.9993ZM11.25 3.33268V4.99935C11.25 5.05407 11.2392 5.10825 11.2183 5.1588C11.1973 5.20935 11.1667 5.25529 11.128 5.29398C11.0893 5.33267 11.0433 5.36336 10.9928 5.3843C10.9422 5.40524 10.8881 5.41602 10.8333 5.41602H9.16667C9.05616 5.41602 8.95018 5.37212 8.87204 5.29398C8.7939 5.21584 8.75 5.10986 8.75 4.99935V3.33268C8.75 3.27797 8.76078 3.22378 8.78172 3.17323C8.80266 3.12268 8.83335 3.07675 8.87204 3.03805C8.91073 2.99936 8.95666 2.96867 9.00722 2.94773C9.05777 2.92679 9.11195 2.91602 9.16667 2.91602H10.8333C10.8881 2.91602 10.9422 2.92679 10.9928 2.94773C11.0433 2.96867 11.0893 2.99936 11.128 3.03805C11.1667 3.07675 11.1973 3.12268 11.2183 3.17323C11.2392 3.22378 11.25 3.27797 11.25 3.33268ZM11.25 9.16602V10.8327C11.25 10.8874 11.2392 10.9416 11.2183 10.9921C11.1973 11.0427 11.1667 11.0886 11.128 11.1273C11.0893 11.166 11.0433 11.1967 10.9928 11.2176C10.9422 11.2386 10.8881 11.2493 10.8333 11.2493H9.16667C9.11195 11.2493 9.05777 11.2386 9.00722 11.2176C8.95666 11.1967 8.91073 11.166 8.87204 11.1273C8.83335 11.0886 8.80266 11.0427 8.78172 10.9921C8.76078 10.9416 8.75 10.8874 8.75 10.8327V9.16602C8.75 9.05551 8.7939 8.94953 8.87204 8.87139C8.95018 8.79325 9.05616 8.74935 9.16667 8.74935H10.8333C10.8881 8.74935 10.9422 8.76013 10.9928 8.78107C11.0433 8.80201 11.0893 8.8327 11.128 8.87139C11.1667 8.91008 11.1973 8.95601 11.2183 9.00657C11.2392 9.05712 11.25 9.1113 11.25 9.16602Z"},null,-1)])])}const Z1={render:W1},N1={t:"1718353836926",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4416","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"200",height:"200"};function R1(z,u){return c(),V("svg",N1,[...u[0]||(u[0]=[r("path",{d:"M862.1 69H161.9C110.7 69 69 110.7 69 161.9v700.2c0 51.2 41.7 92.9 92.9 92.9h700.2c51.2 0 92.9-41.7 92.9-92.9V161.9c0-51.2-41.7-92.9-92.9-92.9z m16.6 92.9v716.7H161.9c-12.5 0-16.5-4-16.5-16.5V161.9c0-12.5 4-16.5 16.5-16.5h700.2c12.6-0.1 16.6 3.9 16.6 16.5z","p-id":"4417"},null,-1),r("path",{d:"M370.3 222.4H268.7c-25.4 0-46 20.6-46 46V370c0 19.8 16.1 35.8 35.8 35.8 19.7 0 35.8-16.1 35.8-35.8v-75.9h75.9c19.8 0 35.8-16.1 35.8-35.8 0.1-19.8-16-35.9-35.7-35.9zM370.3 730.4h-75.9v-75.9c0-19.8-16.1-35.8-35.8-35.8-19.8 0-35.8 16.1-35.8 35.8V756c0 25.4 20.6 46 46 46h101.6c19.8 0 35.8-16.1 35.8-35.8-0.1-19.8-16.2-35.8-35.9-35.8zM766.5 618.6c-19.8 0-35.8 16.1-35.8 35.8v75.9h-75.9c-19.8 0-35.8 16.1-35.8 35.8 0 19.8 16.1 35.8 35.8 35.8h101.6c25.4 0 46-20.6 46-46V654.4c-0.1-19.7-16.2-35.8-35.9-35.8zM756.3 222.4H654.7c-19.8 0-35.8 16.1-35.8 35.8 0 19.8 16.1 35.8 35.8 35.8h75.9v76c0 19.8 16.1 35.8 35.8 35.8 19.7 0 35.8-16.1 35.8-35.8V268.4c0.1-25.3-20.5-46-45.9-46z","p-id":"4418"},null,-1)])])}const U1={render:R1},F1={class:"preview-head flex-align-center"},O1=["title"],j1={class:"create-area flex-align-center"},G1={style:{"line-height":"22px"}},J1={class:"canvas-opt-button"},X1={class:"ed-dropdown-menu__item flex-align-center icon"},me=d1({__name:"PreviewHead",emits:["reload","download","downloadAsAppTemplate"],setup(z,{emit:u}){const Z=B1(),{wsCache:N}=D1("localStorage"),R=x1(),S=z1(),{dvInfo:a}=V1(R),y=u,{t:i}=r1(),h=H1(),U=N.get(I1("open-backend"))==="1"?"_self":"_blank",g=P(!1),F=()=>{const s=(D.value?h.baseUrl:"")+"#/preview?dvId="+a.value.id+"&ignoreParams=true",p=window.open(s,"_blank");E(p)},D=b(()=>S.getIsDataEaseBi),H=b(()=>S.getIsIframe),O=b(()=>Z.getShareDisable||T1()),j=b(()=>A1(a.value.weight,a.value.ext)),G=()=>{y("reload",a.value.id)},I=n=>{y("download",n)},A=n=>{y("downloadAsAppTemplate",n)},J=()=>{if(D.value||H.value){h.clearState(),a.value.type==="dataV"?h.setDvId(a.value.id):h.setResourceId(a.value.id),W().emitter.emit("changeCurrentComponent",a.value.type==="dataV"?"VisualizationEditor":"DashboardEditor");return}const n=a.value.type==="dataV"?"#/dvCanvas?dvId=":"#/dashboard?resourceId=",s=window.open(n+a.value.id,U);E(s)},X=()=>{const n={id:a.value.id,type:a.value.type==="dashboard"?"panel":"screen"};E1(n).then(()=>{k()})},k=()=>{var n;(n=a==null?void 0:a.value)!=null&&n.id&&M1(a.value.id).then(s=>{g.value=s.data})};k(),c1(()=>a.value.id,()=>{k()});const f=P(null),E=n=>{if(f!=null&&f.value){const s={methodName:"initOpenHandler",args:n};f.value.invokeMethod(s)}};return(n,s)=>{const p=T,m=K,L=e1,Q=t1,M=T,Y=o1,x=a1,w=s1,q=u1("ArrowRight"),$=n1,B=i1;return c(),V(f1,null,[r("div",F1,[r("div",{title:e(a).name,class:"canvas-name ellipsis"},l(e(a).name),9,O1),p1(r("div",{class:"canvas-have-update"},l(e(i)("visualization.publish_update_tips")),513),[[m1,e(a).status===2]]),t(L,{effect:"dark",content:g.value?e(i)("visualization.cancel_store"):e(i)("visualization.store"),placement:"top"},{default:o(()=>[e(a).status!==0?(c(),_(m,{key:0,class:"custom-icon hover-icon",onClick:X,style:_1({color:g.value?"#FFC60A":"#646A73"})},{default:o(()=>[t(p,null,{default:o(()=>[(c(),_(v1(g.value?e(w1):e(C1)),{class:"svg-icon"}))]),_:1})]),_:1},8,["style"])):C("",!0)]),_:1},8,["content"]),t(Q,{style:{margin:"0 16px 0 7px"},direction:"vertical"}),r("div",j1,[r("span",G1,l(e(i)("visualization.creator"))+":"+l(e(a).creatorName),1),t(Y,{"show-arrow":"",offset:8,placement:"bottom",width:"400",trigger:"hover"},{reference:o(()=>[t(m,{class:"info-tips"},{default:o(()=>[t(M,{name:"dv-info"},{default:o(()=>[t(e(h1),{class:"svg-icon"})]),_:1})]),_:1})]),default:o(()=>[t(S1)]),_:1})]),r("div",J1,[H.value?C("",!0):(c(),_(x,{key:0,disabled:e(a).status===0,secondary:"",onClick:s[0]||(s[0]=()=>e(W)().emitter.emit("canvasFullscreen"))},{icon:o(()=>[t(p,{name:"icon_pc_fullscreen"},{default:o(()=>[t(e(U1),{class:"svg-icon"})]),_:1})]),default:o(()=>[d(" "+l(e(i)("visualization.fullscreen")),1)]),_:1},8,["disabled"])),t(x,{secondary:"",onClick:s[1]||(s[1]=v=>F()),disabled:e(a).status===0},{icon:o(()=>[t(p,{name:"icon_pc_outlined"},{default:o(()=>[t(e(g1),{class:"svg-icon"})]),_:1})]),default:o(()=>[d(" "+l(e(i)("template_manage.preview")),1)]),_:1},8,["disabled"]),O.value?C("",!0):(c(),_($1,{key:1,disabled:e(a).status===0,"resource-id":e(a).id,weight:e(a).weight,"resource-type":e(a).type},null,8,["disabled","resource-id","weight","resource-type"])),e(a).weight>6?(c(),_(x,{key:2,class:"custom-button",type:"primary",onClick:s[2]||(s[2]=v=>J())},{icon:o(()=>[t(p,{name:"icon_edit_outlined"},{default:o(()=>[t(e(k1),{class:"svg-icon"})]),_:1})]),default:o(()=>[d(" "+l(e(i)("visualization.edit")),1)]),_:1})):C("",!0),t(B,{disabled:e(a).status===0,"popper-class":"pad12",trigger:"click"},{dropdown:o(()=>[t($,null,{default:o(()=>[t(w,{onClick:s[3]||(s[3]=v=>G())},{default:o(()=>[t(m,{color:"#646A73",size:"16"},{default:o(()=>[t(e(y1))]),_:1}),d(l(e(i)("visualization.refresh_data")),1)]),_:1}),j.value[0]?(c(),_(B,{key:0,style:{width:"100%",overflow:"hidden"},trigger:"hover","popper-class":"pad12",placement:"left-start"},{dropdown:o(()=>[t($,null,{default:o(()=>[t(w,{onClick:s[4]||(s[4]=v=>I("pdf"))},{default:o(()=>[...s[8]||(s[8]=[d("PDF",-1)])]),_:1}),t(w,{onClick:s[5]||(s[5]=v=>A("template"))},{default:o(()=>[d(l(e(i)("visualization.style_template")),1)]),_:1}),t(w,{onClick:s[6]||(s[6]=v=>A("app"))},{default:o(()=>[d(l(e(i)("visualization.apply_template")),1)]),_:1}),t(w,{onClick:s[7]||(s[7]=v=>I("img"))},{default:o(()=>[d(l(e(i)("chart.image")),1)]),_:1})]),_:1})]),default:o(()=>[r("div",X1,[t(m,{color:"#646A73",size:"16"},{default:o(()=>[t(e(b1))]),_:1}),d(" "+l(e(i)("visualization.export_as"))+" ",1),t(m,{color:"#646A73",size:"16",class:"arrow-right_icon"},{default:o(()=>[t(q)]),_:1})])]),_:1})):C("",!0)]),_:1})]),default:o(()=>[t(m,{class:"head-more-icon"},{default:o(()=>[t(M,{name:"dv-head-more"},{default:o(()=>[t(e(Z1),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["disabled"])])]),t(e(l1),{ref_key:"openHandler",ref:f,jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvT3BlbkhhbmRsZXI="},null,512)],64)}}});export{me as _,U1 as i};
