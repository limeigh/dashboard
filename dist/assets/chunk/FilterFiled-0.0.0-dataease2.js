import{R as Fe}from"./index-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as Se}from"./el-popover-0.0.0-dataease.js";import{o as ze,G as Ue,n as De,j as Pe,y as $e}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-checkbox-group-0.0.0-dataease.js";import{E as Le,a as Ne}from"./el-checkbox-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{a as Oe,E as Me}from"./el-select-0.0.0-dataease.js";import{a as je,b as Ae}from"./el-dropdown-menu-0.0.0-dataease.js";import{d as Be,r as v,t as Re,x as X,y as C,w as Y,aj as Ge,f as d,O as p,P as o,a4 as f,u as t,j as u,i as r,a8 as Ke,W as k,a6 as T,T as We,g as V,l as qe,S as He,_ as P,a3 as F,V as Je,R as Qe,ag as Xe}from"./vue-0.0.0-dataease.js";import{i as Ye}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as Ze}from"./icon_close_outlined-0.0.0-dataease.js";import{i as el}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{L as ll}from"./dataset-0.0.0-dataease.js";import{s as tl,t as al,a as nl,d as ol,v as sl,f as A}from"./options-0.0.0-dataease.js";import{i as ul}from"./field-list-0.0.0-dataease.js";import{E as il}from"./index-0.0.0-dataease20.js";import{E as rl}from"./index-0.0.0-dataease4.js";import{_ as dl}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./refs-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";import"./index-0.0.0-dataease3.js";const cl={class:"white-nowrap"},ml={class:"filed-title"},vl={class:"dimension"},pl=["onClick"],fl={key:0,class:"white-nowrap flex-align-center",style:{position:"relative"}},_l={class:"filed-title"},hl={class:"filed-title"},yl={class:"de-panel clearfix"},gl={class:"mod-left"},kl={class:"autochecker-list",style:{height:"260px"}},Vl={class:"select-all"},bl=["title"],wl={class:"mod-left right-de"},xl={class:"right-top clearfix"},Cl={class:"right-btn"},Tl={key:0,class:"de-el-dropdown-menu-manu"},El={class:"text-area"},Il=["placeholder"],Fl={class:"text-area-btn"},Sl={class:"autochecker-list"},zl={class:"clear-checkbox__label"},Ul=["title"],Dl={class:"right-menu-foot"},Pl=Be({__name:"FilterFiled",props:{index:{default:0},item:{default:()=>({term:"",fieldId:"",filterType:"",deType:0,enumValue:"",name:"",value:null,timeValue:""})}},emits:["update:item","del"],setup(Z,{emit:ee}){const le=Z,{t:c}=ze(),$=v(),te=v(),L=v(!1),S=v(""),z=v(""),U=v(""),b=v([]),E=v(),B=v(!1),m=v([]),D=v([]),N=v(""),{item:n}=Re(le),O=X("getAuthTargetType"),ae=X("filedList"),_=C(()=>U.value?b.value.filter(a=>a.includes(U.value)):b.value),ne=C(()=>m.value.join(",")),oe=C(()=>["in","not in"].includes(n.value.term)?[{value:"${sysParams.roles}",label:c("auth.sysParams_type.role")}]:tl),se=C(()=>{const{deType:a}=n.value;return w.value==="sysParams"?al:[0,5,7].includes(a)?nl:a===1?ol:sl}),ue=C(()=>S.value?R.value.filter(a=>a.name.includes(S.value)):R.value),R=C(()=>Object.values(ae.value||{})),w=v("");Y(()=>O==null?void 0:O.authTargetType,a=>{w.value===a||!a||(w.value=a)},{immediate:!0}),Ge(()=>{de(),K(n.value.deType)});const ie=()=>{fe(),$.value.$el.click()},re=()=>{const{enumValue:a}=n.value,e=a.trim()?a.split(","):[];m.value=e,i.value=_.value.filter(s=>e.includes(s)),i.value.length&&(g.value=i.value.length===_.value.length,y.value=i.value.length!==_.value.length),i.value.length||(g.value=!1,y.value=!1),$.value.$el.click()},de=()=>{const{name:a,enumValue:e,fieldId:s}=n.value,h=e.trim()?e.split(","):[];!a&&s&&(m.value=h),!(!a&&!s)&&(G(),z.value=n.value.name,m.value=h)},ce=()=>{!E.value&&!B.value&&(B.value=!0),E.value=!0},me=()=>{n.value.term="",n.value.value=null,G()},G=()=>{if(w.value==="sysParams")return;const{deType:a,filterType:e,fieldId:s}=n.value;e==="enum"&&[0,5,7].includes(a)&&ll({fieldIds:[s]}).then(h=>{b.value=ve(h.data),i.value=b.value.filter(x=>m.value.includes(x)),i.value.length&&(g.value=i.value.length===b.value.length,y.value=i.value.length!==b.value.length),i.value.length||(g.value=!1,y.value=!1)})},ve=a=>a?a.filter(e=>!!e):null,pe=()=>{n.value.name=z.value||""},fe=()=>{n.value.enumValue=ne.value||""},_e=(a,e)=>{m.value.splice(a,1),i.value=i.value.filter(s=>s!==e),W()},he=({name:a,id:e,deType:s})=>{z.value=a,Object.assign(n.value,{fieldId:e,name:a,deType:s,filterType:"logic",enumValue:"",value:"",term:"",timeValue:""}),K(s),m.value=[]},K=a=>{D.value=[{value:"logic",label:c("deDataset.logic_filter")},{value:"enum",label:c("deDataset.enum_filter")}],(w.value==="sysParams"||[1,2,3].includes(a))&&(D.value=[D.value[0]])},ye=()=>{m.value=[],i.value=[],g.value=!1,y.value=!1},ge=()=>{_.value.forEach(a=>{m.value.includes(a)||m.value.push(a)}),i.value=[...new Set([..._.value,...i.value])]},y=v(!1),g=v(!1),i=v([]);let I=[];Y(()=>_.value,a=>{!I.length&&a.length!==b.value.length&&(I=[...i.value]),I.length&&a.length===b.value.length&&(I=[]);const e=a.every(s=>i.value.includes(s));y.value=a.length&&i.value.length&&!e,g.value=a.length&&e});const W=()=>{const a=_.value.filter(s=>!i.value.includes(s)),e=[...i.value];m.value=[...new Set(m.value.concat(i.value))].filter(s=>!a.includes(s)),i.value=[...new Set(I.concat(i.value))].filter(s=>!a.includes(s)),e.length&&(g.value=e.length===_.value.length,y.value=e.length!==_.value.length),e.length||(g.value=!1,y.value=!1)},ke=a=>{a?ge():(i.value=i.value.filter(e=>!_.value.includes(e)),m.value=m.value.filter(e=>!_.value.includes(e))),y.value=!1},Ve=()=>{const a=N.value.split(`
`).reduce((e,s)=>{const h=s.trim();return h&&e.add(h),e},new Set([]));a.size&&(m.value=[...new Set([...m.value,...Array.from(a)])]),E.value=!1},be=ee;return(a,e)=>{const s=Ue,h=De,x=Pe,we=je,xe=Ae,M=Oe,j=Me,Ce=il,Te=rl,q=Le,H=Fe,Ee=Ne,J=$e,Ie=Se;return d(),p("div",cl,[o("div",{class:"filed",onMouseover:e[16]||(e[16]=l=>L.value=!0),onMouseleave:e[17]||(e[17]=l=>L.value=!1)},[o("span",ml,f(t(c)("auth.filter_fields")),1),u(xe,{trigger:"click","hide-on-click":!1},{dropdown:r(()=>[u(we,{class:"de-el-dropdown-menu"},{default:r(()=>[u(s,{onKeydown:e[1]||(e[1]=Ke(()=>{},["stop"])),placeholder:t(c)("auth.enter_keywords"),size:"small",modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=l=>S.value=l)},{prefix:r(()=>[u(x,null,{default:r(()=>[u(h,{name:"icon_search-outline_outlined"},{default:r(()=>[u(t(Ye),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),o("ul",vl,[(d(!0),p(k,null,T(ue.value,l=>(d(),p("li",{onClick:Q=>he(l),style:We({backgroundColor:z.value===l.name?"#f0f7ff":""}),key:l.id},[u(x,null,{default:r(()=>[u(h,{className:`field-icon-${t(A)[l.deType]}`},{default:r(()=>[(d(),V(qe(t(ul)[t(A)[l.deType]]),{class:He(["svg-icon",`field-icon-${t(A)[l.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),o("span",null,f(l.name),1)],12,pl))),128))])]),_:1})]),default:r(()=>[u(s,{placeholder:t(c)("auth.select_filter_fields"),modelValue:t(n).name,"onUpdate:modelValue":e[0]||(e[0]=l=>t(n).name=l),size:"small",onInput:pe},null,8,["placeholder","modelValue"])]),_:1}),t(n).fieldId?(d(),p("div",fl,[o("span",_l,f(t(c)("auth.screen_method")),1),u(j,{size:"small",onChange:me,modelValue:t(n).filterType,"onUpdate:modelValue":e[3]||(e[3]=l=>t(n).filterType=l),class:"w181",placeholder:t(c)("auth.select")},{default:r(()=>[(d(!0),p(k,null,T(D.value,l=>(d(),V(M,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),o("span",hl,f(t(c)("auth.fixed_value")),1),t(n).filterType==="logic"?(d(),p(k,{key:0},[u(j,{class:"w100",size:"small",modelValue:t(n).term,"onUpdate:modelValue":e[4]||(e[4]=l=>t(n).term=l),placeholder:t(c)("auth.default_method")},{default:r(()=>[(d(!0),p(k,null,T(se.value,l=>(d(),V(M,{key:l.value,label:t(c)(l.label),value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),w.value==="sysParams"?(d(),V(j,{key:0,class:"w70 mar5",size:"small",modelValue:t(n).value,"onUpdate:modelValue":e[5]||(e[5]=l=>t(n).value=l)},{default:r(()=>[(d(!0),p(k,null,T(oe.value,l=>(d(),V(M,{key:l.value,label:t(c)(l.label),value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):[2,3].includes(t(n).deType)&&!["null","empty","not_null","not_empty"].includes(t(n).term)?(d(),p(k,{key:1},[u(Ce,{class:"w70 mar5",size:"small",effect:"plain",modelValue:t(n).value,"onUpdate:modelValue":e[6]||(e[6]=l=>t(n).value=l),"controls-position":"right"},null,8,["modelValue"]),e[18]||(e[18]=o("div",{class:"bottom-line"},null,-1))],64)):["null","empty","not_null","not_empty"].includes(t(n).term)?P("",!0):(d(),p(k,{key:2},[t(n).deType===1?(d(),V(Te,{key:0,class:"item",effect:"light",content:t(n).timeValue,placement:"top"},{default:r(()=>[u(s,{class:"w70 mar5",size:"small",modelValue:t(n).timeValue,"onUpdate:modelValue":e[7]||(e[7]=l=>t(n).timeValue=l)},null,8,["modelValue"])]),_:1},8,["content"])):(d(),V(s,{key:1,class:"w70 mar5",size:"small",modelValue:t(n).value,"onUpdate:modelValue":e[8]||(e[8]=l=>t(n).value=l)},null,8,["modelValue"])),e[19]||(e[19]=o("div",{class:"bottom-line"},null,-1))],64))],64)):(d(),V(Ie,{key:1,"popper-class":"de-el-dropdown-menu-fixed",width:"360px",trigger:"click",ref_key:"deElDropdownMenuFixed",ref:te,"hide-on-click":!1},{reference:r(()=>[u(s,{modelValue:t(n).enumValue,"onUpdate:modelValue":e[9]||(e[9]=l=>t(n).enumValue=l),ref_key:"enumInput",ref:$,size:"small",readonly:"",clearable:""},null,8,["modelValue"])]),default:r(()=>[o("div",yl,[o("div",gl,[u(s,{placeholder:t(c)("auth.enter_keywords"),modelValue:U.value,"onUpdate:modelValue":e[10]||(e[10]=l=>U.value=l)},null,8,["placeholder","modelValue"]),o("ul",kl,[o("div",Vl,[u(q,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=l=>g.value=l),indeterminate:y.value,label:t(c)("component.allSelect"),onChange:ke},null,8,["modelValue","indeterminate","label"])]),u(Ee,{modelValue:i.value,"onUpdate:modelValue":e[12]||(e[12]=l=>i.value=l),onChange:W},{default:r(()=>[u(H,{height:"230px"},{default:r(()=>[(d(!0),p(k,null,T(_.value,l=>(d(),p("li",{key:l,title:l},[u(q,{label:l},{default:r(()=>[F(f(l),1)]),_:2},1032,["label"])],8,bl))),128))]),_:1})]),_:1},8,["modelValue"])])]),o("div",wl,[o("div",xl,[F(f(t(c)("common.list_selection"))+" ",1),o("div",Cl,[o("span",{onClick:ce},[e[20]||(e[20]=o("i",{class:"el-icon-edit"},null,-1)),F(" "+f(t(c)("auth.manual_input")),1)]),u(Je,{name:"el-zoom-in-top"},{default:r(()=>[E.value?(d(),p("div",Tl,[o("div",El,[Qe(o("textarea",{placeholder:t(c)("auth.please_fill"),class:"input","onUpdate:modelValue":e[13]||(e[13]=l=>N.value=l)},null,8,Il),[[Xe,N.value]]),o("div",Fl,[o("button",{type:"button",onClick:e[14]||(e[14]=l=>E.value=!1),class:"btn"},[o("span",null,f(t(c)("auth.close")),1)]),o("button",{type:"button",onClick:Ve,class:"btn right-add"},[o("span",null,f(t(c)("auth.add")),1)])])])])):P("",!0)]),_:1})])]),o("ul",Sl,[o("div",zl,[o("span",null,f(t(c)("auth.added")+" "+m.value.length),1),o("span",{onClick:ye},f(t(c)("user.clear_button")),1)]),u(H,{height:"230px"},{default:r(()=>[(d(!0),p(k,null,T(m.value,(l,Q)=>(d(),p("li",{key:l},[o("div",{title:l,class:"right-checkbox__label"},f(l),9,Ul),u(x,{onClick:$l=>_e(Q,l),class:"remove-hover-icon"},{default:r(()=>[u(h,null,{default:r(()=>[u(t(Ze),{class:"svg-icon"})]),_:1})]),_:1},8,["onClick"])]))),128))]),_:1})])]),o("div",Dl,[u(J,{secondary:"",onClick:re},{default:r(()=>[F(f(t(c)("common.cancel")),1)]),_:1}),u(J,{type:"primary",onClick:ie},{default:r(()=>[F(f(t(c)("auth.sure")),1)]),_:1})])])]),_:1},512))])):P("",!0),L.value?(d(),V(x,{key:1,class:"font12",onClick:e[15]||(e[15]=l=>be("del"))},{default:r(()=>[u(h,{name:"icon_delete-trash_outlined"},{default:r(()=>[u(t(el),{class:"svg-icon"})]),_:1})]),_:1})):P("",!0)],32)])}}});const _t=dl(Pl,[["__scopeId","data-v-0f513316"]]);export{_t as default};
