import{c as _,a as F,w as D,q as G,d as M,r as T,y as V,n as Y,o as $,b as W,L as Z,j as f,ah as q,W as J,a2 as g,V as Q,R as X,U as ee}from"./vue-0.0.0-dataease.js";import{n as A,t as P,s as oe,v as ne,x as te,p as ae,e as z,k as x,c as se,i as le,d as ce,I as re,w as ie}from"./index-0.0.0-dataease29.js";import{u as de,a as ue,c as fe}from"./use-route-0.0.0-dataease.js";import{u as ve,O as ye}from"./index-0.0.0-dataease31.js";import{P as me,H as Ie}from"./index-0.0.0-dataease30.js";const he={show:Boolean,zIndex:A,overlay:P,duration:A,teleport:[String,Object],lockScroll:P,lazyRender:P,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:oe,transitionAppear:Boolean,closeOnClickOverlay:P};let m=0;const B="van-overflow-hidden";function Oe(e,n){const a=de(),v="01",t="10",r=s=>{a.move(s);const u=a.deltaY.value>0?t:v,k=te(s.target,e.value),{scrollHeight:y,offsetHeight:h,scrollTop:O}=k;let l="11";O===0?l=h>=y?"00":"01":O+h>=y&&(l="10"),l!=="11"&&a.isVertical()&&!(parseInt(l,2)&parseInt(u,2))&&ae(s,!0)},d=()=>{document.addEventListener("touchstart",a.start),document.addEventListener("touchmove",r,{passive:!1}),m||document.body.classList.add(B),m++},i=()=>{m&&(document.removeEventListener("touchstart",a.start),document.removeEventListener("touchmove",r),m--,m||document.body.classList.remove(B))},w=()=>n()&&d(),I=()=>n()&&i();ne(w),_(I),F(I),D(n,s=>{s?d():i()})}let Ce=2e3;const Pe=()=>++Ce,E=()=>{var e;const{scopeId:n}=((e=G())==null?void 0:e.vnode)||{};return n?{[n]:""}:null},we=z({},he,{round:Boolean,position:x("center"),closeIcon:x("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:x("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[ke,L]=se("popup");var pe=M({name:ke,inheritAttrs:!1,props:we,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:n,attrs:a,slots:v}){let t,r;const d=T(),i=T(),w=ve(()=>e.show||!e.lazyRender),I=V(()=>{const o={zIndex:d.value};if(le(e.duration)){const c=e.position==="center"?"animationDuration":"transitionDuration";o[c]=`${e.duration}s`}return o}),s=()=>{t||(t=!0,d.value=e.zIndex!==void 0?+e.zIndex:Pe(),n("open"))},u=()=>{t&&fe(e.beforeClose,{done(){t=!1,n("close"),n("update:show",!1)}})},k=o=>{n("clickOverlay",o),e.closeOnClickOverlay&&u()},y=()=>{if(e.overlay){const o=z({show:e.show,class:e.overlayClass,zIndex:d.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return f(ye,g(o,E(),{onClick:k}),{default:v["overlay-content"]})}},h=o=>{n("clickCloseIcon",o),u()},O=()=>{if(e.closeable)return f(re,{role:"button",tabindex:0,name:e.closeIcon,class:[L("close-icon",e.closeIconPosition),Ie],classPrefix:e.iconPrefix,onClick:h},null)};let l;const R=()=>{l&&clearTimeout(l),l=setTimeout(()=>{n("opened")})},K=()=>n("closed"),N=o=>n("keydown",o),j=w(()=>{var o;const{destroyOnClose:c,round:p,position:C,safeAreaInsetTop:H,safeAreaInsetBottom:U,show:S}=e;if(!(!S&&c))return X(f("div",g({ref:i,style:I.value,role:"dialog",tabindex:0,class:[L({round:p,[C]:C}),{"van-safe-area-top":H,"van-safe-area-bottom":U}],onKeydown:N},a,E()),[(o=v.default)==null?void 0:o.call(v),O()]),[[ee,S]])}),b=()=>{const{position:o,transition:c,transitionAppear:p}=e,C=o==="center"?"van-fade":`van-popup-slide-${o}`;return f(Q,{name:c||C,appear:p,onAfterEnter:R,onAfterLeave:K},{default:j})};return D(()=>e.show,o=>{o&&!t&&(s(),a.tabindex===0&&Y(()=>{var c;(c=i.value)==null||c.focus()})),!o&&t&&(t=!1,n("close"))}),ue({popupRef:i}),Oe(i,()=>e.show&&e.lockScroll),ce("popstate",()=>{e.closeOnPopstate&&(u(),r=!1)}),$(()=>{e.show&&s()}),W(()=>{r&&(n("update:show",!0),r=!1)}),_(()=>{e.show&&e.teleport&&(u(),r=!0)}),Z(me,()=>e.show),()=>e.teleport?f(q,{to:e.teleport},{default:()=>[y(),b()]}):f(J,null,[y(),b()])}});const xe=ie(pe);var Be=xe;export{xe as P,Be as s,E as u};
