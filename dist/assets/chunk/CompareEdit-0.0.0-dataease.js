import{y as j,w as q,P as I,Q as J,x as U,A as B}from"./element-plus-secondary-0.0.0-dataease.js";import{f as R}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as P,t as Y,l as G,k as S,w as Q,o as _,c as b,W as s,U as m,u as c,S as x,a8 as k,T as L,R as W,_ as C,Y as u,a as V}from"./@vue-0.0.0-dataease.js";import{_ as z}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./fast-png-0.0.0-dataease.js";import"./iobuffer-0.0.0-dataease.js";import"./pako-0.0.0-dataease.js";import"./vue-router_2-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const H=[{name:"year_mom",value:"year_mom"}],K=[{name:"month_mom",value:"month_mom"},{name:"year_yoy",value:"year_yoy"}],X=[{name:"day_mom",value:"day_mom"},{name:"month_yoy",value:"month_yoy"},{name:"year_yoy",value:"year_yoy"}],Z={class:"exp-style"},$={class:"exp-style",style:{"padding-top":"2px"}},ee=P({__name:"CompareEdit",props:{compareItem:{type:Object,required:!0},chart:{type:Object,required:!0},dimensionData:{type:Array,required:!1},quotaData:{type:Array,required:!1}},setup(E){const{t:e}=R(),d=E,{compareItem:a,chart:i}=Y(d),o=G({fieldList:[],compareList:[],dateFormatter:"y_M_d"}),A=[{name:e("chart.y"),value:"y"},{name:e("chart.y_M"),value:"y_M"},{name:e("chart.y_M_d"),value:"y_M_d"}],F=()=>{const r=o.fieldList.filter(t=>t.id===a.value.compareCalc.field);r&&r.length>0&&(r[0].dateStyle=o.dateFormatter,a.value.compareCalc.custom||(a.value.compareCalc.custom={timeType:"y_M_d"}),a.value.compareCalc.custom.timeType=o.dateFormatter),h()},g=()=>{var t;const r=(t=a.value.compareCalc.custom)==null?void 0:t.timeType;y.value&&r&&(o.dateFormatter=r,F())},M=S(()=>{let r=o.dateFormatter;const t=o.fieldList.filter(p=>p.id===a.value.compareCalc.field);switch(t&&t.length>0&&(r=t[0].dateStyle),r){case"y_M_d":switch(a.value.compareCalc.type){case"day_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_day_pre");case"sub":return e("chart.compare_calc_day_sub");case"percent":return e("chart.compare_calc_day_percent")}break;case"month_yoy":case"month_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_month_pre");case"sub":return e("chart.compare_calc_month_sub");case"percent":return e("chart.compare_calc_month_percent")}break;case"year_yoy":case"year_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_year_pre");case"sub":return e("chart.compare_calc_year_sub");case"percent":return e("chart.compare_calc_year_percent")}break}break;case"y_M":switch(a.value.compareCalc.type){case"month_yoy":case"month_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_month_pre_m");case"sub":return e("chart.compare_calc_month_sub_m");case"percent":return e("chart.compare_calc_month_percent_m")}break;case"year_yoy":case"year_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_year_pre_m");case"sub":return e("chart.compare_calc_year_sub_m");case"percent":return e("chart.compare_calc_year_percent_m")}break}break;case"y":switch(a.value.compareCalc.type){case"year_yoy":case"year_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_year_pre_y");case"sub":return e("chart.compare_calc_year_sub_y");case"percent":return e("chart.compare_calc_year_percent_y")}break}break}return""});Q(()=>d.chart,()=>{w(),h(),g()},{deep:!0});const y=S(()=>i.value.type==="indicator"),w=()=>{let r=null;Object.prototype.toString.call(i.value.xAxis)==="[object Array]"?r=JSON.parse(JSON.stringify(i.value.xAxis)):r=JSON.parse(i.value.xAxis);const t=r.filter(p=>p.deType===1);if(i.value.type==="table-pivot"){let p=null;Object.prototype.toString.call(i.value.xAxisExt)==="[object Array]"?p=JSON.parse(JSON.stringify(i.value.xAxisExt)):p=JSON.parse(i.value.xAxisExt);const f=p.filter(n=>n.deType===1);t.push(...f)}y.value&&(t.length=0,t.push(...d.dimensionData.filter(p=>p.deType===1)),t.push(...d.quotaData.filter(p=>p.deType===1))),o.fieldList=t,(!a.value.compareCalc.field||a.value.compareCalc.field==="")&&o.fieldList.length>0&&(a.value.compareCalc.field=o.fieldList[0].id)},O=["day_mom","month_yoy","year_yoy","month_mom","year_mom"],h=()=>{const r=o.fieldList.filter(t=>t.id===a.value.compareCalc.field);if(r&&r.length>0)switch(r[0].dateStyle){case"y":o.compareList=H;break;case"y_M":o.compareList=K;break;case"y_M_d":o.compareList=X;break}else o.compareList=[];!O.includes(a.value.compareCalc.type)&&o.compareList.length>0&&(a.value.compareCalc.type=o.compareList[0].value)},T=r=>y.value?r.name:r.name+"("+e("chart."+r.dateStyle)+")";return w(),h(),g(),(r,t)=>{const p=B,f=j,n=q,v=I,D=J,N=U;return _(),b("div",null,[s(N,{ref:"form",model:c(a).compareCalc,"label-width":"80px",class:"compare-form"},{default:m(()=>[s(n,{label:c(e)("chart.compare_date")},{default:m(()=>[s(f,{modelValue:c(a).compareCalc.field,"onUpdate:modelValue":t[0]||(t[0]=l=>c(a).compareCalc.field=l),placeholder:c(e)("chart.pls_select_field"),onChange:h},{default:m(()=>[(_(!0),b(x,null,k(o.fieldList,l=>(_(),L(p,{key:l.id,label:T(l),value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),y.value?(_(),L(n,{key:0,label:c(e)("chart.datePattern")},{default:m(()=>[s(f,{modelValue:o.dateFormatter,"onUpdate:modelValue":t[1]||(t[1]=l=>o.dateFormatter=l),placeholder:c(e)("chart.date_format"),onChange:F},{default:m(()=>[(_(),b(x,null,k(A,l=>s(p,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):W("",!0),s(n,{label:c(e)("chart.compare_type")},{default:m(()=>[s(D,{modelValue:c(a).compareCalc.type,"onUpdate:modelValue":t[2]||(t[2]=l=>c(a).compareCalc.type=l)},{default:m(()=>[(_(!0),b(x,null,k(o.compareList,l=>(_(),L(v,{key:l.value,label:l.value},{default:m(()=>[C(u(c(e)("chart."+l.value)),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(n,{label:c(e)("chart.compare_data")},{default:m(()=>[s(D,{modelValue:c(a).compareCalc.resultData,"onUpdate:modelValue":t[3]||(t[3]=l=>c(a).compareCalc.resultData=l)},{default:m(()=>[s(v,{label:"pre"},{default:m(()=>[C(u(c(e)("chart.data_pre")),1)]),_:1}),s(v,{label:"sub"},{default:m(()=>[C(u(c(e)("chart.data_sub")),1)]),_:1}),s(v,{label:"percent"},{default:m(()=>[C(u(c(e)("chart.data_percent")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(n,{label:c(e)("chart.compare_calc_expression")},{default:m(()=>[V("span",Z,u(M.value),1)]),_:1},8,["label"]),s(n,{label:c(e)("chart.tip")},{default:m(()=>[V("span",$,u(c(e)("chart.compare_calc_tip")),1)]),_:1},8,["label"])]),_:1},8,["model"])])}}});const ra=z(ee,[["__scopeId","data-v-05edf29b"]]);export{ra as default};
