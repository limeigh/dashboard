import"./index-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import{E as j,a as q}from"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as I,a as J}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{o as B}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as U,a as R}from"./index-0.0.0-dataease27.js";import{d as P,t as G,X as W,y as V,w as X,f as u,O as b,j as p,i as m,u as l,W as x,a6 as L,g as k,_ as Y,a3 as C,a4 as i,P as w}from"./vue-0.0.0-dataease.js";import{_ as z}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const H=[{name:"year_mom",value:"year_mom"}],K=[{name:"month_mom",value:"month_mom"},{name:"year_yoy",value:"year_yoy"}],Q=[{name:"day_mom",value:"day_mom"},{name:"month_yoy",value:"month_yoy"},{name:"year_yoy",value:"year_yoy"}],Z={class:"exp-style"},$={class:"exp-style",style:{"padding-top":"2px"}},ee=P({__name:"CompareEdit",props:{compareItem:{type:Object,required:!0},chart:{type:Object,required:!0},dimensionData:{type:Array,required:!1},quotaData:{type:Array,required:!1}},setup(S){const{t:e}=B(),d=S,{compareItem:a,chart:n}=G(d),c=W({fieldList:[],compareList:[],dateFormatter:"y_M_d"}),A=[{name:e("chart.y"),value:"y"},{name:e("chart.y_M"),value:"y_M"},{name:e("chart.y_M_d"),value:"y_M_d"}],g=()=>{const r=c.fieldList.filter(t=>t.id===a.value.compareCalc.field);r&&r.length>0&&(r[0].dateStyle=c.dateFormatter,a.value.compareCalc.custom||(a.value.compareCalc.custom={timeType:"y_M_d"}),a.value.compareCalc.custom.timeType=c.dateFormatter),h()},F=()=>{var t;const r=(t=a.value.compareCalc.custom)==null?void 0:t.timeType;y.value&&r&&(c.dateFormatter=r,g())},O=V(()=>{let r=c.dateFormatter;const t=c.fieldList.filter(s=>s.id===a.value.compareCalc.field);switch(t&&t.length>0&&(r=t[0].dateStyle),r){case"y_M_d":switch(a.value.compareCalc.type){case"day_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_day_pre");case"sub":return e("chart.compare_calc_day_sub");case"percent":return e("chart.compare_calc_day_percent")}break;case"month_yoy":case"month_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_month_pre");case"sub":return e("chart.compare_calc_month_sub");case"percent":return e("chart.compare_calc_month_percent")}break;case"year_yoy":case"year_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_year_pre");case"sub":return e("chart.compare_calc_year_sub");case"percent":return e("chart.compare_calc_year_percent")}break}break;case"y_M":switch(a.value.compareCalc.type){case"month_yoy":case"month_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_month_pre_m");case"sub":return e("chart.compare_calc_month_sub_m");case"percent":return e("chart.compare_calc_month_percent_m")}break;case"year_yoy":case"year_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_year_pre_m");case"sub":return e("chart.compare_calc_year_sub_m");case"percent":return e("chart.compare_calc_year_percent_m")}break}break;case"y":switch(a.value.compareCalc.type){case"year_yoy":case"year_mom":switch(a.value.compareCalc.resultData){case"pre":return e("chart.compare_calc_year_pre_y");case"sub":return e("chart.compare_calc_year_sub_y");case"percent":return e("chart.compare_calc_year_percent_y")}break}break}return""});X(()=>d.chart,()=>{E(),h(),F()},{deep:!0});const y=V(()=>n.value.type==="indicator"),E=()=>{let r=null;Object.prototype.toString.call(n.value.xAxis)==="[object Array]"?r=JSON.parse(JSON.stringify(n.value.xAxis)):r=JSON.parse(n.value.xAxis);const t=r.filter(s=>s.deType===1);if(n.value.type==="table-pivot"){let s=null;Object.prototype.toString.call(n.value.xAxisExt)==="[object Array]"?s=JSON.parse(JSON.stringify(n.value.xAxisExt)):s=JSON.parse(n.value.xAxisExt);const f=s.filter(_=>_.deType===1);t.push(...f)}y.value&&(t.length=0,t.push(...d.dimensionData.filter(s=>s.deType===1)),t.push(...d.quotaData.filter(s=>s.deType===1))),c.fieldList=t,(!a.value.compareCalc.field||a.value.compareCalc.field==="")&&c.fieldList.length>0&&(a.value.compareCalc.field=c.fieldList[0].id)},M=["day_mom","month_yoy","year_yoy","month_mom","year_mom"],h=()=>{const r=c.fieldList.filter(t=>t.id===a.value.compareCalc.field);if(r&&r.length>0)switch(r[0].dateStyle){case"y":c.compareList=H;break;case"y_M":c.compareList=K;break;case"y_M_d":c.compareList=Q;break}else c.compareList=[];!M.includes(a.value.compareCalc.type)&&c.compareList.length>0&&(a.value.compareCalc.type=c.compareList[0].value)},N=r=>y.value?r.name:r.name+"("+e("chart."+r.dateStyle)+")";return E(),h(),F(),(r,t)=>{const s=J,f=I,_=j,v=U,D=R,T=q;return u(),b("div",null,[p(T,{ref:"form",model:l(a).compareCalc,"label-width":"80px",class:"compare-form"},{default:m(()=>[p(_,{label:l(e)("chart.compare_date")},{default:m(()=>[p(f,{modelValue:l(a).compareCalc.field,"onUpdate:modelValue":t[0]||(t[0]=o=>l(a).compareCalc.field=o),placeholder:l(e)("chart.pls_select_field"),onChange:h},{default:m(()=>[(u(!0),b(x,null,L(c.fieldList,o=>(u(),k(s,{key:o.id,label:N(o),value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),y.value?(u(),k(_,{key:0,label:l(e)("chart.datePattern")},{default:m(()=>[p(f,{modelValue:c.dateFormatter,"onUpdate:modelValue":t[1]||(t[1]=o=>c.dateFormatter=o),placeholder:l(e)("chart.date_format"),onChange:g},{default:m(()=>[(u(),b(x,null,L(A,o=>p(s,{key:o.value,label:o.name,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):Y("",!0),p(_,{label:l(e)("chart.compare_type")},{default:m(()=>[p(D,{modelValue:l(a).compareCalc.type,"onUpdate:modelValue":t[2]||(t[2]=o=>l(a).compareCalc.type=o)},{default:m(()=>[(u(!0),b(x,null,L(c.compareList,o=>(u(),k(v,{key:o.value,label:o.value},{default:m(()=>[C(i(l(e)("chart."+o.value)),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(_,{label:l(e)("chart.compare_data")},{default:m(()=>[p(D,{modelValue:l(a).compareCalc.resultData,"onUpdate:modelValue":t[3]||(t[3]=o=>l(a).compareCalc.resultData=o)},{default:m(()=>[p(v,{label:"pre"},{default:m(()=>[C(i(l(e)("chart.data_pre")),1)]),_:1}),p(v,{label:"sub"},{default:m(()=>[C(i(l(e)("chart.data_sub")),1)]),_:1}),p(v,{label:"percent"},{default:m(()=>[C(i(l(e)("chart.data_percent")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(_,{label:l(e)("chart.compare_calc_expression")},{default:m(()=>[w("span",Z,i(O.value),1)]),_:1},8,["label"]),p(_,{label:l(e)("chart.tip")},{default:m(()=>[w("span",$,i(l(e)("chart.compare_calc_tip")),1)]),_:1},8,["label"])]),_:1},8,["model"])])}}});const ge=z(ee,[["__scopeId","data-v-05edf29b"]]);export{ge as default};
