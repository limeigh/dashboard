import"./index-0.0.0-dataease.js";import{E as me}from"./el-color-picker-0.0.0-dataease.js";import{o as ye,n as he,y as ge,j as be,G as ve}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import{E as xe}from"./el-col-0.0.0-dataease.js";import{a as Ve,E as ke,b as Ce}from"./el-select-0.0.0-dataease.js";import{E as Te}from"./el-row-0.0.0-dataease.js";import{E as Ne}from"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{d as Se,X as Je,f as o,g as u,i as a,P as M,j as t,u as i,a4 as S,O as g,a6 as v,W as x,a8 as X,a3 as w,l as q,S as $,_ as V}from"./vue-0.0.0-dataease.js";import{i as Ue}from"./icon_info_filled-0.0.0-dataease.js";import{i as H}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as Q}from"./icon_add_outlined-0.0.0-dataease.js";import{a as Ee}from"./chart-0.0.0-dataease.js";import{f as J}from"./attr-0.0.0-dataease23.js";import{i as j}from"./field-list-0.0.0-dataease.js";import{e as Oe}from"./lodash-0.0.0-dataease.js";import{E as Me}from"./index-0.0.0-dataease20.js";import{_ as we}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease27.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease3.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./axios-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./constants-0.0.0-dataease.js";import"./index-0.0.0-dataease6.js";import"./token-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./dataset-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./decimal-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";const Ae={class:"tip"},Fe={style:{"padding-left":"10px"}},Ie={style:{margin:"0 -5px"}},qe={style:{margin:"0 -5px"}},$e={style:{display:"flex","align-items":"center","justify-content":"center"}},je=Se({__name:"TableThresholdEdit",props:{chart:{type:Object,required:!0},threshold:{type:Array,required:!0}},emits:["onTableThresholdChange"],setup(E,{emit:Y}){const{t:d}=ye(),T=E,Z=Y,ee={term:"",field:"0",value:"0",color:"#ff0000ff",backgroundColor:"#ffffff00",min:"0",max:"1",type:"fixed",dynamicField:{summary:"value"},dynamicMinField:{summary:"value"},dynamicMaxField:{summary:"value"}},le=[{label:"",options:[{value:"eq",label:d("chart.filter_eq")},{value:"not_eq",label:d("chart.filter_not_eq")}]},{label:"",options:[{value:"like",label:d("chart.filter_like")},{value:"not like",label:d("chart.filter_not_like")}]},{label:"",options:[{value:"null",label:d("chart.filter_null")},{value:"not_null",label:d("chart.filter_not_null")}]}],ae=[{label:"",options:[{value:"eq",label:d("chart.filter_eq")},{value:"not_eq",label:d("chart.filter_not_eq")}]},{label:"",options:[{value:"lt",label:d("chart.filter_lt")},{value:"gt",label:d("chart.filter_gt")}]},{label:"",options:[{value:"le",label:d("chart.filter_le")},{value:"ge",label:d("chart.filter_ge")}]}],te=[{label:"",options:[{value:"eq",label:d("chart.filter_eq")},{value:"not_eq",label:d("chart.filter_not_eq")}]},{label:"",options:[{value:"lt",label:d("chart.filter_lt")},{value:"gt",label:d("chart.filter_gt")}]},{label:"",options:[{value:"le",label:d("chart.filter_le")},{value:"ge",label:d("chart.filter_ge")}]},{label:"",options:[{value:"between",label:d("chart.filter_between")}]}],G=Ee,_=Je({thresholdArr:[],fields:[],thresholdObj:{fieldId:"",field:{},conditions:[]}}),ne=()=>{_.thresholdArr=JSON.parse(JSON.stringify(T.threshold)),oe()},F=(n,s)=>{s&&([0,5,7].includes(s.deType)?n.options=JSON.parse(JSON.stringify(le)):s.deType===1?n.options=JSON.parse(JSON.stringify(ae)):n.options=JSON.parse(JSON.stringify(te)),n.conditions&&n.conditions.forEach(r=>{r.term=""}))},oe=()=>{let n=[];if(T.chart.type==="table-info")n=JSON.parse(JSON.stringify(T.chart.xAxis));else if(T.chart.type==="table-pivot"){const r=JSON.parse(JSON.stringify(T.chart.xAxis)),f=JSON.parse(JSON.stringify(T.chart.xAxisExt)),c=JSON.parse(JSON.stringify(T.chart.yAxis));n=[...r,...f,...c]}else{const r=JSON.parse(JSON.stringify(T.chart.xAxis)),f=JSON.parse(JSON.stringify(T.chart.yAxis));n=[...r,...f]}_.fields.splice(0,_.fields.length,...n);let s=!1;_.thresholdArr.forEach(r=>{_.fields.filter(c=>c.id===r.fieldId).length===0&&(s=!0,r.fieldId=null)}),s&&y()},de=()=>{_.thresholdArr.push(JSON.parse(JSON.stringify(_.thresholdObj))),y()},se=n=>{_.thresholdArr.splice(n,1),y()},y=()=>{Z("onTableThresholdChange",_.thresholdArr)},re=n=>{var f,c;const s=JSON.parse(JSON.stringify(ee)),r=(c=(f=T.chart)==null?void 0:f.customAttr)==null?void 0:c.tableCell;r&&(s.backgroundColor=Oe(r.tableItemBgColor)),n.conditions.push(s),y()},ie=(n,s)=>{n.conditions.splice(s,1),y()},A=n=>{_.fields&&_.fields.length>0&&_.fields.forEach(s=>{var r,f,c;n.fieldId===s.id&&(n.field=JSON.parse(JSON.stringify(s)),F(n,n.field)),((r=n.dynamicField)==null?void 0:r.fieldId)===s.id&&(n.dynamicField.field=JSON.parse(JSON.stringify(s)),F(n,n.dynamicField.field)),((f=n.dynamicMinField)==null?void 0:f.fieldId)===s.id&&(n.dynamicMinField.field=JSON.parse(JSON.stringify(s)),F(n,n.dynamicMinField.field)),((c=n.dynamicMaxField)==null?void 0:c.fieldId)===s.id&&(n.dynamicMaxField.field=JSON.parse(JSON.stringify(s)),F(n,n.dynamicMaxField.field))}),y()},ue=[{label:d("chart.field_fixed"),value:"fixed"},{label:d("chart.field_dynamic"),value:"dynamic"}],B=[{id:"value",name:d("chart.field")+d("chart.drag_block_label_value")},{id:"avg",name:d("chart.avg")+d("chart.drag_block_label_value")},{id:"max",name:d("chart.max")},{id:"min",name:d("chart.min")}],D=(n,s,r)=>{var m,U,O,I;const f=_.fields.filter(p=>p.id===n.fieldId);if(f.length===0||((m=f[0])==null?void 0:m.deType)===void 0||((U=f[0])==null?void 0:U.deType)===null)return n.fieldId=null,s.fieldId=null,r.fieldId=null,[];const c=(O=f[0])==null?void 0:O.deType,h=_.fields.filter(p=>[0,1,4,5].includes(c)?p.deType===c:[2,3].includes(c)?p.deType===2||p.deType===3:!1)??[];return h.find(p=>p.id===r.fieldId)||(r.fieldId=(I=h[0])==null?void 0:I.id,A(s)),h},z=n=>{var r,f;const s=(f=(r=_.fields.filter(c=>c.id===n))==null?void 0:r[0])==null?void 0:f.deType;return s===1?B.filter(c=>c.id!=="avg"):s===0||s===5?B.filter(c=>c.id==="value"):B},N=n=>!n.term.includes("null")&&!n.term.includes("empty"),k=n=>n.term==="between",C=n=>n.type==="dynamic",ce=n=>{n.type==="dynamic"&&(n.dynamicField.summary="value",n.dynamicMinField.summary="value",n.dynamicMaxField.summary="value")},fe=()=>ue;return ne(),(n,s)=>{const r=he,f=be,c=Ve,h=ke,m=Ne,U=ge,O=Te,I=Ce,p=xe,L=Me,pe=ve,K=me;return o(),u(p,null,{default:a(()=>[M("div",Ae,[t(r,{name:"icon_info_filled",class:"icon-style"},{default:a(()=>[t(i(Ue),{class:"svg-icon icon-style"})]),_:1}),M("span",Fe,S(i(d)("chart.table_threshold_tip")),1)]),M("div",{onKeydown:s[0]||(s[0]=X(()=>{},["stop"])),onKeyup:s[1]||(s[1]=X(()=>{},["stop"])),style:{"max-height":"50vh","overflow-y":"auto"}},[(o(!0),g(x,null,v(_.thresholdArr,(b,R)=>(o(),g("div",{key:R,class:"field-item"},[t(O,{style:{"margin-top":"6px","align-items":"center","justify-content":"space-between"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{style:{width:"181px"},modelValue:b.fieldId,"onUpdate:modelValue":e=>b.fieldId=e,onChange:e=>A(b)},{default:a(()=>[(o(!0),g(x,null,v(_.fields,e=>(o(),u(c,{class:"series-select-option",key:e.id,label:e.name,value:e.id,disabled:E.chart.type==="table-info"&&e.deType===7},{default:a(()=>[t(f,{style:{"margin-right":"8px"}},{default:a(()=>[t(r,null,{default:a(()=>[(o(),u(q(i(j)[i(J)[e.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(e.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),w(" "+S(e.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),t(U,{class:"circle-button m-icon-btn",text:"",style:{float:"right"},onClick:e=>se(R)},{default:a(()=>[t(f,{size:"20px",style:{color:"#646a73"}},{default:a(()=>[t(r,{name:"icon_delete-trash_outlined"},{default:a(()=>[t(i(H),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["onClick"])]),_:2},1024),t(O,{style:{marginTop:"16px",borderTop:"1px solid #d5d6d8"}},{default:a(()=>[(o(!0),g(x,null,v(b.conditions,(e,W)=>(o(),u(O,{key:W,class:"line-item",gutter:12},{default:a(()=>[t(p,{span:3},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.term,"onUpdate:modelValue":l=>e.term=l,onChange:y},{default:a(()=>[(o(!0),g(x,null,v(b.options,(l,_e)=>(o(),u(I,{key:_e,label:l.label},{default:a(()=>[(o(!0),g(x,null,v(l.options,P=>(o(),u(c,{key:P.value,label:P.label,value:P.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),N(e)&&E.chart.type!=="rich-text"?(o(),u(p,{key:0,span:2,style:{"padding-left":"0 !important"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.type,"onUpdate:modelValue":l=>e.type=l,class:"select-item",onChange:l=>ce(e),style:{width:"100%"}},{default:a(()=>[(o(!0),g(x,null,v(fe(b),l=>(o(),u(c,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&!k(e)&&!C(e)?(o(),u(p,{key:1,span:12,style:{"text-align":"center"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[[2,3].includes(b.field.deType)?(o(),u(L,{key:0,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:i(d)("chart.drag_block_label_value"),"controls-position":"right",class:"value-item",clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(o(),u(pe,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:i(d)("chart.drag_block_label_value"),"controls-position":"right",clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&!k(e)&&C(e)?(o(),u(p,{key:2,span:6},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.dynamicField.fieldId,"onUpdate:modelValue":l=>e.dynamicField.fieldId=l,onChange:l=>A(e),style:{width:"100%"}},{default:a(()=>[(o(!0),g(x,null,v(D(b,e,e.dynamicField),l=>(o(),u(c,{class:"series-select-option",key:l.id,label:l.name,value:l.id,disabled:E.chart.type==="table-info"&&l.deType===7},{default:a(()=>[t(f,{style:{"margin-right":"8px"}},{default:a(()=>[t(r,null,{default:a(()=>[(o(),u(q(i(j)[i(J)[l.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(l.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),w(" "+S(l.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&!k(e)&&C(e)?(o(),u(p,{key:3,span:6,style:{"text-align":"center"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{placeholder:i(d)("chart.aggregation"),modelValue:e.dynamicField.summary,"onUpdate:modelValue":l=>e.dynamicField.summary=l,onChange:y,style:{width:"100%"}},{default:a(()=>[(o(!0),g(x,null,v(z(e.dynamicField.fieldId),l=>(o(),u(c,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&!C(e)?(o(),u(p,{key:4,span:5,style:{"text-align":"center"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(L,{modelValue:e.min,"onUpdate:modelValue":l=>e.min=l,"controls-position":"right",class:"between-item",placeholder:i(d)("chart.axis_value_min"),clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),_:2},1024)):V("",!0),k(e)&&!C(e)?(o(),u(p,{key:5,span:2,style:{"margin-top":"4px","text-align":"center"}},{default:a(()=>[M("span",Ie," ≤ "+S(i(d)("chart.drag_block_label_value"))+" ≤ ",1)]),_:1})):V("",!0),N(e)&&k(e)&&!C(e)?(o(),u(p,{key:6,span:5,style:{"text-align":"center"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(L,{modelValue:e.max,"onUpdate:modelValue":l=>e.max=l,"controls-position":"right",class:"between-item",placeholder:i(d)("chart.axis_value_max"),clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&C(e)?(o(),u(p,{key:7,class:"minField",span:3},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.dynamicMinField.fieldId,"onUpdate:modelValue":l=>e.dynamicMinField.fieldId=l,onChange:l=>A(e)},{default:a(()=>[(o(!0),g(x,null,v(D(b,e,e.dynamicMinField),l=>(o(),u(c,{class:"series-select-option",key:l.id,label:l.name,value:l.id,disabled:E.chart.type==="table-info"&&l.deType===7},{default:a(()=>[t(f,{style:{"margin-right":"8px"}},{default:a(()=>[t(r,null,{default:a(()=>[(o(),u(q(i(j)[i(J)[l.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(l.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),w(" "+S(l.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&C(e)?(o(),u(p,{key:8,class:"minValue",span:2,style:{"padding-left":"0 !important"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.dynamicMinField.summary,"onUpdate:modelValue":l=>e.dynamicMinField.summary=l,onChange:y},{default:a(()=>[(o(!0),g(x,null,v(z(e.dynamicMinField.fieldId),l=>(o(),u(c,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):V("",!0),k(e)&&C(e)?(o(),u(p,{key:9,class:"term",span:2,style:{"margin-top":"4px","text-align":"center"}},{default:a(()=>[M("span",qe," ≤ "+S(i(d)("chart.drag_block_label_value"))+" ≤ ",1)]),_:1})):V("",!0),N(e)&&k(e)&&C(e)?(o(),u(p,{key:10,class:"maxField",span:3},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.dynamicMaxField.fieldId,"onUpdate:modelValue":l=>e.dynamicMaxField.fieldId=l,onChange:l=>A(e)},{default:a(()=>[(o(!0),g(x,null,v(D(b,e,e.dynamicMaxField),l=>(o(),u(c,{class:"series-select-option",key:l.id,label:l.name,value:l.id,disabled:E.chart.type==="table-info"&&l.deType===7},{default:a(()=>[t(f,{style:{"margin-right":"8px"}},{default:a(()=>[t(r,null,{default:a(()=>[(o(),u(q(i(j)[i(J)[l.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(l.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),w(" "+S(l.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&C(e)?(o(),u(p,{key:11,class:"maxValue",span:2,style:{"padding-left":"0 !important"}},{default:a(()=>[t(m,{class:"form-item"},{default:a(()=>[t(h,{modelValue:e.dynamicMaxField.summary,"onUpdate:modelValue":l=>e.dynamicMaxField.summary=l,onChange:y},{default:a(()=>[(o(!0),g(x,null,v(z(e.dynamicMaxField.fieldId),l=>(o(),u(c,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):V("",!0),t(p,{span:3},{default:a(()=>[t(m,{class:"form-item",label:i(d)("chart.textColor")},{default:a(()=>[t(K,{"is-custom":"",modelValue:e.color,"onUpdate:modelValue":l=>e.color=l,"show-alpha":"","trigger-width":68,class:"color-picker-style",predefine:i(G),onChange:y},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1032,["label"])]),_:2},1024),t(p,{span:3},{default:a(()=>[t(m,{class:"form-item",label:i(d)("chart.backgroundColor")},{default:a(()=>[t(K,{"is-custom":"",size:"default",modelValue:e.backgroundColor,"onUpdate:modelValue":l=>e.backgroundColor=l,"trigger-width":68,"show-alpha":"",class:"color-picker-style",predefine:i(G),onChange:y},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1032,["label"])]),_:2},1024),t(p,{span:1},{default:a(()=>[M("div",$e,[t(U,{class:"circle-button m-icon-btn",text:"",onClick:l=>ie(b,W)},{default:a(()=>[t(f,{size:"20px",style:{color:"#646a73"}},{default:a(()=>[t(r,{name:"icon_delete-trash_outlined"},{default:a(()=>[t(i(H),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),t(U,{style:{"margin-top":"10px"},class:"circle-button",type:"primary",text:"",onClick:e=>re(b)},{icon:a(()=>[t(r,{name:"icon_add_outlined"},{default:a(()=>[t(i(Q),{class:"svg-icon"})]),_:1})]),default:a(()=>[w(" "+S(i(d)("chart.add_style")),1)]),_:1},8,["onClick"])]))),128))],32),t(U,{class:"circle-button",text:"",type:"primary",style:{"margin-top":"10px"},onClick:de},{icon:a(()=>[t(r,{name:"icon_add_outlined"},{default:a(()=>[t(i(Q),{class:"svg-icon"})]),_:1})]),default:a(()=>[w(" "+S(i(d)("chart.add_condition")),1)]),_:1})]),_:1})}}});const Cl=we(je,[["__scopeId","data-v-141088da"]]);export{Cl as default};
