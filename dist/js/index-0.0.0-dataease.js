import{u as xt,a as ht,b as dt,c as _t,s as Et,d as St,e as kt}from"../assets/chunk/index-0.0.0-dataease.js";import{d as Ot,r as Ct,e as Tt,f as rt,g as ot,i as Nt,u as jt,j as It,k as At}from"../assets/chunk/vue-0.0.0-dataease.js";import{_ as Rt,u as Lt,a as Pt,r as Y,c as Ut,i as Wt,b as qt,d as Dt,p as it,g as st,s as Mt,e as Bt}from"../assets/chunk/ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{_ as Ft}from"../assets/chunk/ExportExcel.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{u as Gt,a as Jt,s as $t}from"../assets/chunk/usePageLoading-0.0.0-dataease.js";import{installDirective as Vt}from"../assets/chunk/index-0.0.0-dataease2.js";import{useAppStoreWithOut as zt}from"../assets/chunk/app-0.0.0-dataease.js";import{getDefaultSettings as Ht,getRoleRouters as Xt}from"../assets/chunk/common-0.0.0-dataease.js";import{i as Qt}from"../assets/chunk/interactive-0.0.0-dataease.js";import{u as Kt}from"../assets/chunk/appearance-0.0.0-dataease.js";import{c as I,g as mt}from"../assets/chunk/lodash-0.0.0-dataease.js";import{c as $}from"../assets/chunk/_commonjs-dynamic-modules-0.0.0-dataease.js";import"../assets/chunk/axios-0.0.0-dataease.js";import"../assets/chunk/library-0.0.0-dataease.js";import"../assets/chunk/echarts-0.0.0-dataease.js";import"../assets/chunk/tinymce-0.0.0-dataease.js";import"../assets/chunk/el-dialog-0.0.0-dataease.js";import"../assets/chunk/index-0.0.0-dataease3.js";import"../assets/chunk/use-dialog-0.0.0-dataease.js";import"../assets/chunk/refs-0.0.0-dataease.js";import"../assets/chunk/el-drawer-0.0.0-dataease.js";import"../assets/chunk/el-tooltip-0.0.0-dataease.js";import"../assets/chunk/el-popper-0.0.0-dataease.js";import"../assets/chunk/el-progress-0.0.0-dataease.js";import"../assets/chunk/el-table-0.0.0-dataease.js";import"../assets/chunk/index-0.0.0-dataease4.js";import"../assets/chunk/el-checkbox-0.0.0-dataease.js";import"../assets/chunk/index-0.0.0-dataease5.js";import"../assets/chunk/raf-0.0.0-dataease.js";import"../assets/chunk/el-tag-0.0.0-dataease.js";import"../assets/chunk/icon_download_outlined-0.0.0-dataease.js";import"../assets/chunk/de-delete-0.0.0-dataease.js";import"../assets/chunk/icon_refresh_outlined-0.0.0-dataease.js";import"../assets/chunk/EmptyBackground-0.0.0-dataease.js";import"../assets/chunk/el-empty-0.0.0-dataease.js";import"../assets/chunk/none-0.0.0-dataease.js";import"../assets/chunk/nothing-tree-0.0.0-dataease.js";import"../assets/chunk/_plugin-vue_export-helper-0.0.0-dataease.js";import"../assets/chunk/el-tabs-0.0.0-dataease.js";import"../assets/chunk/strings-0.0.0-dataease.js";import"../assets/chunk/dataset-0.0.0-dataease.js";import"../assets/chunk/GridTable-0.0.0-dataease.js";import"../assets/chunk/el-pagination-0.0.0-dataease.js";import"../assets/chunk/el-select-0.0.0-dataease.js";import"../assets/chunk/index-0.0.0-dataease6.js";import"../assets/chunk/token-0.0.0-dataease.js";import"../assets/chunk/dataVisualization-0.0.0-dataease.js";import"../assets/chunk/datasource-0.0.0-dataease.js";import"../assets/chunk/font-0.0.0-dataease.js";import"../assets/chunk/tslib.es6-0.0.0-dataease.js";import"../assets/chunk/antv-0.0.0-dataease.js";const Zt=Ot({__name:"App",setup(O){const R=xt(),n=Ct();return ht({name:"data-export-center",callback:v=>{n.value.init(v)}}),(v,s)=>{const r=Tt("router-view");return rt(),ot(Rt,null,{default:Nt(()=>[(rt(),ot(r,{key:jt(R).path})),It(Ft,{ref_key:"exportExcelRef",ref:n},null,512)]),_:1})}}}),H=Kt(),{wsCache:G}=dt(),F=Lt(),Yt=Qt(),at=Pt(),X=zt(),{start:te,done:vt}=Gt(),{loadStart:ee,loadDone:bt}=Jt(),ne=["/login","/de-link","/chart-view","/admin-login","/401"],re=["/dvCanvas","/dashboard","/preview","/dataset-embedded-form"],oe=["/dataset-embedded","/dataset-form","/dataset-embedded-form"];Y.beforeEach(async(O,R,n)=>{te(),ee();const l=Ut();let v=G.get("app.desktop");if(v===null)try{await X.setAppModel(),v=X.getDesktop}catch(r){console.log(r)}if(Wt()&&!["/chart-view"].includes(O.path)){if(vt(),bt(),O.name==="link"){let r="";if(Object.keys(O.query)){const t=Object.keys(O.query).map(i=>i+"="+O.query[i]).join("&");t&&(r="?"+t)}let o=window.location.pathname;o=o.replace("casbi/",""),o=o.replace("oidc/",""),o=o.substring(0,o.length-1);const a=window.origin+o;let e=O.fullPath;e.includes("?")&&(e=O.fullPath.substring(0,O.fullPath.lastIndexOf("?"))),window.location.href=a+"/mobile.html#"+e+r}else if(G.get("user.token")||v||!qt()&&!Dt()){let r=window.location.pathname;r=r.substring(0,r.length-1);let o=window.origin+r+"/mobile.html#/index";window.location.search&&(o+=window.location.search),window.location.href=o}}await H.setAppearance(),await H.setFontList();const s=await Ht()||{};if(G.set("TreeSort-backend",s["basic.defaultSort"]??"1"),G.set("open-backend",s["basic.defaultOpen"]??"0"),(G.get("user.token")||v)&&!O.path.startsWith("/de-link/"))if(at.getUid||await at.setUser(),O.path==="/login")n({path:"/workbranch/index"});else{if(F.setCurrentPath(O.path),F.getIsAddRouters){let i="";if((R.query.redirect||"?").split("?")[0]===O.path&&(i=(window.location.hash||"?").split("?").reverse()[0],i.includes("redirect=")&&(i="")),i&&(O.fullPath+="?"+i,O.query=i.split("&").reduce((u,c)=>{const[p,d]=c.split("=");return u[p]=d,u},{})),!it(O.path)&&O.path!=="/404"&&!O.path.startsWith("/de-link")){const u=st();n({path:u||"/404"});return}n();return}let r=await Xt()||[];v&&(r=r.filter(i=>i.name!=="system"));const o=r;o.forEach(i=>i.top=!0),await F.generateRoutes(o),F.getAddRouters.forEach(i=>{Y.addRoute(i)});const a=R.query.redirect||O.path,e=decodeURIComponent(a),t=O.path===e?{...O,replace:!0}:{path:e};if(F.setIsAddRouters(!0),await Yt.initInteractive(!0),!it(O.path)&&O.path!=="/404"&&!O.path.startsWith("/de-link")){const i=st();n({path:i||"/404"});return}n(t)}else if(_t().getToken&&X.getIsIframe&&oe.includes(O.path)){if(O.path.includes("/dataset-form")){n({path:"/dataset-embedded-form",query:O.query});return}F.setCurrentPath(O.path),n()}else!l&&re.includes(O.path)||ne.includes(O.path)||O.path.startsWith("/de-link/")?(await H.setFontList(),F.setCurrentPath(O.path),n()):n(`/login?redirect=${O.fullPath||O.path}`)});Y.afterEach(()=>{vt(),bt()});var gt={exports:{}};(function(O,R){(function(n){O.exports=n()})(function(){return function n(l,v,s){function r(e,t){if(!v[e]){if(!l[e]){var i=typeof $=="function"&&$;if(!t&&i)return i(e,!0);if(o)return o(e,!0);var u=new Error("Cannot find module '"+e+"'");throw u.code="MODULE_NOT_FOUND",u}var c=v[e]={exports:{}};l[e][0].call(c.exports,function(p){return r(l[e][1][p]||p)},c,c.exports,n,l,v,s)}return v[e].exports}for(var o=typeof $=="function"&&$,a=0;a<s.length;a++)r(s[a]);return r}({1:[function(n,l,v){(function(s){(function(){var r=n("./transport-list");l.exports=n("./main")(r),"_sockjs_onload"in s&&setTimeout(s._sockjs_onload,1)}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./main":14,"./transport-list":16}],2:[function(n,l,v){var s=n("inherits"),r=n("./event");function o(){r.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}s(o,r),l.exports=o},{"./event":4,inherits:54}],3:[function(n,l,v){var s=n("inherits"),r=n("./eventtarget");function o(){r.call(this)}s(o,r),o.prototype.removeAllListeners=function(a){a?delete this._listeners[a]:this._listeners={}},o.prototype.once=function(a,e){var t=this,i=!1;this.on(a,function u(){t.removeListener(a,u),i||(i=!0,e.apply(this,arguments))})},o.prototype.emit=function(){var a=arguments[0],e=this._listeners[a];if(e){for(var t=arguments.length,i=new Array(t-1),u=1;u<t;u++)i[u-1]=arguments[u];for(var c=0;c<e.length;c++)e[c].apply(this,i)}},o.prototype.on=o.prototype.addListener=r.prototype.addEventListener,o.prototype.removeListener=r.prototype.removeEventListener,l.exports.EventEmitter=o},{"./eventtarget":5,inherits:54}],4:[function(n,l,v){function s(r){this.type=r}s.prototype.initEvent=function(r,o,a){return this.type=r,this.bubbles=o,this.cancelable=a,this.timeStamp=+new Date,this},s.prototype.stopPropagation=function(){},s.prototype.preventDefault=function(){},s.CAPTURING_PHASE=1,s.AT_TARGET=2,s.BUBBLING_PHASE=3,l.exports=s},{}],5:[function(n,l,v){function s(){this._listeners={}}s.prototype.addEventListener=function(r,o){r in this._listeners||(this._listeners[r]=[]);var a=this._listeners[r];a.indexOf(o)===-1&&(a=a.concat([o])),this._listeners[r]=a},s.prototype.removeEventListener=function(r,o){var a=this._listeners[r];if(a){var e=a.indexOf(o);e===-1||(1<a.length?this._listeners[r]=a.slice(0,e).concat(a.slice(e+1)):delete this._listeners[r])}},s.prototype.dispatchEvent=function(){var r=arguments[0],o=r.type,a=arguments.length===1?[r]:Array.apply(null,arguments);if(this["on"+o]&&this["on"+o].apply(this,a),o in this._listeners)for(var e=this._listeners[o],t=0;t<e.length;t++)e[t].apply(this,a)},l.exports=s},{}],6:[function(n,l,v){var s=n("inherits"),r=n("./event");function o(a){r.call(this),this.initEvent("message",!1,!1),this.data=a}s(o,r),l.exports=o},{"./event":4,inherits:54}],7:[function(n,l,v){var s=n("./utils/iframe");function r(o){(this._transport=o).on("message",this._transportMessage.bind(this)),o.on("close",this._transportClose.bind(this))}r.prototype._transportClose=function(o,a){s.postMessage("c",JSON.stringify([o,a]))},r.prototype._transportMessage=function(o){s.postMessage("t",o)},r.prototype._send=function(o){this._transport.send(o)},r.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},l.exports=r},{"./utils/iframe":47}],8:[function(n,l,v){var s=n("./utils/url"),r=n("./utils/event"),o=n("./facade"),a=n("./info-iframe-receiver"),e=n("./utils/iframe"),t=n("./location"),i=function(){};l.exports=function(u,c){var p,d={};c.forEach(function(f){f.facadeTransport&&(d[f.facadeTransport.transportName]=f.facadeTransport)}),d[a.transportName]=a,u.bootstrap_iframe=function(){var f;e.currentWindowId=t.hash.slice(1),r.attachEvent("message",function(m){if(m.source===parent&&(p===void 0&&(p=m.origin),m.origin===p)){var E;try{E=JSON.parse(m.data)}catch{return void i("bad json",m.data)}if(E.windowId===e.currentWindowId)switch(E.type){case"s":var S;try{S=JSON.parse(E.data)}catch{i("bad json",E.data);break}var j=S[0],w=S[1],b=S[2],_=S[3];if(j!==u.version)throw new Error('Incompatible SockJS! Main site uses: "'+j+'", the iframe: "'+u.version+'".');if(!s.isOriginEqual(b,t.href)||!s.isOriginEqual(_,t.href))throw new Error("Can't connect to different domain from within an iframe. ("+t.href+", "+b+", "+_+")");f=new o(new d[w](b,_));break;case"m":f._send(E.data);break;case"c":f&&f._close(),f=null}}}),e.postMessage("s")}}},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:void 0}],9:[function(n,l,v){var s=n("events").EventEmitter,r=n("inherits"),o=n("./utils/object");function a(e,t){s.call(this);var i=this,u=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(c,p){var d,f;if(c===200){if(f=+new Date-u,p)try{d=JSON.parse(p)}catch{}o.isObject(d)||(d={})}i.emit("finish",d,f),i.removeAllListeners()})}r(a,s),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},l.exports=a},{"./utils/object":49,debug:void 0,events:3,inherits:54}],10:[function(n,l,v){var s=n("inherits"),r=n("events").EventEmitter,o=n("./transport/sender/xhr-local"),a=n("./info-ajax");function e(t){var i=this;r.call(this),this.ir=new a(t,o),this.ir.once("finish",function(u,c){i.ir=null,i.emit("message",JSON.stringify([u,c]))})}s(e,r),e.transportName="iframe-info-receiver",e.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},l.exports=e},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:54}],11:[function(n,l,v){(function(s){(function(){var r=n("events").EventEmitter,o=n("inherits"),a=n("./utils/event"),e=n("./transport/iframe"),t=n("./info-iframe-receiver");function i(u,c){var p=this;r.call(this);function d(){var f=p.ifr=new e(t.transportName,c,u);f.once("message",function(m){if(m){var E;try{E=JSON.parse(m)}catch{return p.emit("finish"),void p.close()}var S=E[0],j=E[1];p.emit("finish",S,j)}p.close()}),f.once("close",function(){p.emit("finish"),p.close()})}s.document.body?d():a.attachEvent("load",d)}o(i,r),i.enabled=function(){return e.enabled()},i.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},l.exports=i}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:void 0,events:3,inherits:54}],12:[function(n,l,v){var s=n("events").EventEmitter,r=n("inherits"),o=n("./utils/url"),a=n("./transport/sender/xdr"),e=n("./transport/sender/xhr-cors"),t=n("./transport/sender/xhr-local"),i=n("./transport/sender/xhr-fake"),u=n("./info-iframe"),c=n("./info-ajax");function p(d,f){var m=this;s.call(this),setTimeout(function(){m.doXhr(d,f)},0)}r(p,s),p._getReceiver=function(d,f,m){return m.sameOrigin?new c(f,t):e.enabled?new c(f,e):a.enabled&&m.sameScheme?new c(f,a):u.enabled()?new u(d,f):new c(f,i)},p.prototype.doXhr=function(d,f){var m=this,E=o.addPath(d,"/info");this.xo=p._getReceiver(d,E,f),this.timeoutRef=setTimeout(function(){m._cleanup(!1),m.emit("finish")},p.timeout),this.xo.once("finish",function(S,j){m._cleanup(!0),m.emit("finish",S,j)})},p.prototype._cleanup=function(d){clearTimeout(this.timeoutRef),this.timeoutRef=null,!d&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,l.exports=p},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:void 0,events:3,inherits:54}],13:[function(n,l,v){(function(s){(function(){l.exports=s.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],14:[function(n,l,v){(function(s){(function(){n("./shims");var r,o=n("url-parse"),a=n("inherits"),e=n("./utils/random"),t=n("./utils/escape"),i=n("./utils/url"),u=n("./utils/event"),c=n("./utils/transport"),p=n("./utils/object"),d=n("./utils/browser"),f=n("./utils/log"),m=n("./event/event"),E=n("./event/eventtarget"),S=n("./location"),j=n("./event/close"),w=n("./event/trans-message"),b=n("./info-receiver"),_=function(){};function h(g,T,y){if(!(this instanceof h))return new h(g,T,y);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");E.call(this),this.readyState=h.CONNECTING,this.extensions="",this.protocol="",(y=y||{}).protocols_whitelist&&f.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=y.transports,this._transportOptions=y.transportOptions||{},this._timeout=y.timeout||0;var C=y.sessionId||8;if(typeof C=="function")this._generateSessionId=C;else{if(typeof C!="number")throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return e.string(C)}}this._server=y.server||e.numberString(1e3);var N=new o(g);if(!N.host||!N.protocol)throw new SyntaxError("The URL '"+g+"' is invalid");if(N.hash)throw new SyntaxError("The URL must not contain a fragment");if(N.protocol!=="http:"&&N.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+N.protocol+"' is not allowed.");var L=N.protocol==="https:";if(S.protocol==="https:"&&!L&&!i.isLoopbackAddr(N.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");T?Array.isArray(T)||(T=[T]):T=[];var x=T.sort();x.forEach(function(P,W){if(!P)throw new SyntaxError("The protocols entry '"+P+"' is invalid.");if(W<x.length-1&&P===x[W+1])throw new SyntaxError("The protocols entry '"+P+"' is duplicated.")});var U=i.getOrigin(S.href);this._origin=U?U.toLowerCase():null,N.set("pathname",N.pathname.replace(/\/+$/,"")),this.url=N.href,_("using url",this.url),this._urlInfo={nullOrigin:!d.hasDomain(),sameOrigin:i.isOriginEqual(this.url,S.href),sameScheme:i.isSchemeEqual(this.url,S.href)},this._ir=new b(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function A(g){return g===1e3||3e3<=g&&g<=4999}a(h,E),h.prototype.close=function(g,T){if(g&&!A(g))throw new Error("InvalidAccessError: Invalid code");if(T&&123<T.length)throw new SyntaxError("reason argument has an invalid length");this.readyState!==h.CLOSING&&this.readyState!==h.CLOSED&&this._close(g||1e3,T||"Normal closure",!0)},h.prototype.send=function(g){if(typeof g!="string"&&(g=""+g),this.readyState===h.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===h.OPEN&&this._transport.send(t.quote(g))},h.version=n("./version"),h.CONNECTING=0,h.OPEN=1,h.CLOSING=2,h.CLOSED=3,h.prototype._receiveInfo=function(g,T){if(this._ir=null,g){this._rto=this.countRTO(T),this._transUrl=g.base_url?g.base_url:this.url,g=p.extend(g,this._urlInfo);var y=r.filterToEnabled(this._transportsWhitelist,g);this._transports=y.main,_(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},h.prototype._connect=function(){for(var g=this._transports.shift();g;g=this._transports.shift()){if(_("attempt",g.transportName),g.needBody&&(!s.document.body||s.document.readyState!==void 0&&s.document.readyState!=="complete"&&s.document.readyState!=="interactive"))return this._transports.unshift(g),void u.attachEvent("load",this._connect.bind(this));var T=Math.max(this._timeout,this._rto*g.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),T);var y=i.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),C=this._transportOptions[g.transportName],N=new g(y,this._transUrl,C);return N.on("message",this._transportMessage.bind(this)),N.once("close",this._transportClose.bind(this)),N.transportName=g.transportName,void(this._transport=N)}this._close(2e3,"All transports failed",!1)},h.prototype._transportTimeout=function(){this.readyState===h.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},h.prototype._transportMessage=function(g){var T,y=this,C=g.slice(0,1),N=g.slice(1);switch(C){case"o":return void this._open();case"h":return this.dispatchEvent(new m("heartbeat")),void _("heartbeat",this.transport)}if(N)try{T=JSON.parse(N)}catch{}if(T!==void 0)switch(C){case"a":Array.isArray(T)&&T.forEach(function(L){_("message",y.transport),y.dispatchEvent(new w(L))});break;case"m":_("message",this.transport),this.dispatchEvent(new w(T));break;case"c":Array.isArray(T)&&T.length===2&&this._close(T[0],T[1],!0)}},h.prototype._transportClose=function(g,T){_("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),A(g)||g===2e3||this.readyState!==h.CONNECTING?this._close(g,T):this._connect()},h.prototype._open=function(){_("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===h.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=h.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new m("open")),_("connected",this.transport)):this._close(1006,"Server lost session")},h.prototype._close=function(g,T,y){_("_close",this.transport,g,T,y,this.readyState);var C=!1;if(this._ir&&(C=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===h.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=h.CLOSING,setTimeout((function(){this.readyState=h.CLOSED,C&&this.dispatchEvent(new m("error"));var N=new j("close");N.wasClean=y||!1,N.code=g||1e3,N.reason=T,this.dispatchEvent(N),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)},h.prototype.countRTO=function(g){return 100<g?4*g:300+g},l.exports=function(g){return r=c(g),n("./iframe-bootstrap")(h,g),h}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:void 0,inherits:54,"url-parse":57}],15:[function(n,l,v){function s(y){return e.toString.call(y)==="[object Function]"}function r(y){return c.call(y)==="[object String]"}var o,a=Array.prototype,e=Object.prototype,t=Function.prototype,i=String.prototype,u=a.slice,c=e.toString,p=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}();o=p?function(y,C,N,L){!L&&C in y||Object.defineProperty(y,C,{configurable:!0,enumerable:!1,writable:!0,value:N})}:function(y,C,N,L){!L&&C in y||(y[C]=N)};function d(y,C,N){for(var L in C)e.hasOwnProperty.call(C,L)&&o(y,L,C[L],N)}function f(y){if(y==null)throw new TypeError("can't convert "+y+" to object");return Object(y)}function m(){}d(t,{bind:function(y){var C=this;if(!s(C))throw new TypeError("Function.prototype.bind called on incompatible "+C);for(var N=u.call(arguments,1),L=Math.max(0,C.length-N.length),x=[],U=0;U<L;U++)x.push("$"+U);var P=Function("binder","return function ("+x.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof P){var W=C.apply(this,N.concat(u.call(arguments)));return Object(W)===W?W:this}return C.apply(y,N.concat(u.call(arguments)))});return C.prototype&&(m.prototype=C.prototype,P.prototype=new m,m.prototype=null),P}}),d(Array,{isArray:function(y){return c.call(y)==="[object Array]"}});var E,S,j,w=Object("a"),b=w[0]!=="a"||!(0 in w);d(a,{forEach:function(y,C){var N=f(this),L=b&&r(this)?this.split(""):N,x=C,U=-1,P=L.length>>>0;if(!s(y))throw new TypeError;for(;++U<P;)U in L&&y.call(x,L[U],U,N)}},(E=a.forEach,j=S=!0,E&&(E.call("foo",function(y,C,N){typeof N!="object"&&(S=!1)}),E.call([1],function(){j=typeof this=="string"},"x")),!(E&&S&&j)));var _=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;d(a,{indexOf:function(y,C){var N=b&&r(this)?this.split(""):f(this),L=N.length>>>0;if(!L)return-1;var x=0;for(1<arguments.length&&(x=function(U){var P=+U;return P!=P?P=0:P!==0&&P!==1/0&&P!==-1/0&&(P=(0<P||-1)*Math.floor(Math.abs(P))),P}(C)),x=0<=x?x:Math.max(0,L+x);x<L;x++)if(x in N&&N[x]===y)return x;return-1}},_);var h,A=i.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||1<".".split(/()()/).length?(h=/()??/.exec("")[1]===void 0,i.split=function(y,C){var N=this;if(y===void 0&&C===0)return[];if(c.call(y)!=="[object RegExp]")return A.call(this,y,C);var L,x,U,P,W=[],D=(y.ignoreCase?"i":"")+(y.multiline?"m":"")+(y.extended?"x":"")+(y.sticky?"y":""),q=0;for(y=new RegExp(y.source,D+"g"),N+="",h||(L=new RegExp("^"+y.source+"$(?!\\s)",D)),C=C===void 0?-1>>>0:function(B){return B>>>0}(C);(x=y.exec(N))&&!(q<(U=x.index+x[0].length)&&(W.push(N.slice(q,x.index)),!h&&1<x.length&&x[0].replace(L,function(){for(var B=1;B<arguments.length-2;B++)arguments[B]===void 0&&(x[B]=void 0)}),1<x.length&&x.index<N.length&&a.push.apply(W,x.slice(1)),P=x[0].length,q=U,W.length>=C));)y.lastIndex===x.index&&y.lastIndex++;return q===N.length?!P&&y.test("")||W.push(""):W.push(N.slice(q)),W.length>C?W.slice(0,C):W}):"0".split(void 0,0).length&&(i.split=function(y,C){return y===void 0&&C===0?[]:A.call(this,y,C)});var g=i.substr,T="".substr&&"0b".substr(-1)!=="b";d(i,{substr:function(y,C){return g.call(this,y<0&&(y=this.length+y)<0?0:y,C)}},T)},{}],16:[function(n,l,v){l.exports=[n("./transport/websocket"),n("./transport/xhr-streaming"),n("./transport/xdr-streaming"),n("./transport/eventsource"),n("./transport/lib/iframe-wrap")(n("./transport/eventsource")),n("./transport/htmlfile"),n("./transport/lib/iframe-wrap")(n("./transport/htmlfile")),n("./transport/xhr-polling"),n("./transport/xdr-polling"),n("./transport/lib/iframe-wrap")(n("./transport/xhr-polling")),n("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(n,l,v){(function(s){(function(){var r=n("events").EventEmitter,o=n("inherits"),a=n("../../utils/event"),e=n("../../utils/url"),t=s.XMLHttpRequest,i=function(){};function u(d,f,m,E){var S=this;r.call(this),setTimeout(function(){S._start(d,f,m,E)},0)}o(u,r),u.prototype._start=function(d,f,m,E){var S=this;try{this.xhr=new t}catch{}if(!this.xhr)return this.emit("finish",0,"no xhr support"),void this._cleanup();f=e.addQuery(f,"t="+ +new Date),this.unloadRef=a.unloadAdd(function(){S._cleanup(!0)});try{this.xhr.open(d,f,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){i("xhr timeout"),S.emit("finish",0,""),S._cleanup(!1)})}catch{return this.emit("finish",0,""),void this._cleanup(!1)}if(E&&E.noCredentials||!u.supportsCORS||(this.xhr.withCredentials=!0),E&&E.headers)for(var j in E.headers)this.xhr.setRequestHeader(j,E.headers[j]);this.xhr.onreadystatechange=function(){if(S.xhr){var w,b,_=S.xhr;switch(i("readyState",_.readyState),_.readyState){case 3:try{b=_.status,w=_.responseText}catch{}b===1223&&(b=204),b===200&&w&&0<w.length&&S.emit("chunk",b,w);break;case 4:b=_.status,b===1223&&(b=204),b!==12005&&b!==12029||(b=0),i("finish",b,_.responseText),S.emit("finish",b,_.responseText),S._cleanup(!1)}}};try{S.xhr.send(m)}catch{S.emit("finish",0,""),S._cleanup(!1)}},u.prototype._cleanup=function(d){if(this.xhr){if(this.removeAllListeners(),a.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),d)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},u.prototype.close=function(){this._cleanup(!0)},u.enabled=!!t;var c=["Active"].concat("Object").join("X");!u.enabled&&c in s&&(u.enabled=!!new(t=function(){try{return new s[c]("Microsoft.XMLHTTP")}catch{return null}}));var p=!1;try{p="withCredentials"in new t}catch{}u.supportsCORS=p,l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],18:[function(n,l,v){(function(s){(function(){l.exports=s.EventSource}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],19:[function(n,l,v){(function(s){(function(){var r=s.WebSocket||s.MozWebSocket;l.exports=r?function(o){return new r(o)}:void 0}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],20:[function(n,l,v){var s=n("inherits"),r=n("./lib/ajax-based"),o=n("./receiver/eventsource"),a=n("./sender/xhr-cors"),e=n("eventsource");function t(i){if(!t.enabled())throw new Error("Transport created when disabled");r.call(this,i,"/eventsource",o,a)}s(t,r),t.enabled=function(){return!!e},t.transportName="eventsource",t.roundTrips=2,l.exports=t},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:54}],21:[function(n,l,v){var s=n("inherits"),r=n("./receiver/htmlfile"),o=n("./sender/xhr-local"),a=n("./lib/ajax-based");function e(t){if(!r.enabled)throw new Error("Transport created when disabled");a.call(this,t,"/htmlfile",r,o)}s(e,a),e.enabled=function(t){return r.enabled&&t.sameOrigin},e.transportName="htmlfile",e.roundTrips=2,l.exports=e},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:54}],22:[function(n,l,v){var s=n("inherits"),r=n("events").EventEmitter,o=n("../version"),a=n("../utils/url"),e=n("../utils/iframe"),t=n("../utils/event"),i=n("../utils/random"),u=function(){};function c(p,d,f){if(!c.enabled())throw new Error("Transport created when disabled");r.call(this);var m=this;this.origin=a.getOrigin(f),this.baseUrl=f,this.transUrl=d,this.transport=p,this.windowId=i.string(8);var E=a.addPath(f,"/iframe.html")+"#"+this.windowId;this.iframeObj=e.createIframe(E,function(S){m.emit("close",1006,"Unable to load an iframe ("+S+")"),m.close()}),this.onmessageCallback=this._message.bind(this),t.attachEvent("message",this.onmessageCallback)}s(c,r),c.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){t.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},c.prototype._message=function(p){if(u("message",p.data),a.isOriginEqual(p.origin,this.origin)){var d;try{d=JSON.parse(p.data)}catch{return void u("bad json",p.data)}if(d.windowId===this.windowId)switch(d.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([o,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",d.data);break;case"c":var f;try{f=JSON.parse(d.data)}catch{return void u("bad json",d.data)}this.emit("close",f[0],f[1]),this.close()}else u("mismatched window id",d.windowId,this.windowId)}else u("not same origin",p.origin,this.origin)},c.prototype.postMessage=function(p,d){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:p,data:d||""}),this.origin)},c.prototype.send=function(p){this.postMessage("m",p)},c.enabled=function(){return e.iframeEnabled},c.transportName="iframe",c.roundTrips=2,l.exports=c},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:void 0,events:3,inherits:54}],23:[function(n,l,v){(function(s){(function(){var r=n("inherits"),o=n("./lib/sender-receiver"),a=n("./receiver/jsonp"),e=n("./sender/jsonp");function t(i){if(!t.enabled())throw new Error("Transport created when disabled");o.call(this,i,"/jsonp",e,a)}r(t,o),t.enabled=function(){return!!s.document},t.transportName="jsonp-polling",t.roundTrips=1,t.needBody=!0,l.exports=t}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:54}],24:[function(n,l,v){var s=n("inherits"),r=n("../../utils/url"),o=n("./sender-receiver");function a(e,t,i,u){o.call(this,e,t,function(c){return function(p,d,f){var m={};typeof d=="string"&&(m.headers={"Content-type":"text/plain"});var E=r.addPath(p,"/xhr_send"),S=new c("POST",E,d,m);return S.once("finish",function(j){if(S=null,j!==200&&j!==204)return f(new Error("http status "+j));f()}),function(){S.close(),S=null;var j=new Error("Aborted");j.code=1e3,f(j)}}}(u),i,u)}s(a,o),l.exports=a},{"../../utils/url":52,"./sender-receiver":28,debug:void 0,inherits:54}],25:[function(n,l,v){var s=n("inherits"),r=n("events").EventEmitter,o=function(){};function a(e,t){r.call(this),this.sendBuffer=[],this.sender=t,this.url=e}s(a,r),a.prototype.send=function(e){this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},a.prototype.sendScheduleWait=function(){var e,t=this;this.sendStop=function(){t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){t.sendStop=null,t.sendSchedule()},25)},a.prototype.sendSchedule=function(){o("sendSchedule",this.sendBuffer.length);var e=this;if(0<this.sendBuffer.length){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(i){e.sendStop=null,i?(e.emit("close",i.code||1006,"Sending error: "+i),e.close()):e.sendScheduleWait()}),this.sendBuffer=[]}},a.prototype._cleanup=function(){this.removeAllListeners()},a.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},l.exports=a},{debug:void 0,events:3,inherits:54}],26:[function(n,l,v){(function(s){(function(){var r=n("inherits"),o=n("../iframe"),a=n("../../utils/object");l.exports=function(e){function t(i,u){o.call(this,e.transportName,i,u)}return r(t,o),t.enabled=function(i,u){if(!s.document)return!1;var c=a.extend({},u);return c.sameOrigin=!0,e.enabled(c)&&o.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=o.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/object":49,"../iframe":22,inherits:54}],27:[function(n,l,v){var s=n("inherits"),r=n("events").EventEmitter,o=function(){};function a(e,t,i){r.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=i,this._scheduleReceiver()}s(a,r),a.prototype._scheduleReceiver=function(){var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(i){e.emit("message",i)}),t.once("close",function(i,u){o("close",i,u,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||(u==="network"?e._scheduleReceiver():(e.emit("close",i||1006,u),e.removeAllListeners()))})},a.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},l.exports=a},{debug:void 0,events:3,inherits:54}],28:[function(n,l,v){var s=n("inherits"),r=n("../../utils/url"),o=n("./buffered-sender"),a=n("./polling");function e(t,i,u,c,p){var d=r.addPath(t,i),f=this;o.call(this,t,u),this.poll=new a(c,d,p),this.poll.on("message",function(m){f.emit("message",m)}),this.poll.once("close",function(m,E){f.poll=null,f.emit("close",m,E),f.close()})}s(e,o),e.prototype.close=function(){o.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},l.exports=e},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:void 0,inherits:54}],29:[function(n,l,v){var s=n("inherits"),r=n("events").EventEmitter,o=n("eventsource"),a=function(){};function e(t){r.call(this);var i=this,u=this.es=new o(t);u.onmessage=function(c){a("message",c.data),i.emit("message",decodeURI(c.data))},u.onerror=function(c){a("error",u.readyState);var p=u.readyState!==2?"network":"permanent";i._cleanup(),i._close(p)}}s(e,r),e.prototype.abort=function(){this._cleanup(),this._close("user")},e.prototype._cleanup=function(){var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)},e.prototype._close=function(t){var i=this;setTimeout(function(){i.emit("close",null,t),i.removeAllListeners()},200)},l.exports=e},{debug:void 0,events:3,eventsource:18,inherits:54}],30:[function(n,l,v){(function(s){(function(){var r=n("inherits"),o=n("../../utils/iframe"),a=n("../../utils/url"),e=n("events").EventEmitter,t=n("../../utils/random"),i=function(){};function u(p){e.call(this);var d=this;o.polluteGlobalNamespace(),this.id="a"+t.string(6),p=a.addQuery(p,"c="+decodeURIComponent(o.WPrefix+"."+this.id)),i("using htmlfile",u.htmlfileEnabled);var f=u.htmlfileEnabled?o.createHtmlfile:o.createIframe;s[o.WPrefix][this.id]={start:function(){d.iframeObj.loaded()},message:function(m){d.emit("message",m)},stop:function(){d._cleanup(),d._close("network")}},this.iframeObj=f(p,function(){d._cleanup(),d._close("permanent")})}r(u,e),u.prototype.abort=function(){this._cleanup(),this._close("user")},u.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete s[o.WPrefix][this.id]},u.prototype._close=function(p){this.emit("close",null,p),this.removeAllListeners()},u.htmlfileEnabled=!1;var c=["Active"].concat("Object").join("X");if(c in s)try{u.htmlfileEnabled=!!new s[c]("htmlfile")}catch{}u.enabled=u.htmlfileEnabled||o.iframeEnabled,l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],31:[function(n,l,v){(function(s){(function(){var r=n("../../utils/iframe"),o=n("../../utils/random"),a=n("../../utils/browser"),e=n("../../utils/url"),t=n("inherits"),i=n("events").EventEmitter,u=function(){};function c(p){var d=this;i.call(this),r.polluteGlobalNamespace(),this.id="a"+o.string(6);var f=e.addQuery(p,"c="+encodeURIComponent(r.WPrefix+"."+this.id));s[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(f),this.timeoutId=setTimeout(function(){d._abort(new Error("JSONP script loaded abnormally (timeout)"))},c.timeout)}t(c,i),c.prototype.abort=function(){if(s[r.WPrefix][this.id]){var p=new Error("JSONP user aborted read");p.code=1e3,this._abort(p)}},c.timeout=35e3,c.scriptErrorTimeout=1e3,c.prototype._callback=function(p){this._cleanup(),this.aborting||(p&&this.emit("message",p),this.emit("close",null,"network"),this.removeAllListeners())},c.prototype._abort=function(p){this._cleanup(),this.aborting=!0,this.emit("close",p.code,p.message),this.removeAllListeners()},c.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var p=this.script;p.parentNode.removeChild(p),p.onreadystatechange=p.onerror=p.onload=p.onclick=null,this.script=null}delete s[r.WPrefix][this.id]},c.prototype._scriptError=function(){var p=this;this.errorTimer||(this.errorTimer=setTimeout(function(){p.loadedOkay||p._abort(new Error("JSONP script loaded abnormally (onerror)"))},c.scriptErrorTimeout))},c.prototype._createScript=function(p){var d,f=this,m=this.script=s.document.createElement("script");if(m.id="a"+o.string(8),m.src=p,m.type="text/javascript",m.charset="UTF-8",m.onerror=this._scriptError.bind(this),m.onload=function(){f._abort(new Error("JSONP script loaded abnormally (onload)"))},m.onreadystatechange=function(){if(u("onreadystatechange",m.readyState),/loaded|closed/.test(m.readyState)){if(m&&m.htmlFor&&m.onclick){f.loadedOkay=!0;try{m.onclick()}catch{}}m&&f._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},m.async===void 0&&s.document.attachEvent)if(a.isOpera())(d=this.script2=s.document.createElement("script")).text="try{var a = document.getElementById('"+m.id+"'); if(a)a.onerror();}catch(x){};",m.async=d.async=!1;else{try{m.htmlFor=m.id,m.event="onclick"}catch{}m.async=!0}m.async!==void 0&&(m.async=!0);var E=s.document.getElementsByTagName("head")[0];E.insertBefore(m,E.firstChild),d&&E.insertBefore(d,E.firstChild)},l.exports=c}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],32:[function(n,l,v){var s=n("inherits"),r=n("events").EventEmitter;function o(a,e){r.call(this);var t=this;this.bufferPosition=0,this.xo=new e("POST",a,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(i,u){t._chunkHandler(i,u),t.xo=null;var c=i===200?"network":"permanent";t.emit("close",null,c),t._cleanup()})}s(o,r),o.prototype._chunkHandler=function(a,e){if(a===200&&e)for(var t=-1;;this.bufferPosition+=t+1){var i=e.slice(this.bufferPosition);if((t=i.indexOf(`
`))===-1)break;var u=i.slice(0,t);u&&this.emit("message",u)}},o.prototype._cleanup=function(){this.removeAllListeners()},o.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},l.exports=o},{debug:void 0,events:3,inherits:54}],33:[function(n,l,v){(function(s){(function(){var r,o,a=n("../../utils/random"),e=n("../../utils/url"),t=function(){};l.exports=function(i,u,c){r||((r=s.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(o=s.document.createElement("textarea")).name="d",r.appendChild(o),s.document.body.appendChild(r));var p="a"+a.string(8);r.target=p,r.action=e.addQuery(e.addPath(i,"/jsonp_send"),"i="+p);var d=function(m){try{return s.document.createElement('<iframe name="'+m+'">')}catch{var E=s.document.createElement("iframe");return E.name=m,E}}(p);d.id=p,d.style.display="none",r.appendChild(d);try{o.value=u}catch{}r.submit();function f(m){d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){d.parentNode.removeChild(d),d=null},500),o.value="",c(m))}return d.onerror=function(){f()},d.onload=function(){f()},d.onreadystatechange=function(m){t("onreadystatechange",p,d.readyState),d.readyState==="complete"&&f()},function(){f(new Error("Aborted"))}}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:void 0}],34:[function(n,l,v){(function(s){(function(){var r=n("events").EventEmitter,o=n("inherits"),a=n("../../utils/event"),e=n("../../utils/browser"),t=n("../../utils/url"),i=function(){};function u(c,p,d){var f=this;r.call(this),setTimeout(function(){f._start(c,p,d)},0)}o(u,r),u.prototype._start=function(c,p,d){var f=this,m=new s.XDomainRequest;p=t.addQuery(p,"t="+ +new Date),m.onerror=function(){f._error()},m.ontimeout=function(){f._error()},m.onprogress=function(){i("progress",m.responseText),f.emit("chunk",200,m.responseText)},m.onload=function(){f.emit("finish",200,m.responseText),f._cleanup(!1)},this.xdr=m,this.unloadRef=a.unloadAdd(function(){f._cleanup(!0)});try{this.xdr.open(c,p),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(d)}catch{this._error()}},u.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},u.prototype._cleanup=function(c){if(this.xdr){if(this.removeAllListeners(),a.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,c)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},u.prototype.close=function(){this._cleanup(!0)},u.enabled=!(!s.XDomainRequest||!e.hasDomain()),l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],35:[function(n,l,v){var s=n("inherits"),r=n("../driver/xhr");function o(a,e,t,i){r.call(this,a,e,t,i)}s(o,r),o.enabled=r.enabled&&r.supportsCORS,l.exports=o},{"../driver/xhr":17,inherits:54}],36:[function(n,l,v){var s=n("events").EventEmitter;function r(){var o=this;s.call(this),this.to=setTimeout(function(){o.emit("finish",200,"{}")},r.timeout)}n("inherits")(r,s),r.prototype.close=function(){clearTimeout(this.to)},r.timeout=2e3,l.exports=r},{events:3,inherits:54}],37:[function(n,l,v){var s=n("inherits"),r=n("../driver/xhr");function o(a,e,t){r.call(this,a,e,t,{noCredentials:!0})}s(o,r),o.enabled=r.enabled,l.exports=o},{"../driver/xhr":17,inherits:54}],38:[function(n,l,v){var s=n("../utils/event"),r=n("../utils/url"),o=n("inherits"),a=n("events").EventEmitter,e=n("./driver/websocket"),t=function(){};function i(u,c,p){if(!i.enabled())throw new Error("Transport created when disabled");a.call(this);var d=this,f=r.addPath(u,"/websocket");f=f.slice(0,5)==="https"?"wss"+f.slice(5):"ws"+f.slice(4),this.url=f,this.ws=new e(this.url,[],p),this.ws.onmessage=function(m){t("message event",m.data),d.emit("message",m.data)},this.unloadRef=s.unloadAdd(function(){d.ws.close()}),this.ws.onclose=function(m){t("close event",m.code,m.reason),d.emit("close",m.code,m.reason),d._cleanup()},this.ws.onerror=function(m){d.emit("close",1006,"WebSocket connection broken"),d._cleanup()}}o(i,a),i.prototype.send=function(u){var c="["+u+"]";this.ws.send(c)},i.prototype.close=function(){var u=this.ws;this._cleanup(),u&&u.close()},i.prototype._cleanup=function(){var u=this.ws;u&&(u.onmessage=u.onclose=u.onerror=null),s.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},i.enabled=function(){return!!e},i.transportName="websocket",i.roundTrips=2,l.exports=i},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:void 0,events:3,inherits:54}],39:[function(n,l,v){var s=n("inherits"),r=n("./lib/ajax-based"),o=n("./xdr-streaming"),a=n("./receiver/xhr"),e=n("./sender/xdr");function t(i){if(!e.enabled)throw new Error("Transport created when disabled");r.call(this,i,"/xhr",a,e)}s(t,r),t.enabled=o.enabled,t.transportName="xdr-polling",t.roundTrips=2,l.exports=t},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:54}],40:[function(n,l,v){var s=n("inherits"),r=n("./lib/ajax-based"),o=n("./receiver/xhr"),a=n("./sender/xdr");function e(t){if(!a.enabled)throw new Error("Transport created when disabled");r.call(this,t,"/xhr_streaming",o,a)}s(e,r),e.enabled=function(t){return!t.cookie_needed&&!t.nullOrigin&&a.enabled&&t.sameScheme},e.transportName="xdr-streaming",e.roundTrips=2,l.exports=e},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:54}],41:[function(n,l,v){var s=n("inherits"),r=n("./lib/ajax-based"),o=n("./receiver/xhr"),a=n("./sender/xhr-cors"),e=n("./sender/xhr-local");function t(i){if(!e.enabled&&!a.enabled)throw new Error("Transport created when disabled");r.call(this,i,"/xhr",o,a)}s(t,r),t.enabled=function(i){return!i.nullOrigin&&(!(!e.enabled||!i.sameOrigin)||a.enabled)},t.transportName="xhr-polling",t.roundTrips=2,l.exports=t},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],42:[function(n,l,v){(function(s){(function(){var r=n("inherits"),o=n("./lib/ajax-based"),a=n("./receiver/xhr"),e=n("./sender/xhr-cors"),t=n("./sender/xhr-local"),i=n("../utils/browser");function u(c){if(!t.enabled&&!e.enabled)throw new Error("Transport created when disabled");o.call(this,c,"/xhr_streaming",a,e)}r(u,o),u.enabled=function(c){return!c.nullOrigin&&!i.isOpera()&&e.enabled},u.transportName="xhr-streaming",u.roundTrips=2,u.needBody=!!s.document,l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],43:[function(n,l,v){(function(s){(function(){s.crypto&&s.crypto.getRandomValues?l.exports.randomBytes=function(r){var o=new Uint8Array(r);return s.crypto.getRandomValues(o),o}:l.exports.randomBytes=function(r){for(var o=new Array(r),a=0;a<r;a++)o[a]=Math.floor(256*Math.random());return o}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],44:[function(n,l,v){(function(s){(function(){l.exports={isOpera:function(){return s.navigator&&/opera/i.test(s.navigator.userAgent)},isKonqueror:function(){return s.navigator&&/konqueror/i.test(s.navigator.userAgent)},hasDomain:function(){if(!s.document)return!0;try{return!!s.document.domain}catch{return!1}}}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],45:[function(n,l,v){var s,r=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g;l.exports={quote:function(o){var a=JSON.stringify(o);return r.lastIndex=0,r.test(a)?(s=s||function(e){var t,i={},u=[];for(t=0;t<65536;t++)u.push(String.fromCharCode(t));return e.lastIndex=0,u.join("").replace(e,function(c){return i[c]="\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,i}(r),a.replace(r,function(e){return s[e]})):a}}},{}],46:[function(n,l,v){(function(s){(function(){var r=n("./random"),o={},a=!1,e=s.chrome&&s.chrome.app&&s.chrome.app.runtime;l.exports={attachEvent:function(t,i){s.addEventListener!==void 0?s.addEventListener(t,i,!1):s.document&&s.attachEvent&&(s.document.attachEvent("on"+t,i),s.attachEvent("on"+t,i))},detachEvent:function(t,i){s.addEventListener!==void 0?s.removeEventListener(t,i,!1):s.document&&s.detachEvent&&(s.document.detachEvent("on"+t,i),s.detachEvent("on"+t,i))},unloadAdd:function(t){if(e)return null;var i=r.string(8);return o[i]=t,a&&setTimeout(this.triggerUnloadCallbacks,0),i},unloadDel:function(t){t in o&&delete o[t]},triggerUnloadCallbacks:function(){for(var t in o)o[t](),delete o[t]}},e||l.exports.attachEvent("unload",function(){a||(a=!0,l.exports.triggerUnloadCallbacks())})}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./random":50}],47:[function(n,l,v){(function(s){(function(){var r=n("./event"),o=n("./browser"),a=function(){};l.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){l.exports.WPrefix in s||(s[l.exports.WPrefix]={})},postMessage:function(e,t){s.parent!==s?s.parent.postMessage(JSON.stringify({windowId:l.exports.currentWindowId,type:e,data:t||""}),"*"):a()},createIframe:function(e,t){function i(){clearTimeout(p);try{f.onload=null}catch{}f.onerror=null}function u(){f&&(i(),setTimeout(function(){f&&f.parentNode.removeChild(f),f=null},0),r.unloadDel(d))}function c(m){f&&(u(),t(m))}var p,d,f=s.document.createElement("iframe");return f.src=e,f.style.display="none",f.style.position="absolute",f.onerror=function(){c("onerror")},f.onload=function(){clearTimeout(p),p=setTimeout(function(){c("onload timeout")},2e3)},s.document.body.appendChild(f),p=setTimeout(function(){c("timeout")},15e3),d=r.unloadAdd(u),{post:function(m,E){setTimeout(function(){try{f&&f.contentWindow&&f.contentWindow.postMessage(m,E)}catch{}},0)},cleanup:u,loaded:i}},createHtmlfile:function(e,t){function i(){clearTimeout(p),f.onerror=null}function u(){E&&(i(),r.unloadDel(d),f.parentNode.removeChild(f),f=E=null,CollectGarbage())}function c(j){E&&(u(),t(j))}var p,d,f,m=["Active"].concat("Object").join("X"),E=new s[m]("htmlfile");E.open(),E.write('<html><script>document.domain="'+s.document.domain+'";<\/script></html>'),E.close(),E.parentWindow[l.exports.WPrefix]=s[l.exports.WPrefix];var S=E.createElement("div");return E.body.appendChild(S),f=E.createElement("iframe"),S.appendChild(f),f.src=e,f.onerror=function(){c("onerror")},p=setTimeout(function(){c("timeout")},15e3),d=r.unloadAdd(u),{post:function(j,w){try{setTimeout(function(){f&&f.contentWindow&&f.contentWindow.postMessage(j,w)},0)}catch{}},cleanup:u,loaded:i}}},l.exports.iframeEnabled=!1,s.document&&(l.exports.iframeEnabled=(typeof s.postMessage=="function"||typeof s.postMessage=="object")&&!o.isKonqueror())}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./browser":44,"./event":46,debug:void 0}],48:[function(n,l,v){(function(s){(function(){var r={};["log","debug","warn"].forEach(function(o){var a;try{a=s.console&&s.console[o]&&s.console[o].apply}catch{}r[o]=a?function(){return s.console[o].apply(s.console,arguments)}:o==="log"?function(){}:r.log}),l.exports=r}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],49:[function(n,l,v){l.exports={isObject:function(s){var r=typeof s;return r=="function"||r=="object"&&!!s},extend:function(s){if(!this.isObject(s))return s;for(var r,o,a=1,e=arguments.length;a<e;a++)for(o in r=arguments[a])Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o]);return s}}},{}],50:[function(n,l,v){var s=n("crypto"),r="abcdefghijklmnopqrstuvwxyz012345";l.exports={string:function(o){for(var a=r.length,e=s.randomBytes(o),t=[],i=0;i<o;i++)t.push(r.substr(e[i]%a,1));return t.join("")},number:function(o){return Math.floor(Math.random()*o)},numberString:function(o){var a=(""+(o-1)).length;return(new Array(a+1).join("0")+this.number(o)).slice(-a)}}},{crypto:43}],51:[function(n,l,v){var s=function(){};l.exports=function(r){return{filterToEnabled:function(o,a){var e={main:[],facade:[]};return o?typeof o=="string"&&(o=[o]):o=[],r.forEach(function(t){t&&(t.transportName!=="websocket"||a.websocket!==!1?o.length&&o.indexOf(t.transportName)===-1?s("not in whitelist",t.transportName):t.enabled(a)?(s("enabled",t.transportName),e.main.push(t),t.facadeTransport&&e.facade.push(t.facadeTransport)):s("disabled",t.transportName):s())}),e}}}},{debug:void 0}],52:[function(n,l,v){var s=n("url-parse");l.exports={getOrigin:function(r){if(!r)return null;var o=new s(r);if(o.protocol==="file:")return null;var a=o.port;return a=a||(o.protocol==="https:"?"443":"80"),o.protocol+"//"+o.hostname+":"+a},isOriginEqual:function(r,o){var a=this.getOrigin(r)===this.getOrigin(o);return a},isSchemeEqual:function(r,o){return r.split(":")[0]===o.split(":")[0]},addPath:function(r,o){var a=r.split("?");return a[0]+o+(a[1]?"?"+a[1]:"")},addQuery:function(r,o){return r+(r.indexOf("?")===-1?"?"+o:"&"+o)},isLoopbackAddr:function(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^\[::1\]$/.test(r)}}},{debug:void 0,"url-parse":57}],53:[function(n,l,v){l.exports="1.6.1"},{}],54:[function(n,l,v){typeof Object.create=="function"?l.exports=function(s,r){r&&(s.super_=r,s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:l.exports=function(s,r){if(r){let o=function(){};s.super_=r,o.prototype=r.prototype,s.prototype=new o,s.prototype.constructor=s}}},{}],55:[function(n,l,v){var s=Object.prototype.hasOwnProperty;function r(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}v.stringify=function(o,a){a=a||"";var e,t,i=[];for(t in typeof a!="string"&&(a="?"),o)if(s.call(o,t)){if((e=o[t])||e!=null&&!isNaN(e)||(e=""),t=encodeURIComponent(t),e=encodeURIComponent(e),t===null||e===null)continue;i.push(t+"="+e)}return i.length?a+i.join("&"):""},v.parse=function(o){for(var a,e=/([^=?&]+)=?([^&]*)/g,t={};a=e.exec(o);){var i=r(a[1]),u=r(a[2]);i===null||u===null||i in t||(t[i]=u)}return t}},{}],56:[function(n,l,v){l.exports=function(s,r){if(r=r.split(":")[0],!(s=+s))return!1;switch(r){case"http":case"ws":return s!==80;case"https":case"wss":return s!==443;case"ftp":return s!==21;case"gopher":return s!==70;case"file":return!1}return s!==0}},{}],57:[function(n,l,v){(function(s){(function(){var r=n("requires-port"),o=n("querystringify"),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,e=/[\n\r\t]/g,t=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function p(w){return(w||"").toString().replace(a,"")}var d=[["#","hash"],["?","query"],function(w,b){return E(b.protocol)?w.replace(/\\/g,"/"):w},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function m(w){var b,_=(typeof window<"u"?window:s!==void 0?s:typeof self<"u"?self:{}).location||{},h={},A=typeof(w=w||_);if(w.protocol==="blob:")h=new j(unescape(w.pathname),{});else if(A=="string")for(b in h=new j(w,{}),f)delete h[b];else if(A=="object"){for(b in w)b in f||(h[b]=w[b]);h.slashes===void 0&&(h.slashes=t.test(w.href))}return h}function E(w){return w==="file:"||w==="ftp:"||w==="http:"||w==="https:"||w==="ws:"||w==="wss:"}function S(w,b){w=(w=p(w)).replace(e,""),b=b||{};var _,h=u.exec(w),A=h[1]?h[1].toLowerCase():"",g=!!h[2],T=!!h[3],y=0;return g?y=T?(_=h[2]+h[3]+h[4],h[2].length+h[3].length):(_=h[2]+h[4],h[2].length):T?(_=h[3]+h[4],y=h[3].length):_=h[4],A==="file:"?2<=y&&(_=_.slice(2)):E(A)?_=h[4]:A?g&&(_=_.slice(2)):2<=y&&E(b.protocol)&&(_=h[4]),{protocol:A,slashes:g||E(A),slashesCount:y,rest:_}}function j(w,b,_){if(w=(w=p(w)).replace(e,""),!(this instanceof j))return new j(w,b,_);var h,A,g,T,y,C,N=d.slice(),L=typeof b,x=this,U=0;for(L!="object"&&L!="string"&&(_=b,b=null),_&&typeof _!="function"&&(_=o.parse),h=!(A=S(w||"",b=m(b))).protocol&&!A.slashes,x.slashes=A.slashes||h&&b.slashes,x.protocol=A.protocol||b.protocol||"",w=A.rest,(A.protocol==="file:"&&(A.slashesCount!==2||c.test(w))||!A.slashes&&(A.protocol||A.slashesCount<2||!E(x.protocol)))&&(N[3]=[/(.*)/,"pathname"]);U<N.length;U++)typeof(T=N[U])!="function"?(g=T[0],C=T[1],g!=g?x[C]=w:typeof g=="string"?~(y=g==="@"?w.lastIndexOf(g):w.indexOf(g))&&(w=typeof T[2]=="number"?(x[C]=w.slice(0,y),w.slice(y+T[2])):(x[C]=w.slice(y),w.slice(0,y))):(y=g.exec(w))&&(x[C]=y[1],w=w.slice(0,y.index)),x[C]=x[C]||h&&T[3]&&b[C]||"",T[4]&&(x[C]=x[C].toLowerCase())):w=T(w,x);_&&(x.query=_(x.query)),h&&b.slashes&&x.pathname.charAt(0)!=="/"&&(x.pathname!==""||b.pathname!=="")&&(x.pathname=function(P,W){if(P==="")return W;for(var D=(W||"/").split("/").slice(0,-1).concat(P.split("/")),q=D.length,B=D[q-1],nt=!1,z=0;q--;)D[q]==="."?D.splice(q,1):D[q]===".."?(D.splice(q,1),z++):z&&(q===0&&(nt=!0),D.splice(q,1),z--);return nt&&D.unshift(""),B!=="."&&B!==".."||D.push(""),D.join("/")}(x.pathname,b.pathname)),x.pathname.charAt(0)!=="/"&&E(x.protocol)&&(x.pathname="/"+x.pathname),r(x.port,x.protocol)||(x.host=x.hostname,x.port=""),x.username=x.password="",x.auth&&(~(y=x.auth.indexOf(":"))?(x.username=x.auth.slice(0,y),x.username=encodeURIComponent(decodeURIComponent(x.username)),x.password=x.auth.slice(y+1),x.password=encodeURIComponent(decodeURIComponent(x.password))):x.username=encodeURIComponent(decodeURIComponent(x.auth)),x.auth=x.password?x.username+":"+x.password:x.username),x.origin=x.protocol!=="file:"&&E(x.protocol)&&x.host?x.protocol+"//"+x.host:"null",x.href=x.toString()}j.prototype={set:function(w,b,_){var h=this;switch(w){case"query":typeof b=="string"&&b.length&&(b=(_||o.parse)(b)),h[w]=b;break;case"port":h[w]=b,r(b,h.protocol)?b&&(h.host=h.hostname+":"+b):(h.host=h.hostname,h[w]="");break;case"hostname":h[w]=b,h.port&&(b+=":"+h.port),h.host=b;break;case"host":h[w]=b,i.test(b)?(b=b.split(":"),h.port=b.pop(),h.hostname=b.join(":")):(h.hostname=b,h.port="");break;case"protocol":h.protocol=b.toLowerCase(),h.slashes=!_;break;case"pathname":case"hash":if(b){var A=w==="pathname"?"/":"#";h[w]=b.charAt(0)!==A?A+b:b}else h[w]=b;break;case"username":case"password":h[w]=encodeURIComponent(b);break;case"auth":var g=b.indexOf(":");~g?(h.username=b.slice(0,g),h.username=encodeURIComponent(decodeURIComponent(h.username)),h.password=b.slice(g+1),h.password=encodeURIComponent(decodeURIComponent(h.password))):h.username=encodeURIComponent(decodeURIComponent(b))}for(var T=0;T<d.length;T++){var y=d[T];y[4]&&(h[y[1]]=h[y[1]].toLowerCase())}return h.auth=h.password?h.username+":"+h.password:h.username,h.origin=h.protocol!=="file:"&&E(h.protocol)&&h.host?h.protocol+"//"+h.host:"null",h.href=h.toString(),h},toString:function(w){w&&typeof w=="function"||(w=o.stringify);var b,_=this,h=_.host,A=_.protocol;A&&A.charAt(A.length-1)!==":"&&(A+=":");var g=A+(_.protocol&&_.slashes||E(_.protocol)?"//":"");return _.username?(g+=_.username,_.password&&(g+=":"+_.password),g+="@"):_.password?(g+=":"+_.password,g+="@"):_.protocol!=="file:"&&E(_.protocol)&&!h&&_.pathname!=="/"&&(g+="@"),(h[h.length-1]===":"||i.test(_.hostname)&&!_.port)&&(h+=":"),g+=h+_.pathname,(b=typeof _.query=="object"?w(_.query):_.query)&&(g+=b.charAt(0)!=="?"?"?"+b:b),_.hash&&(g+=_.hash),g}},j.extractProtocol=S,j.location=m,j.trimLeft=p,j.qs=o,l.exports=j}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{querystringify:55,"requires-port":56}]},{},[1])(1)})})(gt);var ie=gt.exports;const se=mt(ie);var V={exports:{}},et={};(function(O){(function(){var R,n,l,v,s={}.hasOwnProperty,r=[].slice;R={LF:`
`,NULL:"\0"},l=function(){var o;function a(e,t,i){this.command=e,this.headers=t??{},this.body=i??""}return a.prototype.toString=function(){var e,t,i,u,c;e=[this.command],i=this.headers["content-length"]===!1,i&&delete this.headers["content-length"],c=this.headers;for(t in c)s.call(c,t)&&(u=c[t],e.push(""+t+":"+u));return this.body&&!i&&e.push("content-length:"+a.sizeOfUTF8(this.body)),e.push(R.LF+this.body),e.join(R.LF)},a.sizeOfUTF8=function(e){return e?encodeURI(e).match(/%..|./g).length:0},o=function(e){var t,i,u,c,p,d,f,m,E,S,j,w,b,_,h,A,g;for(c=e.search(RegExp(""+R.LF+R.LF)),p=e.substring(0,c).split(R.LF),u=p.shift(),d={},w=function(T){return T.replace(/^\s+|\s+$/g,"")},A=p.reverse(),b=0,h=A.length;b<h;b++)S=A[b],m=S.indexOf(":"),d[w(S.substring(0,m))]=w(S.substring(m+1));if(t="",j=c+2,d["content-length"])E=parseInt(d["content-length"]),t=(""+e).substring(j,j+E);else for(i=null,f=_=j,g=e.length;(j<=g?_<g:_>g)&&(i=e.charAt(f),i!==R.NULL);f=j<=g?++_:--_)t+=i;return new a(u,d,t)},a.unmarshall=function(e){var t;return function(){var i,u,c,p;for(c=e.split(RegExp(""+R.NULL+R.LF+"*")),p=[],i=0,u=c.length;i<u;i++)t=c[i],(t!=null?t.length:void 0)>0&&p.push(o(t));return p}()},a.marshall=function(e,t,i){var u;return u=new a(e,t,i),u.toString()+R.NULL},a}(),n=function(){var o;function a(e){this.ws=e,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16*1024,this.subscriptions={}}return a.prototype.debug=function(e){var t;return typeof window<"u"&&window!==null&&(t=window.console)!=null?t.log(e):void 0},o=function(){return Date.now?Date.now():new Date().valueOf},a.prototype._transmit=function(e,t,i){var u;for(u=l.marshall(e,t,i),typeof this.debug=="function"&&this.debug(">>> "+u);;)if(u.length>this.maxWebSocketFrameSize)this.ws.send(u.substring(0,this.maxWebSocketFrameSize)),u=u.substring(this.maxWebSocketFrameSize),typeof this.debug=="function"&&this.debug("remaining = "+u.length);else return this.ws.send(u)},a.prototype._setupHeartbeat=function(e){var t,i,u,c,p,d;if(!((p=e.version)!==v.VERSIONS.V1_1&&p!==v.VERSIONS.V1_2)&&(d=function(){var f,m,E,S;for(E=e["heart-beat"].split(","),S=[],f=0,m=E.length;f<m;f++)c=E[f],S.push(parseInt(c));return S}(),i=d[0],t=d[1],this.heartbeat.outgoing===0||t===0||(u=Math.max(this.heartbeat.outgoing,t),typeof this.debug=="function"&&this.debug("send PING every "+u+"ms"),this.pinger=v.setInterval(u,function(f){return function(){return f.ws.send(R.LF),typeof f.debug=="function"?f.debug(">>> PING"):void 0}}(this))),!(this.heartbeat.incoming===0||i===0)))return u=Math.max(this.heartbeat.incoming,i),typeof this.debug=="function"&&this.debug("check PONG every "+u+"ms"),this.ponger=v.setInterval(u,function(f){return function(){var m;if(m=o()-f.serverActivity,m>u*2)return typeof f.debug=="function"&&f.debug("did not receive server activity for the last "+m+"ms"),f.ws.close()}}(this))},a.prototype._parseConnect=function(){var e,t,i,u;switch(e=1<=arguments.length?r.call(arguments,0):[],u={},e.length){case 2:u=e[0],t=e[1];break;case 3:e[1]instanceof Function?(u=e[0],t=e[1],i=e[2]):(u.login=e[0],u.passcode=e[1],t=e[2]);break;case 4:u.login=e[0],u.passcode=e[1],t=e[2],i=e[3];break;default:u.login=e[0],u.passcode=e[1],t=e[2],i=e[3],u.host=e[4]}return[u,t,i]},a.prototype.connect=function(){var e,t,i,u;return e=1<=arguments.length?r.call(arguments,0):[],u=this._parseConnect.apply(this,e),i=u[0],this.connectCallback=u[1],t=u[2],typeof this.debug=="function"&&this.debug("Opening Web Socket..."),this.ws.onmessage=function(c){return function(p){var d,f,m,E,S,j,w,b,_,h,A,g;if(E=typeof ArrayBuffer<"u"&&p.data instanceof ArrayBuffer?(d=new Uint8Array(p.data),typeof c.debug=="function"&&c.debug("--- got data length: "+d.length),function(){var T,y,C;for(C=[],T=0,y=d.length;T<y;T++)f=d[T],C.push(String.fromCharCode(f));return C}().join("")):p.data,c.serverActivity=o(),E===R.LF){typeof c.debug=="function"&&c.debug("<<< PONG");return}for(typeof c.debug=="function"&&c.debug("<<< "+E),A=l.unmarshall(E),g=[],_=0,h=A.length;_<h;_++)switch(S=A[_],S.command){case"CONNECTED":typeof c.debug=="function"&&c.debug("connected to server "+S.headers.server),c.connected=!0,c._setupHeartbeat(S.headers),g.push(typeof c.connectCallback=="function"?c.connectCallback(S):void 0);break;case"MESSAGE":b=S.headers.subscription,w=c.subscriptions[b]||c.onreceive,w?(m=c,j=S.headers["message-id"],S.ack=function(T){return T==null&&(T={}),m.ack(j,b,T)},S.nack=function(T){return T==null&&(T={}),m.nack(j,b,T)},g.push(w(S))):g.push(typeof c.debug=="function"?c.debug("Unhandled received MESSAGE: "+S):void 0);break;case"RECEIPT":g.push(typeof c.onreceipt=="function"?c.onreceipt(S):void 0);break;case"ERROR":g.push(typeof t=="function"?t(S):void 0);break;default:g.push(typeof c.debug=="function"?c.debug("Unhandled frame: "+S):void 0)}return g}}(this),this.ws.onclose=function(c){return function(){var p;return p="Whoops! Lost connection to "+c.ws.url,typeof c.debug=="function"&&c.debug(p),c._cleanUp(),typeof t=="function"?t(p):void 0}}(this),this.ws.onopen=function(c){return function(){return typeof c.debug=="function"&&c.debug("Web Socket Opened..."),i["accept-version"]=v.VERSIONS.supportedVersions(),i["heart-beat"]=[c.heartbeat.outgoing,c.heartbeat.incoming].join(","),c._transmit("CONNECT",i)}}(this)},a.prototype.disconnect=function(e,t){return t==null&&(t={}),this._transmit("DISCONNECT",t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),typeof e=="function"?e():void 0},a.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&v.clearInterval(this.pinger),this.ponger)return v.clearInterval(this.ponger)},a.prototype.send=function(e,t,i){return t==null&&(t={}),i==null&&(i=""),t.destination=e,this._transmit("SEND",t,i)},a.prototype.subscribe=function(e,t,i){var u;return i==null&&(i={}),i.id||(i.id="sub-"+this.counter++),i.destination=e,this.subscriptions[i.id]=t,this._transmit("SUBSCRIBE",i),u=this,{id:i.id,unsubscribe:function(){return u.unsubscribe(i.id)}}},a.prototype.unsubscribe=function(e){return delete this.subscriptions[e],this._transmit("UNSUBSCRIBE",{id:e})},a.prototype.begin=function(e){var t,i;return i=e||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:i}),t=this,{id:i,commit:function(){return t.commit(i)},abort:function(){return t.abort(i)}}},a.prototype.commit=function(e){return this._transmit("COMMIT",{transaction:e})},a.prototype.abort=function(e){return this._transmit("ABORT",{transaction:e})},a.prototype.ack=function(e,t,i){return i==null&&(i={}),i["message-id"]=e,i.subscription=t,this._transmit("ACK",i)},a.prototype.nack=function(e,t,i){return i==null&&(i={}),i["message-id"]=e,i.subscription=t,this._transmit("NACK",i)},a}(),v={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(o,a){var e,t;return a==null&&(a=["v10.stomp","v11.stomp"]),e=v.WebSocketClass||WebSocket,t=new e(o,a),new n(t)},over:function(o){return new n(o)},Frame:l},O!==null&&(O.Stomp=v),typeof window<"u"&&window!==null?(v.setInterval=function(o,a){return window.setInterval(a,o)},v.clearInterval=function(o){return window.clearInterval(o)},window.Stomp=v):O||(self.Stomp=v)}).call(I)})(et);var tt={},ut={},ct;function yt(){if(ct)return ut;ct=1;var O=yt();for(k in O)I[k]=O[k];return ut}var Q,lt;function ae(){if(lt)return Q;lt=1;var O=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Q=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return O()}try{return __global__||O()}finally{delete Object.prototype.__global__}}(),Q}const ue="websocket",ce="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",le=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],fe="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",pe=["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],he="1.0.35",de={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},me="https://github.com/theturtle32/WebSocket-Node",ve={node:">=4.0.0"},be={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.63","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},ge={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},ye={verbose:!1},we={test:"tape test/unit/*.js",gulp:"gulp"},xe="index",_e={lib:"./lib"},Ee="lib/browser.js",Se="Apache-2.0",ke={name:ue,description:ce,keywords:le,author:fe,contributors:pe,version:he,repository:de,homepage:me,engines:ve,dependencies:be,devDependencies:ge,config:ye,scripts:we,main:xe,directories:_e,browser:Ee,license:Se};var K,ft;function Oe(){return ft||(ft=1,K=ke.version),K}var Z,pt;function Ce(){if(pt)return Z;pt=1;var O;if(typeof globalThis=="object")O=globalThis;else try{O=ae()}catch{}finally{if(!O&&typeof window<"u"&&(O=window),!O)throw new Error("Could not determine global this")}var R=O.WebSocket||O.MozWebSocket,n=Oe();function l(v,s){var r;return s?r=new R(v,s):r=new R(v),r}return R&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(v){Object.defineProperty(l,v,{get:function(){return R[v]}})}),Z={w3cwebsocket:R?l:null,version:n},Z}(function(){var O,R,n,l,v,s;O=et,R=yt(),O.Stomp.setInterval=function(r,o){return setInterval(o,r)},O.Stomp.clearInterval=function(r){return clearInterval(r)},v=function(r,o){var a,e;return a=null,e={url:"tcp:// "+o+":"+r,send:function(t){return a.write(t)},close:function(){return a.end()}},a=R.connect(r,o,function(t){return e.onopen()}),a.on("error",function(t){return typeof e.onclose=="function"?e.onclose(t):void 0}),a.on("close",function(t){return typeof e.onclose=="function"?e.onclose(t):void 0}),a.on("data",function(t){var i;return i={data:t.toString()},e.onmessage(i)}),e},s=function(r){var o,a,e,t;return o=Ce().client,a=null,t={url:r,send:function(i){return a.sendUTF(i)},close:function(){return a.close()}},e=new o,e.on("connect",function(i){return a=i,t.onopen(),a.on("error",function(u){return typeof t.onclose=="function"?t.onclose(u):void 0}),a.on("close",function(){return typeof t.onclose=="function"?t.onclose():void 0}),a.on("message",function(u){var c;if(u.type==="utf8")return c={data:u.utf8Data},t.onmessage(c)})}),e.connect(r),t},n=function(r,o){var a;return a=v(o,r),O.Stomp.over(a)},l=function(r){var o;return o=s(r),O.Stomp.over(o)},tt.overTCP=n,tt.overWS=l}).call(I);var Te=et,wt=tt;V.exports=Te.Stomp;V.exports.overTCP=wt.overTCP;V.exports.overWS=wt.overWS;var Ne=V.exports;const je=mt(Ne),{wsCache:J}=dt();let M;const Ie={install(){const O=[{topic:"/task-export-topic",event:"task-export-topic-call"},{topic:"/report-notice",event:"report-notice-call"}];function R(){return J.get("app.desktop")?!0:J.get("user.token")&&J.get("user.uid")}function n(){var e;if(!R()||M&&M.connected)return;let s="/";(e=window.DataEaseBi)!=null&&e.baseUrl?s=window.DataEaseBi.baseUrl:s=location.origin+location.pathname,s.endsWith("/")||(s+="/");const r=J.get("app.desktop")?1:J.get("user.uid"),o=new se(s+"websocket?userId="+r);M=je.over(o);const a={userId:r};M.connect(a,()=>{O.forEach(t=>{M.subscribe("/user/"+r+t.topic,i=>{i&&i.body&&ht().emitter.emit(t.event,i.body)})})},t=>{l(),console.error("连接失败: "+t)})}function l(){M&&M.connected&&M.disconnect(function(){console.info("断开连接")},function(s){console.info("断开连接失败: "+s)}),M=null}function v(){n(),setInterval(()=>{if(!R()){l();return}(!M||!M.connected)&&n()},5e3)}v()}},Ae=async()=>{const O=At(Zt);Vt(O),Et(O),await Mt(O),Bt(O),St(O),$t(O),kt(O),O.use(Ie),O.mount("#app")};Ae();
